var roosterjs=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=107)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeTypes=t.PluginEventType=t.TableBorderFormat=t.KnownCreateElementDataIndex=t.ClearFormatMode=t.ImageEditOperation=t.TableOperation=t.RegionType=t.QueryScope=t.PositionType=t.ListType=t.Capitalization=t.Indentation=t.GetContentMode=t.FontSizeChange=t.ExperimentalFeatures=t.EntityOperation=t.EntityClasses=t.Direction=t.DarkModeDatasetNames=t.ContentPosition=t.ColorTransformDirection=t.ChangeSource=t.Alignment=t.ContentType=t.ContentTypePrefix=t.NodeType=t.Keys=t.DocumentPosition=t.DocumentCommand=void 0;var r=n(112);Object.defineProperty(t,"DocumentCommand",{enumerable:!0,get:function(){return r.DocumentCommand}});var o=n(113);Object.defineProperty(t,"DocumentPosition",{enumerable:!0,get:function(){return o.DocumentPosition}});var i=n(114);Object.defineProperty(t,"Keys",{enumerable:!0,get:function(){return i.Keys}});var a=n(115);Object.defineProperty(t,"NodeType",{enumerable:!0,get:function(){return a.NodeType}});var l=n(116);Object.defineProperty(t,"ContentTypePrefix",{enumerable:!0,get:function(){return l.ContentTypePrefix}}),Object.defineProperty(t,"ContentType",{enumerable:!0,get:function(){return l.ContentType}});var s=n(117);Object.defineProperty(t,"Alignment",{enumerable:!0,get:function(){return s.Alignment}});var u=n(118);Object.defineProperty(t,"ChangeSource",{enumerable:!0,get:function(){return u.ChangeSource}});var c=n(119);Object.defineProperty(t,"ColorTransformDirection",{enumerable:!0,get:function(){return c.ColorTransformDirection}});var d=n(120);Object.defineProperty(t,"ContentPosition",{enumerable:!0,get:function(){return d.ContentPosition}});var f=n(121);Object.defineProperty(t,"DarkModeDatasetNames",{enumerable:!0,get:function(){return f.DarkModeDatasetNames}});var h=n(122);Object.defineProperty(t,"Direction",{enumerable:!0,get:function(){return h.Direction}});var p=n(123);Object.defineProperty(t,"EntityClasses",{enumerable:!0,get:function(){return p.EntityClasses}});var g=n(124);Object.defineProperty(t,"EntityOperation",{enumerable:!0,get:function(){return g.EntityOperation}});var v=n(125);Object.defineProperty(t,"ExperimentalFeatures",{enumerable:!0,get:function(){return v.ExperimentalFeatures}});var y=n(126);Object.defineProperty(t,"FontSizeChange",{enumerable:!0,get:function(){return y.FontSizeChange}});var m=n(127);Object.defineProperty(t,"GetContentMode",{enumerable:!0,get:function(){return m.GetContentMode}});var b=n(128);Object.defineProperty(t,"Indentation",{enumerable:!0,get:function(){return b.Indentation}});var E=n(129);Object.defineProperty(t,"Capitalization",{enumerable:!0,get:function(){return E.Capitalization}});var C=n(130);Object.defineProperty(t,"ListType",{enumerable:!0,get:function(){return C.ListType}});var T=n(131);Object.defineProperty(t,"PositionType",{enumerable:!0,get:function(){return T.PositionType}});var S=n(132);Object.defineProperty(t,"QueryScope",{enumerable:!0,get:function(){return S.QueryScope}});var P=n(133);Object.defineProperty(t,"RegionType",{enumerable:!0,get:function(){return P.RegionType}});var w=n(134);Object.defineProperty(t,"TableOperation",{enumerable:!0,get:function(){return w.TableOperation}});var O=n(135);Object.defineProperty(t,"ImageEditOperation",{enumerable:!0,get:function(){return O.ImageEditOperation}});var N=n(136);Object.defineProperty(t,"ClearFormatMode",{enumerable:!0,get:function(){return N.ClearFormatMode}});var x=n(137);Object.defineProperty(t,"KnownCreateElementDataIndex",{enumerable:!0,get:function(){return x.KnownCreateElementDataIndex}});var R=n(138);Object.defineProperty(t,"TableBorderFormat",{enumerable:!0,get:function(){return R.TableBorderFormat}});var I=n(139);Object.defineProperty(t,"PluginEventType",{enumerable:!0,get:function(){return I.PluginEventType}});var M=n(140);Object.defineProperty(t,"SelectionRangeTypes",{enumerable:!0,get:function(){return M.SelectionRangeTypes}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KnownCreateElementData=t.createElement=t.matchesSelector=t.setColor=t.getInnerHTML=t.readFile=t.safeInstanceOf=t.toArray=t.normalizeRect=t.splitTextNode=t.getLastLeafNode=t.getFirstLeafNode=t.getPreviousLeafSibling=t.getNextLeafSibling=t.wrap=t.unwrap=t.splitBalancedNodeRange=t.splitParentNode=t.queryElements=t.matchLink=t.isVoidHtmlElement=t.isNodeEmpty=t.isBlockElement=t.getTagOfNode=t.PendableFormatCommandMap=t.getPendableFormatState=t.getComputedStyle=t.getComputedStyles=t.fromHtml=t.findClosestElementAncestor=t.contains=t.collapseNodes=t.changeElementTag=t.applyFormat=t.getBrowserInfo=t.Browser=t.arrayPush=t.extractClipboardItemsForIE=t.extractClipboardItems=t.extractClipboardEvent=t.applyTextStyle=t.PartialInlineElement=t.NodeInlineElement=t.LinkInlineElement=t.ImageInlineElement=t.getInlineElementAtNode=t.PositionContentSearcher=t.ContentTraverser=t.getFirstLastBlockElement=t.getBlockElementAtNode=void 0,t.getTextContent=t.deleteSelectedContent=t.adjustInsertPosition=t.setStyles=t.getStyles=t.isCtrlOrMetaPressed=t.isCharacterValue=t.isModifierKey=t.clearEventDataCache=t.cacheGetEventData=t.getEntitySelector=t.getEntityFromElement=t.commitEntity=t.chainSanitizerCallback=t.createDefaultHtmlSanitizerOptions=t.getInheritableStyles=t.HtmlSanitizer=t.canUndoAutoComplete=t.createSnapshots=t.moveCurrentSnapsnot=t.moveCurrentSnapshot=t.clearProceedingSnapshotsV2=t.clearProceedingSnapshots=t.canMoveCurrentSnapshot=t.addSnapshotV2=t.addSnapshot=t.addRangeToSelection=t.setHtmlWithMetadata=t.setHtmlWithSelectionPath=t.getHtmlWithSelectionPath=t.getSelectionPath=t.isPositionAtBeginningOf=t.getPositionRect=t.createRange=t.Position=t.mergeBlocksInRegion=t.getSelectionRangeInRegion=t.isNodeInRegion=t.collapseNodesInRegion=t.getSelectedBlockElementsInRegion=t.getRegionsFromRange=t.setListItemStyle=t.VListChain=t.createVListFromRegion=t.VListItem=t.VList=t.isWholeTableSelected=t.VTable=t.moveChildNodes=void 0;var r=n(8);Object.defineProperty(t,"getBlockElementAtNode",{enumerable:!0,get:function(){return r.default}});var o=n(58);Object.defineProperty(t,"getFirstLastBlockElement",{enumerable:!0,get:function(){return o.default}});var i=n(23);Object.defineProperty(t,"ContentTraverser",{enumerable:!0,get:function(){return i.default}});var a=n(63);Object.defineProperty(t,"PositionContentSearcher",{enumerable:!0,get:function(){return a.default}});var l=n(16);Object.defineProperty(t,"getInlineElementAtNode",{enumerable:!0,get:function(){return l.default}});var s=n(59);Object.defineProperty(t,"ImageInlineElement",{enumerable:!0,get:function(){return s.default}});var u=n(41);Object.defineProperty(t,"LinkInlineElement",{enumerable:!0,get:function(){return u.default}});var c=n(28);Object.defineProperty(t,"NodeInlineElement",{enumerable:!0,get:function(){return c.default}});var d=n(30);Object.defineProperty(t,"PartialInlineElement",{enumerable:!0,get:function(){return d.default}});var f=n(39);Object.defineProperty(t,"applyTextStyle",{enumerable:!0,get:function(){return f.default}});var h=n(145);Object.defineProperty(t,"extractClipboardEvent",{enumerable:!0,get:function(){return h.default}});var p=n(64);Object.defineProperty(t,"extractClipboardItems",{enumerable:!0,get:function(){return p.default}});var g=n(65);Object.defineProperty(t,"extractClipboardItemsForIE",{enumerable:!0,get:function(){return g.default}});var v=n(44);Object.defineProperty(t,"arrayPush",{enumerable:!0,get:function(){return v.default}});var y=n(22);Object.defineProperty(t,"Browser",{enumerable:!0,get:function(){return y.Browser}}),Object.defineProperty(t,"getBrowserInfo",{enumerable:!0,get:function(){return y.getBrowserInfo}});var m=n(146);Object.defineProperty(t,"applyFormat",{enumerable:!0,get:function(){return m.default}});var b=n(17);Object.defineProperty(t,"changeElementTag",{enumerable:!0,get:function(){return b.default}});var E=n(19);Object.defineProperty(t,"collapseNodes",{enumerable:!0,get:function(){return E.default}});var C=n(4);Object.defineProperty(t,"contains",{enumerable:!0,get:function(){return C.default}});var T=n(12);Object.defineProperty(t,"findClosestElementAncestor",{enumerable:!0,get:function(){return T.default}});var S=n(57);Object.defineProperty(t,"fromHtml",{enumerable:!0,get:function(){return S.default}});var P=n(40);Object.defineProperty(t,"getComputedStyles",{enumerable:!0,get:function(){return P.default}}),Object.defineProperty(t,"getComputedStyle",{enumerable:!0,get:function(){return P.getComputedStyle}});var w=n(147);Object.defineProperty(t,"getPendableFormatState",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"PendableFormatCommandMap",{enumerable:!0,get:function(){return w.PendableFormatCommandMap}});var O=n(3);Object.defineProperty(t,"getTagOfNode",{enumerable:!0,get:function(){return O.default}});var N=n(20);Object.defineProperty(t,"isBlockElement",{enumerable:!0,get:function(){return N.default}});var x=n(32);Object.defineProperty(t,"isNodeEmpty",{enumerable:!0,get:function(){return x.default}});var R=n(38);Object.defineProperty(t,"isVoidHtmlElement",{enumerable:!0,get:function(){return R.default}});var I=n(148);Object.defineProperty(t,"matchLink",{enumerable:!0,get:function(){return I.default}});var M=n(18);Object.defineProperty(t,"queryElements",{enumerable:!0,get:function(){return M.default}});var D=n(14);Object.defineProperty(t,"splitParentNode",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(t,"splitBalancedNodeRange",{enumerable:!0,get:function(){return D.splitBalancedNodeRange}});var _=n(33);Object.defineProperty(t,"unwrap",{enumerable:!0,get:function(){return _.default}});var A=n(13);Object.defineProperty(t,"wrap",{enumerable:!0,get:function(){return A.default}});var L=n(9);Object.defineProperty(t,"getNextLeafSibling",{enumerable:!0,get:function(){return L.getNextLeafSibling}}),Object.defineProperty(t,"getPreviousLeafSibling",{enumerable:!0,get:function(){return L.getPreviousLeafSibling}});var k=n(61);Object.defineProperty(t,"getFirstLeafNode",{enumerable:!0,get:function(){return k.getFirstLeafNode}}),Object.defineProperty(t,"getLastLeafNode",{enumerable:!0,get:function(){return k.getLastLeafNode}});var B=n(29);Object.defineProperty(t,"splitTextNode",{enumerable:!0,get:function(){return B.default}});var j=n(46);Object.defineProperty(t,"normalizeRect",{enumerable:!0,get:function(){return j.default}});var F=n(6);Object.defineProperty(t,"toArray",{enumerable:!0,get:function(){return F.default}});var z=n(2);Object.defineProperty(t,"safeInstanceOf",{enumerable:!0,get:function(){return z.default}});var H=n(43);Object.defineProperty(t,"readFile",{enumerable:!0,get:function(){return H.default}});var K=n(66);Object.defineProperty(t,"getInnerHTML",{enumerable:!0,get:function(){return K.default}});var U=n(45);Object.defineProperty(t,"setColor",{enumerable:!0,get:function(){return U.default}});var W=n(56);Object.defineProperty(t,"matchesSelector",{enumerable:!0,get:function(){return W.default}});var V=n(21);Object.defineProperty(t,"createElement",{enumerable:!0,get:function(){return V.default}}),Object.defineProperty(t,"KnownCreateElementData",{enumerable:!0,get:function(){return V.KnownCreateElementData}});var q=n(31);Object.defineProperty(t,"moveChildNodes",{enumerable:!0,get:function(){return q.default}});var G=n(67);Object.defineProperty(t,"VTable",{enumerable:!0,get:function(){return G.default}});var Y=n(151);Object.defineProperty(t,"isWholeTableSelected",{enumerable:!0,get:function(){return Y.default}});var Q=n(47);Object.defineProperty(t,"VList",{enumerable:!0,get:function(){return Q.default}});var X=n(68);Object.defineProperty(t,"VListItem",{enumerable:!0,get:function(){return X.default}});var Z=n(152);Object.defineProperty(t,"createVListFromRegion",{enumerable:!0,get:function(){return Z.default}});var $=n(153);Object.defineProperty(t,"VListChain",{enumerable:!0,get:function(){return $.default}});var J=n(69);Object.defineProperty(t,"setListItemStyle",{enumerable:!0,get:function(){return J.default}});var ee=n(72);Object.defineProperty(t,"getRegionsFromRange",{enumerable:!0,get:function(){return ee.default}});var te=n(71);Object.defineProperty(t,"getSelectedBlockElementsInRegion",{enumerable:!0,get:function(){return te.default}});var ne=n(73);Object.defineProperty(t,"collapseNodesInRegion",{enumerable:!0,get:function(){return ne.default}});var re=n(25);Object.defineProperty(t,"isNodeInRegion",{enumerable:!0,get:function(){return re.default}});var oe=n(49);Object.defineProperty(t,"getSelectionRangeInRegion",{enumerable:!0,get:function(){return oe.default}});var ie=n(74);Object.defineProperty(t,"mergeBlocksInRegion",{enumerable:!0,get:function(){return ie.default}});var ae=n(5);Object.defineProperty(t,"Position",{enumerable:!0,get:function(){return ae.default}});var le=n(10);Object.defineProperty(t,"createRange",{enumerable:!0,get:function(){return le.default}});var se=n(154);Object.defineProperty(t,"getPositionRect",{enumerable:!0,get:function(){return se.default}});var ue=n(76);Object.defineProperty(t,"isPositionAtBeginningOf",{enumerable:!0,get:function(){return ue.default}});var ce=n(77);Object.defineProperty(t,"getSelectionPath",{enumerable:!0,get:function(){return ce.default}});var de=n(155);Object.defineProperty(t,"getHtmlWithSelectionPath",{enumerable:!0,get:function(){return de.default}});var fe=n(156);Object.defineProperty(t,"setHtmlWithSelectionPath",{enumerable:!0,get:function(){return fe.default}}),Object.defineProperty(t,"setHtmlWithMetadata",{enumerable:!0,get:function(){return fe.setHtmlWithMetadata}});var he=n(157);Object.defineProperty(t,"addRangeToSelection",{enumerable:!0,get:function(){return he.default}});var pe=n(158);Object.defineProperty(t,"addSnapshot",{enumerable:!0,get:function(){return pe.default}}),Object.defineProperty(t,"addSnapshotV2",{enumerable:!0,get:function(){return pe.addSnapshotV2}});var ge=n(50);Object.defineProperty(t,"canMoveCurrentSnapshot",{enumerable:!0,get:function(){return ge.default}});var ve=n(78);Object.defineProperty(t,"clearProceedingSnapshots",{enumerable:!0,get:function(){return ve.default}}),Object.defineProperty(t,"clearProceedingSnapshotsV2",{enumerable:!0,get:function(){return ve.clearProceedingSnapshotsV2}});var ye=n(159);Object.defineProperty(t,"moveCurrentSnapshot",{enumerable:!0,get:function(){return ye.default}}),Object.defineProperty(t,"moveCurrentSnapsnot",{enumerable:!0,get:function(){return ye.moveCurrentSnapsnot}});var me=n(160);Object.defineProperty(t,"createSnapshots",{enumerable:!0,get:function(){return me.default}});var be=n(161);Object.defineProperty(t,"canUndoAutoComplete",{enumerable:!0,get:function(){return be.default}});var Ee=n(162);Object.defineProperty(t,"HtmlSanitizer",{enumerable:!0,get:function(){return Ee.default}});var Ce=n(79);Object.defineProperty(t,"getInheritableStyles",{enumerable:!0,get:function(){return Ce.default}});var Te=n(164);Object.defineProperty(t,"createDefaultHtmlSanitizerOptions",{enumerable:!0,get:function(){return Te.default}});var Se=n(165);Object.defineProperty(t,"chainSanitizerCallback",{enumerable:!0,get:function(){return Se.default}});var Pe=n(166);Object.defineProperty(t,"commitEntity",{enumerable:!0,get:function(){return Pe.default}});var we=n(167);Object.defineProperty(t,"getEntityFromElement",{enumerable:!0,get:function(){return we.default}});var Oe=n(168);Object.defineProperty(t,"getEntitySelector",{enumerable:!0,get:function(){return Oe.default}});var Ne=n(169);Object.defineProperty(t,"cacheGetEventData",{enumerable:!0,get:function(){return Ne.default}});var xe=n(170);Object.defineProperty(t,"clearEventDataCache",{enumerable:!0,get:function(){return xe.default}});var Re=n(81);Object.defineProperty(t,"isModifierKey",{enumerable:!0,get:function(){return Re.default}});var Ie=n(171);Object.defineProperty(t,"isCharacterValue",{enumerable:!0,get:function(){return Ie.default}});var Me=n(172);Object.defineProperty(t,"isCtrlOrMetaPressed",{enumerable:!0,get:function(){return Me.default}});var De=n(34);Object.defineProperty(t,"getStyles",{enumerable:!0,get:function(){return De.default}});var _e=n(35);Object.defineProperty(t,"setStyles",{enumerable:!0,get:function(){return _e.default}});var Ae=n(173);Object.defineProperty(t,"adjustInsertPosition",{enumerable:!0,get:function(){return Ae.default}});var Le=n(174);Object.defineProperty(t,"deleteSelectedContent",{enumerable:!0,get:function(){return Le.default}});var ke=n(175);Object.defineProperty(t,"getTextContent",{enumerable:!0,get:function(){return ke.default}})},function(e,t,n){"use strict";function r(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=void 0,t.getTargetWindow=r,t.default=function(e,t){var n=r(e),o=n&&n[t],i=window,a=i&&i[t];return a&&e instanceof a||o&&e instanceof o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return e&&e.nodeType==r.NodeType.Element?e.tagName.toUpperCase():""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),o=n(0);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||((0,r.default)(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&t.nodeType==o.NodeType.Text&&(t=t.parentNode,n=!0),e.nodeType!=o.NodeType.Element&&e.nodeType!=o.NodeType.DocumentFragment?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12),o=n(15),i=n(0),a=function(){function e(e,t,n){switch(void 0===t&&(t=0),this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case i.PositionType.Before:this.offset=l(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case i.PositionType.After:this.offset=l(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case i.PositionType.End:this.offset=s(this.node),this.isAtEnd=!0;break;default:var o=s(this.node);this.offset=Math.max(0,Math.min(t,o)),this.isAtEnd=t>0&&t>=o}this.element=(0,r.default)(this.node)}return e.prototype.normalize=function(){if(this.node.nodeType==i.NodeType.Text||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?i.PositionType.End:this.offset;t.nodeType==i.NodeType.Element||t.nodeType==i.NodeType.DocumentFragment;){var r=this.isFromEndOfRange?n==i.PositionType.End?t.lastChild:t.childNodes[n-1]:n==i.PositionType.Begin?t.firstChild:n==i.PositionType.End?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?i.PositionType.End:i.PositionType.Begin}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:(0,o.default)(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function l(e){for(var t=0;e=(null==e?void 0:e.previousSibling)||null;)t++;return t}function s(e){var t;return e.nodeType==i.NodeType.Text?(null===(t=e.nodeValue)||void 0===t?void 0:t.length)||0:e.nodeType==i.NodeType.Element?e.childNodes.length:1}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.experimentCommitListChains=t.blockFormat=t.toggleListType=t.applyCellShading=t.toggleHeader=t.toggleUnderline=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleCodeBlock=t.toggleBlockQuote=t.setOrderedListNumbering=t.toggleNumbering=t.toggleItalic=t.toggleBullet=t.toggleBold=t.changeCapitalization=t.setIndentation=t.setImageAltText=t.setFontSize=t.setFontName=t.setDirection=t.setTextColor=t.setBackgroundColor=t.setAlignment=t.rotateElement=t.replaceWithNode=t.removeLink=t.formatTable=t.editTable=t.insertTable=t.insertImage=t.insertEntity=t.getElementBasedFormatState=t.getFormatState=t.createLink=t.clearFormat=t.clearBlockFormat=t.FONT_SIZES=t.changeFontSize=void 0;var r=n(215);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"FONT_SIZES",{enumerable:!0,get:function(){return r.FONT_SIZES}});var o=n(216);Object.defineProperty(t,"clearBlockFormat",{enumerable:!0,get:function(){return o.default}});var i=n(88);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return i.default}});var a=n(217);Object.defineProperty(t,"createLink",{enumerable:!0,get:function(){return a.default}});var l=n(218);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"getElementBasedFormatState",{enumerable:!0,get:function(){return l.getElementBasedFormatState}});var s=n(219);Object.defineProperty(t,"insertEntity",{enumerable:!0,get:function(){return s.default}});var u=n(220);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return u.default}});var c=n(221);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return c.default}});var d=n(222);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return d.default}});var f=n(223);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return f.default}});var h=n(224);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return h.default}});var p=n(225);Object.defineProperty(t,"replaceWithNode",{enumerable:!0,get:function(){return p.default}});var g=n(226);Object.defineProperty(t,"rotateElement",{enumerable:!0,get:function(){return g.default}});var v=n(227);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return v.default}});var y=n(90);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return y.default}});var m=n(93);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return m.default}});var b=n(228);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return b.default}});var E=n(91);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return E.default}});var C=n(92);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return C.default}});var T=n(230);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return T.default}});var S=n(231);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return S.default}});var P=n(232);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return P.default}});var w=n(94);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return w.default}});var O=n(233);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return O.default}});var N=n(95);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return N.default}});var x=n(234);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return x.default}});var R=n(235);Object.defineProperty(t,"setOrderedListNumbering",{enumerable:!0,get:function(){return R.default}});var I=n(236);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return I.default}});var M=n(237);Object.defineProperty(t,"toggleCodeBlock",{enumerable:!0,get:function(){return M.default}});var D=n(238);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return D.default}});var _=n(239);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return _.default}});var A=n(240);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return A.default}});var L=n(96);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return L.default}});var k=n(241);Object.defineProperty(t,"toggleHeader",{enumerable:!0,get:function(){return k.default}});var B=n(242);Object.defineProperty(t,"applyCellShading",{enumerable:!0,get:function(){return B.default}});var j=n(52);Object.defineProperty(t,"toggleListType",{enumerable:!0,get:function(){return j.default}});var F=n(26);Object.defineProperty(t,"blockFormat",{enumerable:!0,get:function(){return F.default}});var z=n(89);Object.defineProperty(t,"experimentCommitListChains",{enumerable:!0,get:function(){return z.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(4),i=n(3),a=n(20),l=n(55),s=n(141);function u(e,t,n){var r=e;if("BR"==(0,i.default)(r)&&n)return r;for(;r;){for(var o=e;e.parentNode&&!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if((0,a.default)(o))return r;if("BR"==(0,i.default)(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}t.default=function(e,t){if(!(0,o.default)(e,t))return null;var n=s.default.getBlockContext(t);if(!n)return null;if(n==t)return new l.default(n);var i=u(t,n,!1),c=u(t,n,!0),d=(0,r.default)(e,i,c,!1);if(i=d[0],c=d[d.length-1],i.parentNode!=c.parentNode)return new s.default(e,i,c);for(;!i.previousSibling&&!c.nextSibling;){var f=i.parentNode;if(f==n){n!=e&&(i=c=f);break}if(!f||f==e)break;i=c=f}return i==c&&(0,a.default)(i)?new l.default(i):new s.default(e,i,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviousLeafSibling=t.getNextLeafSibling=t.getLeafSibling=void 0;var r=n(4),o=n(3),i=n(24);function a(e,t,n,a,l){var s=null,u=n?function(e){return(null==e?void 0:e.nextSibling)||null}:function(e){return(null==e?void 0:e.previousSibling)||null},c=n?function(e){return e.firstChild}:function(e){return e.lastChild};if((0,r.default)(e,t))for(var d=t,f=!0;f;){var h=(null==d?void 0:d.parentNode)||null;for(d=u(d);!d&&h!=e;)d=u(h),h=(null==h?void 0:h.parentNode)||null;for(;d&&(!a||a.indexOf((0,o.default)(d))<0)&&c(d);)d=c(d);if(!(f=!!d&&(0,i.default)(d,l))){s=d;break}}return s}t.getLeafSibling=a,t.getNextLeafSibling=function(e,t,n){return a(e,t,!0,n)},t.getPreviousLeafSibling=function(e,t,n){return a(e,t,!1,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(5),i=n(2),a=n(0);function l(e){return e.node.nodeType==a.NodeType.Element&&(0,r.default)(e.node)?new o.default(e.node,e.isAtEnd?a.PositionType.After:a.PositionType.Before):e}function s(e){return e&&e.node}function u(e,t){if(!e||!t)return null;for(var n=0,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&e.nodeType==a.NodeType.Element&&e.childNodes.length>n);r++)e=e.childNodes[n];return new o.default(e,n)}t.default=function(e,t,n,r){var c,d=null,f=null;if(s(e)?(d=e,f=s(t)?t:null):(0,i.default)(e,"Node")&&(Array.isArray(t)?(d=u(e,t),f=Array.isArray(n)?u(e,n):null):"number"==typeof t?(d=new o.default(e,t),f=(0,i.default)(n,"Node")?new o.default(n,r):null):!(0,i.default)(t,"Node")&&t||(d=new o.default(e,a.PositionType.Before),f=new o.default(t||e,a.PositionType.After))),null===(c=null==d?void 0:d.node)||void 0===c?void 0:c.ownerDocument){var h=d.node.ownerDocument.createRange();return d=l(d),f=l(f||d),h.setStart(d.node,d.offset),h.setEnd(f.node,f.offset),h}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0);t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},i=e.getSelectionRangeEx();if(i&&i.areAllCollapsed){e.addUndoSnapshot();var a=e.getPendableFormatState(!1);n();var l=Object.keys(r.PendableFormatCommandMap).filter((function(e){return r.PendableFormatCommandMap[e]==t}))[0];l&&(a[l]=!a[l],e.triggerPluginEvent(o.PluginEventType.PendingFormatStateChanged,{formatState:a}))}else e.addUndoSnapshot((function(){var t;i.ranges.forEach((function(r){i.type==o.SelectionRangeTypes.TableSelection&&e.select(r),n(),t=r})),t&&i.type==o.SelectionRangeTypes.TableSelection&&e.select(i.table,i.coordinates)}),o.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(56),i=n(0);t.default=function(e,t,n){var a=(e=e?e.nodeType==i.NodeType.Element?e:e.parentNode:null)&&e.nodeType==i.NodeType.Element?e:null;if(a&&n)if(a.closest)a=a.closest(n);else for(;a&&a!=t&&!(0,o.default)(a,n);)a=a.parentElement;return!t||(0,r.default)(t,a)?a:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(57),i=n(2);t.default=function(e,t){if(0==(e=e?(0,i.default)(e,"Node")?[e]:e:[]).length||!e[0]||!e[0].ownerDocument)return null;if(t||(t="div"),!(0,i.default)(t,"HTMLElement")){var n=e[0].ownerDocument;t="string"==typeof t?/^\w+$/.test(t)?n.createElement(t):(0,o.default)(t,n)[0]:(0,r.default)(t,n)}var a=e[0].parentNode;a&&a.insertBefore(t,e[0]);for(var l=0,s=e;l<s.length;l++){var u=s[l];t.appendChild(u)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitBalancedNodeRange=void 0;var r=n(15);function o(e,t){var n;if(!e||!e.parentNode)return null;var r=e.parentNode,o=r.cloneNode(!1);if(o.removeAttribute("id"),t)for(;r.firstChild&&r.firstChild!=e;)o.appendChild(r.firstChild);else for(;e.nextSibling;)o.appendChild(e.nextSibling);return o.firstChild&&""!=o.innerHTML?null===(n=r.parentNode)||void 0===n||n.insertBefore(o,t?r:r.nextSibling):o=null,o}t.default=o,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,i=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(i){if((0,r.default)(t,n)){var a=n;n=t,t=a}o(t,!0),o(n,!1)}return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){return!(!e||!t||(t.compareDocumentPosition(e)&r.DocumentPosition.Following)!=r.DocumentPosition.Following)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),o=n(3),i=n(59),a=n(41),l=n(28),s=n(2);t.default=function(e,t){var n=(0,s.default)(e,"Node")?(0,r.default)(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],s=e.parentNode;s&&t.contains(s);s=s.parentNode)r.push(s);for(var u=r.length-1;u>=0&&!n;u--){var c=r[u],d=(0,o.default)(c);"A"==d?n=new a.default(c,t):"IMG"==d&&(n=new i.default(c,t))}return n||new l.default(e,t)}(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(40),o=n(3),i=n(31);t.default=function(e,t){var n;if(!e||!t)return null;var a=(0,o.default)(e);if(a==t.toUpperCase())return e;for(var l=e.ownerDocument.createElement(t),s=0;s<e.attributes.length;s++){var u=e.attributes[s];l.setAttribute(u.name,u.value)}return(0,i.default)(l,e),"P"!=a&&"P"!=(0,o.default)(l)||(n=(0,r.default)(e,["margin-top","margin-bottom"]),l.style.marginTop=n[0],l.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(l,e),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(0);function i(e,t){return t.some((function(t){return t==o.DocumentPosition.Same?e==o.DocumentPosition.Same:(e&t)==t}))}t.default=function(e,t,n,a,l){if(void 0===a&&(a=o.QueryScope.Body),!e||!t)return[];var s=(0,r.default)(e.querySelectorAll(t));if(a!=o.QueryScope.Body&&l){var u=l.startContainer,c=l.startOffset,d=l.endContainer,f=l.endOffset;if(u.nodeType==o.NodeType.Element&&u.firstChild){var h=u.childNodes[c];u=h||u.lastChild}d=d.nodeType==o.NodeType.Element&&d.firstChild&&f>0?d.childNodes[f-1]:d,s=s.filter((function(e){return function(e,t,n,r){var a=e.compareDocumentPosition(t),l=e.compareDocumentPosition(n),s=[o.DocumentPosition.Same,o.DocumentPosition.Contains];r||s.push(o.DocumentPosition.ContainedBy);return i(a,s)||i(l,s)||i(a,[o.DocumentPosition.Preceding])&&i(l,[o.DocumentPosition.Following])&&!i(l,[o.DocumentPosition.ContainedBy])}(e,u,d,a==o.QueryScope.InSelection)}))}return n&&s.forEach(n),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapse=void 0;var r=n(4),o=n(14),i=n(6);function a(e,t,n,i,a){for(;t.parentNode!=e&&!(0,r.default)(t.parentNode,n);){if(i&&t.previousSibling||!i&&t.nextSibling){if(!a)break;(0,o.default)(t,i)}if(!t.parentNode)break;t=t.parentNode}return t}t.default=function(e,t,n,o){var l;if(!(0,r.default)(e,t)||!(0,r.default)(e,n))return[];if(t=a(e,t,n,!0,o),n=a(e,n,t,!1,o),(0,r.default)(t,n,!0))return[t];if((0,r.default)(n,t))return[n];if(t.parentNode==n.parentNode){var s=t.parentNode?(0,i.default)(null===(l=t.parentNode)||void 0===l?void 0:l.childNodes):[],u=s.indexOf(t),c=s.indexOf(n);return s.slice(u,c+1)}return[t,n]},t.collapse=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),i=["block","list-item","table-cell"];t.default=function(e){var t=(0,r.default)(e);return!(!t||!(i.indexOf(e.style.display)>=0||o.indexOf(t)>=0))}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.KnownCreateElementData=void 0;var o=n(2),i=n(22),a=n(0);t.KnownCreateElementData=((r={})[a.KnownCreateElementDataIndex.None]={tag:""},r[a.KnownCreateElementDataIndex.EmptyLine]=i.Browser.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},r[a.KnownCreateElementDataIndex.BlockquoteWrapper]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},r[a.KnownCreateElementDataIndex.CopyPasteTempDiv]={tag:"div",style:"width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},r[a.KnownCreateElementDataIndex.BlockListItem]={tag:"li",style:"display:block"},r[a.KnownCreateElementDataIndex.ContextMenuWrapper]={tag:"div",style:"position: fixed; width: 0; height: 0"},r[a.KnownCreateElementDataIndex.ImageEditWrapper]={tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"},r[a.KnownCreateElementDataIndex.TableHorizontalResizer]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},r[a.KnownCreateElementDataIndex.TableVerticalResizer]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},r[a.KnownCreateElementDataIndex.TableResizerLTR]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},r[a.KnownCreateElementDataIndex.TableResizerRTL]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},r[a.KnownCreateElementDataIndex.TableSelector]={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"},r),t.default=function e(n,r){if("number"==typeof n&&(n=t.KnownCreateElementData[n]),!n||!n.tag)return null;var i=n.tag,a=n.namespace,l=n.className,s=n.style,u=n.dataset,c=n.attributes,d=n.children,f=a?r.createElementNS(a,i):r.createElement(i);return s&&f.setAttribute("style",s),l&&(f.className=l),u&&(0,o.default)(f,"HTMLElement")&&Object.keys(u).forEach((function(e){f.dataset[e]=u[e]})),c&&Object.keys(c).forEach((function(e){f.setAttribute(e,c[e])})),d&&d.forEach((function(t){if("string"==typeof t)f.appendChild(r.createTextNode(t));else if(t){var n=e(t,r);n&&f.appendChild(n)}})),f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Browser=t.getBrowserInfo=void 0;var r=/android/i;function o(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),o=-1!=e.indexOf("MSIE")||n,i=!1,a=!1,l=!1,s=!1,u=-1!=e.indexOf("WebKit");return o||(i=-1!=e.indexOf("Chrome"),a=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(l=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(s=-1!=e.indexOf("Edge"))&&(u=i=a=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:u,isIE:o,isIE11OrGreater:n,isSafari:l,isChrome:i,isFirefox:a,isEdge:s,isIEOrEdge:o||s,isAndroid:r.test(e)}}t.getBrowserInfo=o,t.Browser=window?o(window.navigator.userAgent,window.navigator.appVersion):{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(142),o=n(62),i=n(8),a=n(16),l=n(30),s=n(143),u=n(144),c=n(42),d=n(9),f=n(0),h=function(){function e(e,t){this.scoper=e,this.skipTags=t,this.currentInline=null,this.currentBlock=null}return e.createBodyTraverser=function(t,n,o){return new e(new r.default(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new u.default(t,n),r)},e.createBlockTraverser=function(t,n,r,o){return void 0===r&&(r=f.ContentPosition.SelectionStart),new e(new s.default(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!1,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=(0,d.getLeafSibling)(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?(0,i.default)(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof o.default?null:this.currentInline},enumerable:!1,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof o.default?(t=(0,c.getInlineElementBeforeAfter)(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof l.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var o=t.getContainerNode();return o=(0,d.getLeafSibling)(e,o,n),(0,a.default)(e,o)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(40),i=n(0),a=/^[\r\n]+$/gm,l=/[\t\r\n\u0020\u200B]/gm;t.default=function e(t,n){if(t.nodeType==i.NodeType.Text)return!(t.nodeValue&&""!=t.textContent&&!a.test(t.nodeValue))||!(!n||""!=t.nodeValue.replace(l,""));if(t.nodeType==i.NodeType.Element){if("none"==(0,o.getComputedStyle)(t,"display"))return!0;var s=(0,r.default)(t);if("DIV"==s||"SPAN"==s){for(var u=t.firstChild;u;u=u.nextSibling)if(!e(u,n))return!1;return!0}return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(0);t.default=function(e,t){return!(!e||!(0,r.default)(e.rootNode,t)||e.nodeBefore&&e.nodeBefore.compareDocumentPosition(t)!=o.DocumentPosition.Following||e.nodeAfter&&e.nodeAfter.compareDocumentPosition(t)!=o.DocumentPosition.Preceding)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(89),o=n(1),i=n(0);t.default=function(e,t,n){e.focus();var a=e.getSelectionRangeEx();e.addUndoSnapshot((function(l,s){if(!n||n()){var u=e.getSelectedRegions(),c=o.VListChain.createListChains(u,null==l?void 0:l.node);u.forEach((function(e){return t(e,l,s,c)})),(0,r.default)(e,c)}a.type==i.SelectionRangeTypes.Normal?e.select(l,s):e.select(a.table,a.coordinates)}),i.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEditInfoFromImage=t.deleteEditInfo=t.saveEditInfo=void 0;var r=n(100);t.saveEditInfo=function(e,t){e&&(e.dataset.roosterEditInfo=JSON.stringify(t))},t.deleteEditInfo=function(e){e&&delete e.dataset.roosterEditInfo},t.getEditInfoFromImage=function(e){var t=function(e){try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterEditInfo);return 0==(0,r.default)(t)?function(e){return{src:e.getAttribute("src")||"",widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}}(e):t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(39),o=n(15),i=n(5),a=n(0),l=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return(this.containerNode.nodeType==a.NodeType.Text?this.containerNode.nodeValue:this.containerNode.textContent)||""},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new i.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new i.default(this.containerNode,a.PositionType.End).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&this.containerNode.nodeType==a.NodeType.Text},e.prototype.isAfter=function(e){return e&&(0,o.default)(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){(0,r.default)(this.containerNode,e)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r,o,i,a=(null===(r=e.nodeValue)||void 0===r?void 0:r.substring(0,t))||"",l=(null===(o=e.nodeValue)||void 0===o?void 0:o.substring(t))||"",s=e.ownerDocument.createTextNode(n?a:l);return e.nodeValue=n?l:a,null===(i=e.parentNode)||void 0===i||i.insertBefore(s,n?e:e.nextSibling),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(39),o=n(10),i=n(5),a=n(0),l=n(9),s=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return(0,o.default)(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end?new e(this.inlineElement,this.end):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start?new e(this.inlineElement,void 0,this.start):null},enumerable:!1,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),o=this.getContainerNode();if(t.isAtEnd){var s=(0,l.getNextLeafSibling)(o,t.node);t=s?new i.default(s,a.PositionType.Begin):null}if(0==n.offset){var u=(0,l.getPreviousLeafSibling)(o,n.node);n=u?new i.default(u,a.PositionType.End):null}(0,r.default)(o,e,t||void 0,n||void 0)},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(0),i=["IMG"],a=["TABLE","IMG","LI"].join(","),l=/\u200b/g;function s(e,t){return e=e.replace(l,""),t?e.trim():e}t.default=function(e,t){if(!e)return!1;if(e.nodeType==o.NodeType.Text)return""==s(e.nodeValue||"",t);if(e.nodeType==o.NodeType.Element){var n=e;if(""!=s(n.textContent||"",t)||i.indexOf((0,r.default)(n))>=0||n.querySelectorAll(a)[0])return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n),o=e.slice(n+1);r&&o&&(t[r.trim()]=o.trim())})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e){var n=Object.keys(t||{}).map((function(e){var n=t[e],r=e?e.trim():null,o=n?n.trim():null;return r&&o?r+":"+o:null})).filter((function(e){return e})).join(";");n?e.setAttribute("style",n):e.removeAttribute("style")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0);t.default=function(e,t){e.focus();var n=e.getSelectionRangeEx();if(n&&n.areAllCollapsed){var i=n.ranges[0],a=i.startContainer;if("SPAN"==(0,r.getTagOfNode)(a)&&(!a.firstChild||"BR"==(0,r.getTagOfNode)(a.firstChild)&&!a.firstChild.nextSibling))e.addUndoSnapshot(),t(a);else a&&a.nodeType==o.NodeType.Text&&"​"==a.nodeValue&&"SPAN"==(0,r.getTagOfNode)(a.parentNode)||(e.addUndoSnapshot(),a=e.getDocument().createTextNode("​"),i.insertNode(a)),(0,r.applyTextStyle)(a,t),e.select(a,o.PositionType.End)}else e.addUndoSnapshot((function(){var r,i;n.ranges.forEach((function(n){for(var o=e.getSelectionTraverser(n),a=o&&o.currentInlineElement;a;){var l=o.getNextInlineElement();a.applyStyle((function(e,n){t(e,n),r=r||e,i=e})),a=l}})),r&&i&&n.type==o.SelectionRangeTypes.Normal&&e.select(r,o.PositionType.Before,i,o.PositionType.After)}),o.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r,o){var i=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=r,this.zoomScale=o,this.onMouseDown=function(e){var t,n;e.preventDefault(),e.stopPropagation(),i.addDocumentEvents(),i.initX=e.pageX,i.initY=e.pageY,i.initValue=null===(n=(t=i.handler).onDragStart)||void 0===n?void 0:n.call(t,i.context,e)},this.onMouseMove=function(e){var t,n,r;e.preventDefault();var o=(e.pageX-i.initX)/i.zoomScale,a=(e.pageY-i.initY)/i.zoomScale;(null===(n=(t=i.handler).onDragging)||void 0===n?void 0:n.call(t,i.context,e,i.initValue,o,a))&&(null===(r=i.onSubmit)||void 0===r||r.call(i,i.context,i.trigger))},this.onMouseUp=function(e){var t,n,r;e.preventDefault(),i.removeDocumentEvents(),(null===(n=(t=i.handler).onDragEnd)||void 0===n?void 0:n.call(t,i.context,e,i.initValue))&&(null===(r=i.onSubmit)||void 0===r||r.call(i,i.context,i.trigger))},e.addEventListener("mousedown",this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener("mousedown",this.onMouseDown),this.removeDocumentEvents()},e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&o.indexOf((0,r.default)(e))>=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(5),i=n(29),a=n(13),l=n(9),s=n(0),u=n(14),c="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function d(e,t){e&&e.nodeType==s.NodeType.Element&&t(e,!0)}t.default=function(e,t,n,f){void 0===n&&(n=new o.default(e,s.PositionType.Begin).normalize()),void 0===f&&(f=new o.default(e,s.PositionType.End).normalize());for(var h=[],p=n,g=f;p&&g&&g.isAfter(p);){var v=p.node,y=(0,r.default)(v.parentNode),m=(0,l.getNextLeafSibling)(e,v);v.nodeType==s.NodeType.Text&&["TR","TABLE"].indexOf(y)<0&&(v!=g.node||g.isAtEnd||(v=(0,i.default)(v,g.offset,!0)),p.offset>0&&(v=(0,i.default)(v,p.offset,!1)),h.push(v)),p=m&&new o.default(m,s.PositionType.Begin)}if(h.length>0){if(h.every((function(e){return e.parentNode==h[0].parentNode}))){var b=h.shift();h.forEach((function(e){var t,n=(b.nodeValue||"")+(e.nodeValue||"");b.nodeValue=n,null===(t=e.parentNode)||void 0===t||t.removeChild(e)})),h=[b]}h.forEach((function(e){for(;"SPAN"!=(0,r.default)(e)&&c.indexOf((0,r.default)(e.parentNode))>=0;)d(e,t),e=(0,u.splitBalancedNodeRange)(e);"SPAN"!=(0,r.default)(e)&&(d(e,t),e=(0,a.default)(e,"SPAN")),t(e)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getComputedStyle=void 0;var r=n(12);function o(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n=(0,r.default)(e),o=[];if(t=Array.isArray(t)?t:[t],n){var a=(n.ownerDocument.defaultView||window).getComputedStyle(n);if(a)for(var l=0,s=t;l<s.length;l++){var u=s[l],c=a.getPropertyValue(u)||"";c="font-family"!=u?c.toLowerCase():c,c="font-size"==u?i(c):c,o.push(c)}}return o}function i(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}t.default=o,t.getComputedStyle=function(e,t){return o(e,t)[0]||""}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(28).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getInlineElementBeforeAfter=t.getInlineElementAfter=t.getInlineElementBefore=void 0;var r=n(16),o=n(30),i=n(24),a=n(9),l=n(0);function s(e,t,n){if(!e||!t||!t.node)return null;var s=(t=t.normalize()).offset,u=t.isAtEnd,c=t.node,d=!1;!n&&0==s&&!u||n&&u?c=(0,a.getLeafSibling)(e,c,n):c.nodeType==l.NodeType.Text&&(!n&&!u||n&&s>0)&&(d=!0),c&&(0,i.default)(c)&&(c=(0,a.getLeafSibling)(e,c,n));var f=(0,r.default)(e,c);return f&&(d||f.contains(t))&&(f=n?new o.default(f,t,void 0):new o.default(f,void 0,t)),f}t.getInlineElementBefore=function(e,t){return s(e,t,!1)},t.getInlineElementAfter=function(e,t){return s(e,t,!0)},t.getInlineElementBeforeAfter=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Array.prototype.push.apply(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e,t,n,i,a){var l="string"==typeof t?t.trim():"",s="string"==typeof t?null:t;if(l||s){if(e.style.setProperty(n?"background-color":"color",(i?null==s?void 0:s.darkModeColor:null==s?void 0:s.lightModeColor)||l),e.dataset){var u=n?r.DarkModeDatasetNames.OriginalStyleBackgroundColor:r.DarkModeDatasetNames.OriginalStyleColor;i?s&&(e.dataset[u]=s.lightModeColor):delete e.dataset[u]}n&&a&&function(e,t){var n;if(null===(n=e.firstElementChild)||void 0===n?void 0:n.hasAttribute("style"))return;var i=e.style.getPropertyValue("background-color"),a=t&&(e.dataset[r.DarkModeDatasetNames.OriginalStyleBackgroundColor]||e.dataset[r.DarkModeDatasetNames.OriginalAttributeBackgroundColor])||i;if(!a||"transparent"===a)return;switch(function(e){var t=function(e){var t,n,r,o,i;"#"==e.substring(0,1)?(t=function(e){4===e.length&&(e=e.replace(/(.)/g,"$1$1"));var t=e.replace("#",""),n=parseInt(t.substr(0,2),16),r=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16);return[n,r,o]}(e),r=t[0],o=t[1],i=t[2]):(n=function(e){var t=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),n=parseInt(t[1]),r=parseInt(t[2]),o=parseInt(t[3]);return[n,r,o]}(e),r=n[0],o=n[1],i=n[2]);var a=r/255,l=o/255,s=i/255;return 50*(Math.max(a,l,s)+Math.min(a,l,s))}(e);if(t<20)return 1;if(t>80)return 0;return 2}(a)){case 1:o(e,{lightModeColor:"#ffffff",darkModeColor:"#333333"},!1,t);break;case 0:o(e,{lightModeColor:"#000000",darkModeColor:"#ffffff"},!1,t)}}(e,i)}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e||{left:0,right:0,top:0,bottom:0},n=t.left,r=t.right,o=t.top,i=t.bottom;return n+r+o+i>0?{left:Math.round(n),right:Math.round(r),top:Math.round(o),bottom:Math.round(i)}:null}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(48),a=n(3),l=n(20),s=n(32),u=n(5),c=n(18),d=n(2),f=n(14),h=n(6),p=n(33),g=n(68),v=n(13),y=n(0),m=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");b(this.rootList),(0,c.default)(this.rootList,"ol,ul",b),(0,c.default)(this.rootList,"li",E),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getLastItemNumber=function(){var e=this.getStart();return void 0===e?e:e-1+this.items.filter((function(e){return e.getListType()==y.ListType.Ordered&&1==e.getLevel()&&!e.isDummy()})).length},e.prototype.writeBack=function(){var e=this;if(!this.rootList)throw new Error("rootList must not be null");var t,n=this.rootList.ownerDocument,r=[n.createDocumentFragment()],o=n.createTextNode(""),i=this.getStart()||1;this.rootList.parentNode.replaceChild(o,this.rootList),this.items.forEach((function(n){var o=n.getNewListStart();o&&o!=i&&(r.splice(1,r.length-1),i=o),n.writeBack(r,e.rootList);var a=r[1];(0,d.default)(a,"HTMLOListElement")&&(t!=a&&(1==i?a.removeAttribute("start"):a.start=i),1==n.getLevel()&&i++),t=a})),o.parentNode.replaceChild(r[0],o)},e.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},e.prototype.setIndentation=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var a=!1;if(this.findListItems(e,t,(function(e){a=a||0==i.items.indexOf(e),n==y.Indentation.Decrease?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent(o):e.indent()})),a&&o)for(var l=0;l<this.items.length;l++)this.items[l].addNegativeMargins()},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.appendItem=function(e,t){var n=(0,a.default)(e);"DIV"==n?e=(0,o.default)(e,"LI"):"LI"!=n&&(e=(0,v.default)(e,"LI")),this.items.push(t==y.ListType.None?new g.default(e):new g.default(e,t))},e.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList))},e.prototype.getListItemIndex=function(e){if(this.items)for(var t=(this.getStart()||1)-1,n=0;n<this.items.length;n++){var r=this.items[n];if(1!=r.getLevel()||r.isDummy()||t++,r.getNode()==e)return t}return-1},e.prototype.getStart=function(){return(0,d.default)(this.rootList,"HTMLOListElement")?this.rootList.start:void 0},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new u.default(this.items[0].getNode(),y.PositionType.Begin),o=new u.default(this.items[this.items.length-1].getNode(),y.PositionType.End),i=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(o)?1:0);this.items.forEach((function(n,r){i=n.contains(e.node)?r:i,a=n.contains(t.node)?r:a})),i=a<this.items.length?Math.max(0,i):i,a=i>=0?Math.min(this.items.length-1,a):a;var l=i<=a?this.items.slice(i,a+1):[];return n&&l.forEach(n),l},e.prototype.populateItems=function(e,t){var n=this;void 0===t&&(t=[]);var o=(0,i.default)(e);(0,h.default)(e.childNodes).forEach((function(e){var a=r(r([],t,!0),[o],!1);(0,i.isListElement)(e)?n.populateItems(e,a):e.nodeType==y.NodeType.Text&&""==(e.nodeValue||"").trim()||n.items.push(new(g.default.bind.apply(g.default,r([void 0,e],a,!1))))}))},e}();function b(e){var t=null;(0,h.default)(e.childNodes).forEach((function(e){"LI"==(0,a.default)(e)?t=e:(0,i.isListElement)(e)?t=null:t&&!(0,s.default)(e,!0)&&t.appendChild((0,l.default)(e)?e:(0,v.default)(e))}))}function E(e){for(;!(0,i.isListElement)(e.parentNode);){(0,f.default)(e,!0);var t=(0,h.default)(e.parentNode.childNodes).slice(1);t.length>0&&((0,l.default)(t[0])||(t=[(0,v.default)(t)]),t.forEach((function(t){return e.appendChild(t)}))),(0,p.default)(e.parentNode)}}t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isListElement=void 0;var r=n(3),o=n(0);function i(e){switch((0,r.default)(e)){case"OL":return o.ListType.Ordered;case"UL":return o.ListType.Unordered;default:return o.ListType.None}}t.default=i,t.isListElement=function(e){return i(e)!=o.ListType.None}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10),o=n(5),i=n(9);t.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,a=e.rootNode,l=e.skipTags,s=t?(0,i.getNextLeafSibling)(e.rootNode,t,e.skipTags):a.firstChild,u=n?(0,i.getPreviousLeafSibling)(a,n,l):a.lastChild,c=s&&u&&(0,r.default)(s,u);if(!function(e){var t=e;return!!t.fullSelectionEnd&&!!t.fullSelectionStart}(e))return c;if(c){var d=o.default.getStart(c).normalize(),f=o.default.getEnd(c).normalize(),h=e.fullSelectionEnd,p=e.fullSelectionStart;if(!p.isAfter(f)&&!d.isAfter(h)){var g=p.isAfter(d)?p:d,v=h.isAfter(f)?f:h;return(0,r.default)(g,v)}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),o=n(1);t.default=function(e,t,n){var i=[];(0,r.default)(e,(function(t,r){n(t,r);var o=e.getElementAtCursor("LI",t);o&&-1===i.indexOf(o)&&i.push(o)})),function(e,t){e.forEach((function(e){(0,o.safeInstanceOf)(e,"HTMLLIElement")&&(0,o.setListItemStyle)(e,t)}))}(i,[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),o=n(1);t.default=function(e,t,n,i){void 0===i&&(i=!0),(0,r.default)(e,(function(e,r,a,l){var s,u=n>0&&l.filter((function(e){return e.canAppendAtCursor(n)}))[0],c=u&&r.equalTo(a)?u.createVListAtBlock(null===(s=(0,o.getBlockElementAtNode)(e.rootNode,r.node))||void 0===s?void 0:s.collapseToSingleElement(),n):(0,o.createVListFromRegion)(e,i);c&&(c.changeListType(r,a,t),c.writeBack())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.widthPx,r=e.heightPx,o=e.angleRad,i=n/(1-e.leftPercent-e.rightPercent),a=r/(1-e.topPercent-e.bottomPercent),l=t?i:n,s=t?a:r;return{targetWidth:Math.abs(l*Math.cos(o))+Math.abs(s*Math.sin(o)),targetHeight:Math.abs(l*Math.sin(o))+Math.abs(s*Math.cos(o)),originalWidth:i,originalHeight:a,visibleWidth:l,visibleHeight:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Editor=void 0;var r=n(109);Object.defineProperty(t,"Editor",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(15),i=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return(0,o.default)(this.element,e.getEndNode())},e.prototype.contains=function(e){return(0,r.default)(this.element,e,!0)},e.prototype.getTextContent=function(){var e;return(null===(e=this.element)||void 0===e?void 0:e.textContent)||""},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.default=function(e,t){return(0,r.default)(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,(0,r.default)(n.childNodes)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t.default=function(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&(0,r.default)(e,n)||null}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(28).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastInlineElement=t.getFirstInlineElement=void 0;var r=n(16),o=n(61);t.getFirstInlineElement=function(e){var t=(0,o.getFirstLeafNode)(e);return t?(0,r.default)(e,t):null},t.getLastInlineElement=function(e){var t=(0,o.getLastLeafNode)(e);return t?(0,r.default)(e,t):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLastLeafNode=t.getFirstLeafNode=void 0;var r=n(24),o=n(9);function i(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},i=n(e);i&&n(i);)i=n(i);return i&&(0,r.default)(i)&&(i=(0,o.getLeafSibling)(e,i,t)),i}t.getFirstLeafNode=function(e){return i(e,!0)},t.getLastLeafNode=function(e){return i(e,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(10),i=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.word="",this.inlineBefore=null,this.inlineAfter=null,this.traverser=null,this.traversingComplete=!1,this.inlineElements=[],this.nearestNonTextInlineElement=null}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word||""},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=r.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n=null,r=null,i=e.length-1;return this.forEachTextInlineElement((function(o){for(var a=o.getTextContent()||"",l=a.length-1;l>=0&&i>=0;l--)if(e.charCodeAt(i)==a.charCodeAt(l))i--,r||(r=o.getStartPosition().move(l+1));else if(t||r)return!0;return-1==i&&(n=o.getStartPosition().move(l+1),!0)})),n&&r&&(0,o.default)(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||r.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var o=i.exec(n);o&&2==o.length&&(this.word=o[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(43),a=n(22),l=n(0),s=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,u=l.ContentTypePrefix.Text+"*",c=((r={})[l.ContentType.HTML]=function(e,t){return e.rawHtml=a.Browser.isEdge?function(e){var t=s.exec(e);if(3==(null==t?void 0:t.length)){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}(t):t},r[l.ContentType.PlainText]=function(e,t){return e.text=t},r[u]=function(e,t,n){return!!n&&(e.customValues[n]=t)},r);function d(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}}t.default=function(e,t){var n={types:[],text:"",image:null,files:[],rawHtml:null,customValues:{}},r=o({},c);return(null==t?void 0:t.allowLinkPreview)&&(r[l.ContentTypePrefix.Text+"link-preview"]=d),Promise.all((e||[]).map((function(e){var o=e.type;if(0!=o.indexOf(l.ContentTypePrefix.Image)||n.image||"file"!=e.kind){if("file"==e.kind)return new Promise((function(t){var r=e.getAsFile();r&&(n.types.push(o),n.files.push(r)),t()}));var a=function(e,t){var n=0==e.indexOf(l.ContentTypePrefix.Text)?e.substring(l.ContentTypePrefix.Text.length):null,r=t&&n?t.indexOf(n):-1;return n&&r>=0?n:void 0}(o,null==t?void 0:t.allowedCustomPasteType),s=r[o]||(a?r[u]:null);return new Promise((function(t){return s?e.getAsString((function(e){n.types.push(o),s(n,e,a),t()})):t()}))}return n.types.push(o),n.image=e.getAsFile(),new Promise((function(e){n.image?(0,i.default)(n.image,(function(t){n.imageDataUri=t,e()})):e()}))}))).then((function(){return n}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),o=n(6),i=n(0);t.default=function(e,t,n){for(var a,l,s,u={types:e.types?(0,o.default)(e.types):[],text:e.getData("text"),image:null,files:[],rawHtml:null,customValues:{}},c=0;c<(e.files?e.files.length:0);c++){var d=e.files.item(c);if(0==(null===(a=null==d?void 0:d.type)||void 0===a?void 0:a.indexOf(i.ContentTypePrefix.Image))){u.image=d;break}}var f=function(){u.image?(0,r.default)(u.image,(function(e){u.imageDataUri=e,t(u)})):t(u)};if((null==n?void 0:n.getTempDiv)&&(null==n?void 0:n.removeTempDiv)){var h=n.getTempDiv();h.contentEditable="true",h.innerHTML="",h.focus(),null===(s=null===(l=h.ownerDocument)||void 0===l?void 0:l.defaultView)||void 0===s||s.setTimeout((function(){var e;u.rawHtml=h.innerHTML,null===(e=n.removeTempDiv)||void 0===e||e.call(n,h),f()}),0)}else u.rawHtml=void 0,f()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.default=function(e){if((0,r.default)(e,"HTMLElement"))return e.innerHTML;if(e){var t=e.ownerDocument.createElement("span");return t.appendChild(e.cloneNode(!0)),t.innerHTML}return""}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(149),i=n(31),a=n(46),l=n(2),s=n(6),u=n(150),c=n(0),d={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:c.TableBorderFormat.DEFAULT,keepCellShade:!1},f=function(){function e(e,t,n){var r=this;if(this.cells=null,this.selection=null,this.formatInfo=null,this.trs=[],this.table=(0,l.default)(e,"HTMLTableElement")?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var o=(0,l.default)(e,"HTMLTableElement")?null:e,i=(0,s.default)(this.table.rows);this.cells=i.map((function(e){return[]})),i.forEach((function(e,t){r.trs[t%2]=e;for(var n=0,i=0;n<e.cells.length;n++){for(;r.cells[t][i];i++);var a=e.cells[n];a==o&&(r.col=i,r.row=t);for(var l=0;l<a.colSpan;l++,i++)for(var s=0;s<a.rowSpan;s++){var u=l+s==0,c=a.getBoundingClientRect();r.cells[t+s][i]={td:u?a:null,spanLeft:l>0,spanAbove:s>0,width:u?c.width:void 0,height:u?c.height:void 0}}}})),this.formatInfo=(0,u.getTableFormatInfo)(this.table),t&&this.normalizeSize("number"==typeof n?function(e){return e/n}:n)}}return e.prototype.writeBack=function(e){var t,n=this;this.cells?((0,i.default)(this.table),this.cells.forEach((function(e,t){var r=g(n.trs[t%2]||n.trs[0]);r&&(n.table.appendChild(r),e.forEach((function(e,o){e.td&&(n.recalculateSpans(t,o),r.appendChild(e.td))})))})),this.formatInfo&&!e&&((0,u.saveTableInfo)(this.table,this.formatInfo),(0,o.default)(this.table,this.cells,this.formatInfo))):this.table&&(null===(t=this.table.parentNode)||void 0===t||t.removeChild(this.table))},e.prototype.applyFormat=function(e){this.table&&(this.formatInfo=r(r(r({},d),this.formatInfo||{}),e||{}),this.formatInfo.keepCellShade||this.deleteCellShadeDataset(this.cells))},e.prototype.deleteCellShadeDataset=function(e){null==e||e.forEach((function(e){e.forEach((function(e){e.td&&e.td.dataset.cellShade&&delete e.td.dataset.cellShade}))}))},e.prototype.edit=function(e){var t=this;if(this.table&&this.cells&&void 0!==this.row&&null!=this.col){var n=this.cells[this.row],r=n[this.col],o=this.selection?this.selection.firstCell.y:this.row,i=this.selection?this.selection.lastCell.y:this.row,a=this.selection?this.selection.firstCell.x:this.col,l=this.selection?this.selection.lastCell.x:this.col;switch(e){case c.TableOperation.InsertAbove:for(var s=o;s<=i;s++)this.cells.splice(o,0,n.map(p));break;case c.TableOperation.InsertBelow:var u=function(e){var n=i+d.countSpanAbove(i,d.col);d.cells.splice(n,0,d.cells[n-1].map((function(e,r){var o=t.getCell(n,r);if(o.spanAbove)return p(o);if(e.spanLeft){var i=p(e);return i.spanAbove=!1,i}return{td:g(t.getTd(t.row,r))}})))},d=this;for(s=o;s<=i;s++)u();break;case c.TableOperation.InsertLeft:var f=function(e){h.forEachCellOfCurrentColumn((function(t,n){n.splice(e,0,p(t))}))},h=this;for(s=a;s<=l;s++)f(s);break;case c.TableOperation.InsertRight:var v=function(e){var n=l+y.countSpanLeft(y.row,l);y.forEachCellOfColumn(n-1,(function(e,r,o){var i,a=t.getCell(o,n);a.spanLeft?i=p(a):e.spanAbove?(i=p(e)).spanLeft=!1:i={td:g(t.getTd(o,t.col))},r.splice(n,0,i)}))},y=this;for(s=a;s<=l;s++)v();break;case c.TableOperation.DeleteRow:for(var m=function(e){b.forEachCellOfRow(e,(function(n,r){var o=t.getCell(e+1,r);n.td&&n.td.rowSpan>1&&o.spanAbove&&(o.td=n.td)}))},b=this,E=o;E<=i;E++)m(E);var C=this.selection?this.selection.lastCell.y-this.selection.firstCell.y:0;this.cells.splice(o,C+1);break;case c.TableOperation.DeleteColumn:for(var T=0,S=function(e){P.forEachCellOfColumn(e,(function(n,r,o){var i=t.getCell(o,e+1);n.td&&n.td.colSpan>1&&i.spanLeft&&(i.td=n.td);var a=t.selection?e-T:t.col;r.splice(a,1)})),T++},P=this,w=a;w<=l;w++)S(w);break;case c.TableOperation.MergeAbove:case c.TableOperation.MergeBelow:var O=e==c.TableOperation.MergeAbove?-1:1;for(E=this.row+O;E>=0&&E<this.cells.length;E+=O){if((D=this.getCell(E,this.col)).td&&!D.spanAbove){var N=E<this.row?D:r,x=E<this.row?r:D;this.mergeCells(N,x);break}}break;case c.TableOperation.MergeLeft:case c.TableOperation.MergeRight:var R=e==c.TableOperation.MergeLeft?-1:1;for(w=this.col+R;w>=0&&w<this.cells[this.row].length;w+=R){if((D=this.getCell(this.row,w)).td&&!D.spanLeft){var I=w<this.col?D:r,M=w<this.col?r:D;this.mergeCells(I,M,!0);break}}break;case c.TableOperation.MergeCells:for(w=a;w<=l;w++)for(E=o+1;E<=i;E++){var D=this.getCell(o,w),_=this.getCell(E,w);this.mergeCells(D,_)}for(w=a+1;w<=l;w++){D=this.getCell(o,a);var A=this.getCell(o,w);this.mergeCells(D,A,!0)}break;case c.TableOperation.DeleteTable:this.cells=null;break;case c.TableOperation.SplitVertically:if(r.td&&r.td.rowSpan>1)this.getCell(this.row+1,this.col).td=g(r.td);else{var L=n.map((function(e){return{td:e==r?g(e.td):null,spanAbove:e!=r,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,L)}break;case c.TableOperation.SplitHorizontally:r.td&&r.td.colSpan>1?this.getCell(this.row,this.col+1).td=g(r.td):this.forEachCellOfCurrentColumn((function(e,r){r.splice(t.col+1,0,{td:r==n?g(e.td):null,spanAbove:e.spanAbove,spanLeft:r!=n})}));break;case c.TableOperation.AlignCenter:this.table.style.marginLeft="auto",this.table.style.marginRight="auto";break;case c.TableOperation.AlignLeft:this.table.style.marginLeft="",this.table.style.marginRight="auto";break;case c.TableOperation.AlignRight:this.table.style.marginLeft="auto",this.table.style.marginRight="";break;case c.TableOperation.AlignCellCenter:this.setAlignmentToSelectedCells(o,i,a,l,"center");break;case c.TableOperation.AlignCellLeft:this.setAlignmentToSelectedCells(o,i,a,l,"left");break;case c.TableOperation.AlignCellRight:this.setAlignmentToSelectedCells(o,i,a,l,"right");break;case c.TableOperation.AlignCellTop:this.setAlignmentToSelectedCells(o,i,a,l,"top",!0);break;case c.TableOperation.AlignCellMiddle:this.setAlignmentToSelectedCells(o,i,a,l,"middle",!0);break;case c.TableOperation.AlignCellBottom:this.setAlignmentToSelectedCells(o,i,a,l,"bottom",!0)}}},e.prototype.setAlignmentToSelectedCells=function(e,t,n,r,o,i){for(var a,l,s=e;s<=t;s++)for(var u=n;u<=r;u++)if(this.cells){var c=this.cells[s][u].td;i&&c?null===(a=c.style)||void 0===a||a.setProperty("vertical-align",o):c&&(null===(l=c.style)||void 0===l||l.setProperty("text-align",o))}},e.prototype.mergeCells=function(e,t,n){var r,o,a,l,s=n?(null===(r=e.td)||void 0===r?void 0:r.rowSpan)===(null===(o=t.td)||void 0===o?void 0:o.rowSpan)&&!e.spanLeft:(null===(a=e.td)||void 0===a?void 0:a.colSpan)===(null===(l=t.td)||void 0===l?void 0:l.colSpan)&&!e.spanAbove;e.td&&t.td&&s&&((0,i.default)(e.td,t.td,!0),t.td=null,n?t.spanLeft=!0:t.spanAbove=!0)},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;this.cells&&r<this.cells.length;r++)for(var o=0;o<this.cells[r].length;o++){var i=this.getCell(r,o);if(i.td){var l=(0,a.default)(i.td.getBoundingClientRect());if(l){var s=!1;if(t){if(l.right==e)s=!0,n.push(i.td);else if(s)break}else if(l.left==e)s=!0,n.push(i.td);else if(s)break}}}return n},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&void 0!==e&&void 0!==t&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){if(void 0!==e)for(var n=0;this.cells&&n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;this.cells&&r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;this.cells&&r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},e.prototype.normalizeEmptyTableCells=function(){for(var e=0,t=void 0;t=this.table.rows[e];e++)for(var n=0,r=void 0;r=t.cells[n];n++)r&&(r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br")))},e.prototype.normalizeTableCellSize=function(e){for(var t=0,n=void 0;n=this.table.rows[t];t++)n.removeAttribute("width"),n.style.setProperty("width",null),n.removeAttribute("height"),n.style.setProperty("height",null);for(t=0;this.cells&&t<this.cells.length;t++)for(var r=0;r<this.cells[t].length;r++){var o=this.cells[t][r];if(o){var i="number"==typeof e?function(t){return t/e}:e,a=o.width||0,l=o.height||0;h(o.td,(null==i?void 0:i(a))||a,(null==i?void 0:i(l))||l)}}},e.prototype.normalizeSize=function(e){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(e);var t=this.table.getBoundingClientRect();h(this.table,(null==e?void 0:e(t.width))||t.width,(null==e?void 0:e(t.height))||t.height)},e}();function h(e,t,n){e&&(e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box",e.style.width=t+"px",e.style.height=n+"px")}function p(e){return{td:g(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function g(e){var t=e?e.cloneNode(!1):null;return(0,l.default)(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}t.default=f},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),i=n(48),a=n(3),l=n(20),s=n(31),u=n(2),c=n(69),d=n(6),f=n(33),h=n(13),p=n(0),g=[null,"lower-alpha","lower-roman"],v=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=(0,u.default)(e,"HTMLLIElement")?e:(0,h.default)(e,p.KnownCreateElementDataIndex.BlockListItem);var o=this.node.style.display;this.dummy="list-item"!=o&&""!=o,this.listTypes=r([p.ListType.None],t,!0)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getLevel=function(){return this.listTypes.length-1},e.prototype.getNode=function(){return this.node},e.prototype.getNewListStart=function(){return this.newListStart},e.prototype.contains=function(e){return(0,o.default)(this.node,e,!0)},e.prototype.isDummy=function(){return this.dummy},e.prototype.isOrphanItem=function(){return!1},e.prototype.canMerge=function(e){return!(!(null==e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;m((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){if("-.25in"==this.node.style.marginLeft)return this.node.style.margin="",void(this.node.style.marginLeft="");var e=this.getListType();e!=p.ListType.None&&this.listTypes.push(e)},e.prototype.outdent=function(e){void 0===e&&(e=!1);var t=e?2:1;this.listTypes.length>t&&this.listTypes.pop()},e.prototype.addNegativeMargins=function(){this.node.style.margin="0in 0in 0in 0.5in",this.node.style.marginLeft="-.25in"},e.prototype.changeListType=function(e){e==p.ListType.None?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.setIsDummy=function(e){this.dummy=e},e.prototype.setNewListStart=function(e){this.newListStart=e},e.prototype.writeBack=function(e,t){for(var n,r,o=1;o<e.length;o++)if((0,i.default)(e[o])!==this.listTypes[o]){e.splice(o);break}for(;o<this.listTypes.length;o++){var l=y(e[0],this.listTypes[o],o,t);e[e.length-1].appendChild(l),e.push(l)}if(e[e.length-1].appendChild(this.node),this.node.style.setProperty("display",this.dummy?"block":null),this.listTypes.length>1&&!(this.node.style.fontSize||this.node.style.color||this.node.style.fontFamily)){(0,c.default)(this.node,["font-size","font-family","color"])}this.listTypes.length<=1&&m("LI"==(0,a.default)(this.node)?(n=this.node,r=(0,d.default)(n.childNodes),(0,f.default)(n),r):[this.node],!0,!0)},e}();function y(e,t,n,r){var a,l=e.ownerDocument;return 1==n&&r&&t==(0,i.default)(r)?(0,o.default)(e,r)?(a=r.cloneNode(!1)).removeAttribute("id"):((0,s.default)(r),a=r):a=l.createElement(t==p.ListType.Ordered?"ol":"ul"),t==p.ListType.Ordered&&n>1&&a.style.setProperty("list-style-type",g[(n-1)%g.length]),a}function m(e,t,n){return!(e.length>0)||t&&(0,l.default)(e[0])||n&&(0,l.default)(e[e.length])||(e=[(0,h.default)(e)]),e}t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(12),i=n(34),a=n(2),l=n(35);t.default=function(e,t){var n=function(e){var t=[],n=r.default.createBodyTraverser(e),l=null;for(;n.currentInlineElement!=l;){var s=(null==(l=n.currentInlineElement)?void 0:l.getContainerNode())||null;if(s=s?(0,o.default)(s):null,(0,a.default)(s,"HTMLElement")){var u=(0,i.default)(s);u&&t.push(u)}n.getNextInlineElement()}return t}(e),s=(0,i.default)(e);t.forEach((function(e){var t=n.map((function(t){return void 0!==t[e]?t[e]:""}));t&&(1==t.length||1==new Set(t).size)&&t[0]&&(s[e]=t[0])})),(0,l.default)(e,s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(12);t.default=function(e,t,n){var o=e&&(0,r.default)(n,e.rootNode,t);if(o)for(var i=void 0;i=(0,r.default)(o.parentNode,e.rootNode,t);)o=i;return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(21),i=n(8),a=n(49),l=n(24),s=n(0);t.default=function(e,t){var n=(0,a.default)(e),u=[];if(n){for(var c=e.rootNode,d=e.skipTags,f=r.default.createSelectionTraverser(c,n,d),h=null==f?void 0:f.currentBlockElement;h;h=f.getNextBlockElement())u.push(h);u=u.filter((function(e){var t,n=e.getStartNode();return n!=e.getEndNode()||!(0,l.default)(n,!0)||(null===(t=n.parentNode)||void 0===t||t.removeChild(n),!1)}))}if(0==u.length&&e&&!e.rootNode.firstChild&&t){var p=(0,o.default)(s.KnownCreateElementDataIndex.EmptyLine,e.rootNode.ownerDocument);e.rootNode.appendChild(p),(h=(0,i.default)(e.rootNode,p))&&u.push(h)}return u}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.getRegionCreator=void 0;var o=n(4),i=n(12),a=n(5),l=n(18),s=n(9),u=n(0),c=((r={})[u.RegionType.Table]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},r);function d(e,t){var n=a.default.getStart(e).normalize(),r=a.default.getEnd(e).normalize();return function(e,i,a){return function(e,t,n,r){if(e){var i=t&&(0,s.getNextLeafSibling)(e,t,r),a=n&&(0,s.getPreviousLeafSibling)(e,n,r),l=!t||(0,o.default)(e,t)&&(0,o.default)(e,i),u=!n||(0,o.default)(e,n)&&(0,o.default)(e,a),c=!(t&&n&&((0,o.default)(t,n,!0)||(0,o.default)(t,a,!0)||(0,o.default)(n,t,!0)||(0,o.default)(n,i,!0)));return l&&u&&c}return!1}(e,i,a,t)?{rootNode:e,nodeBefore:i,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:r}:null}}t.default=function(e,t,n){var r=[];if(e&&t){var a=c[n],s=a.innerSelector,f=a.skipTags,h=function(e,t,n){var r=[{innerNode:e,children:[]}],a=c[n],s=a.outerSelector,d=a.innerSelector,f=(0,l.default)(e,s,null,u.QueryScope.InSelection,t);return(0,l.default)(e,d,(function(t){var n=(0,i.default)(t,e,s);if(n&&f.indexOf(n)<0){for(var a={innerNode:t,children:[]},l=r.length-1;l>=0;l--){var u=r[l],c=u.innerNode,d=u.children;if((0,o.default)(c,n)){var h=d.filter((function(e){return e.outerNode==n}))[0];h||(h={outerNode:n,boundaries:[]},d.push(h)),h.boundaries.push(a);break}}r.push(a)}}),u.QueryScope.OnSelection,t),r[0]}(e,t,n),p=(0,i.default)(t.startContainer,e,s)||e,g=(0,i.default)(t.endContainer,e,s)||e;r=function e(t,n,r,o,i){var a;i=i||n.innerNode==r;var l=!1,s=n.children,u=n.innerNode,c=[];if(0==s.length){(f=t(u))&&c.push(f)}else for(var d=0;d<=s.length&&!l;d++){var f,h=s[d]||{},p=h.outerNode,g=h.boundaries,v=null===(a=s[d-1])||void 0===a?void 0:a.outerNode;if(i)(f=t(u,v,p))&&c.push(f);null==g||g.forEach((function(n){var a,s;s=(a=e(t,n,r,o,i))[0],i=a[1],l=a[2],c=c.concat(s)}))}return[c,i,l||u==o]}(d(t,f),h,p,g)[0]}return r.filter((function(e){return!!e}))},t.getRegionCreator=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(25),i=n(2);t.default=function(e,t){if(!t||0==t.length)return[];var n=(0,i.default)(t[0],"Node")?t:[t[0].getStartNode(),t[t.length-1].getEndNode()],a=(n=n&&n.filter((function(t){return(0,o.default)(e,t)})))[0],l=n[n.length-1];return(0,o.default)(e,a)&&(0,o.default)(e,l)?(0,r.default)(e.rootNode,a,l,!0):[]}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=n(4),a=n(8),l=n(75),s=n(34),u=n(25),c=n(2),d=n(35),f=n(19);t.default=function(e,t,n){var h,p,g,v;if((0,u.default)(e,t)&&(0,u.default)(e,n)&&(v=(0,a.default)(e.rootNode,n))&&!v.contains(t)){for(var y=v.collapseToSingleElement(),m=(0,f.collapse)(e.rootNode,y,t,!1,!0),b=y;(0,i.default)(m,b);){var E=b.parentNode;if((0,c.default)(E,"HTMLElement")){var C=r(r(r({},(0,l.default)(E)||{}),(0,s.default)(E)),(0,s.default)(y));(0,d.default)(y,C)}b=E}var T=null,S=1==y.childNodes.length&&0==y.attributes.length?y.firstChild:(0,o.default)(y,"SPAN");for(b=S;(0,i.default)(m,b)&&1==(null===(h=b.parentNode)||void 0===h?void 0:h.childNodes.length);b=b.parentNode)T=b.parentNode;null===(p=t.parentNode)||void 0===p||p.insertBefore(S,t.nextSibling),null===(g=null==T?void 0:T.parentNode)||void 0===g||g.removeChild(T)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}};t.default=function(e,t){var n=(0,r.default)(e);return o[n]||(t||{})[n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(3),i=n(32);function a(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==(0,o.default)(e)||!(0,i.default)(e))return!1;return!0}t.default=function(e,t){if(e){var n=(e=e.normalize()).node;if(0==e.offset){for(;n&&(0,r.default)(t,n)&&a(n);)n=(null==n?void 0:n.parentNode)||null;return n==t}}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(5),i=n(0);function a(e,t){var n,o;if(!e||!t)return[];var a,l=e.node,s=e.offset,u=[];if(!(0,r.default)(t,l,!0))return[];if(l.nodeType==i.NodeType.Text){for(a=l.parentNode;l.previousSibling&&l.previousSibling.nodeType==i.NodeType.Text;)s+=(null===(n=l.previousSibling.nodeValue)||void 0===n?void 0:n.length)||0,l=l.previousSibling;u.unshift(s)}else a=l,l=l.childNodes[s];do{s=0;for(var c=!1,d=(null==a?void 0:a.firstChild)||null;d&&d!=l;d=d.nextSibling){if(d.nodeType==i.NodeType.Text){if(0===(null===(o=d.nodeValue)||void 0===o?void 0:o.length)||c)continue;c=!0}else c=!1;s++}u.unshift(s),l=a,a=(null==a?void 0:a.parentNode)||null}while(l&&l!=t);return u}t.default=function(e,t){return t?{start:a(o.default.getStart(t),e),end:a(o.default.getEnd(t),e)}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearProceedingSnapshotsV2=void 0;var r=n(50);function o(e,t){if(t=t||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},(0,r.default)(e,1)){for(var n=0,o=e.currentIndex+1;o<e.snapshots.length;o++)n+=t(e.snapshots[o]);e.snapshots.splice(e.currentIndex+1),e.totalSize-=n,e.autoCompleteIndex=-1}}t.default=o,t.clearProceedingSnapshotsV2=function(e){o(e,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&e&&t.getComputedStyle(e),o={};return r.forEach((function(e){return o[e]=n&&n.getPropertyValue(e)||""})),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cloneObject=void 0;var r=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];n[i]=e[i]}return n};t.cloneObject=function(e,t){return r(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,r=e.metaKey||"Meta"===e.key;return t||n||r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasFocus=void 0;var r=n(1);t.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return t&&(0,r.contains)(e.contentDiv,t,!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDarkColor=void 0;var r=n(204);Object.defineProperty(t,"getDarkColor",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){var r=n(84),o={};for(var i in r)r.hasOwnProperty(i)&&(o[r[i]]=i);var a=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in a)if(a.hasOwnProperty(l)){if(!("channels"in a[l]))throw new Error("missing channels property: "+l);if(!("labels"in a[l]))throw new Error("missing channel labels property: "+l);if(a[l].labels.length!==a[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=a[l].channels,u=a[l].labels;delete a[l].channels,delete a[l].labels,Object.defineProperty(a[l],"channels",{value:s}),Object.defineProperty(a[l],"labels",{value:u})}a.rgb.hsl=function(e){var t,n,r=e[0]/255,o=e[1]/255,i=e[2]/255,a=Math.min(r,o,i),l=Math.max(r,o,i),s=l-a;return l===a?t=0:r===l?t=(o-i)/s:o===l?t=2+(i-r)/s:i===l&&(t=4+(r-o)/s),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+l)/2,[t,100*(l===a?0:n<=.5?s/(l+a):s/(2-l-a)),100*n]},a.rgb.hsv=function(e){var t,n,r,o,i,a=e[0]/255,l=e[1]/255,s=e[2]/255,u=Math.max(a,l,s),c=u-Math.min(a,l,s),d=function(e){return(u-e)/6/c+.5};return 0===c?o=i=0:(i=c/u,t=d(a),n=d(l),r=d(s),a===u?o=r-n:l===u?o=1/3+t-r:s===u&&(o=2/3+n-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*i,100*u]},a.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[a.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},a.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-o)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-o-t)/(1-t)||0),100*t]},a.rgb.keyword=function(e){var t=o[e];if(t)return t;var n,i,a,l=1/0;for(var s in r)if(r.hasOwnProperty(s)){var u=r[s],c=(i=e,a=u,Math.pow(i[0]-a[0],2)+Math.pow(i[1]-a[1],2)+Math.pow(i[2]-a[2],2));c<l&&(l=c,n=s)}return n},a.keyword.rgb=function(e){return r[e]},a.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},a.rgb.lab=function(e){var t=a.rgb.xyz(e),n=t[0],r=t[1],o=t[2];return r/=100,o/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},a.hsl.rgb=function(e){var t,n,r,o,i,a=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[i=255*s,i,i];t=2*s-(n=s<.5?s*(1+l):s+l-s*l),o=[0,0,0];for(var u=0;u<3;u++)(r=a+1/3*-(u-1))<0&&r++,r>1&&r--,i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,o[u]=255*i;return o},a.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,o=n,i=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,o*=i<=1?i:2-i,[t,100*(0===r?2*o/(i+o):2*n/(r+n)),100*((r+n)/2)]},a.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,o=Math.floor(t)%6,i=t-Math.floor(t),a=255*r*(1-n),l=255*r*(1-n*i),s=255*r*(1-n*(1-i));switch(r*=255,o){case 0:return[r,s,a];case 1:return[l,r,a];case 2:return[a,r,s];case 3:return[a,l,r];case 4:return[s,a,r];case 5:return[r,a,l]}},a.hsv.hsl=function(e){var t,n,r,o=e[0],i=e[1]/100,a=e[2]/100,l=Math.max(a,.01);return r=(2-i)*a,n=i*l,[o,100*(n=(n/=(t=(2-i)*l)<=1?t:2-t)||0),100*(r/=2)]},a.hwb.rgb=function(e){var t,n,r,o,i,a,l,s=e[0]/360,u=e[1]/100,c=e[2]/100,d=u+c;switch(d>1&&(u/=d,c/=d),r=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(r=1-r),o=u+r*((n=1-c)-u),t){default:case 6:case 0:i=n,a=o,l=u;break;case 1:i=o,a=n,l=u;break;case 2:i=u,a=n,l=o;break;case 3:i=u,a=o,l=n;break;case 4:i=o,a=u,l=n;break;case 5:i=n,a=u,l=o}return[255*i,255*a,255*l]},a.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o))]},a.xyz.rgb=function(e){var t,n,r,o=e[0]/100,i=e[1]/100,a=e[2]/100;return n=-.9689*o+1.8758*i+.0415*a,r=.0557*o+-.204*i+1.057*a,t=(t=3.2406*o+-1.5372*i+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},a.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},a.lab.xyz=function(e){var t,n,r,o=e[0];t=e[1]/500+(n=(o+16)/116),r=n-e[2]/200;var i=Math.pow(n,3),a=Math.pow(t,3),l=Math.pow(r,3);return n=i>.008856?i:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},a.lab.lch=function(e){var t,n=e[0],r=e[1],o=e[2];return(t=360*Math.atan2(o,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+o*o),t]},a.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},a.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],o=1 in arguments?arguments[1]:a.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var i=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===o&&(i+=60),i},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},a.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255,i=Math.max(Math.max(n,r),o),a=Math.min(Math.min(n,r),o),l=i-a;return t=l<=0?0:i===n?(r-o)/l%6:i===r?2+(o-n)/l:4+(n-r)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?a/(1-l):0)]},a.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,o=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(o=(n-.5*r)/(1-r)),[e[0],100*r,100*o]},a.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var o,i=[0,0,0],a=t%1*6,l=a%1,s=1-l;switch(Math.floor(a)){case 0:i[0]=1,i[1]=l,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=l;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=l,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return o=(1-n)*r,[255*(n*i[0]+o),255*(n*i[1]+o),255*(n*i[2]+o)]},a.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},a.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},a.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=a.gray.hsv=function(e){return[0,0,e[0]]},a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(211),t),o(n(252),t),o(n(255),t),o(n(258),t),o(n(261),t),o(n(264),t),o(n(271),t),o(n(274),t),o(n(289),t),o(n(292),t),o(n(301),t),o(n(304),t)},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(214),i=n(243),a=n(244),l=n(245),s=n(246),u=n(247),c=n(248),d=n(249),f=n(250),h=n(251),p=r(r(r(r(r(r(r(r(r(r({},l.ListFeatures),u.QuoteFeatures),f.TableFeatures),d.StructuredNodeFeatures),o.AutoLinkFeatures),c.ShortcutFeatures),i.CursorFeatures),s.MarkdownFeatures),a.EntityFeatures),h.TextFeatures);t.default=function(){return p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),o=n(11),i=n(90),a=n(91),l=n(92),s=n(93),u=n(94),c=n(95),d=n(96),f=n(0),h=n(1),p=["font","text-decoration","color","background"],g="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),v=["href","src"],y=["TD","TH","TR","TABLE","TBODY","THEAD"];function m(e){var t=(0,h.toArray)(e.childNodes).map(m).every((function(e){return e})),n=(0,h.isBlockElement)(e),r=(0,h.getTagOfNode)(e);return r&&(g.indexOf(r)>=0||t&&!(0,h.isVoidHtmlElement)(e)&&y.indexOf(r)<0?(n&&!t&&(0,h.wrap)(e),(0,h.unwrap)(e)):function(e){for(var t=(0,h.safeInstanceOf)(e,"HTMLTableCellElement"),n=0,r=(0,h.toArray)(e.attributes);n<r.length;n++){var o=r[n];t&&"style"==o.name?b(e):v.indexOf(o.name.toLowerCase())<0&&0!=o.name.indexOf("data-")&&e.removeAttribute(o.name)}}(e)),n}function b(e){var t=(0,h.getStyles)(e),n={};return Object.keys(t).forEach((function(e){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])})),(0,h.setStyles)(e,t),n}function E(e){(0,r.default)(e,(function(t){var n=(0,h.getSelectedBlockElementsInRegion)(t),r=(0,h.collapseNodesInRegion)(t,n);if(e.contains(t.rootNode)){var o=b(t.rootNode);if(Object.keys(o).length>0){var i=(0,h.wrap)((0,h.toArray)(t.rootNode.childNodes));(0,h.setStyles)(i,o)}}for(;r.length>0&&(0,h.isNodeInRegion)(t,r[0].parentNode);)r=[(0,h.splitBalancedNodeRange)(r)];r.forEach(m)}))}function C(e,t){switch(void 0===t&&(t=f.ClearFormatMode.Inline),t){case f.ClearFormatMode.Inline:!function(e){e.focus(),e.addUndoSnapshot((function(){(0,o.default)(e,f.DocumentCommand.RemoveFormat),e.queryElements("[class]",f.QueryScope.OnSelection,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;if(e.queryElements("[style]",f.QueryScope.InSelection,(function(e){p.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),!n){if(t.fontFamily&&(0,a.default)(e,t.fontFamily),t.fontSize&&(0,l.default)(e,t.fontSize),t.textColor){var r=e.queryElements("a *, a",f.QueryScope.OnSelection),h=r.length>0?function(e){return-1==r.indexOf(e)}:null;t.textColors?(0,s.default)(e,t.textColors,h):(0,s.default)(e,t.textColor,h)}t.backgroundColor&&(t.backgroundColors?(0,i.default)(e,t.backgroundColors):(0,i.default)(e,t.backgroundColor)),t.bold&&(0,u.default)(e),t.italic&&(0,c.default)(e),t.underline&&(0,d.default)(e)}}),f.ChangeSource.Format)}(e);break;case f.ClearFormatMode.Block:E(e);break;default:!function(e){if(!function(e){var t=e.getSelectionTraverser();return!!t.currentBlockElement&&!!t.getNextBlockElement()}(e)&&e.getSelectionTraverser().currentInlineElement instanceof h.PartialInlineElement)return void C(e);E(e)}(e)}}t.default=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),o=n&&r.Position.getStart(n),i=n&&r.Position.getEnd(n);t.forEach((function(e){return e.commit()})),e.select(o,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),o=n(1);t.default=function(e,t){(0,r.default)(e,(function(n,r){(0,o.setColor)(n,r?"":t,!0,e.isDarkMode())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51);t.default=function(e,t){(0,r.default)(e,"font-family",(function(e,n){e.style.fontFamily=n?"":t}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=n(1);t.default=function(e,t){(0,r.default)(e,"font-size",(function(e,n){e.style.fontSize=n?"":t,"normal"!=(0,o.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=n(1);t.default=function(e,t,n){(0,r.default)(e,"color",(function(r,i){n&&!n(r)||(0,o.setColor)(r,i?"":t,!1,e.isDarkMode())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(0);t.default=function(e){(0,r.default)(e,o.DocumentCommand.Bold)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(0);t.default=function(e){(0,r.default)(e,o.DocumentCommand.Italic)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(0);t.default=function(e){(0,r.default)(e,o.DocumentCommand.Underline)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),o=n(1);t.default=function(e,t,n){(0,r.default)(e,(function(e){var n=(0,o.getSelectedBlockElementsInRegion)(e,!0),r=(0,o.collapseNodesInRegion)(e,n);if(r.length>0){if(1==r.length){var i=(0,o.getTagOfNode)(r[0]);"BR"==i?r=[(0,o.wrap)(r[0])]:"LI"!=i&&"TD"!=i||(r=(0,o.toArray)(r[0].childNodes))}for(;r[0]&&(0,o.isNodeInRegion)(e,r[0].parentNode)&&r.some((function(e){return"LI"==(0,o.getTagOfNode)(e)}));)r=[(0,o.splitBalancedNodeRange)(r)];t(r)}}),n)}},function(e,t,n){"use strict";var r,o,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var l=n(99),s=n(101),u=n(37),c=n(53),d=n(267),f=n(27),h=n(268),p=n(7),g=n(1),v=n(102),y=n(0),m=2*Math.PI/8,b=["nw","n","ne","e","se","s","sw","w"],E=((r={})[y.ExperimentalFeatures.SingleDirectionResize]=y.ImageEditOperation.SideResize,r[y.ExperimentalFeatures.ImageRotate]=y.ImageEditOperation.Rotate,r[y.ExperimentalFeatures.ImageCrop]=y.ImageEditOperation.Crop,r),C={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:null},T=((o={})[y.ImageEditOperation.CornerResize]=v.getCornerResizeHTML,o[y.ImageEditOperation.SideResize]=v.getSideResizeHTML,o[y.ImageEditOperation.Rotate]=h.getRotateHTML,o[y.ImageEditOperation.Crop]=d.getCropHTML,o),S=function(){function e(e){var t=this;this.allowedOperations=y.ImageEditOperation.CornerResize,this.onBlur=function(){t.setEditingImage(null)},this.removeWrapper=function(e){var t=null==e?void 0:e.parentNode,n=null==e?void 0:e.querySelector("img");n&&t&&(n.style.position="",n.style.margin=null,n.style.textAlign=null,t.insertBefore(n,e),t.removeChild(e))},this.updateWrapper=function(e){var n,r=t.getImageWrapper(t.image);if(r){var o=O(r,"r_cropC"),i=O(r,"r_cropO"),a=O(r,"r_rotateC")[0],l=O(r,"r_rotateH")[0],s=O(r,"r_resizeH"),u=O(r,"r_cropH"),d=1==o.length&&4==i.length,f=t.editInfo,p=f.angleRad,y=f.bottomPercent,m=f.leftPercent,b=f.rightPercent,E=f.topPercent,C=(0,c.default)(t.editInfo,d),T=C.targetWidth,S=C.targetHeight,N=C.originalWidth,R=C.originalHeight,I=C.visibleWidth,M=C.visibleHeight,D=(T-I)/2,_=(S-M)/2,A=N*m,L=N*b,k=R*E,B=R*y;if(r.style.width=w(I),r.style.height=w(M),r.style.margin=_+"px "+D+"px",r.style.transform="rotate("+p+"rad)",r.style.textAlign=(n=r.parentNode,(0,g.safeInstanceOf)(n,"HTMLElement")&&"rtl"==(0,g.getComputedStyle)(n,"direction")?"right":"left"),t.image.style.width=w(N),t.image.style.height=w(R),d)P(o[0],A,k,L,B,void 0,void 0),P(i[0],0,0,L,void 0,void 0,k),P(i[1],void 0,0,0,B,L,void 0),P(i[2],A,void 0,0,0,void 0,B),P(i[3],0,k,void 0,0,A,void 0),x(u,p);else{if(t.image.style.margin=-k+"px 0 0 "+-A+"px","r_resizeH"==(null==e?void 0:e.elementClass)){var j=r.clientWidth,F=r.clientHeight;t.wasResized=!0,(0,v.doubleCheckResize)(t.editInfo,t.options.preserveRatio,j,F),t.updateWrapper()}(0,h.updateRotateHandlePosition)(t.editInfo,t.editor.getRelativeDistanceToEditor(r,!0),_,a,l),x(s,p)}}},this.options=i(i({},C),e||{})}return e.prototype.getName=function(){return"ImageEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler("blur",this.onBlur),Object.keys(E).forEach((function(e){t.allowedOperations|=t.editor.isFeatureEnabled(e)?E[e]:0}))},e.prototype.dispose=function(){this.clearDndHelpers(),this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case y.PluginEventType.MouseDown:this.setEditingImage(null);break;case y.PluginEventType.MouseUp:var t=e.rawEvent.target;e.isClicking&&0==e.rawEvent.button&&(0,g.safeInstanceOf)(t,"HTMLImageElement")&&t.isContentEditable&&(0,g.matchesSelector)(t,this.options.imageSelector)&&this.setEditingImage(t,y.ImageEditOperation.ResizeAndRotate);break;case y.PluginEventType.KeyDown:var n=e.rawEvent.which;n==y.Keys.DELETE||n==y.Keys.BACKSPACE?this.setEditingImage(null,!0):n==y.Keys.ESCAPE&&this.image?(this.editInfo=(0,f.getEditInfoFromImage)(this.image),this.setEditingImage(null),e.rawEvent.preventDefault()):16!=n&&17!=n&&18!=n&&this.setEditingImage(null,!0);break;case y.PluginEventType.ContentChanged:e.source==y.ChangeSource.InsertEntity&&"IMAGE_EDIT_WRAPPER"==e.data.type||this.editor.queryElements((0,g.getEntitySelector)("IMAGE_EDIT_WRAPPER"),this.removeWrapper);break;case y.PluginEventType.EntityOperation:"IMAGE_EDIT_WRAPPER"==e.entity.type&&(e.operation==y.EntityOperation.ReplaceTemporaryContent?this.removeWrapper(e.entity.wrapper):e.operation==y.EntityOperation.Click&&e.rawEvent.preventDefault());break;case y.PluginEventType.ExtractContentWithDom:(0,g.toArray)(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach((function(e){(0,f.deleteEditInfo)(e)}))}},e.prototype.setEditingImage=function(e,t){var n=this,r="number"==typeof t?t:y.ImageEditOperation.None,o="number"!=typeof t&&!!t;this.image&&(this.clearDndHelpers(),(0,l.default)(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized)&&this.editor.addUndoSnapshot((function(){return n.image}),y.ChangeSource.ImageResize),(i=this.getImageWrapper(this.image))&&this.removeWrapper(i),o&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null);if(!this.image&&(null==e?void 0:e.isContentEditable)){this.editor.addUndoSnapshot(),this.image=e,this.editInfo=(0,f.getEditInfoFromImage)(e),this.wasResized=function(e){var t=e.width,n=e.height,r=e.style;return!(""!==r.maxWidth&&"initial"!==r.maxWidth&&"auto"!==r.maxWidth||!(R(r.height)||R(r.width)||R(t)||R(n)))}(this.image),r=((0,s.default)(e)?r:y.ImageEditOperation.Resize)&this.allowedOperations;var i=this.createWrapper(r);this.updateWrapper(),this.dndHelpers=a(a(a(a([],this.createDndHelpers("r_resizeH",v.Resizer),!0),this.createDndHelpers("r_rotateH",h.Rotator),!0),this.createDndHelpers("r_cropH",d.Cropper),!0),this.createDndHelpers("r_cropC",d.Cropper),!0),this.editor.select(i,y.PositionType.After)}},e.prototype.createWrapper=function(e){var t=this,n=(0,p.insertEntity)(this.editor,"IMAGE_EDIT_WRAPPER",(0,g.wrap)(this.image,y.KnownCreateElementDataIndex.ImageEditWrapper),!1,!0).wrapper;n.style.position="relative",n.style.maxWidth="100%",n.style.verticalAlign="bottom",n.style.display=g.Browser.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.getAttribute("src"),this.image.src=this.editInfo.src,this.image.style.position="absolute",this.image.style.maxWidth=null;var r,o,i,a,l=this.editor.isFeatureEnabled(y.ExperimentalFeatures.AdaptiveHandlesResizer),s={borderColor:this.options.borderColor,rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white",isSmallImage:(r=this.editInfo,o=l,i=r.widthPx,a=r.heightPx,i&&a&&i*i<1e4&&o),handlesExperimentalFeatures:l},u=[(0,v.getResizeBordersHTML)(s)];return Object.keys(T).forEach((function(t){(e&t)==t&&(0,g.arrayPush)(u,T[t](s))})),u.forEach((function(e){var r=(0,g.createElement)(e,t.image.ownerDocument);r&&n.appendChild(r)})),n},e.prototype.getImageWrapper=function(e){var t,n=(0,g.getEntityFromElement)(null===(t=null==e?void 0:e.parentNode)||void 0===t?void 0:t.parentNode);return"IMAGE_EDIT_WRAPPER"==(null==n?void 0:n.type)?n.wrapper:null},e.prototype.createDndHelpers=function(e,t){var n=this,r={editInfo:this.editInfo,options:this.options,elementClass:e},o=this.getImageWrapper(this.image);return o?O(o,e).map((function(e){return new u.default(e,i(i({},r),{x:e.dataset.x,y:e.dataset.y}),n.updateWrapper,t,n.editor.getZoomScale())})):[]},e.prototype.clearDndHelpers=function(){var e;null===(e=this.dndHelpers)||void 0===e||e.forEach((function(e){return e.dispose()})),this.dndHelpers=null},e}();function P(e,t,n,r,o,i,a){e.style.left=w(t),e.style.top=w(n),e.style.right=w(r),e.style.bottom=w(o),e.style.width=w(i),e.style.height=w(a)}function w(e){return void 0===e?null:e+"px"}function O(e,t){return(0,g.toArray)(e.querySelectorAll("."+t))}function N(e,t){var n=function(e){var t=Math.round(e/m)%8;return t<0?t+8:t}(t),r=e.dataset.y+e.dataset.x,o=b.indexOf(r);return b[(o>=0&&o+n)%8]}function x(e,t){e.map((function(e){e.style.cursor=N(e,t)+"-resize"}))}function R(e){var t="string"==typeof e?parseInt(e):e;return!isNaN(t)}t.default=S},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(100),o=n(266),i=n(53),a=n(27),l=n(0);t.default=function(e,t,n,s,u){var c="",d=(0,a.getEditInfoFromImage)(t);switch((0,r.default)(n,d)){case 1:c=n.src;break;case 2:c=s;break;case 3:c=(0,o.default)(t,n)}var f=c!=s;f&&(c=e.triggerPluginEvent(l.PluginEventType.EditImage,{image:t,originalSrc:n.src,previousSrc:s,newSrc:c}).newSrc),c==n.src?(0,a.deleteEditInfo)(t):(0,a.saveEditInfo)(t,n);var h=(0,i.default)(n),p=h.targetWidth,g=h.targetHeight;return t.src=c,function(e,t,n,r){t?(e.style.maxWidth="initial",e.width=n,e.height=r,e.style.width=n+"px",e.style.height=r+"px"):(e.style.maxWidth="100%",e.style.height="initial",e.style.width="initial",e.removeAttribute("height"),e.removeAttribute("width"))}(t,u,p,g),f||n.widthPx!=d.widthPx||n.heightPx!=d.heightPx}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0});var o=["angleRad"],i=["leftPercent","rightPercent","topPercent","bottomPercent"],a=r(r([],o,!0),i,!0),l=r(r([],a,!0),["widthPx","heightPx"],!0);function s(e,t){return Math.abs(e-t)<.001}t.default=function(e,t){return e&&e.src&&!l.some((function(t){return!("number"==typeof e[t])}))?a.every((function(t){return s(e[t],0)}))?1:t&&o.every((function(t){return s(e[t],0)}))&&o.every((function(e){return s(t[e],0)}))&&i.every((function(n){return s(e[n],t[n])}))?2:3:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas");t.width=10,t.height=10;var n=t.getContext("2d");return n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getResizeBordersHTML=t.getSideResizeHTML=t.getCornerResizeHTML=t.doubleCheckResize=t.rotateCoordinate=t.Resizer=void 0;var o=["w","","e"],i=["s","","n"];function a(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function l(e,t,n,r){var o="w"==e?"left":"right",i="n"==t?"top":"bottom",a=t+e;return""==e&&""==t?null:{tag:"div",style:"position:absolute;"+o+":"+(""==e?"50%":"0px")+";"+i+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:s[r](a,i,o,n),className:"r_resizeH",dataset:{x:e,y:t}}]}}t.Resizer={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,o){var i,l=e.x,s=e.y,u=e.editInfo,c=e.options,d=n.widthPx>0&&n.heightPx>0?1*n.widthPx/n.heightPx:0;r=(i=a(r,o,u.angleRad))[0],o=i[1];var f=""==l,h=""==s,p=!(f||h)&&(c.preserveRatio||t.shiftKey),g=f?n.widthPx:Math.max(n.widthPx+r*("w"==l?-1:1),c.minWidth),v=h?n.heightPx:Math.max(n.heightPx+o*("n"==s?-1:1),c.minHeight);return p&&d>0&&(v=Math.min(v,g/d),(g=Math.min(g,v*d))<v*d?g=v*d:v=g/d),u.widthPx=g,u.heightPx=v,!0}},t.rotateCoordinate=a,t.doubleCheckResize=function(e,t,n,r){var o=e.widthPx,i=e.heightPx,a=i>0?o/i:0;n=Math.floor(n),r=Math.floor(r),o=Math.floor(o),i=Math.floor(i),e.widthPx=n,e.heightPx=r,t&&a>0&&(o!==n||i!==r)&&(n<o?e.heightPx=n/a:e.widthPx=r*a)},t.getCornerResizeHTML=function(e){var t=e.borderColor,n=e.handlesExperimentalFeatures,r=[];return o.forEach((function(e){return i.forEach((function(o){return r.push(""==e==(""==o)?l(e,o,t,n?1:0):null)}))})),r},t.getSideResizeHTML=function(e){var t=e.borderColor,n=e.isSmallImage,r=e.handlesExperimentalFeatures;if(n)return null;var a=[];return o.forEach((function(e){return i.forEach((function(n){return a.push(""==e!=(""==n)?l(e,n,t,r?1:0):null)}))})),a},t.getResizeBordersHTML=function(e){return{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 2px "+e.borderColor+";pointer-events:none;"}};var s={0:function(e,t,n,r){return"position:relative;width:10px;height:10px;background-color: "+r+";cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;"},1:function(e,t,n){return"position:relative;width:10px;height:10px;background-color: #FFFFFF;cursor:"+e+"-resize;"+n+":-3px;"+t+":-3px;border-radius:100%;border: 2px solid #bfbfbf;box-shadow: 0px 0.36316px 1.36185px rgba(100, 100, 100, 0.25);"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.naturalWidth,r=e.naturalHeight,o=e.leftPercent,i=e.topPercent;return{width:n*(1-o-e.rightPercent)*t,height:r*(1-i-e.bottomPercent)*t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(103),o=n(27);t.default=function(e,t){var n=(0,o.getEditInfoFromImage)(e),i=(0,r.default)(n,t),a=i.width,l=i.height;return Math.round(a)==Math.round(n.widthPx)&&Math.round(l)==Math.round(n.heightPx)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getObject=t.setObject=t.createCustomData=void 0;var r=n(0);function o(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,i){if(t.nodeType==r.NodeType.Element){var a=o(e,t);""!=a&&(e.dict[a]||(e.dict[a]={}),e.dict[a][n]=i)}},t.getObject=function(e,t,n){if(t.nodeType==r.NodeType.Element){var i=o(e,t);if(""!=i)return e.dict[i]&&e.dict[i][n]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=void 0,t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.createEditor=void 0;var i=n(108);Object.defineProperty(t,"createEditor",{enumerable:!0,get:function(){return i.default}}),o(n(0),t),o(n(1),t),o(n(54),t),o(n(7),t),o(n(86),t),o(n(83),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(54),o=n(83),i=n(86);t.default=function(e,t,n){var a=[new i.HyperLink,new i.Paste,new i.ContentEdit];t&&(a=a.concat(t));var l={plugins:a,initialContent:n,getDarkColor:o.getDarkColor,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new r.Editor(e,l)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(110),i=n(193),a=n(0),l=n(1),s=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=(0,l.getTagOfNode)(e))throw new Error("contentDiv must be an HTML DIV element");var s=(0,i.default)(e,t),u=[];Object.keys(s).forEach((function(e){"_placeholder"==e?(0,l.arrayPush)(u,t.plugins):u.push(s[e])}));var c=t.zoomScale>0?t.zoomScale:1;this.core=r(r({contentDiv:e,api:r(r({},o.coreApiMap),t.coreApiOverride||{}),originalApi:o.coreApiMap,plugins:u.filter((function(e){return!!e}))},(0,i.getPluginState)(s)),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e},zoomScale:c,sizeTransformer:t.sizeTransformer||function(e){return e/c}}),this.core.plugins.forEach((function(e){return e.initialize(n)})),this.ensureTypeInContainer(new l.Position(this.core.contentDiv,a.PositionType.Begin).normalize())}return e.prototype.dispose=function(){for(var e=this.core.plugins.length-1;e>=0;e--)this.core.plugins[e].dispose();this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){return!!e&&this.core.api.insertNode(this.core,e,t)},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){return!(!this.contains(e)||!t)&&(this.core.api.transformColor(this.core,n?t:null,!0,(function(){return e.parentNode.replaceChild(t,e)}),a.ColorTransformDirection.LightToDark),!0)},e.prototype.getBlockElementAtNode=function(e){return(0,l.getBlockElementAtNode)(this.core.contentDiv,e)},e.prototype.contains=function(e){return(0,l.contains)(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){var r=this;void 0===t&&(t=a.QueryScope.Body);var o=[],i=t instanceof Function?a.QueryScope.Body:t;n=t instanceof Function?t:n;var s=i==a.QueryScope.Body?null:this.getSelectionRangeEx();return s?(s.ranges.forEach((function(t){o.push.apply(o,(0,l.queryElements)(r.core.contentDiv,e,n,i,t))})),o):(0,l.queryElements)(this.core.contentDiv,e,n,i,null)},e.prototype.collapseNodes=function(e,t,n){return(0,l.collapseNodes)(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return(0,l.isNodeEmpty)(this.core.contentDiv,e)},e.prototype.getContent=function(e){return void 0===e&&(e=a.GetContentMode.CleanHTML),this.core.api.getContent(this.core,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0),this.core.api.setContent(this.core,e,t)},e.prototype.insertContent=function(e,t){var n;if(e){var r=this.getDocument(),o=null===(n=(new DOMParser).parseFromString(this.core.trustedHTMLHandler(e),"text/html"))||void 0===n?void 0:n.body,i=(null==o?void 0:o.childNodes)?(0,l.toArray)(o.childNodes):[];t&&t.insertOnNewLine&&i.length>1&&(i=[(0,l.wrap)(i)]);var a=r.createDocumentFragment();i.forEach((function(e){return a.appendChild(e)})),this.insertNode(a,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed&&(0,l.deleteSelectedContent)(this.core.contentDiv,e)},e.prototype.paste=function(e,t,n){var r=this;if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(a.GetContentMode.RawHTMLWithSelection);var o=this.getSelectionRange(),i=o&&l.Position.getStart(o),s=this.core.api.createPasteFragment(this.core,e,i,t,n);this.addUndoSnapshot((function(){return r.insertNode(s),e}),a.ChangeSource.Paste)}},e.prototype.getSelectionRange=function(e){return void 0===e&&(e=!0),this.core.api.getSelectionRange(this.core,e)},e.prototype.getSelectionRangeEx=function(){return this.core.api.getSelectionRangeEx(this.core)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&(0,l.getSelectionPath)(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,r){var o;if(null===(o=e)||void 0===o?void 0:o.rows){var i=this.core.api.selectTable(this.core,e,t);return this.core.domEvent.tableSelectionRange=i,!!i}this.core.api.selectTable(this.core,null),this.core.domEvent.tableSelectionRange=null;var a=e?(0,l.safeInstanceOf)(e,"Range")?e:Array.isArray(e.start)&&Array.isArray(e.end)?(0,l.createRange)(this.core.contentDiv,e.start,e.end):(0,l.createRange)(e,t,n,r):null;return this.contains(a)&&this.core.api.selectRange(this.core,a)},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if(this.contains(t&&t.focusNode))return new l.Position(t.focusNode,t.focusOffset);var n=this.getSelectionRange();return n?l.Position.getStart(n):null},e.prototype.getElementAtCursor=function(e,t,n){var r=this;return n=t?null:n,(0,l.cacheGetEventData)(n,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=r.getFocusedPosition();t=n&&n.node}return t&&(0,l.findClosestElementAncestor)(t,r.core.contentDiv,e)}))},e.prototype.isPositionAtBeginning=function(e){return(0,l.isPositionAtBeginningOf)(e,this.core.contentDiv)},e.prototype.getSelectedRegions=function(e){var t=this;void 0===e&&(e=a.RegionType.Table);var n=this.getSelectionRangeEx(),r=[];return n.ranges.forEach((function(n){r.push.apply(r,n?(0,l.getRegionsFromRange)(t.core.contentDiv,n,e):[])})),r.filter((function(e,t,n){return n.indexOf(e)===t}))},e.prototype.addDomEventHandler=function(e,t){var n,r="string"==typeof e?((n={})[e]=t,n):e;return this.core.api.attachDomEvent(this.core,r)},e.prototype.triggerPluginEvent=function(e,t,n){var o=r({eventType:e},t);return this.core.api.triggerEvent(this.core,o,n),o},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e=a.ChangeSource.SetContent),this.triggerPluginEvent(a.PluginEventType.ContentChanged,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,-1)},e.prototype.redo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,1)},e.prototype.addUndoSnapshot=function(e,t,n){this.core.api.addUndoSnapshot(this.core,e,t,n)},e.prototype.getUndoState=function(){var e=this.core.undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.core.contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.core.domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){return(this.core.lifecycle.customData[e]=this.core.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.core.domEvent.isInIME},e.prototype.getDefaultFormat=function(){return this.core.lifecycle.defaultFormat},e.prototype.getBodyTraverser=function(e){return l.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(e){return(e=null!=e?e:this.getSelectionRange())&&l.ContentTraverser.createSelectionTraverser(this.core.contentDiv,e)},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=a.ContentPosition.SelectionStart);var t=this.getSelectionRange();return t&&l.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return(0,l.cacheGetEventData)(e,"ContentSearcher",(function(){var e=t.getSelectionRange();return e&&new l.PositionContentSearcher(t.core.contentDiv,l.Position.getStart(e))}))},e.prototype.runAsync=function(e){var t=this,n=this.core.contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}));return function(){n.cancelAnimationFrame(r)}},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n=this.core.contentDiv,r=n.getBoundingClientRect(),o=e.getBoundingClientRect();if(r&&o){var i=o.left-(null==r?void 0:r.left),a=o.top-(null==r?void 0:r.top);return t&&(i+=n.scrollLeft,a+=n.scrollTop),[i,a]}}return null},e.prototype.addContentEditFeature=function(e){var t=this;null==e||e.keys.forEach((function(n){var r=t.core.edit.features[n]||[];r.push(e),t.core.edit.features[n]=r}))},e.prototype.getStyleBasedFormatState=function(e){if(!e){var t=this.getSelectionRange();e=t&&l.Position.getStart(t).normalize().node}return this.core.api.getStyleBasedFormatState(this.core,e)},e.prototype.getPendableFormatState=function(e){return this.core.api.getPendableFormatState(this.core,e)},e.prototype.ensureTypeInContainer=function(e,t){this.core.api.ensureTypeInContainer(this.core,e,t)},e.prototype.setDarkModeState=function(e){this.isDarkMode()!=!!e&&(this.core.api.transformColor(this.core,this.core.contentDiv,!1,null,e?a.ColorTransformDirection.LightToDark:a.ColorTransformDirection.DarkToLight,!0),this.triggerContentChangedEvent(e?a.ChangeSource.SwitchToDarkMode:a.ChangeSource.SwitchToLightMode))},e.prototype.isDarkMode=function(){return this.core.lifecycle.isDarkMode},e.prototype.transformToDarkColor=function(e){this.core.api.transformColor(this.core,e,!0,null,a.ColorTransformDirection.LightToDark)},e.prototype.startShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!0)},e.prototype.stopShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!1)},e.prototype.isInShadowEdit=function(){return!!this.core.lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return this.core.lifecycle.experimentalFeatures.indexOf(e)>=0},e.prototype.getTrustedHTMLHandler=function(){return this.core.trustedHTMLHandler},e.prototype.getSizeTransformer=function(){return this.core.sizeTransformer},e.prototype.getZoomScale=function(){return this.core.zoomScale},e.prototype.setZoomScale=function(e){if(e>0&&e<=10){var t=this.core.zoomScale;this.core.zoomScale=e,t!=e&&this.triggerPluginEvent(a.PluginEventType.ZoomChanged,{oldZoomScale:t,newZoomScale:e},!0)}},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coreApiMap=void 0;var r=n(111),o=n(176),i=n(177),a=n(178),l=n(179),s=n(180),u=n(181),c=n(182),d=n(183),f=n(184),h=n(82),p=n(185),g=n(186),v=n(187),y=n(188),m=n(189),b=n(190),E=n(191),C=n(192);t.coreApiMap={attachDomEvent:o.attachDomEvent,addUndoSnapshot:r.addUndoSnapshot,createPasteFragment:i.createPasteFragment,ensureTypeInContainer:a.ensureTypeInContainer,focus:l.focus,getContent:s.getContent,getSelectionRange:c.getSelectionRange,getSelectionRangeEx:d.getSelectionRangeEx,getStyleBasedFormatState:f.getStyleBasedFormatState,getPendableFormatState:u.getPendableFormatState,hasFocus:h.hasFocus,insertNode:p.insertNode,restoreUndoSnapshot:g.restoreUndoSnapshot,selectRange:v.selectRange,setContent:m.setContent,switchShadowEdit:b.switchShadowEdit,transformColor:E.transformColor,triggerEvent:C.triggerEvent,selectTable:y.selectTable}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.addUndoSnapshot=void 0;var o=n(1),i=n(0);function a(e,t){if(!e.lifecycle.shadowEditFragment){var n=e.api.getSelectionRangeEx(e),a=e.lifecycle.isDarkMode,l=(null==n?void 0:n.type)==i.SelectionRangeTypes.TableSelection?r({type:i.SelectionRangeTypes.TableSelection,tableId:n.table.id,isDarkMode:a},n.coordinates):r({type:i.SelectionRangeTypes.Normal,isDarkMode:a,start:[],end:[]},(0,o.getSelectionPath)(e.contentDiv,n.ranges[0])||{});e.undo.snapshotsService.addSnapshot({html:e.contentDiv.innerHTML,metadata:l},t),e.undo.hasNewContent=!1}}t.addUndoSnapshot=function(e,t,n,r){var l,s=e.undo,u=s.isNested;u||(s.isNested=!0,a(e,r));try{var c;if(t)l=t((c=e.api.getSelectionRange(e,!0))&&o.Position.getStart(c).normalize(),c&&o.Position.getEnd(c).normalize()),u||a(e,!1)}finally{u||(s.isNested=!1)}if(t&&n){var d={eventType:i.PluginEventType.ContentChanged,source:n,data:l};e.api.triggerEvent(e,d,!0)}r&&((c=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=o.Position.getStart(c)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentCommand=void 0,function(e){e.AutoUrlDetect="AutoUrlDetect",e.BackColor="backColor",e.Bold="bold",e.ClearAuthenticationCache="ClearAuthenticationCache",e.ContentReadOnly="contentReadOnly",e.Copy="copy",e.CreateLink="createLink",e.Cut="cut",e.DecreaseFontSize="decreaseFontSize",e.DefaultParagraphSeparator="defaultParagraphSeparator",e.Delete="delete",e.EnableInlineTableEditing="enableInlineTableEditing",e.EnableObjectResizing="enableObjectResizing",e.FontName="fontName",e.FontSize="fontSize",e.ForeColor="foreColor",e.FormatBlock="formatBlock",e.ForwardDelete="forwardDelete",e.Heading="heading",e.HiliteColor="hiliteColor",e.IncreaseFontSize="increaseFontSize",e.Indent="indent",e.InsertBrOnReturn="insertBrOnReturn",e.InsertHorizontalRule="insertHorizontalRule",e.InsertHTML="insertHTML",e.InsertImage="insertImage",e.InsertOrderedList="insertOrderedList",e.InsertUnorderedList="insertUnorderedList",e.InsertParagraph="insertParagraph",e.InsertText="insertText",e.Italic="italic",e.JustifyCenter="justifyCenter",e.JustifyFull="justifyFull",e.JustifyLeft="justifyLeft",e.JustifyRight="justifyRight",e.Outdent="outdent",e.Paste="paste",e.Redo="redo",e.RemoveFormat="removeFormat",e.SelectAll="selectAll",e.StrikeThrough="strikeThrough",e.Subscript="subscript",e.Superscript="superscript",e.Underline="underline",e.Undo="undo",e.Unlink="unlink",e.StyleWithCSS="styleWithCSS"}(t.DocumentCommand||(t.DocumentCommand={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DocumentPosition=void 0,function(e){e[e.Same=0]="Same",e[e.Disconnected=1]="Disconnected",e[e.Preceding=2]="Preceding",e[e.Following=4]="Following",e[e.Contains=8]="Contains",e[e.ContainedBy=16]="ContainedBy"}(t.DocumentPosition||(t.DocumentPosition={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Keys=void 0,function(e){e[e.NULL=0]="NULL",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGEUP=33]="PAGEUP",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.DELETE=46]="DELETE",e[e.EIGHT_ASTIRISK=56]="EIGHT_ASTIRISK",e[e.EIGHT_ASTERISK=56]="EIGHT_ASTERISK",e[e.B=66]="B",e[e.I=73]="I",e[e.U=85]="U",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.COMMA=188]="COMMA",e[e.DASH_UNDERSCORE=189]="DASH_UNDERSCORE",e[e.PERIOD=190]="PERIOD",e[e.FORWARDSLASH=191]="FORWARDSLASH",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_TILDE=192]="GRAVE_TILDE",e[e.CONTENTCHANGED=257]="CONTENTCHANGED",e[e.RANGE=258]="RANGE",e[e.Ctrl=4096]="Ctrl",e[e.Meta=8192]="Meta",e[e.Shift=16384]="Shift"}(t.Keys||(t.Keys={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeType=void 0,function(e){e[e.Element=1]="Element",e[e.Text=3]="Text",e[e.ProcessingInstruction=7]="ProcessingInstruction",e[e.Comment=8]="Comment",e[e.Document=9]="Document",e[e.DocumentType=10]="DocumentType",e[e.DocumentFragment=11]="DocumentFragment"}(t.NodeType||(t.NodeType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentType=t.ContentTypePrefix=void 0,function(e){e.Text="text/",e.Image="image/"}(t.ContentTypePrefix||(t.ContentTypePrefix={})),function(e){e.PlainText="text/plain",e.HTML="text/html"}(t.ContentType||(t.ContentType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Alignment=void 0,function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(t.Alignment||(t.Alignment={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeSource=void 0,function(e){e.AutoLink="AutoLink",e.CreateLink="CreateLink",e.Format="Format",e.ImageResize="ImageResize",e.Paste="Paste",e.SetContent="SetContent",e.Cut="Cut",e.Drop="Drop",e.InsertEntity="InsertEntity",e.SwitchToDarkMode="SwitchToDarkMode",e.SwitchToLightMode="SwitchToLightMode",e.ListChain="ListChain"}(t.ChangeSource||(t.ChangeSource={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorTransformDirection=void 0,function(e){e[e.LightToDark=0]="LightToDark",e[e.DarkToLight=1]="DarkToLight"}(t.ColorTransformDirection||(t.ColorTransformDirection={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentPosition=void 0,function(e){e[e.Begin=0]="Begin",e[e.End=1]="End",e[e.DomEnd=2]="DomEnd",e[e.SelectionStart=3]="SelectionStart",e[e.Outside=4]="Outside",e[e.Range=5]="Range"}(t.ContentPosition||(t.ContentPosition={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DarkModeDatasetNames=void 0,function(e){e.OriginalStyleColor="ogsc",e.OriginalStyleBackgroundColor="ogsb",e.OriginalAttributeColor="ogac",e.OriginalAttributeBackgroundColor="ogab"}(t.DarkModeDatasetNames||(t.DarkModeDatasetNames={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Direction=void 0,function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft"}(t.Direction||(t.Direction={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityClasses=void 0,function(e){e.ENTITY_INFO_NAME="_Entity",e.ENTITY_TYPE_PREFIX="_EType_",e.ENTITY_ID_PREFIX="_EId_",e.ENTITY_READONLY_PREFIX="_EReadonly_"}(t.EntityClasses||(t.EntityClasses={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityOperation=void 0,function(e){e[e.NewEntity=0]="NewEntity",e[e.Click=1]="Click",e[e.ContextMenu=2]="ContextMenu",e[e.Escape=3]="Escape",e[e.RemoveFromStart=4]="RemoveFromStart",e[e.RemoveFromEnd=5]="RemoveFromEnd",e[e.Overwrite=6]="Overwrite",e[e.PartialOverwrite=7]="PartialOverwrite",e[e.ReplaceTemporaryContent=8]="ReplaceTemporaryContent",e[e.AddShadowRoot=9]="AddShadowRoot",e[e.RemoveShadowRoot=10]="RemoveShadowRoot"}(t.EntityOperation||(t.EntityOperation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExperimentalFeatures=void 0,function(e){e.NewIndentation="NewIndentation",e.NewBullet="NewBullet",e.NewNumbering="NewNumbering",e.ListChain="ListChain",e.MergePastedLine="MergePastedLine",e.SingleDirectionResize="SingleDirectionResize",e.PasteWithLinkPreview="PasteWithLinkPreview",e.ImageRotate="ImageRotate",e.ImageCrop="ImageCrop",e.AlwaysApplyDefaultFormat="AlwaysApplyDefaultFormat",e.ConvertSingleImageBody="ConvertSingleImageBody",e.TableAlignment="TableAlignment",e.TabKeyTextFeatures="TabKeyTextFeatures",e.AdaptiveHandlesResizer="AdaptiveHandlesResizer"}(t.ExperimentalFeatures||(t.ExperimentalFeatures={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontSizeChange=void 0,function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.FontSizeChange||(t.FontSizeChange={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GetContentMode=void 0,function(e){e[e.CleanHTML=0]="CleanHTML",e[e.RawHTMLOnly=1]="RawHTMLOnly",e[e.RawHTMLWithSelection=2]="RawHTMLWithSelection",e[e.PlainText=3]="PlainText",e[e.PlainTextFast=4]="PlainTextFast"}(t.GetContentMode||(t.GetContentMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Indentation=void 0,function(e){e[e.Increase=0]="Increase",e[e.Decrease=1]="Decrease"}(t.Indentation||(t.Indentation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Capitalization=void 0,function(e){e.Sentence="sentence",e.Lowercase="lowercase",e.Uppercase="uppercase",e.CapitalizeEachWord="capitalize"}(t.Capitalization||(t.Capitalization={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListType=void 0,function(e){e[e.None=0]="None",e[e.Ordered=1]="Ordered",e[e.Unordered=2]="Unordered"}(t.ListType||(t.ListType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PositionType=void 0,function(e){e[e.Begin=0]="Begin",e[e.End=-1]="End",e[e.Before=-2]="Before",e[e.After=-3]="After"}(t.PositionType||(t.PositionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryScope=void 0,function(e){e[e.Body=0]="Body",e[e.OnSelection=1]="OnSelection",e[e.InSelection=2]="InSelection"}(t.QueryScope||(t.QueryScope={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RegionType=void 0,function(e){e[e.Table=0]="Table"}(t.RegionType||(t.RegionType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableOperation=void 0,function(e){e[e.InsertAbove=0]="InsertAbove",e[e.InsertBelow=1]="InsertBelow",e[e.InsertLeft=2]="InsertLeft",e[e.InsertRight=3]="InsertRight",e[e.DeleteTable=4]="DeleteTable",e[e.DeleteColumn=5]="DeleteColumn",e[e.DeleteRow=6]="DeleteRow",e[e.MergeAbove=7]="MergeAbove",e[e.MergeBelow=8]="MergeBelow",e[e.MergeLeft=9]="MergeLeft",e[e.MergeRight=10]="MergeRight",e[e.MergeCells=11]="MergeCells",e[e.SplitHorizontally=12]="SplitHorizontally",e[e.SplitVertically=13]="SplitVertically",e[e.AlignCenter=14]="AlignCenter",e[e.AlignLeft=15]="AlignLeft",e[e.AlignRight=16]="AlignRight",e[e.AlignCellLeft=17]="AlignCellLeft",e[e.AlignCellCenter=18]="AlignCellCenter",e[e.AlignCellRight=19]="AlignCellRight",e[e.AlignCellTop=20]="AlignCellTop",e[e.AlignCellMiddle=21]="AlignCellMiddle",e[e.AlignCellBottom=22]="AlignCellBottom"}(t.TableOperation||(t.TableOperation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageEditOperation=void 0,function(e){e[e.None=0]="None",e[e.CornerResize=1]="CornerResize",e[e.SideResize=2]="SideResize",e[e.Resize=3]="Resize",e[e.Rotate=4]="Rotate",e[e.ResizeAndRotate=7]="ResizeAndRotate",e[e.Crop=8]="Crop",e[e.All=15]="All"}(t.ImageEditOperation||(t.ImageEditOperation={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClearFormatMode=void 0,function(e){e[e.Inline=0]="Inline",e[e.Block=1]="Block",e[e.AutoDetect=2]="AutoDetect"}(t.ClearFormatMode||(t.ClearFormatMode={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KnownCreateElementDataIndex=void 0,function(e){e[e.None=0]="None",e[e.EmptyLine=1]="EmptyLine",e[e.BlockquoteWrapper=2]="BlockquoteWrapper",e[e.CopyPasteTempDiv=3]="CopyPasteTempDiv",e[e.BlockListItem=4]="BlockListItem",e[e.ContextMenuWrapper=5]="ContextMenuWrapper",e[e.ImageEditWrapper=6]="ImageEditWrapper",e[e.TableHorizontalResizer=7]="TableHorizontalResizer",e[e.TableVerticalResizer=8]="TableVerticalResizer",e[e.TableResizerLTR=9]="TableResizerLTR",e[e.TableResizerRTL=10]="TableResizerRTL",e[e.TableSelector=11]="TableSelector"}(t.KnownCreateElementDataIndex||(t.KnownCreateElementDataIndex={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableBorderFormat=void 0,function(e){e[e.DEFAULT=0]="DEFAULT",e[e.LIST_WITH_SIDE_BORDERS=1]="LIST_WITH_SIDE_BORDERS",e[e.NO_HEADER_BORDERS=2]="NO_HEADER_BORDERS",e[e.NO_SIDE_BORDERS=3]="NO_SIDE_BORDERS",e[e.FIRST_COLUMN_HEADER_EXTERNAL=4]="FIRST_COLUMN_HEADER_EXTERNAL",e[e.ESPECIAL_TYPE_1=5]="ESPECIAL_TYPE_1",e[e.ESPECIAL_TYPE_2=6]="ESPECIAL_TYPE_2",e[e.ESPECIAL_TYPE_3=7]="ESPECIAL_TYPE_3"}(t.TableBorderFormat||(t.TableBorderFormat={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PluginEventType=void 0,function(e){e[e.KeyDown=0]="KeyDown",e[e.KeyPress=1]="KeyPress",e[e.KeyUp=2]="KeyUp",e[e.Input=3]="Input",e[e.CompositionEnd=4]="CompositionEnd",e[e.MouseDown=5]="MouseDown",e[e.MouseUp=6]="MouseUp",e[e.ContentChanged=7]="ContentChanged",e[e.ExtractContentWithDom=8]="ExtractContentWithDom",e[e.BeforeCutCopy=9]="BeforeCutCopy",e[e.BeforePaste=10]="BeforePaste",e[e.EditorReady=11]="EditorReady",e[e.BeforeDispose=12]="BeforeDispose",e[e.PendingFormatStateChanged=13]="PendingFormatStateChanged",e[e.Scroll=14]="Scroll",e[e.EntityOperation=15]="EntityOperation",e[e.ContextMenu=16]="ContextMenu",e[e.EnteredShadowEdit=17]="EnteredShadowEdit",e[e.LeavingShadowEdit=18]="LeavingShadowEdit",e[e.EditImage=19]="EditImage",e[e.BeforeSetContent=20]="BeforeSetContent",e[e.ZoomChanged=21]="ZoomChanged"}(t.PluginEventType||(t.PluginEventType={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionRangeTypes=void 0,function(e){e[e.Normal=0]="Normal",e[e.TableSelection=1]="TableSelection"}(t.SelectionRangeTypes||(t.SelectionRangeTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(4),i=n(10),a=n(3),l=n(20),s=n(15),u=n(13),c=n(14),d=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(var t=e;t&&!(0,l.default)(t);)t=t.parentNode;return t},e.prototype.collapseToSingleElement=function(){for(var t=e.getBlockContext(this.startNode),n=t?(0,r.default)(t,this.startNode,this.endNode,!0):[],o=e.getBlockContext(this.startNode);n[0]&&n[0]!=o&&n[0].parentNode!=this.rootNode&&d.indexOf((0,a.default)(n[0].parentNode))<0;)n=[(0,c.splitBalancedNodeRange)(n)];return 1==n.length&&(0,l.default)(n[0])?n[0]:(0,u.default)(n)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return(0,s.default)(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return(0,o.default)(this.startNode,e,!0)||(0,o.default)(this.endNode,e,!0)||(0,s.default)(e,this.startNode)&&(0,s.default)(this.endNode,e)},e.prototype.getTextContent=function(){var e=(0,i.default)(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(8),i=n(58),a=n(16),l=n(60),s=function(){function e(e,t){this.rootNode=e,this.startNode=(0,r.default)(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?(0,o.default)(this.rootNode,this.startNode):(0,i.default)(this.rootNode,!0)},e.prototype.getStartInlineElement=function(){return this.startNode?(0,a.default)(this.rootNode,this.startNode):(0,l.getFirstInlineElement)(this.rootNode)},e.prototype.isBlockInScope=function(e){return(0,r.default)(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(62),o=n(8),i=n(16),a=n(55),l=n(5),s=n(2),u=n(0),c=n(42),d=n(60),f=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,t=(0,s.default)(t,"Range")?l.default.getStart(t):t,this.position=t.normalize(),this.block=(0,o.default)(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case u.ContentPosition.Begin:case u.ContentPosition.End:case u.ContentPosition.DomEnd:return function(e,t){if(e instanceof a.default){var n=e.getStartNode();return t?(0,d.getFirstInlineElement)(n):(0,d.getLastInlineElement)(n)}return(0,i.default)(e,t?e.getStartNode():e.getEndNode())}(this.block,this.startFrom==u.ContentPosition.Begin);case u.ContentPosition.SelectionStart:var e=(0,c.getInlineElementAfter)(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new r.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),o=n(30),i=n(5),a=n(42),l=function(){function e(e,t){this.rootNode=e,this.startBlock=null,this.startInline=null,this.start=i.default.getStart(t).normalize(),this.end=i.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=(0,r.default)(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement((0,a.getInlineElementAfter)(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=!!n&&n.equals(e);else{var o=(0,r.default)(this.rootNode,this.end.node);t=!!n&&!!o&&(e.equals(n)||e.equals(o)||e.isAfter(n)&&o.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,i=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,i=!0),t.isAfter(n)||t.equalTo(n)?null:r||i?new o.default(e,r?t:void 0,i?n:void 0):e},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(64),o=n(65),i=n(6);t.default=function(e,t,n){var a,l=e.clipboardData||(null===(a=e.target.ownerDocument)||void 0===a?void 0:a.defaultView).clipboardData;l.items?(e.preventDefault(),(0,r.default)((0,i.default)(l.items),n).then(t)):(0,o.default)(l,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45);t.default=function(e,t,n){if(t){var o=e.style,i=t.fontFamily,a=t.fontSize,l=t.textColor,s=t.textColors,u=t.backgroundColor,c=t.backgroundColors,d=t.bold,f=t.italic,h=t.underline;i&&(o.fontFamily=i),a&&(o.fontSize=a),s?(0,r.default)(e,s,!1,n):l&&(0,r.default)(e,l,!1,n),c?(0,r.default)(e,c,!0,n):u&&(0,r.default)(e,u,!0,n),d&&(o.fontWeight="bold"),f&&(o.fontStyle="italic"),h&&(o.textDecoration="underline")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap=void 0;var r=n(0);t.PendableFormatCommandMap={isBold:r.DocumentCommand.Bold,isItalic:r.DocumentCommand.Italic,isUnderline:r.DocumentCommand.Underline,isStrikeThrough:r.DocumentCommand.StrikeThrough,isSubscript:r.DocumentCommand.Subscript,isSuperscript:r.DocumentCommand.Superscript},t.default=function(e){return Object.keys(t.PendableFormatCommandMap).reduce((function(n,r){return n[r]=e.queryCommandState(t.PendableFormatCommandMap[r]),n}),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,o="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",i={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+o+"|www\\."+o,"i"),except:r,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+o,"i"),except:r},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+o+"|ftp\\."+o,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+o,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+o,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+o,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+o,"i")}};t.default=function(e){if(e)for(var t=0,n=Object.keys(i);t<n.length;t++){var r=n[t],o=i[r],a=e.match(o.match);if(a&&a[0]==e&&(!o.except||!o.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(45),i=n(0),a="transparent";function l(e){return!!e.td&&!!e.td.dataset.cellShade}function s(e){return"solid 1px "+(e||"transparent")}t.default=function(e,t,n){n&&(e.style.borderCollapse="collapse",function(e,t){e.forEach((function(n,r){n.forEach((function(o,l){o.td&&function(e,t,n,r,o,l){switch(function(e,t){e.style.borderTop=s(t.topBorderColor),e.style.borderLeft=s(t.verticalBorderColor),e.style.borderRight=s(t.verticalBorderColor),e.style.borderBottom=s(t.bottomBorderColor)}(t,e),e.tableBorderFormat){case i.TableBorderFormat.DEFAULT:return;case i.TableBorderFormat.LIST_WITH_SIDE_BORDERS:o||(t.style.borderLeftColor=a),l||(t.style.borderRightColor=a);break;case i.TableBorderFormat.FIRST_COLUMN_HEADER_EXTERNAL:n||(t.style.borderTopColor=a),r||n||(t.style.borderBottomColor=a),o||(t.style.borderLeftColor=a),l||o||(t.style.borderRightColor=a),o&&n&&(t.style.borderRightColor=a);break;case i.TableBorderFormat.NO_HEADER_BORDERS:n&&(t.style.borderTopColor=a,t.style.borderRightColor=a,t.style.borderLeftColor=a),o&&(t.style.borderLeftColor=a),l&&(t.style.borderRightColor=a);break;case i.TableBorderFormat.NO_SIDE_BORDERS:o&&(t.style.borderLeftColor=a),l&&(t.style.borderRightColor=a);break;case i.TableBorderFormat.ESPECIAL_TYPE_1:n&&(t.style.borderRightColor=a,t.style.borderLeftColor=a),o&&(t.style.borderBottomColor=a,t.style.borderTopColor=a),n&&o&&(t.style.borderLeftColor=e.verticalBorderColor||a,t.style.borderBottomColor=e.bottomBorderColor||a,t.style.borderTopColor=e.topBorderColor||a);break;case i.TableBorderFormat.ESPECIAL_TYPE_2:n&&(t.style.borderRightColor=a,t.style.borderLeftColor=a),o&&(t.style.borderBottomColor=a,t.style.borderTopColor=a),n&&o&&(t.style.borderLeftColor=e.verticalBorderColor||a,t.style.borderBottomColor=e.bottomBorderColor||a,t.style.borderTopColor=e.topBorderColor||a),n||o||(t.style.borderLeftColor=a,t.style.borderBottomColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a);break;case i.TableBorderFormat.ESPECIAL_TYPE_3:n&&(t.style.borderLeftColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a),o&&(t.style.borderLeftColor=a,t.style.borderTopColor=a,t.style.borderBottomColor=a),n||o||(t.style.borderLeftColor=a,t.style.borderBottomColor=a,t.style.borderTopColor=a,t.style.borderRightColor=a),n&&o&&(t.style.borderBottomColor=e.bottomBorderColor||a)}}(t,o.td,0===r,r===e.length-1,0===l,l===n.length-1)}))}))}(t,n),function(e,t){var n=function(e){return e%2==0?t.bgColorEven:t.bgColorOdd},r=t.hasBandedRows,i=t.hasBandedColumns,s=t.bgColorOdd,u=t.bgColorEven,c=!r&&s===u;e.forEach((function(e,i){e.forEach((function(e){if(e.td&&!l(e))if(r){var s=n(i);(0,o.default)(e.td,s||a,!0,void 0,!0)}else c?(0,o.default)(e.td,t.bgColorOdd||a,!0,void 0,!0):(0,o.default)(e.td,a,!0,void 0,!0)}))})),i&&e.forEach((function(e){e.forEach((function(e,t){var r=n(t);e.td&&r&&!l(e)&&(0,o.default)(e.td,r,!0,void 0,!0)}))}))}(t,n),function(e,t){if(!t.hasFirstColumn)return void e.forEach((function(e){e.forEach((function(e,t){e.td&&0===t&&(e.td=(0,r.default)(e.td,"TD"),e.td.scope="")}))}));e.forEach((function(t,n){t.forEach((function(t,i){t.td&&0===i&&(0===n||l(t)||(t.td.style.borderTopColor=a,(0,o.default)(t.td,a,!0,void 0,!0)),n!==e.length-1&&0!==n&&(t.td.style.borderBottomColor=a),t.td=(0,r.default)(t.td,"TH"),t.td.scope="col")}))}))}(t,n),function(e,t){var n,i;if(!t.hasHeaderRow)return void(null===(n=e[0])||void 0===n||n.forEach((function(e){e.td&&(e.td=(0,r.default)(e.td,"TD"),e.td.scope="")})));null===(i=e[0])||void 0===i||i.forEach((function(e){e.td&&t.headerRowColor&&(l(e)||(0,o.default)(e.td,t.headerRowColor,!0,void 0,!0),e.td.style.borderRightColor=t.headerRowColor,e.td.style.borderLeftColor=t.headerRowColor,e.td.style.borderTopColor=t.headerRowColor,e.td=(0,r.default)(e.td,"TH"),e.td.scope="row")}))}(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.saveTableInfo=t.getTableFormatInfo=void 0;t.getTableFormatInfo=function(e){var t=function(e){if(!e)return null;try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterTableInfo);return function(e){if(!e)return!1;var t=e.topBorderColor,n=e.verticalBorderColor,r=e.bottomBorderColor,o=e.bgColorOdd,i=e.bgColorEven,a=e.hasBandedColumns,l=e.hasBandedRows,s=e.hasFirstColumn,u=e.hasHeaderRow,c=e.tableBorderFormat,d=[a,l,s,u];if([t,n,r,o,i].some((function(e){return!function(e){if(null==e||"string"==typeof e)return!0;return!1}(e)}))||d.some((function(e){return!function(e){if("boolean"==typeof e)return!0;return!1}(e)}))||!function(e){if(-1<e&&e<8)return!0;return!1}(c))return!1;return!0}(t)?t:null},t.saveTableInfo=function(e,t){e&&t&&(e.dataset.roosterTableInfo=JSON.stringify(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!t||!e.cells)return!1;var n=t.firstCell,r=t.lastCell,o=e.cells.length-1,i=e.cells[o].length-1,a=n.x,l=n.y,s=r.x,u=r.y;return 0==a&&0==l&&s==i&&u==o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(70),i=n(71),a=n(25),l=n(5),s=n(2),u=n(24),c=n(6),d=n(47),f=n(13),h=n(9),p=n(48),g=n(0);function v(e,t,n){var r=t[n?t.length-1:0];r=(0,h.getLeafSibling)(e.rootNode,r,n,e.skipTags,!0),r=(0,o.default)(e,"ol,ul",r),(0,a.default)(e,r)&&(0,p.isListElement)(r)&&(n?(0,s.default)(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}t.default=function(e,t,n){if(!e)return null;var a=[];if(n){var h=(0,o.default)(e,"ol,ul",n);h&&a.push(h)}else{if((0,i.default)(e).forEach((function(n){var r=(0,o.default)(e,"ol,ul",n.getStartNode());r?(a[a.length-1]!=r&&a.push(r),1==a.length&&(0,s.default)(r,"HTMLOListElement")&&r.start>1&&(t=!1)):a.push(n.collapseToSingleElement())})),0==a.length&&!e.rootNode.firstChild){var y=(0,r.default)(g.KnownCreateElementDataIndex.EmptyLine,e.rootNode.ownerDocument);e.rootNode.appendChild(y),a.push(y),e.fullSelectionStart=new l.default(y,g.PositionType.Begin),e.fullSelectionEnd=new l.default(y,g.PositionType.End)}t&&(v(e,a,!1),v(e,a,!0)),a=a.filter((function(e){return!(0,u.default)(e,!0)}))}var m=null;if(a.length>0){var b=a.shift()||null;(m=(0,p.isListElement)(b)?new d.default(b):b?function(e){var t=(0,c.default)(e.childNodes),n=1==t.length?t[0]:(0,f.default)(t,"SPAN"),r=e.ownerDocument.createElement("ol");e.appendChild(r);var o=new d.default(r);return o.appendItem(n,g.ListType.None),o}(b):null)&&a.forEach((function(e){(0,p.isListElement)(e)?m.mergeVList(new d.default(e)):m.appendItem(e,g.ListType.None)}))}return m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),o=n(70),i=n(15),a=n(25),l=n(18),s=n(47),u=n(0),c=0,d=function(){function e(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}return e.createListChains=function(t,n,a){var s=Array.isArray(t)?t:t?[t]:[],u=[];return s.forEach((function(t){var s,c=[];(0,l.default)(t.rootNode,"ol",(function(r){var l=(0,o.default)(t,"ol",r);if(s!=l){var u=c.filter((function(e){return e.canAppendToTail(l)}))[0]||new e(t,(a||f)()),d=c.indexOf(u),h=!!n&&(0,i.default)(l,n);h?d<0&&c.push(u):(d>=0&&c.splice(d,1),c.unshift(u)),u.append(l,h),s=l}})),(0,r.default)(u,c)})),u},e.prototype.canAppendAtCursor=function(e){return e>1&&this.lastNumberBeforeCursor+1==e},e.prototype.createVListAtBlock=function(e,t){if(e&&e.parentNode){var n=e.ownerDocument.createElement("ol");n.start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e);var r=new s.default(n);return r.appendItem(e,u.ListType.None),r}return null},e.prototype.commit=function(){for(var e=this.getLists(),t=0,n=0;n<e.length;n++){var r=e[n];r.start=t+1;var o=new s.default(r);t=o.getLastItemNumber()||0,delete r.dataset.listchain,delete r.dataset.listchainafter,o.writeBack()}},e.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},e.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new s.default(e).getLastItemNumber()||0,t?e.dataset.listchainafter="true":this.lastNumberBeforeCursor=this.lastNumber},e.prototype.applyChainName=function(e){e.dataset.listchain=this.name},e.prototype.getLists=function(){var e=this;return(0,l.default)(this.region.rootNode,"ol[data-listchain="+this.name+"]").filter((function(t){return(0,a.default)(e.region,t)}))},e}();function f(){return"__List_Chain_"+c++}t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(10),i=n(46),a=n(0);t.default=function(e){var t;if(!e)return null;var n=(0,o.default)(e),l=n.getBoundingClientRect&&(0,i.default)(n.getBoundingClientRect());if(l)return l;e=e.normalize();var s=n.getClientRects&&n.getClientRects();if(l=s&&1==s.length?(0,i.default)(s[0]):null)return l;if(e.node.nodeType==a.NodeType.Text&&e.node.ownerDocument){var u=(0,r.default)({tag:"span",children:["​"]},e.node.ownerDocument);if((n=(0,o.default)(e)).insertNode(u),l=u.getBoundingClientRect&&(0,i.default)(u.getBoundingClientRect()),null===(t=u.parentNode)||void 0===t||t.removeChild(u),l)return l}var c=e.element;return c&&c.getBoundingClientRect&&(l=(0,i.default)(c.getBoundingClientRect()))?l:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(66),o=n(77);t.default=function(e,t){if(!e)return"";var n=(0,r.default)(e),i=t&&(0,o.default)(e,t);return i?n+"\x3c!--"+JSON.stringify(i)+"--\x3e":n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setHtmlWithMetadata=void 0;var r=n(10),o=n(2),i=n(0);function a(e,t,n){if(e){t=t||"",e.innerHTML=(null==n?void 0:n(t))||t;var r=e.lastChild;if((0,o.default)(r,"Comment"))try{var a=JSON.parse(r.nodeValue||"");if(function(e){if(!e||"object"!=typeof e)return!1;switch(e.type||i.SelectionRangeTypes.Normal){case i.SelectionRangeTypes.Normal:var t=e;if(l(t.start)&&l(t.end))return e.type=i.SelectionRangeTypes.Normal,e.isDarkMode=!!e.isDarkMode,!0;break;case i.SelectionRangeTypes.TableSelection:var n=e;if("string"==typeof n.tableId&&n.tableId&&s(n.firstCell)&&s(n.lastCell))return e.isDarkMode=!!e.isDarkMode,!0}return!1}(a))return e.removeChild(r),a}catch(e){}}}function l(e){return e&&Array.isArray(e)&&e.every((function(e){return"number"==typeof e}))}function s(e){var t=e;return t&&"object"==typeof t&&"number"==typeof t.x&&"number"==typeof t.y}t.default=function(e,t,n){var o=a(e,t,n);return(null==o?void 0:o.type)==i.SelectionRangeTypes.Normal?(0,r.default)(e,o.start,o.end):null},t.setHtmlWithMetadata=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22);t.default=function(e,t){var n,o,i,a=null===(i=null===(o=null===(n=null==e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===o?void 0:o.defaultView)||void 0===i?void 0:i.getSelection();if(a){var l=!0;if(a.rangeCount>0)try{var s=null;(t||r.Browser.isEdge)&&(s=1==a.rangeCount?a.getRangeAt(0):null)&&s.startContainer==e.startContainer&&s.startOffset==e.startOffset&&s.endContainer==e.endContainer&&s.endOffset==e.endOffset?l=!1:a.removeAllRanges()}catch(e){}l&&a.addRange(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSnapshotV2=void 0;var r=n(78);function o(e,t,n,o,i){o=o||function(e){var t;return(null===(t=e)||void 0===t?void 0:t.length)||0},i=i||a;var l=e.snapshots[e.currentIndex];if(e.currentIndex<0||!l||!i(t,l)){(0,r.default)(e,o),e.snapshots.push(t),e.currentIndex++,e.totalSize+=o(t);for(var s=0;s<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=o(e.snapshots[s]),s++;s>0&&(e.snapshots.splice(0,s),e.currentIndex-=s,e.autoCompleteIndex-=s),n&&(e.autoCompleteIndex=e.currentIndex)}}function i(e,t){return e.html==t.html}function a(e,t){return e==t}t.default=o,t.addSnapshotV2=function(e,t,n){o(e,t,n,(function(e){var t;return(null===(t=e.html)||void 0===t?void 0:t.length)||0}),i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.moveCurrentSnapsnot=void 0;var r=n(50);function o(e,t){return(0,r.default)(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}t.default=o,t.moveCurrentSnapsnot=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.autoCompleteIndex>=0&&e.currentIndex-e.autoCompleteIndex==1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(79),i=n(75),a=n(34),l=n(3),s=n(2),u=n(35),c=n(6),d=n(80),f=n(163),h=n(0),p=function(){function e(e){e=e||{},this.elementCallbacks=(0,d.cloneObject)(e.elementCallbacks),this.styleCallbacks=(0,f.getStyleCallbacks)(e.cssStyleCallbacks),this.attributeCallbacks=(0,d.cloneObject)(e.attributeCallbacks),this.tagReplacements=(0,f.getTagReplacement)(e.additionalTagReplacements),this.allowedAttributes=(0,f.getAllowedAttributes)(e.additionalAllowedAttributes),this.allowedCssClassesRegex=(0,f.getAllowedCssClassesRegex)(e.additionalAllowedCssClasses),this.defaultStyleValues=(0,f.getDefaultStyleValues)(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement||null,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments||!1,this.unknownTagReplacement=e.unknownTagReplacement||null}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),i=(0,s.default)(n.currentElementOrStyle,"HTMLElement")?(0,o.default)(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,i)},e.prototype.exec=function(e,t,n){var r=(new DOMParser).parseFromString(e||"","text/html");return r&&r.body&&r.body.firstChild&&(this.convertGlobalCssToInlineCss(r),t||this.sanitize(r.body,n)),r&&r.body&&r.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=(0,d.cloneObject)(t,(0,o.default)(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=(0,c.default)(e.querySelectorAll("style")),n=0,r=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(t.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));n<r.length;n++)for(var o=r[n],i=function(t){var n=o.cssRules[t],r=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!r||!n.selectorText)return"continue";for(var i=0,a=n.selectorText.split(",");i<a.length;i++){var l=a[i];if(l&&l.trim()&&!(l.indexOf(":")>=0))(0,c.default)(e.querySelectorAll(l)).forEach((function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))}))}},a=o.cssRules.length-1;a>=0;a--)i(a);t.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var o,i=e.nodeType,a=i==h.NodeType.Element,s=i==h.NodeType.Text,u=i==h.NodeType.DocumentFragment,c=i==h.NodeType.Comment,f=!1;if(a){var p=(0,l.default)(e),g=this.elementCallbacks[p],v=this.tagReplacements[p.toLowerCase()];void 0===v&&(v=this.unknownTagReplacement),g?f=g(e,n):p.indexOf(":")>0||p==v||"*"==v?f=!0:v&&/^[a-zA-Z][\w\-]*$/.test(v)&&(e=(0,r.default)(e,v),f=!0)}else if(s){var y=t["white-space"];f="pre"==y||"pre-line"==y||"pre-wrap"==y||!/^[\r\n]*$/g.test(e.nodeValue||"")}else f=!!u||!!c&&this.preserveHtmlComments;if(f)if(!s||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(a||u){var m=(0,d.cloneObject)(t),b=e;a&&(this.processAttributes(b,n),this.preprocessCss(b,m),this.processCss(b,m,n));for(var E=b.firstChild,C=void 0;E;E=C)C=E.nextSibling,this.processNode(E,m,n)}}else e.nodeValue=(e.nodeValue||"").replace(/^ /gm," ").replace(/ {2}/g,"  ");else null===(o=e.parentNode)||void 0===o||o.removeChild(e)},e.prototype.preprocessCss=function(e,t){var n=(0,i.default)(e,this.additionalPredefinedCssForElement);n&&Object.keys(n).forEach((function(e){t[e]=n[e]}))},e.prototype.processCss=function(e,t,n){var r=this,o=(0,a.default)(e);Object.keys(o).forEach((function(i){var a=o[i],l=r.styleCallbacks[i],s=null!=t[i],u=(!l||l(a,e,t,n))&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=i.substr(0,1)&&r.defaultStyleValues[i]!=a&&(s&&a!=t[i]||!s&&"initial"!=a&&"normal"!=a);u&&s&&(t[i]=a),u||delete o[i]})),(0,u.default)(e,o)},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],l=a?a(i,e,t):this.allowedAttributes.indexOf(o)>=0||0==o.indexOf("data-")?i:null;"class"==o&&this.allowedCssClassesRegex&&(l=this.processCssClass(i,l)),null==l||l.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=l}},e.prototype.processCssClass=function(e,t){var n=this,r=e?e.split(" "):[],o=t?t.split(" "):[];return r.forEach((function(e){var t;(null===(t=n.allowedCssClassesRegex)||void 0===t?void 0:t.test(e))&&o.indexOf(e)<0&&o.push(e)})),(null==o?void 0:o.length)>0?o.join(" "):null},e}();t.default=p},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleCallbacks=t.getDefaultStyleValues=t.getAllowedCssClassesRegex=t.getAllowedAttributes=t.getTagReplacement=void 0;var o=n(80),i={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,template:null,title:null,track:null,video:null},a="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap".split(","),l={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},s=[];function u(){return null}function c(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}t.getTagReplacement=function(e){var t=r({},i),n=e||{};return Object.keys(n).forEach((function(e){e&&(t[e.toLowerCase()]=n[e])})),t},t.getAllowedAttributes=function(e){return(t=a.concat(e||[]),t.filter((function(e,t,n){return n.indexOf(e)==t}))).map((function(e){return e.toLocaleLowerCase()}));var t},t.getAllowedCssClassesRegex=function(e){var t=s.concat(e||[]);return t.length>0?new RegExp(t.join("|")):null},t.getDefaultStyleValues=function(e){var t=(0,o.cloneObject)(l);return e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r?t[n]=r:delete t[n]})),t},t.getStyleCallbacks=function(e){var t=(0,o.cloneObject)(e);return t.position=t.position||u,t.width=t.width||c,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e[t]){var r=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}}else e[t]=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n,o){e&&(e.className=r.EntityClasses.ENTITY_INFO_NAME+" "+r.EntityClasses.ENTITY_TYPE_PREFIX+t+" "+(o?""+r.EntityClasses.ENTITY_ID_PREFIX+o+" ":"")+r.EntityClasses.ENTITY_READONLY_PREFIX+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute("contenteditable")&&e.removeAttribute("contenteditable"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){var t,n=!1,o="",i="",a=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach((function(e){e==r.EntityClasses.ENTITY_INFO_NAME?n=!0:0==e.indexOf(r.EntityClasses.ENTITY_TYPE_PREFIX)?o=e.substr(r.EntityClasses.ENTITY_TYPE_PREFIX.length):0==e.indexOf(r.EntityClasses.ENTITY_ID_PREFIX)?i=e.substr(r.EntityClasses.ENTITY_ID_PREFIX.length):0==e.indexOf(r.EntityClasses.ENTITY_READONLY_PREFIX)&&(a="1"==e.substr(r.EntityClasses.ENTITY_READONLY_PREFIX.length))})),n?{wrapper:e,id:i,type:o,isReadonly:a}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e?"."+r.EntityClasses.ENTITY_TYPE_PREFIX+e:"",o=t?"."+r.EntityClasses.ENTITY_ID_PREFIX+t:"";return"."+r.EntityClasses.ENTITY_INFO_NAME+n+o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(81);t.default=function(e){return!(0,r.default)(e)&&!!e.key&&1==e.key.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=function(e){return r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(4),i=n(10),a=n(12),l=n(8),s=n(3),u=n(32),c=n(76),d=n(38),f=n(41),h=n(5),p=n(63),g=n(18),v=n(29),y=n(6),m=n(33),b=n(67),E=n(13),C=n(0),T=n(14),S=[function(e,t,n,r){var a,s,c=(0,l.default)(e,n.node);if(c){var d=(0,g.default)(e,"a[href]",null,C.QueryScope.OnSelection,(0,i.default)(n)).filter((function(e){return c.contains(e)}))[0];if(d&&(0,u.default)(d)&&(n=new h.default(d,C.PositionType.Before),P(d),d=null),d&&(null===(a=t)||void 0===a?void 0:a.querySelector)&&(null===(s=t)||void 0===s?void 0:s.querySelector("a[href]"))){var f=n.normalize(),p=f.node.parentNode,y=f.node.nodeType==C.NodeType.Text?(0,v.default)(f.node,f.offset,!1):f.isAtEnd?f.node.nextSibling:f.node,m=e.ownerDocument.createTextNode("");for(p.insertBefore(m,y);(0,o.default)(d,m);)m=(0,T.splitBalancedNodeRange)(m);n=new h.default(m,C.PositionType.Before),P(m)}}return n},function(e,t,n,r){var o,i,l,u=t;if(u.nodeType==C.NodeType.DocumentFragment){var d=(0,y.default)(u.childNodes).filter((function(e){return"BR"!=(0,s.default)(e)}));u=1==d.length?d[0]:null}var f=(0,s.default)(u),p=f&&u&&"BR"==(0,s.default)(u.nextSibling),g=(0,a.default)(n.node,e,"LI"),v=g&&(0,a.default)(g,e,"OL,UL"),T=(0,a.default)(n.node,e,"TD,TH"),S=T&&(0,a.default)(T,e,"TR");"LI"==f&&(f=v?(0,s.default)(v):"UL",u=(0,E.default)(u,f));if("OL"!=f&&"UL"!=f||!u||"LI"!=(0,s.default)(u.firstChild)){if("TABLE"==f&&S){var w=new b.default(u),O=new b.default(T);0==O.col&&T==O.getCell(O.row||0,0).td&&(null===(o=w.cells)||void 0===o?void 0:o[0])&&w.cells[0].length==(null===(i=O.cells)||void 0===i?void 0:i[0].length)&&(0,c.default)(n,T)&&("TBODY"!=(0,s.default)(u.firstChild)||(null===(l=u.firstChild)||void 0===l?void 0:l.nextSibling)||(0,m.default)(u.firstChild),(0,m.default)(u),n=new h.default(S,C.PositionType.After))}}else{var N=!u.firstChild.nextSibling&&!p;p&&u.parentNode&&P(u.nextSibling),N?((0,m.default)(u.firstChild),(0,m.default)(u)):(0,s.default)(v)==f&&((0,m.default)(u),n=new h.default(g,(0,c.default)(n,g)?C.PositionType.Before:C.PositionType.After))}return n},function(e,t,n,o){if("P"==(0,s.default)(n.node)){var i=n.normalize(),a=(0,r.default)(n.node,"div");i.node!=a&&(n=i)}return n},function(e,t,n,r){(0,d.default)(n.node)&&(n=new h.default(n.node,n.isAtEnd?C.PositionType.After:C.PositionType.Before));return n},function(e,t,n,r){if(r&&r.collapsed){var o=new p.default(e,h.default.getStart(r)),i=o.getInlineElementBefore(),a=o.getInlineElementAfter();i instanceof f.default?n=new h.default(i.getContainerNode(),C.PositionType.After):a instanceof f.default&&(n=new h.default(a.getContainerNode(),C.PositionType.Before))}return n}];function P(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}t.default=function(e,t,n,r){return S.forEach((function(o){n=o(e,t,n,r)})),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(44),o=n(73),i=n(72),a=n(49),l=n(74),s=n(5),u=n(18),c=n(2),d=n(29),f=n(0);function h(e,t,n){var r,o;if((0,c.default)(e,"Text")){var i=(0,d.default)(e,t,n);return n?[i,e]:[e,i]}var a=e.childNodes[t-1],l=e.childNodes[t];if(a||l||(n?a=(l=e).previousSibling:l=(a=e).nextSibling),(a||l)&&(!a||!l)){var s=e.ownerDocument.createTextNode("");null===(o=null===(r=a||l)||void 0===r?void 0:r.parentNode)||void 0===o||o.insertBefore(s,l),a?l=s:a=s}return[a,l]}t.default=function(e,t){var n=null,c=(0,u.default)(e,"table,tr",null,f.QueryScope.InSelection,t),d=(0,i.default)(e,t,f.RegionType.Table).map((function(e){var t=(0,a.default)(e);if(!t)return null;var i=t.startContainer,l=t.endContainer,s=t.startOffset,u=h(l,t.endOffset,!1),d=u[0],f=u[1],p=h(i,s,!0),g=p[0],v=p[1];n=n||g;var y=(0,o.default)(e,[v,d]);return(0,r.default)(c,y),{region:e,beforeStart:g,afterEnd:f}})).filter((function(e){return!!e}));return c.forEach((function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})),d.forEach((function(e){e&&(0,l.default)(e.region,e.beforeStart,e.afterEnd)})),n&&new s.default(n,f.PositionType.End)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23);t.default=function(e){for(var t=r.default.createBodyTraverser(e),n=t&&t.currentBlockElement,o=[];n;)o.push(n.getTextContent()),n=t.getNextBlockElement();return o.join("\n")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=void 0;t.attachDomEvent=function(e,t){var n=Object.keys(t||{}).map((function(n){var r=function(e){var t={pluginEventType:null,beforeDispatch:null};"number"==typeof e?t.pluginEventType=e:"function"==typeof e?t.beforeDispatch=e:"object"==typeof e&&(t=e);return t}(t[n]),o=r.pluginEventType,i=r.beforeDispatch,a=function(t){i&&i(t),null!=o&&e.api.triggerEvent(e,{eventType:o,rawEvent:t},!1)};return e.contentDiv.addEventListener(n,a),function(){e.contentDiv.removeEventListener(n,a)}}));return function(){return n.forEach((function(e){return e()}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPasteFragment=void 0;var r=n(1),o=n(0);function i(e,t){(0,r.toArray)(e.querySelectorAll("style")).forEach(t)}t.createPasteFragment=function(e,t,n,a,l){var s,u;if(!t)return null;var c,d=function(e,t){return{eventType:o.PluginEventType.BeforePaste,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:(0,r.createDefaultHtmlSanitizerOptions)(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}}}(e,t),f=d.fragment,h=d.sanitizingOption,p=t.rawHtml,g=t.text,v=t.imageDataUri,y=e.contentDiv.ownerDocument;if(p&&(null===(s=c=(new DOMParser).parseFromString(e.trustedHTMLHandler(p),"text/html"))||void 0===s?void 0:s.body)){var m=null===(u=c.querySelector("html"))||void 0===u?void 0:u.attributes;(m?(0,r.toArray)(m):[]).reduce((function(e,t){return e[t.name]=t.value,e}),d.htmlAttributes),(0,r.toArray)(c.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),d.htmlAttributes),t.htmlFirstLevelChildTags=[],null==c||c.body.normalize();for(var b=0;b<(null==c?void 0:c.body.childNodes.length);b++){var E=null==c?void 0:c.body.childNodes.item(b);if(E.nodeType==Node.TEXT_NODE)if(!E.nodeValue.replace(/(\r\n|\r|\n)/gm,"").trim())continue;var C=(0,r.getTagOfNode)(E);E.nodeType!=Node.COMMENT_NODE&&t.htmlFirstLevelChildTags.push(C)}i(c,(function(e){c.head.appendChild(e),h.additionalGlobalStyleNodes.push(e)}));var T=p.indexOf("\x3c!--StartFragment--\x3e"),S=p.lastIndexOf("\x3c!--EndFragment--\x3e");T>=0&&S>=T+"\x3c!--StartFragment--\x3e".length&&(d.htmlBefore=p.substr(0,T),d.htmlAfter=p.substr(S+"\x3c!--EndFragment--\x3e".length),t.html=p.substring(T+"\x3c!--StartFragment--\x3e".length,S),c.body.innerHTML=e.trustedHTMLHandler(t.html),i(c.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})))}if(a||g||!v)if(!a&&p&&c&&c.body){if((0,r.moveChildNodes)(f,c.body),l&&n){var P=function(e,t){var n=e.api.getPendableFormatState(e,!0),r=e.api.getStyleBasedFormatState(e,t);return{fontFamily:r.fontName,fontSize:r.fontSize,textColor:r.textColor,backgroundColor:r.backgroundColor,textColors:r.textColors,backgroundColors:r.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);(0,r.applyTextStyle)(f,(function(e){return(0,r.applyFormat)(e,P)}))}}else g&&g.split("\n").forEach((function(e,t,n){e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  ");var o=y.createTextNode(e);2==n.length&&0==t?(f.appendChild(o),f.appendChild(y.createElement("br"))):t>0&&t<n.length-1?f.appendChild((0,r.wrap)(""==e?y.createElement("br"):o)):f.appendChild(o)}));else{var w=y.createElement("img");w.style.maxWidth="100%",w.src=v,f.appendChild(w)}e.api.triggerEvent(e,d,!0);var O=new r.HtmlSanitizer(d.sanitizingOption);return O.convertGlobalCssToInlineCss(f),O.sanitize(f,n&&(0,r.getInheritableStyles)(n.element)),f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensureTypeInContainer=void 0;var r=n(0),o=n(1);t.ensureTypeInContainer=function(e,t,n){var i,a=(0,o.findClosestElementAncestor)(t.node,e.contentDiv,"table");a&&(i=a.querySelector("td,th"))&&(t=new o.Position(i,r.PositionType.Begin)),t=t.normalize();var l,s=(0,o.getBlockElementAtNode)(e.contentDiv,t.node);if(s){l=s.collapseToSingleElement();var u=(0,o.isNodeEmpty)(l)||n&&function(e,t){return(0,o.safeInstanceOf)(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,l);l=l&&u?l:null}else l=(0,o.createElement)(r.KnownCreateElementDataIndex.EmptyLine,e.contentDiv.ownerDocument),e.api.insertNode(e,l,{position:r.ContentPosition.End,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new o.Position(l.firstChild,r.PositionType.Begin);l&&(0,o.applyFormat)(l,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode),n&&e.api.selectRange(e,(0,o.createRange)(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0;var r=n(1),o=n(0);t.focus=function(e){if(!e.lifecycle.shadowEditFragment){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=(0,r.getFirstLeafNode)(e.contentDiv)||e.contentDiv;e.api.selectRange(e,(0,r.createRange)(t,o.PositionType.Begin),!0)}e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContent=void 0;var r=n(0),o=n(1);t.getContent=function(e,t){var n="",i=t==r.GetContentMode.CleanHTML,a=t==r.GetContentMode.RawHTMLWithSelection,l=e.lifecycle.shadowEditFragment||e.contentDiv;if(t==r.GetContentMode.PlainTextFast)n=l.textContent;else if(t==r.GetContentMode.PlainText)n=(0,o.getTextContent)(l);else if(i||e.lifecycle.isDarkMode){var s=function(e){var t;(0,o.safeInstanceOf)(e,"DocumentFragment")?(t=e.ownerDocument.createElement("div")).appendChild(e.cloneNode(!0)):t=e.cloneNode(!0);return t}(l);s.normalize();var u=e.api.getSelectionRange(e,!0),c=a?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:u?(0,o.getSelectionPath)(e.contentDiv,u):null:null,d=c&&(0,o.createRange)(s,c.start,c.end);e.lifecycle.isDarkMode&&e.api.transformColor(e,s,!1,null,r.ColorTransformDirection.DarkToLight),i?(e.api.triggerEvent(e,{eventType:r.PluginEventType.ExtractContentWithDom,clonedRoot:s},!0),n=s.innerHTML):n=d?(0,o.getHtmlWithSelectionPath)(s,d):s.innerHTML}else n=(0,o.getHtmlWithSelectionPath)(l,a&&e.api.getSelectionRange(e,!0));return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPendableFormatState=void 0;var r=n(1),o=n(0);t.getPendableFormatState=function(e,t){var n,l=e.api.getSelectionRange(e,!0),s=e.pendingFormatState.pendableFormatState,u=null===(n=e.pendingFormatState.pendableFormatPosition)||void 0===n?void 0:n.normalize(),c=l&&r.Position.getStart(l).normalize(),d=c&&l.collapsed&&c.equalTo(u);return l&&s&&d&&!t?s:c?function(e,t){var n=t.node,l={},s=[],u=function(){var e=(0,r.getTagOfNode)(n),t=n.nodeType==o.NodeType.Element&&n.style;e&&t&&Object.keys(i).forEach((function(n){s.indexOf(n)>=0||(l[n]=l[n]||i[n](e,t),a[n](t)&&s.push(n))})),n=n.parentNode};for(;(0,r.contains)(e.contentDiv,n);)u();return l}(e,c):{}};var i={isBold:function(e,t){return"B"==e||"STRONG"==e||parseInt(t.fontWeight)>=700||["bold","bolder"].indexOf(t.fontWeight)>=0},isUnderline:function(e,t){return"U"==e||t.textDecoration.indexOf("underline")>=0},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||t.textDecoration.indexOf("line-through")>=0}},a={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRange=void 0;var r=n(1);t.getSelectionRange=function(e,t){var n,o=null;if(e.lifecycle.shadowEditFragment)return o=e.lifecycle.shadowEditSelectionPath&&(0,r.createRange)(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end);if(!t||e.api.hasFocus(e)){var i=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(i&&i.rangeCount>0){var a=i.getRangeAt(0);(0,r.contains)(e.contentDiv,a)&&(o=a)}}return!o&&t&&(o=e.domEvent.selectionRange),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionRangeEx=void 0;var r=n(1),o=n(0);function i(e){return{type:o.SelectionRangeTypes.Normal,ranges:e,areAllCollapsed:a(e)}}function a(e){return e.filter((function(e){return null==e?void 0:e.collapsed})).length==e.length}t.getSelectionRangeEx=function(e){var t,n;if(e.lifecycle.shadowEditFragment){var l=e.lifecycle,s=l.shadowEditTableSelectionPath,u=l.shadowEditSelectionPath;if((null==s?void 0:s.length)>0){var c=e.lifecycle.shadowEditTableSelectionPath.map((function(t){return(0,r.createRange)(e.contentDiv,t.start,t.end)}));return{type:o.SelectionRangeTypes.TableSelection,ranges:c,areAllCollapsed:a(c),table:(0,r.findClosestElementAncestor)(c[0].startContainer,e.contentDiv,"table"),coordinates:null}}var d=u&&(0,r.createRange)(e.contentDiv,u.start,u.end);return i(d?[d]:[])}if(e.api.hasFocus(e)){if(e.domEvent.tableSelectionRange)return e.domEvent.tableSelectionRange;var f=null===(t=e.contentDiv.ownerDocument.defaultView)||void 0===t?void 0:t.getSelection();if(f&&f.rangeCount>0){var h=f.getRangeAt(0);if((0,r.contains)(e.contentDiv,h))return i([h])}}return null!==(n=e.domEvent.tableSelectionRange)&&void 0!==n?n:i(e.domEvent.selectionRange?[e.domEvent.selectionRange]:[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getStyleBasedFormatState=void 0;var r=n(0),o=n(1),i="[data-"+r.DarkModeDatasetNames.OriginalStyleColor+"],[data-"+r.DarkModeDatasetNames.OriginalAttributeColor+"]",a="[data-"+r.DarkModeDatasetNames.OriginalStyleBackgroundColor+"],[data-"+r.DarkModeDatasetNames.OriginalAttributeBackgroundColor+"]";t.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?(0,o.getComputedStyles)(t):[],l=e.lifecycle.isDarkMode,s=e.contentDiv,u=l&&(0,o.findClosestElementAncestor)(t,s,i),c=l&&(0,o.findClosestElementAncestor)(t,s,a);return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:u?{darkModeColor:n[2],lightModeColor:u.dataset[r.DarkModeDatasetNames.OriginalStyleColor]||u.dataset[r.DarkModeDatasetNames.OriginalAttributeColor]}:void 0,backgroundColors:c?{darkModeColor:n[3],lightModeColor:c.dataset[r.DarkModeDatasetNames.OriginalStyleBackgroundColor]||c.dataset[r.DarkModeDatasetNames.OriginalAttributeBackgroundColor]}:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.insertNode=void 0;var r=n(0),o=n(1);t.insertNode=function(e,t,n){n=n||{position:r.ContentPosition.SelectionStart,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var i=e.contentDiv;return n.updateCursor&&e.api.focus(e),n.position==r.ContentPosition.Outside?(i.parentNode.insertBefore(t,i.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){switch(n.position){case r.ContentPosition.Begin:case r.ContentPosition.End:var a,l=n.position==r.ContentPosition.Begin,s=(0,o.getFirstLastBlockElement)(i,l);if(s){var u=l?s.getStartNode():s.getEndNode();n.insertOnNewLine||u.nodeType==r.NodeType.Text||(0,o.isVoidHtmlElement)(u)?(0,o.safeInstanceOf)(t,"DocumentFragment")?(a=(0,o.toArray)(t.childNodes),u.parentNode.insertBefore(t,l?u:u.nextSibling)):a=u.parentNode.insertBefore(t,l?u:u.nextSibling):a=u.insertBefore(t,l?u.firstChild:null)}else a=i.appendChild(t);if(a&&n.insertOnNewLine){var c=Array.isArray(a)?a:[a];(0,o.isBlockElement)(c[0])&&(0,o.isBlockElement)(c[c.length-1])||(0,o.wrap)(c)}break;case r.ContentPosition.DomEnd:var d=i.appendChild(t);d&&n.insertOnNewLine&&!(0,o.isBlockElement)(d)&&(0,o.wrap)(d);break;case r.ContentPosition.Range:case r.ContentPosition.SelectionStart:var f=function(e,t){var n=e.api.getSelectionRange(e,!0),o=null;return t.position==r.ContentPosition.Range?(o=n,n=t.range):n&&(o=n.cloneRange()),{range:n,rangeToRestore:o}}(e,n),h=f.range,p=f.rangeToRestore;if(!h)return;n.replaceSelection&&!h.collapsed&&h.deleteContents();var g=o.Position.getStart(h),v=void 0;g=n.insertOnNewLine&&(v=(0,o.getBlockElementAtNode)(i,g.normalize().node))?new o.Position(v.getEndNode(),r.PositionType.After):(0,o.adjustInsertPosition)(i,t,g,h);var y=t.nodeType==r.NodeType.DocumentFragment?t.lastChild:t;(h=(0,o.createRange)(g)).insertNode(t),n.updateCursor&&y&&(p=(0,o.createRange)(new o.Position(y,r.PositionType.After).normalize())),e.api.selectRange(e,p)}}),r.ColorTransformDirection.LightToDark),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=void 0;t.restoreUndoSnapshot=function(e,t){e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var n=e.undo.snapshotsService.move(t);if(n&&null!=n.html)try{e.undo.isRestoring=!0,e.api.setContent(e,n.html,!0,n.metadata)}finally{e.undo.isRestoring=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectRange=void 0;var r=n(82),o=n(1);t.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!(0,o.contains)(e.contentDiv,t))&&((0,o.addRangeToSelection)(t,n),(0,r.hasFocus)(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,r=e.api.getSelectionRange;if(n.pendableFormatState){var i=t.ownerDocument,a=(0,o.getPendableFormatState)(i);Object.keys(o.PendableFormatCommandMap).forEach((function(e){!!n.pendableFormatState[e]!=a[e]&&i.execCommand(o.PendableFormatCommandMap[e],!1,null)}));var l=r(e,!0);n.pendableFormatPosition=l&&o.Position.getStart(l)}}(e),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.selectTable=void 0;var r=n(1),o=n(0);function i(e,t){if(e&&!e.id){for(var n=e.ownerDocument,r=function(e){return e.getElementById(t+o)},o=0,i=r(n);i;)i=r(n),o++;e.id=t+o}}function a(e,t,n,r,o,i){return e+" #"+t+n+" tr:nth-child("+r+")>"+o+":nth-child("+i+")"}function l(e){if(e){var t=(0,r.getStyles)(e),n=0;["background-color","background"].forEach((function(e){var r;if((null===(r=t[e])||void 0===r?void 0:r.indexOf("!important"))>-1){var o=t[e].indexOf("!");t[e]=t[e].substring(0,o),n++}})),n>0&&(0,r.setStyles)(e,t)}}function s(e){return(!!e||0==e)&&e>-1}t.selectTable=function(e,t,n){if(function(e){var t,n=e.contentDiv,r=n.ownerDocument.getElementById("tableStyle"+n.id);if(null===(t=null==r?void 0:r.sheet)||void 0===t?void 0:t.cssRules)for(;r.sheet.cssRules.length>0;)r.sheet.deleteRule(0)}(e),function(e){if(e){var t=e||{},n=t.firstCell,r=t.lastCell;if(n&&r){var o=function(e){return s(e.x)&&s(e.y)};return o(n)&&o(r)}}return!1}(n)&&t){i(t,"tableSelected"),i(e.contentDiv,"contentDiv_");var u=function(e,t,n){var o=e.contentDiv.ownerDocument,i="#"+e.contentDiv.id,s=function(e,t,n){var o=t.firstCell.y,i=t.firstCell.x,s=t.lastCell.y,u=t.lastCell.x,c=[],d=null,f=null,h="",p=!0,g=new r.VTable(e),v=(0,r.toArray)(e.childNodes).filter((function(e){return["THEAD","TBODY","TFOOT"].indexOf((0,r.getTagOfNode)(e))>-1})),y=0,m=v.map((function(e){var t={el:(0,r.getTagOfNode)(e),start:y,end:e.childNodes.length+y};return y=t.end,t}));return g.cells.forEach((function(t,g){var v=0,y=0;d=null,f=null;for(var b=m.filter((function(e){return e.start<=g&&e.end>g}))[0],E=b?">"+b.el+">":">",C=b&&g+1>=b.start?g+1-b.start:g+1,T=0;T<t.length;T++)if(t[T].td){var S=(0,r.getTagOfNode)(t[T].td);if("TD"==S&&v++,"TH"==S&&y++,g>=o&&g<=s&&T>=i&&T<=u){p?p=!1:h.endsWith(",")||(h+=","),l(t[T].td);var P=a(n,e.id,E,C,S,"TD"==S?v:y);h+=P,d=d||e.querySelector(P),f=e.querySelector(P)}}if(d&&f){var w=new Range;w.setStartBefore(d),w.setEndAfter(f),c.push(w)}})),{css:h+="{background-color: rgba(198,198,198,0.7) !important;}",ranges:c}}(t,n,i),u=s.css,c=s.ranges,d=o.getElementById("tableStyle"+e.contentDiv.id);d||(d=o.createElement("style"),o.head.appendChild(d),d.id="tableStyle"+e.contentDiv.id);return d.sheet.insertRule(u),c}(e,t,n);return function(e,t){var n=t.firstCell;return!(e.rows.item(n.y)&&e.rows.item(n.y).cells.item(n.x))}(t,n)||e.api.selectRange(e,(0,r.createRange)(new r.Position(t.rows.item(n.firstCell.y).cells.item(n.firstCell.x),o.PositionType.Begin))),{type:o.SelectionRangeTypes.TableSelection,ranges:u,table:t,areAllCollapsed:u.filter((function(e){return null==e?void 0:e.collapsed})).length==u.length,coordinates:n}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setContent=void 0;var r=n(1),o=n(1),i=n(0);t.setContent=function(e,t,n,a){var l=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:i.PluginEventType.BeforeSetContent,newContent:t},!0);var s=(0,o.setHtmlWithMetadata)(e.contentDiv,t,e.trustedHTMLHandler);(function(e,t){switch(null==t?void 0:t.type){case i.SelectionRangeTypes.Normal:var n=(0,r.createRange)(e.contentDiv,t.start,t.end);e.api.selectRange(e,n);break;case i.SelectionRangeTypes.TableSelection:var o=(0,r.queryElements)(e.contentDiv,"#"+t.tableId)[0];o&&e.api.selectTable(e,o,t)}})(e,a=a||s),l=!0}var u=e.lifecycle.isDarkMode;(!a&&u||a&&!!a.isDarkMode!=!!u)&&(e.api.transformColor(e,e.contentDiv,!1,null,u?i.ColorTransformDirection.LightToDark:i.ColorTransformDirection.DarkToLight,!0),l=!0),n&&l&&e.api.triggerEvent(e,{eventType:i.PluginEventType.ContentChanged,source:i.ChangeSource.SetContent},!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var r=n(1),o=n(0);t.switchShadowEdit=function(e,t){var n=e.lifecycle,i=e.contentDiv,a=n.shadowEditFragment,l=n.shadowEditSelectionPath,s=n.shadowEditTableSelectionPath,u=!!a;if(t){if(!u){var c=e.api.getSelectionRangeEx(e),d=e.api.getSelectionRange(e,!0);l=d&&(0,r.getSelectionPath)(i,d),s=(null==c?void 0:c.type)==o.SelectionRangeTypes.TableSelection&&c.ranges.map((function(e){return(0,r.getSelectionPath)(i,e)})),a=e.contentDiv.ownerDocument.createDocumentFragment(),(0,r.moveChildNodes)(a,i),a.normalize(),e.api.triggerEvent(e,{eventType:o.PluginEventType.EnteredShadowEdit,fragment:a,selectionPath:l},!1),n.shadowEditFragment=a,n.shadowEditSelectionPath=l,n.shadowEditTableSelectionPath=s}(0,r.moveChildNodes)(i),i.appendChild(n.shadowEditFragment.cloneNode(!0))}else if(n.shadowEditFragment=null,n.shadowEditSelectionPath=null,u&&(e.api.triggerEvent(e,{eventType:o.PluginEventType.LeavingShadowEdit},!1),(0,r.moveChildNodes)(i),i.appendChild(a),e.api.focus(e),l&&e.api.selectRange(e,(0,r.createRange)(i,l.start,l.end)),e.domEvent.tableSelectionRange)){var f=e.domEvent.tableSelectionRange,h=f.table,p=f.coordinates,g=h.id,v=e.contentDiv.querySelector("#"+g);h&&(e.domEvent.tableSelectionRange=e.api.selectTable(e,v,p))}}},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.transformColor=void 0;var i=n(1),a=n(0),l=[(r={},r[0]="color",r[1]="color",r[2]=a.DarkModeDatasetNames.OriginalStyleColor,r[3]=a.DarkModeDatasetNames.OriginalAttributeColor,r),(o={},o[0]="background-color",o[1]="bgcolor",o[2]=a.DarkModeDatasetNames.OriginalStyleBackgroundColor,o[3]=a.DarkModeDatasetNames.OriginalAttributeBackgroundColor,o)];function s(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}function u(e){var t=e;return!!t.style&&!!t.dataset}t.transformColor=function(e,t,n,r,o,c){var d=c||e.lifecycle.isDarkMode?function(e,t){var n=[];if((0,i.safeInstanceOf)(e,"HTMLElement")){t&&n.push(e);var r=e.getElementsByTagName("*");(0,i.arrayPush)(n,(0,i.toArray)(r))}else if((0,i.safeInstanceOf)(e,"DocumentFragment")){r=e.querySelectorAll("*");(0,i.arrayPush)(n,(0,i.toArray)(r))}return n.filter(u)}(t,n):[];null==r||r(),o==a.ColorTransformDirection.DarkToLight?function(e){e.forEach((function(e){l.forEach((function(t){e.style.setProperty(t[0],s(e.dataset[t[2]],"")),delete e.dataset[t[2]];var n=e.dataset[t[3]];s(n,null)?e.setAttribute(t[1],n):e.removeAttribute(t[1]),delete e.dataset[t[3]]}))}))}(d):e.lifecycle.onExternalContentTransform?d.forEach((function(t){return e.lifecycle.onExternalContentTransform(t)})):function(e,t){l.forEach((function(n){e.map((function(e){var r=e.style.getPropertyValue(n[0]),o=e.getAttribute(n[1]);return e.dataset[n[2]]||e.dataset[n[3]]||!r&&!o||"inherit"==r?null:{element:e,styleColor:r,attrColor:o,newColor:t(r||o)}})).filter((function(e){return!!e})).forEach((function(e){var t=e.element,r=e.styleColor,o=e.attrColor,i=e.newColor;t.style.setProperty(n[0],i,"important"),t.dataset[n[2]]=r||"",o&&(t.setAttribute(n[1],i),t.dataset[n[3]]=o)}))}))}(d,e.lifecycle.getDarkColor)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=void 0;var r=n(0),o=[r.PluginEventType.EditorReady,r.PluginEventType.BeforeDispose,r.PluginEventType.ExtractContentWithDom,r.PluginEventType.ZoomChanged];t.triggerEvent=function(e,t,n){e.lifecycle.shadowEditFragment&&!(o.indexOf(t.eventType)>=0)||!n&&e.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPluginState=void 0;var r=n(194),o=n(195),i=n(196),a=n(197),l=n(198),s=n(199),u=n(200),c=n(201),d=n(202),f=n(203);t.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new d.default,edit:n.edit||new i.default,pendingFormatState:n.pendingFormatState||new c.default,_placeholder:null,typeAfterLink:null,undo:n.undo||new f.default(t),domEvent:n.domEvent||new o.default(t,e),mouseUp:n.mouseUp||new s.default,copyPaste:n.copyPaste||new r.default(t),entity:n.entity||new a.default,normalizeTable:n.normalizeTable||new u.default,lifecycle:n.lifecycle||new l.default(t,e)}},t.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=function(){function e(e){var t=this;this.onPaste=function(e){var n;(0,r.extractClipboardEvent)(e,(function(e){return t.editor.paste(e)}),{allowLinkPreview:t.editor.isFeatureEnabled(o.ExperimentalFeatures.PasteWithLinkPreview),allowedCustomPasteType:t.state.allowedCustomPasteType,getTempDiv:function(){return n=t.editor.getSelectionRange(),t.getTempDiv()},removeTempDiv:function(e){t.cleanUpAndRestoreSelection(e,n,!1)}})},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:this.onPaste,copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,t){var n=this,i=this.editor.getSelectionRangeEx();if(i&&!i.areAllCollapsed){var a=this.editor.getContent(o.GetContentMode.RawHTMLWithSelection),l=this.getTempDiv(!0),s=(0,r.setHtmlWithSelectionPath)(l,a,this.editor.getTrustedHTMLHandler());s&&(0,r.addRangeToSelection)(s),this.editor.triggerPluginEvent(o.PluginEventType.BeforeCutCopy,{clonedRoot:l,range:s,rawEvent:e,isCut:t}),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(l,i,!t),t&&e.addUndoSnapshot((function(){var t=n.editor.deleteSelectedContent();e.focus(),e.select(t)}),o.ChangeSource.Cut)}))}},e.prototype.getTempDiv=function(e){var t=this,n=this.editor.getCustomData("CopyPasteTempDiv",(function(){var e=(0,r.createElement)(o.KnownCreateElementDataIndex.CopyPasteTempDiv,t.editor.getDocument());return t.editor.insertNode(e,{position:o.ContentPosition.Outside}),e}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return e&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t,n){var i,a;if((null===(i=t)||void 0===i?void 0:i.type)||0==t.type){var l=t;switch(l.type){case o.SelectionRangeTypes.TableSelection:this.editor.select(l.table,l.coordinates);break;case o.SelectionRangeTypes.Normal:var s=null===(a=l.ranges)||void 0===a?void 0:a[0];this.restoreRange(s,n)}}else this.restoreRange(t,n);e.style.backgroundColor="",e.style.color="",e.style.display="none",(0,r.moveChildNodes)(e)},e.prototype.restoreRange=function(e,t){e&&(t&&r.Browser.isAndroid&&e.collapse(),this.editor.select(e))},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=function(){function e(e,t){var n,i=this;this.onDrop=function(e){i.editor.runAsync((function(e){e.addUndoSnapshot((function(){}),o.ChangeSource.Drop)}))},this.onFocus=function(){var e=i.state.tableSelectionRange||{},t=e.table,n=e.coordinates;t&&n?i.editor.select(t,n):i.editor.select(i.state.selectionRange),i.state.selectionRange=null},this.onKeyDownDocument=function(e){e.which!=o.Keys.TAB||e.defaultPrevented||i.cacheSelection()},this.onMouseDownDocument=function(e){i.state.selectionRange||i.editor.contains(e.target)||i.cacheSelection()},this.cacheSelection=function(){i.state.selectionRange||(i.state.selectionRange=i.editor.getSelectionRange(!1))},this.onScroll=function(e){i.editor.triggerPluginEvent(o.PluginEventType.Scroll,{rawEvent:e,scrollContainer:i.state.scrollContainer})},this.onKeyboardEvent=function(e){(0,r.isCharacterValue)(e)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t=[],n=i.editor.getContentSearcherOfCursor(),a=null==n?void 0:n.getInlineElementBefore(),l=e.target;2!=e.button&&(l=null==a?void 0:a.getContainerNode()),i.state.contextMenuProviders.forEach((function(e){var n=e.getContextMenuItems(l);(null==n?void 0:n.length)>0&&(t.length>0&&t.push(null),(0,r.arrayPush)(t,n))})),i.editor.triggerPluginEvent(o.PluginEventType.ContextMenu,{rawEvent:e,items:t})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(a))||[],tableSelectionRange:null}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n,i,a,l=this;this.editor=e;var s=this.editor.getDocument(),u=((t={keypress:this.getEventHandler(o.PluginEventType.KeyPress),keydown:this.getEventHandler(o.PluginEventType.KeyDown),keyup:this.getEventHandler(o.PluginEventType.KeyUp),mousedown:o.PluginEventType.MouseDown,contextmenu:this.onContextMenuEvent,compositionstart:function(){return l.state.isInIME=!0},compositionend:function(t){l.state.isInIME=!1,e.triggerPluginEvent(o.PluginEventType.CompositionEnd,{rawEvent:t})},drop:this.onDrop,focus:this.onFocus})[r.Browser.isIE?"textinput":"input"]=this.getEventHandler(o.PluginEventType.Input),t);r.Browser.isSafari?(s.addEventListener("mousedown",this.onMouseDownDocument,!0),s.addEventListener("keydown",this.onKeyDownDocument),null===(n=s.defaultView)||void 0===n||n.addEventListener("blur",this.cacheSelection)):u[r.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.cacheSelection,this.disposer=e.addDomEventHandler(u),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(i=s.defaultView)||void 0===i||i.addEventListener("scroll",this.onScroll),null===(a=s.defaultView)||void 0===a||a.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,n,o=this.editor.getDocument();r.Browser.isSafari&&(o.removeEventListener("mousedown",this.onMouseDownDocument,!0),o.removeEventListener("keydown",this.onKeyDownDocument),null===(e=o.defaultView)||void 0===e||e.removeEventListener("blur",this.cacheSelection)),null===(t=o.defaultView)||void 0===t||t.removeEventListener("resize",this.onScroll),null===(n=o.defaultView)||void 0===n||n.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:e==o.PluginEventType.Input?this.onInputEvent:this.onKeyboardEvent}:e},e}();function a(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=function(){function e(){this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,i=!1;if(e.eventType==o.PluginEventType.KeyDown){var a=e.rawEvent,l=this.editor.getSelectionRange();n=(i=(0,r.isCtrlOrMetaPressed)(a))||a.altKey,t=this.state.features[a.which]||l&&!l.collapsed&&this.state.features[o.Keys.RANGE]}else e.eventType==o.PluginEventType.ContentChanged&&(t=this.state.features[o.Keys.CONTENTCHANGED]);for(var s=0;s<(null==t?void 0:t.length);s++){var u=t[s];if((u.allowFunctionKeys||!n)&&u.shouldHandleEvent(e,this.editor,i)){u.handleEvent(e,this.editor);break}}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=/_(\d{1,8})$/,a=["^"+o.EntityClasses.ENTITY_INFO_NAME+"$","^"+o.EntityClasses.ENTITY_ID_PREFIX,"^"+o.EntityClasses.ENTITY_TYPE_PREFIX,"^"+o.EntityClasses.ENTITY_READONLY_PREFIX],l=[o.EntityOperation.Overwrite,o.EntityOperation.PartialOverwrite,o.EntityOperation.RemoveFromStart,o.EntityOperation.RemoveFromEnd],s=function(){function e(){var e=this;this.handleCutEvent=function(t){var n=e.editor.getSelectionRange();n&&!n.collapsed&&e.checkRemoveEntityForRange(t)},this.state={knownEntityElements:[],shadowEntityCache:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.willHandleEventExclusively=function(e){var t;return e.eventType==o.PluginEventType.KeyPress&&!!(null===(t=e.rawEvent.target)||void 0===t?void 0:t.shadowRoot)},e.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[]},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case o.PluginEventType.MouseUp:this.handleMouseUpEvent(e);break;case o.PluginEventType.KeyDown:this.handleKeyDownEvent(e.rawEvent);break;case o.PluginEventType.BeforeCutCopy:e.isCut&&this.handleCutEvent(e.rawEvent);break;case o.PluginEventType.BeforePaste:this.handleBeforePasteEvent(e.sanitizingOption);break;case o.PluginEventType.ContentChanged:this.handleContentChangedEvent(e);break;case o.PluginEventType.EditorReady:this.handleContentChangedEvent();break;case o.PluginEventType.ExtractContentWithDom:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case o.PluginEventType.ContextMenu:this.handleContextMenuEvent(e.rawEvent);break;case o.PluginEventType.BeforeSetContent:this.handleBeforeSetContentEvent();break;case o.PluginEventType.EntityOperation:this.handleEntityOperationEvent(e)}},e.prototype.handleContextMenuEvent=function(e){var t=e.target,n=t&&this.editor.getElementAtCursor((0,r.getEntitySelector)(),t);n&&(e.preventDefault(),this.triggerEvent(n,o.EntityOperation.ContextMenu,e))},e.prototype.handleMouseUpEvent=function(e){var t,n=e.rawEvent,i=e.isClicking,a=n.target;i&&a&&(t=this.editor.getElementAtCursor((0,r.getEntitySelector)(),a))&&(this.triggerEvent(t,o.EntityOperation.Click,n),u(this.editor))},e.prototype.handleKeyDownEvent=function(e){if((0,r.isCharacterValue)(e)||e.which==o.Keys.BACKSPACE||e.which==o.Keys.DELETE||e.which==o.Keys.ENTER){var t=this.editor.getSelectionRange();t&&!t.collapsed&&this.checkRemoveEntityForRange(e)}},e.prototype.handleBeforePasteEvent=function(e){this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null),(0,r.arrayPush)(e.additionalAllowedCssClasses,a)},e.prototype.handleBeforeSetContentEvent=function(){this.cacheShadowEntities(this.state.shadowEntityCache)},e.prototype.handleContentChangedEvent=function(e){for(var t=this,n=this.state.knownEntityElements.length-1;n>=0;n--){var i=this.state.knownEntityElements[n];this.editor.contains(i)||(this.setIsEntityKnown(i,!1),i.shadowRoot&&this.triggerEvent(i,o.EntityOperation.RemoveShadowRoot))}var a=this.state.knownEntityElements.map((function(e){var t;return null===(t=(0,r.getEntityFromElement)(e))||void 0===t?void 0:t.id})).filter((function(e){return!!e}));((null==e?void 0:e.source)==o.ChangeSource.InsertEntity&&e.data?[e.data]:this.getExistingEntities().filter((function(e){var n=e.wrapper;return!t.isEntityKnown(n)}))).forEach((function(e){var n=e.wrapper,o=e.type,i=e.id,l=e.isReadonly;e.id=t.ensureUniqueId(o,i,a),(0,r.commitEntity)(n,o,l,e.id),t.handleNewEntity(e)})),Object.keys(this.state.shadowEntityCache).forEach((function(e){t.triggerEvent(t.state.shadowEntityCache[e],o.EntityOperation.Overwrite),delete t.state.shadowEntityCache[e]}))},e.prototype.handleEntityOperationEvent=function(e){var t,n=this;l.indexOf(e.operation)>=0&&(null===(t=this.cancelAsyncRun)||void 0===t||t.call(this),this.cancelAsyncRun=this.editor.runAsync((function(){n.cancelAsyncRun=null,n.handleContentChangedEvent()})))},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;(0,r.toArray)(e.querySelectorAll((0,r.getEntitySelector)())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,o.EntityOperation.ReplaceTemporaryContent)}))},e.prototype.checkRemoveEntityForRange=function(e){var t=this,n=[],i=(0,r.getEntitySelector)();if(this.editor.queryElements(i,o.QueryScope.OnSelection,(function(r){r.isContentEditable?n.push(r):t.triggerEvent(r,o.EntityOperation.Overwrite,e)})),n.length>0){var a=this.editor.queryElements(i,o.QueryScope.InSelection);n.forEach((function(n){var r=a.indexOf(n)>=0;t.triggerEvent(n,r?o.EntityOperation.Overwrite:o.EntityOperation.PartialOverwrite,e)}))}},e.prototype.triggerEvent=function(e,t,n,i){var a=e&&(0,r.getEntityFromElement)(e);a&&this.editor.triggerPluginEvent(o.PluginEventType.EntityOperation,{operation:t,rawEvent:n,entity:a,contentForShadowEntity:i})},e.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.editor.getDocument().createDocumentFragment(),i=this.state.shadowEntityCache[e.id];if(delete this.state.shadowEntityCache[e.id],(null==i?void 0:i.shadowRoot)&&(0,r.moveChildNodes)(n,i.shadowRoot),this.triggerEvent(t,o.EntityOperation.NewEntity,void 0,n),n.firstChild)t.shadowRoot?(0,r.moveChildNodes)(t.shadowRoot,n):this.createShadowRoot(t,n);else if(t.shadowRoot){this.triggerEvent(t,o.EntityOperation.RemoveShadowRoot);var a=t.cloneNode();(0,r.moveChildNodes)(a,t),this.editor.replaceNode(t,a),e.wrapper=a}this.setIsEntityKnown(e.wrapper,!0)},e.prototype.getExistingEntities=function(e){return this.editor.queryElements((0,r.getEntitySelector)()).map(r.getEntityFromElement).filter((function(t){return!(!t||e&&!t.wrapper.shadowRoot)}))},e.prototype.createShadowRoot=function(e,t){if(e.attachShadow){var n=e.attachShadow({mode:"open",delegatesFocus:!0});return e.contentEditable="false",this.triggerEvent(e,o.EntityOperation.AddShadowRoot),(0,r.moveChildNodes)(n,t),n}},e.prototype.cacheShadowEntities=function(e){this.getExistingEntities(!0).forEach((function(t){var n=t.wrapper,r=t.id;e[r]=n}))},e.prototype.ensureUniqueId=function(e,t,n){for(var r=i.exec(t),o=(r?t.substr(0,t.length-r[0].length):t)||e,a="",l=r&&parseInt(r[1])||0;;l++)if(a=l>0?o+"_"+l:o,n.indexOf(a)<0){n.push(a);break}return a},e.prototype.setIsEntityKnown=function(e,t){var n=this.state.knownEntityElements.indexOf(e);t&&n<0?this.state.knownEntityElements.push(e):!t&&n>=0&&this.state.knownEntityElements.splice(n,1)},e.prototype.isEntityKnown=function(e){return this.state.knownEntityElements.indexOf(e)>=0},e}();t.default=s;var u=r.Browser.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=(0,r.createElement)({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},e.getDocument());return t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:o.ContentPosition.Outside}),t}));t.style.display="",(0,r.addRangeToSelection)((0,r.createRange)(t,0))}))}:function(){}},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var i=n(1),a=n(0),l=i.Browser.isFirefox?((r={})[a.DocumentCommand.EnableObjectResizing]=!1,r[a.DocumentCommand.EnableInlineTableEditing]=!1,r):i.Browser.isIE?((o={})[a.DocumentCommand.DefaultParagraphSeparator]="div",o[a.DocumentCommand.AutoUrlDetect]=!1,o):{},s={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},u={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},c=function(){function e(e,t){var n=this;this.initialContent=e.initialContent||t.innerHTML||"",this.contentDivFormat=(0,i.getComputedStyles)(t),null===t.getAttribute("contenteditable")&&(this.initializer=function(){t.contentEditable="true",t.style.userSelect="text",t.style.webkitUserSelect="text"},this.disposer=function(){t.style.userSelect="",t.style.webkitUserSelect="",t.removeAttribute("contenteditable")}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e=u,r=s,o=n.state.isDarkMode;(0,i.setColor)(t,e,!1,o),(0,i.setColor)(t,r,!0,o)},this.state={customData:{},defaultFormat:e.defaultFormat||null,isDarkMode:!!e.inDarkMode,getDarkColor:e.getDarkColor||function(e){return e},onExternalContentTransform:e.onExternalContentTransform,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditSelectionPath:null,shadowEditTableSelectionPath:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(a.PluginEventType.EditorReady,{},!0)},e.prototype.dispose=function(){var e=this;this.editor.triggerPluginEvent(a.PluginEventType.BeforeDispose,{},!0),Object.keys(this.state.customData).forEach((function(t){var n=e.state.customData[t];n&&n.disposer&&n.disposer(n.value),delete e.state.customData[t]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){e.eventType!=a.PluginEventType.ContentChanged||e.source!=a.ChangeSource.SwitchToDarkMode&&e.source!=a.ChangeSource.SwitchToLightMode||(this.state.isDarkMode=e.source==a.ChangeSource.SwitchToDarkMode,this.recalculateDefaultFormat(),this.adjustColor())},e.prototype.adjustBrowserBehavior=function(){var e=this;Object.keys(l).forEach((function(t){try{e.editor.getDocument().execCommand(t,!1,l[t])}catch(e){}}))},e.prototype.recalculateDefaultFormat=function(){var e=this.state,t=e.defaultFormat,n=e.isDarkMode;if(n&&t&&(t.backgroundColors||(t.backgroundColors=s),t.textColors||(t.textColors=u)),!t||0!==Object.keys(t).length){var r=t||{},o=r.fontFamily,i=r.fontSize,a=r.textColor,l=r.textColors,c=r.backgroundColor,d=r.backgroundColors,f=r.bold,h=r.italic,p=r.underline,g=this.contentDivFormat;this.state.defaultFormat={fontFamily:o||g[0],fontSize:i||g[1],get textColor(){return l?n?l.darkModeColor:l.lightModeColor:a||g[2]},textColors:l,get backgroundColor(){return d?n?d.darkModeColor:d.lightModeColor:c||""},backgroundColors:d,bold:f,italic:h,underline:p}}},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(r.PluginEventType.MouseUp,{rawEvent:t,isClicking:e.mouseDownX==t.pageX&&e.mouseDownY==t.pageY}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){e.eventType!=r.PluginEventType.MouseDown||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=function(){function e(){}return e.prototype.getName=function(){return"NormalizeTable"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case o.PluginEventType.EditorReady:case o.PluginEventType.ContentChanged:this.normalizeTables(this.editor.queryElements("table"));break;case o.PluginEventType.BeforePaste:this.normalizeTables((0,r.toArray)(e.fragment.querySelectorAll("table")));break;case o.PluginEventType.MouseDown:this.normalizeTableFromEvent(e.rawEvent);break;case o.PluginEventType.KeyDown:e.rawEvent.shiftKey&&this.normalizeTableFromEvent(e.rawEvent)}},e.prototype.normalizeTableFromEvent=function(e){var t=this.editor.getElementAtCursor("table",e.target);t&&this.normalizeTables([t])},e.prototype.normalizeTables=function(e){if(e.length>0){var t=this.editor.getSelectionRangeEx(),n=(null==t?void 0:t.type)==o.SelectionRangeTypes.Normal&&t.ranges[0]||{},i=n.startContainer,a=n.endContainer,l=n.startOffset,s=n.endOffset;(function(e){var t=!1;return e.forEach((function(e){for(var n=null,o=e.firstChild;o;o=o.nextSibling){switch((0,r.getTagOfNode)(o)){case"TR":n||(n=e.ownerDocument.createElement("tbody"),e.insertBefore(n,o)),n.appendChild(o),o=n,t=!0;break;case"TBODY":n?((0,r.moveChildNodes)(n,o,!0),o.parentNode.removeChild(o),o=n,t=!0):n=o;break;case"COLGROUP":e.tHead&&e.tHead.prepend(o);break;default:n=null}}})),t})(e)&&(i&&a?this.editor.select(i,l,a,s):(null==t?void 0:t.type)==o.SelectionRangeTypes.TableSelection&&this.editor.select(t.table,t.coordinates))}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=function(){function e(){this.state={pendableFormatPosition:null,pendableFormatState:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case o.PluginEventType.PendingFormatStateChanged:this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState;break;case o.PluginEventType.KeyDown:case o.PluginEventType.MouseDown:case o.PluginEventType.ContentChanged:this.state.pendableFormatPosition&&!this.state.pendableFormatPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&r.Position.getStart(e).normalize()},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1),i=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(e.eventType==r.PluginEventType.KeyPress){var t=this.editor.getSelectionRange();if(!t||this.editor.contains((0,o.findClosestElementAncestor)(t.startContainer,null,"[style]")))return;t.collapsed?this.editor.ensureTypeInContainer(o.Position.getStart(t),e.rawEvent):this.editor.runAsync((function(t){t.ensureTypeInContainer(t.getFocusedPosition(),e.rawEvent)}))}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1),i=function(){function e(e){var t,n;this.state={snapshotsService:e.undoMetadataSnapshotService||(n=e.undoSnapshotService,n?{canMove:function(e){return n.canMove(e)},move:function(e){return{html:n.move(e),metadata:null}},addSnapshot:function(e,t){return n.addSnapshot(e.html+(e.metadata?"\x3c!--"+JSON.stringify(e.metadata)+"--\x3e":""),t)},clearRedo:function(){return n.clearRedo()},canUndoAutoComplete:function(){return n.canUndoAutoComplete()}}:void 0)||(t=(0,o.createSnapshots)(1e7),{canMove:function(e){return(0,o.canMoveCurrentSnapshot)(t,e)},move:function(e){return(0,o.moveCurrentSnapshot)(t,e)},addSnapshot:function(e,n){return(0,o.addSnapshotV2)(t,e,n)},clearRedo:function(){return(0,o.clearProceedingSnapshotsV2)(t)},canUndoAutoComplete:function(){return(0,o.canUndoAutoComplete)(t)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return e.eventType==r.PluginEventType.KeyDown&&e.rawEvent.which==r.Keys.BACKSPACE&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case r.PluginEventType.EditorReady:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case r.PluginEventType.KeyDown:this.onKeyDown(e.rawEvent);break;case r.PluginEventType.KeyPress:this.onKeyPress(e.rawEvent);break;case r.PluginEventType.CompositionEnd:this.clearRedoForInput(),this.addUndoSnapshot();break;case r.PluginEventType.ContentChanged:this.state.isRestoring||e.source==r.ChangeSource.SwitchToDarkMode||e.source==r.ChangeSource.SwitchToLightMode||this.clearRedoForInput()}},e.prototype.onKeyDown=function(e){if(e.which==r.Keys.BACKSPACE||e.which==r.Keys.DELETE)if(e.which==r.Keys.BACKSPACE&&this.canUndoAutoComplete())e.preventDefault(),this.editor.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else{var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!(0,o.isCtrlOrMetaPressed)(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=r.Keys.PAGEUP&&e.which<=r.Keys.DOWN&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||e.which==r.Keys.SPACE&&this.lastKeyPress!=r.Keys.SPACE||e.which==r.Keys.ENTER?(this.addUndoSnapshot(),e.which==r.Keys.ENTER&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e;return this.state.snapshotsService.canUndoAutoComplete()&&(null===(e=this.state.autoCompletePosition)||void 0===e?void 0:e.equalTo(this.editor.getFocusedPosition()))},e.prototype.addUndoSnapshot=function(){this.editor.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(205);t.default=function(e){try{var t=r(e||void 0),n=t.lab().array(),o=.78753*(100-n[0])+21.247;e=r.lab(o,n[1],n[2]).rgb().alpha(t.alpha()).toString()}catch(e){}return e}},function(e,t,n){"use strict";var r=n(206),o=n(209),i=[].slice,a=["keyword","gray","hex"],l={};Object.keys(o).forEach((function(e){l[i.call(o[e].labels).sort().join("")]=e}));var s={};function u(e,t){if(!(this instanceof u))return new u(e,t);if(t&&t in a&&(t=null),t&&!(t in o))throw new Error("Unknown model: "+t);var n,c;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof u)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var d=r.get(e);if(null===d)throw new Error("Unable to parse color from string: "+e);this.model=d.model,c=o[this.model].channels,this.color=d.value.slice(0,c),this.valpha="number"==typeof d.value[c]?d.value[c]:1}else if(e.length){this.model=t||"rgb",c=o[this.model].channels;var f=i.call(e,0,c);this.color=h(f,c),this.valpha="number"==typeof e[c]?e[c]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var p=Object.keys(e);"alpha"in e&&(p.splice(p.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var g=p.sort().join("");if(!(g in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[g];var v=o[this.model].labels,y=[];for(n=0;n<v.length;n++)y.push(e[v[n]]);this.color=h(y)}if(s[this.model])for(c=o[this.model].channels,n=0;n<c;n++){var m=s[this.model][n];m&&(this.color[n]=m(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function c(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(s[e]||(s[e]=[]))[t]=n})),e=e[0],function(r){var o;return arguments.length?(n&&(r=n(r)),(o=this[e]()).color[t]=r,o):(o=this[e]().color[t],n&&(o=n(o)),o)}}function d(e){return function(t){return Math.max(0,Math.min(e,t))}}function f(e){return Array.isArray(e)?e:[e]}function h(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}u.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in r.to?this:this.rgb(),n=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return r.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return r.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=o[this.model].channels,n=o[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new u(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new u(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:c("rgb",0,d(255)),green:c("rgb",1,d(255)),blue:c("rgb",2,d(255)),hue:c(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:c("hsl",1,d(100)),lightness:c("hsl",2,d(100)),saturationv:c("hsv",1,d(100)),value:c("hsv",2,d(100)),chroma:c("hcg",1,d(100)),gray:c("hcg",2,d(100)),white:c("hwb",1,d(100)),wblack:c("hwb",2,d(100)),cyan:c("cmyk",0,d(100)),magenta:c("cmyk",1,d(100)),yellow:c("cmyk",2,d(100)),black:c("cmyk",3,d(100)),x:c("xyz",0,d(100)),y:c("xyz",1,d(100)),z:c("xyz",2,d(100)),l:c("lab",0,d(100)),a:c("lab",1),b:c("lab",2),keyword:function(e){return arguments.length?new u(e):o[this.model].keyword(this.color)},hex:function(e){return arguments.length?new u(e):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return u.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),r=this.rgb(),o=void 0===t?.5:t,i=2*o-1,a=n.alpha()-r.alpha(),l=((i*a==-1?i:(i+a)/(1+i*a))+1)/2,s=1-l;return u.rgb(l*n.red()+s*r.red(),l*n.green()+s*r.green(),l*n.blue()+s*r.blue(),n.alpha()*o+r.alpha()*(1-o))}},Object.keys(o).forEach((function(e){if(-1===a.indexOf(e)){var t=o[e].channels;u.prototype[e]=function(){if(this.model===e)return new u(this);if(arguments.length)return new u(arguments,e);var n="number"==typeof arguments[t]?t:this.valpha;return new u(f(o[this.model][e].raw(this.color)).concat(n),e)},u[e]=function(n){return"number"==typeof n&&(n=h(i.call(arguments),t)),new u(n,e)}}})),e.exports=u},function(e,t,n){var r=n(84),o=n(207),i=Object.hasOwnProperty,a=Object.create(null);for(var l in r)i.call(r,l)&&(a[r[l]]=l);var s=e.exports={to:{},get:{}};function u(e,t,n){return Math.min(Math.max(t,e),n)}function c(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}s.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=s.get.hsl(e),n="hsl";break;case"hwb":t=s.get.hwb(e),n="hwb";break;default:t=s.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},s.get.rgb=function(e){if(!e)return null;var t,n,o,a=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=t[2],t=t[1],n=0;n<3;n++){var l=2*n;a[n]=parseInt(t.slice(l,l+2),16)}o&&(a[3]=parseInt(o,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(o=(t=t[1])[3],n=0;n<3;n++)a[n]=parseInt(t[n]+t[n],16);o&&(a[3]=parseInt(o+o,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(n=0;n<3;n++)a[n]=parseInt(t[n+1],0);t[4]&&(t[5]?a[3]=.01*parseFloat(t[4]):a[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:i.call(r,t[1])?((a=r[t[1]])[3]=1,a):null:null;for(n=0;n<3;n++)a[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(t[5]?a[3]=.01*parseFloat(t[4]):a[3]=parseFloat(t[4]))}for(n=0;n<3;n++)a[n]=u(a[n],0,255);return a[3]=u(a[3],0,1),a},s.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(n)?1:n,0,1)]}return null},s.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,u(parseFloat(t[2]),0,100),u(parseFloat(t[3]),0,100),u(isNaN(n)?1:n,0,1)]}return null},s.to.hex=function(){var e=o(arguments);return"#"+c(e[0])+c(e[1])+c(e[2])+(e[3]<1?c(Math.round(255*e[3])):"")},s.to.rgb=function(){var e=o(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},s.to.rgb.percent=function(){var e=o(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},s.to.hsl=function(){var e=o(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},s.to.hwb=function(){var e=o(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},s.to.keyword=function(e){return a[e.slice(0,3)]}},function(e,t,n){"use strict";var r=n(208),o=Array.prototype.concat,i=Array.prototype.slice,a=e.exports=function(e){for(var t=[],n=0,a=e.length;n<a;n++){var l=e[n];r(l)?t=o.call(t,i.call(l)):t.push(l)}return t};a.wrap=function(e){return function(){return e(a(arguments))}}},function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},function(e,t,n){var r=n(85),o=n(210),i={};Object.keys(r).forEach((function(e){i[e]={},Object.defineProperty(i[e],"channels",{value:r[e].channels}),Object.defineProperty(i[e],"labels",{value:r[e].labels});var t=o(e);Object.keys(t).forEach((function(n){var r=t[n];i[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,o=0;o<r;o++)n[o]=Math.round(n[o]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(r),i[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=i},function(e,t,n){var r=n(85);function o(e){var t=function(){for(var e={},t=Object.keys(r),n=t.length,o=0;o<n;o++)e[t[o]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var o=n.pop(),i=Object.keys(r[o]),a=i.length,l=0;l<a;l++){var s=i[l],u=t[s];-1===u.distance&&(u.distance=t[o].distance+1,u.parent=o,n.unshift(s))}return t}function i(e,t){return function(n){return t(e(n))}}function a(e,t){for(var n=[t[e].parent,e],o=r[t[e].parent][e],a=t[e].parent;t[a].parent;)n.unshift(t[a].parent),o=i(r[t[a].parent][a],o),a=t[a].parent;return o.conversion=n,o}e.exports=function(e){for(var t=o(e),n={},r=Object.keys(t),i=r.length,l=0;l<i;l++){var s=r[l];null!==t[s].parent&&(n[s]=a(s,t))}return n}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(212),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAllFeatures=t.ContentEdit=void 0;var r=n(213);Object.defineProperty(t,"ContentEdit",{enumerable:!0,get:function(){return r.default}});var o=n(87);Object.defineProperty(t,"getAllFeatures",{enumerable:!0,get:function(){return o.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(87),o=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this,n=[],o=(0,r.default)();Object.keys(o).forEach((function(e){var r=o[e],i=t.settingsOverride&&void 0!==t.settingsOverride[e];(i&&t.settingsOverride[e]||!i&&!r.defaultDisabled)&&n.push(r)})),n.concat(this.additionalFeatures||[]).forEach((function(t){return e.addContentEditFeature(t)}))},e.prototype.dispose=function(){},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoLinkFeatures=void 0;var r=n(7),o=n(0),i=n(1),a=/[.+=\s:;"',>]+$/i,l={keys:[o.Keys.ENTER,o.Keys.SPACE,o.Keys.CONTENTCHANGED],shouldHandleEvent:u,handleEvent:function(e,t){var n=t.getDocument().createElement("a"),a=u(e,t),l=t.getContentSearcherOfCursor();n.textContent=a.originalUrl,n.href=a.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return(0,r.replaceWithNode)(t,a.originalUrl,n,!1,l),(0,i.clearEventDataCache)(e),n}),o.ChangeSource.AutoLink,!0)}))}},s={keys:[o.Keys.BACKSPACE],shouldHandleEvent:function(e,t){return t.getContentSearcherOfCursor(e).getInlineElementBefore()instanceof i.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),(0,r.removeLink)(t)},defaultDisabled:!0};function u(e,t){return e.eventType==o.PluginEventType.KeyDown||e.eventType==o.PluginEventType.ContentChanged&&e.source==o.ChangeSource.Paste?(0,i.cacheGetEventData)(e,"LINK_DATA",(function(){var n=e.eventType==o.PluginEventType.ContentChanged&&e.source==o.ChangeSource.Paste&&e.data,r=(0,i.matchLink)((n.text||"").trim()),l=t.getContentSearcherOfCursor(e);if(r&&l.getRangeFromText(r.originalUrl,!1))return r;var s=l&&l.getWordBefore();if(s&&s.length>5){var u=(s.match(a)||[])[0]||"",c=s.substring(0,s.length-u.length);return["()","{}","[]"].forEach((function(e){c[c.length-1]==e[1]&&c.indexOf(e[0])<0&&(c=c.substr(0,c.length-1))})),(0,i.matchLink)(c)}return null})):null}t.AutoLinkFeatures={autoLink:l,unlinkWhenBackspaceAfterLink:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewFontSize=t.FONT_SIZES=void 0;var r=n(36),o=n(0),i=n(1);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];function a(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;o>=0;o--)if(e>n[o]){e=n[o];break}return e}t.default=function(e,n,l){void 0===l&&(l=t.FONT_SIZES);var s=n==o.FontSizeChange.Increase?1:-1;(0,r.default)(e,(function(e){var t=parseFloat((0,i.getComputedStyle)(e,"font-size"));e.style.fontSize=a(t,s,l)+"pt","normal"!=(0,i.getComputedStyle)(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),o=n(0);t.default=function(e){(0,r.default)(e,o.ClearFormatMode.Block)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1),i=/^[a-zA-Z]+:/i,a=/^[\w.%+-]+@/i,l=/^ftp\./i;function s(e){return e.queryElements("a[href]",r.QueryScope.OnSelection)[0]}function u(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,c){e.focus();var d=(function(e){var t=new o.HtmlSanitizer,n=document.createElement("a");return n.href=e||"",t.sanitize(n),n.getAttribute("href")}(t)||"").trim();if(d){var f=(0,o.matchLink)(d),h=f?f.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(i)<0&&(t=0==e.search(a)?"mailto:":0==e.search(l)?"ftp://":"http://"),t+e}(d),p=f?f.originalUrl:d;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),o=null;if(t&&t.collapsed)(o=s(e))?(o.href=h,u(o,c)):((o=e.getDocument().createElement("A")).textContent=c||p,o.href=h,e.insertNode(o));else{e.getDocument().execCommand(r.DocumentCommand.CreateLink,!1,h);for(var i=e.getSelectionTraverser(),a=i.getNextInlineElement();a;){var l=a.getContainerNode();l.parentElement.removeChild(l),a=i.getNextInlineElement()}u(o=s(e),c)}return n&&o&&(o.title=n),o}),r.ChangeSource.CreateLink)}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getElementBasedFormatState=void 0;var o=n(1),i=n(0);function a(e,t){var n=(0,o.getTagOfNode)(e.getElementAtCursor("OL,UL",null,t)),r=(0,o.getTagOfNode)(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:r&&parseInt(r[1])||0,canUnlink:!!e.queryElements("a[href]",i.QueryScope.OnSelection)[0],canAddImageAltText:!!e.queryElements("img",i.QueryScope.OnSelection)[0],isBlockQuote:!!e.queryElements("blockquote",i.QueryScope.OnSelection)[0],isInTable:!!e.queryElements("table",i.QueryScope.OnSelection)[0]}}t.getElementBasedFormatState=a,t.default=function(e,t){return r(r(r(r(r({},e.getPendableFormatState(!1)),a(e,t)),e.getStyleBasedFormatState()),e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0);t.default=function(e,t,n,i,a,l){var s=(0,r.wrap)(n,i?"DIV":"SPAN");if(!i&&a&&(s.style.display="inline-block"),(0,r.commitEntity)(s,t,a),!e.contains(s)){var u=void 0,c=void 0;if("number"==typeof l)c=l;else if(l){u=e.getSelectionRange();var d=l.normalize().node,f=d&&e.getElementAtCursor((0,r.getEntitySelector)(),d);f&&(l=new r.Position(f,o.PositionType.After)),e.select(l),c=o.ContentPosition.SelectionStart}else e.focus(),c=o.ContentPosition.SelectionStart;e.insertNode(s,{updateCursor:!1,insertOnNewLine:i,replaceSelection:!0,position:c}),c==o.ContentPosition.SelectionStart&&(u?e.select(u):i||e.select(s,o.PositionType.After))}if(i){var h=e.getDocument().createElement("BR");s.parentNode.insertBefore(h,s.nextSibling)}var p=(0,r.getEntityFromElement)(s);return e.triggerContentChangedEvent(o.ChangeSource.InsertEntity,p),p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);function i(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),r.ChangeSource.Format)}t.default=function(e,t){"string"==typeof t?i(e,t):(0,o.readFile)(t,(function(t){t&&!e.isDisposed()&&i(e,t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);function i(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,a){var l=e.getDocument(),s=l.createDocumentFragment(),u=l.createElement("table");s.appendChild(u),u.cellSpacing="0",u.cellPadding="1";for(var c=0;c<n;c++){var d=l.createElement("tr");u.appendChild(d);for(var f=0;f<t;f++){var h=l.createElement("td");d.appendChild(h),h.appendChild(l.createElement("br")),h.style.width=i(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new o.VTable(u);t.applyFormat(a),t.writeBack(),e.insertNode(s),e.runAsync((function(e){return e.select(new o.Position(u,r.PositionType.Begin).normalize())}))}),r.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(){var i=new r.VTable(n);!function(e,t){var n=e.getSelectionRangeEx();n&&n.type===o.SelectionRangeTypes.TableSelection&&(t.selection=n.coordinates)}(e,i),i.edit(t),i.writeBack(),e.transformToDarkColor(i.table),e.focus();var a=function(e,t,n){var r=t,i=n;switch(e){case o.TableOperation.InsertAbove:i=0;break;case o.TableOperation.InsertBelow:r+=1,i=0;break;case o.TableOperation.InsertLeft:r=0;break;case o.TableOperation.InsertRight:r=0,i+=1}return{newRow:r,newCol:i}}(t,i.row,i.col);e.select(i.getCell(a.newRow,a.newCol).td,o.PositionType.Begin)}),o.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(r,i){var a=new o.VTable(n);a.applyFormat(t),a.writeBack(),e.transformToDarkColor(a.table),e.focus(),e.select(r,i)}),r.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",r.QueryScope.OnSelection,o.unwrap),e.select(t,n)}),r.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n,o,i){if(!t||!n)return!1;var a;if(a="string"==typeof t?(i=i||e.getContentSearcherOfCursor())&&i.getRangeFromText(t,o):t){var l=e.getSelectionRange();return l.collapsed&&a.endContainer==l.startContainer&&a.endOffset==l.startOffset&&(o=!0),e.insertNode(n,{position:r.ContentPosition.Range,updateCursor:o,replaceSelection:!0,insertOnNewLine:!1,range:a}),!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n){t&&e.addUndoSnapshot((function(){t.style.transform="rotate("+n+"deg)"}),r.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(1),i=n(0);t.default=function(e,t){var n=e.getSelectionRangeEx(),a=n&&n.type===i.SelectionRangeTypes.TableSelection;e.addUndoSnapshot((function(){e.isFeatureEnabled(i.ExperimentalFeatures.TableAlignment)&&a&&(0,o.isWholeTableSelected)(new o.VTable(n.table),n.coordinates)?function(e,t){var n=e.table;t==i.Alignment.Center?(n.style.marginLeft="auto",n.style.marginRight="auto"):t==i.Alignment.Right?(n.style.marginLeft="auto",n.style.marginRight=""):(n.style.marginLeft="",n.style.marginRight="auto")}(n,t):function(e,t){var n="left",o=i.DocumentCommand.JustifyLeft;t==i.Alignment.Center?(o=i.DocumentCommand.JustifyCenter,n="center"):t==i.Alignment.Right&&(o=i.DocumentCommand.JustifyRight,n="right");(0,r.default)(e,o),e.queryElements("[align]",i.QueryScope.OnSelection,(function(e){return e.style.textAlign=n}))}(e,t)}),i.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(229),o=n(0);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,i){(0,r.default)(e,(function(e){e.setAttribute("dir",t==o.Direction.LeftToRight?"ltr":"rtl"),e.style.textAlign=t==o.Direction.LeftToRight?"left":"right"})),e.select(n,i)}),o.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);function i(e){var t=e.getStartNode();return t==e.getEndNode()&&t.nodeType==r.NodeType.Text&&["TR","TABLE"].indexOf((0,o.getTagOfNode)(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),r=n&&n.currentBlockElement,o=[];r;)i(r)||o.push(r),r=n.getNextBlockElement();o.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",r.QueryScope.OnSelection,(function(e){return e.setAttribute("alt",t)}))}),r.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26),o=n(0),i=n(1);function a(e,t){var n=(0,i.collapseNodesInRegion)(e,t);(0,i.wrap)(n,o.KnownCreateElementDataIndex.BlockquoteWrapper)}function l(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=(0,i.findClosestElementAncestor)(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=(0,i.wrap)((0,i.toArray)(n.childNodes)));(0,i.isNodeInRegion)(e,n)&&"BLOCKQUOTE"!=(0,i.getTagOfNode)(n);)n=(0,i.splitBalancedNodeRange)(n);(0,i.isNodeInRegion)(e,n)&&(0,i.unwrap)(n)}}))}function s(e,t){var n;return(null===(n=e.items[0])||void 0===n?void 0:n.getNode())==t&&e.getListItemIndex(t)==(e.getStart()||1)}function u(e,t,n){return e==o.Indentation.Increase||t.getElementAtCursor("blockquote",n)}t.default=function(e,t){var n=t==o.Indentation.Increase?a:l;(0,r.default)(e,(function(r,a,l){for(var c=(0,i.getSelectedBlockElementsInRegion)(r,!0),d=[[]],f=0;f<c.length;f++){var h=c[f].getStartNode(),p=(0,i.createVListFromRegion)(r,!0,h);if(p){for(;c[f+1]&&p.contains(c[f+1].getStartNode());)f++;var g=e.isFeatureEnabled(o.ExperimentalFeatures.TabKeyTextFeatures);if(g&&s(p,h)&&u(t,e,h)){var v=e.getBlockElementAtNode(p.rootList);d.push([v])}else t==o.Indentation.Decrease?p.setIndentation(a,l,t,!1,g):p.setIndentation(a,l,t),p.writeBack(),d.push([])}else d[d.length-1].push(c[f])}d.forEach((function(e){return n(r,e)}))}),(function(){var n=e.getSelectionRangeEx();if(n.type==o.SelectionRangeTypes.TableSelection&&(0,i.isWholeTableSelected)(new i.VTable(n.table),n.coordinates)){if(t==o.Indentation.Decrease){var r=e.getElementAtCursor("blockquote",n.table);(0,i.unwrap)(r)}else t==o.Indentation.Increase&&(0,i.wrap)(n.table,o.KnownCreateElementDataIndex.BlockquoteWrapper);return!1}return!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),o=n(0),i=n(1);t.default=function(e,t,n){function a(e,n){switch(t){case o.Capitalization.Lowercase:return e.toLocaleLowerCase(n);case o.Capitalization.Uppercase:return e.toLocaleUpperCase(n);case o.Capitalization.CapitalizeEachWord:for(var r=e.toLocaleLowerCase(n).split(" "),i=0;i<r.length;i++)r[i]=r[i].charAt(0).toLocaleUpperCase(n)+r[i].slice(1);return r.join(" ");case o.Capitalization.Sentence:var a=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(n).replace(a,(function(e){return e.toLocaleUpperCase(n)}))}}(0,r.default)(e,(function(e){for(var t=(0,i.getFirstLeafNode)(e);t;t=(0,i.getNextLeafSibling)(e,t))if(t.nodeType==o.NodeType.Text)try{t.textContent=a(t.textContent,n)}catch(e){t.textContent=a(t.textContent,void 0)}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(52),o=n(0);t.default=function(e){(0,r.default)(e,o.ListType.Unordered)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(52),o=n(0);t.default=function(e,t){(0,r.default)(e,o.ListType.Ordered,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);t.default=function(e,t,n){void 0===n&&(n=1),e.addUndoSnapshot((function(){e.focus();var r=e.getSelectedRegions();if(r[0]){var i=(0,o.createVListFromRegion)(r[0],!1,t);i&&(i.split(t,n),i.writeBack())}}),r.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=n(0),i=n(1),a=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,i.wrap)(e,"blockquote");(t||a)(n)}),(function(){return 0==e.queryElements("blockquote",o.QueryScope.OnSelection,i.unwrap).length}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=n(0),i=n(1);t.default=function(e,t){(0,r.default)(e,(function(e){var n=(0,i.wrap)(e,"code"),r=(0,i.wrap)(n,"pre");null==t||t(r)}),(function(){return 0==e.queryElements("pre>code",o.QueryScope.OnSelection,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;(0,i.unwrap)(e),(0,i.unwrap)(t)}})).length}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(0);t.default=function(e){(0,r.default)(e,o.DocumentCommand.StrikeThrough)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(0);t.default=function(e){(0,r.default)(e,o.DocumentCommand.Subscript)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(0);t.default=function(e){(0,r.default)(e,o.DocumentCommand.Superscript)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",r.QueryScope.OnSelection,(function(t){n||(e.getDocument().execCommand(r.DocumentCommand.FormatBlock,!1,"<DIV>"),n=!0);var i=e.getDocument().createElement("div");(0,o.moveChildNodes)(i,t),e.replaceNode(t,i)})),t>0){for(var i=e.getSelectionTraverser(),a=i?i.currentBlockElement:null,l=new o.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});a;){var s=a.collapseToSingleElement();l.sanitize(s),a=i.getNextBlockElement()}e.getDocument().execCommand(r.DocumentCommand.FormatBlock,!1,"<H"+t+">")}}),r.ChangeSource.Format)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.getSelectedRegions().forEach((function(n){(0,r.safeInstanceOf)(n.rootNode,"HTMLTableCellElement")&&((0,r.setColor)(n.rootNode,t,!0,e.isDarkMode(),!0),n.rootNode.dataset.cellShade="true",n.rootNode.dataset.originalBackgroundColor=n.rootNode.style.backgroundColor)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CursorFeatures=void 0;var r=n(1),o=n(0),i={keys:[o.Keys.LEFT,o.Keys.RIGHT],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var i,a;if(!(n&&(i=t.getSelectionRange())&&i.collapsed&&(a=r.Position.getStart(i))&&t.isPositionAtBeginning(a)))return!1;var l="rtl"==(0,r.getComputedStyle)(a.element,"direction"),s=e.rawEvent;return!l&&s.which==o.Keys.LEFT||l&&s.which==o.Keys.RIGHT},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!r.Browser.isChrome};t.CursorFeatures={noCycleCursorMove:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EntityFeatures=void 0;var r=n(1),o=n(0),i={keys:[o.Keys.ENTER],shouldHandleEvent:function(e,t){return l(e,t)},handleEvent:function(e,t){l(e,t,o.EntityOperation.Click)}},a={keys:[o.Keys.ESCAPE],shouldHandleEvent:function(e,t){return l(e,t)},handleEvent:function(e,t){l(e,t,o.EntityOperation.Escape)}};function l(e,t,n){var i=(0,r.cacheGetEventData)(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,o=n&&t.getElementAtCursor((0,r.getEntitySelector)(),n);return o&&!o.isContentEditable?o:null}));return i&&void 0!==n&&t.triggerPluginEvent(o.PluginEventType.EntityOperation,{operation:n,rawEvent:e.rawEvent,entity:(0,r.getEntityFromElement)(i)}),i}var s={keys:[o.Keys.ENTER],shouldHandleEvent:function(e,t){return d(e,t,!0,!1)},handleEvent:function(e,t){var n;e.rawEvent.preventDefault();var i=t.getSelectionRange(),a=r.Position.getEnd(i).normalize().node,l=t.getDocument().createElement("BR");a.parentNode.insertBefore(l,a.nextSibling);var s,u=t.getBlockElementAtNode(a);u&&(s=u.collapseToSingleElement(),null===(n=l.parentNode)||void 0===n||n.removeChild(l)),t.getSelectionRange().deleteContents(),s.nextSibling&&t.select(s.nextSibling,o.PositionType.Begin)}},u={keys:[o.Keys.BACKSPACE],shouldHandleEvent:function(e,t){return d(e,t,!1,!0)},handleEvent:function(e,t){d(e,t,!1,!0,o.EntityOperation.RemoveFromEnd)}},c={keys:[o.Keys.DELETE],shouldHandleEvent:function(e,t){return d(e,t,!0,!0)},handleEvent:function(e,t){d(e,t,!0,!0,o.EntityOperation.RemoveFromStart)}};function d(e,t,n,i,a){var l=(0,r.cacheGetEventData)(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+i,(function(){var e=t.getSelectionRange();if(i&&!e.collapsed)return null;e.commonAncestorContainer.normalize();var o=r.Position.getEnd(e).normalize(),a=null;if(0==o.offset||o.isAtEnd){var l=t.getBodyTraverser(o.node),s=n?0==o.offset?l.currentInlineElement:l.getNextInlineElement():o.isAtEnd?l.currentInlineElement:l.getPreviousInlineElement(),u=s&&s.getContainerNode();if(!i){var c=t.getBlockElementAtNode(o.node);c&&c.contains(u)||(u=null)}a=u&&t.getElementAtCursor((0,r.getEntitySelector)(),u)}return a}));return l&&void 0!==a&&t.triggerPluginEvent(o.PluginEventType.EntityOperation,{operation:a,rawEvent:e.rawEvent,entity:(0,r.getEntityFromElement)(l)}),l}t.EntityFeatures={clickOnEntity:i,escapeFromEntity:a,enterBeforeReadonlyEntity:s,backspaceAfterEntity:u,deleteBeforeEntity:c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListFeatures=void 0;var r=n(7),o=n(1),i=n(0),a={keys:[i.Keys.TAB],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&m(e,t)},handleEvent:function(e,t){(0,r.setIndentation)(t,i.Indentation.Increase),e.rawEvent.preventDefault()}},l={keys:[i.Keys.TAB],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&m(e,t)},handleEvent:function(e,t){(0,r.setIndentation)(t,i.Indentation.Decrease),e.rawEvent.preventDefault()}},s={keys:[i.Keys.BACKSPACE],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e),r=t.getSelectionRange();return n&&(null==r?void 0:r.collapsed)&&(0,o.isPositionAtBeginningOf)(o.Position.getStart(r),n)},handleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);n.previousSibling?(0,r.blockFormat)(t,(function(t,r,a){var l=(0,o.createVListFromRegion)(t,!1,n);l.setIndentation(r,a,i.Indentation.Decrease,!0),l.writeBack(),e.rawEvent.preventDefault()})):y(e,t)},defaultDisabled:!0},u={keys:[i.Keys.BACKSPACE],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return n&&(0,o.isNodeEmpty)(n)&&!n.previousSibling},handleEvent:y},c={keys:[i.Keys.DELETE],shouldHandleEvent:function(e,t){if(t.getElementAtCursor("LI",null,e))return!1;var n=o.Position.getEnd(t.getSelectionRange()).isAtEnd?function(e,t){return(0,o.cacheGetEventData)(e,"nextSibling",(function(){var e,n=t.getSelectionRange(),r=o.Position.getEnd(n).normalize(),i=t.getBodyTraverser(r.node);return null===(e=null==i?void 0:i.getNextBlockElement())||void 0===e?void 0:e.getStartNode()}))}(e,t):null;return t.getElementAtCursor("LI",n,e)},handleEvent:function(e,t){var n=g(t);t.runAsync((function(e){return(0,r.experimentCommitListChains)(e,n)}))}},d={keys:[i.Keys.ENTER],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return!e.rawEvent.shiftKey&&n&&(0,o.isNodeEmpty)(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return y(e,t,!1)}),null,!0)},defaultDisabled:!o.Browser.isIE&&!o.Browser.isChrome},f={keys:[i.Keys.SPACE],shouldHandleEvent:function(e,t){if(!m(e,t)){var n=t.getContentSearcherOfCursor(e);return p(n.getSubStringBefore(4))&&!n.getNearestNonTextInlineElement()}return!1},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,o=t.getContentSearcherOfCursor(),i=o.getSubStringBefore(4),a=o.getRangeFromText(i,!0);if(a){if(0==i.indexOf("*")||0==i.indexOf("-"))v(t,a),(0,r.toggleBullet)(t);else if(p(i))v(t,a),(0,r.toggleNumbering)(t);else if((n=t.getSelectedRegions())&&1==n.length){var l=parseInt(i);v(t,a),(0,r.toggleNumbering)(t,l)}}else;null===(e=o.getRangeFromText(i,!0))||void 0===e||e.deleteContents()}),null,!0)}},h={keys:[i.Keys.ENTER,i.Keys.TAB,i.Keys.DELETE,i.Keys.BACKSPACE,i.Keys.RANGE],shouldHandleEvent:function(e,t){return t.queryElements("li",i.QueryScope.OnSelection).length>0},handleEvent:function(e,t){var n=g(t);t.runAsync((function(e){return(0,r.experimentCommitListChains)(e,n)}))}};function p(e){return/^(\*|-|[0-9]{1,2}\.|[0-9]{1,2}\>|[0-9]{1,2}\)|[0-9]{1,2}\-|\([0-9]{1,2}\))$/.test(e)}function g(e){return o.VListChain.createListChains(e.getSelectedRegions())}function v(e,t){var n=e.getBlockElementAtNode(t.startContainer),r=null==n?void 0:n.getEndNode();if(r&&"BR"!=(0,o.getTagOfNode)(r)){var i=e.getDocument().createElement("BR");(0,o.isBlockElement)(r)?r.appendChild(i):r.parentNode.insertBefore(i,r.nextSibling),e.select(t.startContainer,t.startOffset)}}function y(e,t,n){void 0===n&&(n=!0);var a=m(e,t);if(a){var l=a[0],s=(0,o.getTagOfNode)(l);"UL"!=s&&"OL"!=s||(0,r.toggleListType)(t,"UL"==s?i.ListType.Unordered:i.ListType.Ordered,null,n),t.focus(),e.rawEvent.preventDefault()}}function m(e,t){var n=t.getElementAtCursor("LI,TABLE",null,e),r=n&&"LI"==(0,o.getTagOfNode)(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}t.ListFeatures={autoBullet:f,indentWhenTab:a,outdentWhenShiftTab:l,outdentWhenBackspaceOnEmptyFirstLine:u,outdentWhenEnterOnEmptyLine:d,mergeInNewLineWhenBackspaceOnFirstChar:s,maintainListChain:h,maintainListChainWhenDelete:c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MarkdownFeatures=void 0;var r=n(1),o=n(0);function i(e,t,n,r){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===r&&!!a(e,n,t)},handleEvent:function(e,r){r.runAsync((function(r){!function(e,t,n,r){t.addUndoSnapshot((function(){var i=a(e,t,n);if(i){var l=i.cloneRange();l.setStart(l.startContainer,l.startOffset+1),i.setEnd(i.endContainer,i.endOffset+1);var s=t.getDocument().createElement(r);s.appendChild(l.extractContents()),i.deleteContents();var u=t.getDocument().createTextNode("​");i.insertNode(u),i.insertNode(s),t.select(u,o.PositionType.End)}}),o.ChangeSource.Format,!0)}(e,r,t,n)}))}}}function a(e,t,n){return(0,r.cacheGetEventData)(e,"MARKDOWN_RANGE",(function(){var o,i;return t.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){if(i&&o)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===n)return!1;if(i||(i=e.getStartPosition().move(t.length)),t[0]==n)o=e.getStartPosition();else for(var r=t.length-1;r>0;r--){if(o)return!0;if(t[r]==n&&0==t[r-1].trim().length)return o=e.getStartPosition().move(r),!0}})),!!o&&!!i&&(0,r.createRange)(o,i)}))}var l=i(o.Keys.EIGHT_ASTERISK,"*","b",!0),s=i(o.Keys.DASH_UNDERSCORE,"_","i",!0),u=i(o.Keys.GRAVE_TILDE,"~","s",!0),c=i(o.Keys.GRAVE_TILDE,"`","code",!1);t.MarkdownFeatures={markdownBold:l,markdownItalic:s,markdownStrikethru:u,markdownInlineCode:c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuoteFeatures=void 0;var r=n(7),o=n(0),i=n(1),a="BLOCKQUOTE",l=[a,"LI","TD","TH"].join(","),s={keys:[o.Keys.BACKSPACE],shouldHandleEvent:function(e,t){var n=c(e,t);return n&&(0,i.isNodeEmpty)(n)&&!n.previousSibling},handleEvent:d},u={keys:[o.Keys.ENTER],shouldHandleEvent:function(e,t){var n=c(e,t);return!e.rawEvent.shiftKey&&n&&(0,i.isNodeEmpty)(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return d(e,t)}),null,!0)}};function c(e,t){return(0,i.cacheGetEventData)(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(l);if(e&&(0,i.getTagOfNode)(e)==a){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var o=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return(0,i.isNodeEmpty)(o)?o:null}}return null}))}function d(e,t){t.addUndoSnapshot((function(){var n,l,s=c(e,t);(0,i.getTagOfNode)(s)==a&&(s=(0,i.wrap)((0,i.toArray)(s.childNodes))),n=(0,i.splitBalancedNodeRange)(s),l=f(n),(0,i.unwrap)(n),t.select(s,o.PositionType.Begin),l&&(0,r.clearFormat)(t)})),e.rawEvent.preventDefault()}var f=function(e){return!!(e&&(0,i.safeInstanceOf)(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)};t.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:s,unquoteWhenEnterOnEmptyLine:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShortcutFeatures=void 0;var r=n(1),o=n(0),i=n(7);function a(e,t,n){return{winKey:e,macKey:t,action:n}}var l=[a(o.Keys.Ctrl|o.Keys.B,o.Keys.Meta|o.Keys.B,i.toggleBold),a(o.Keys.Ctrl|o.Keys.I,o.Keys.Meta|o.Keys.I,i.toggleItalic),a(o.Keys.Ctrl|o.Keys.U,o.Keys.Meta|o.Keys.U,i.toggleUnderline),a(o.Keys.Ctrl|o.Keys.Z,o.Keys.Meta|o.Keys.Z,(function(e){return e.undo()})),a(o.Keys.Ctrl|o.Keys.Y,o.Keys.Meta|o.Keys.Shift|o.Keys.Z,(function(e){return e.redo()})),a(o.Keys.Ctrl|o.Keys.PERIOD,o.Keys.Meta|o.Keys.PERIOD,i.toggleBullet),a(o.Keys.Ctrl|o.Keys.FORWARD_SLASH,o.Keys.Meta|o.Keys.FORWARD_SLASH,i.toggleNumbering),a(o.Keys.Ctrl|o.Keys.Shift|o.Keys.PERIOD,o.Keys.Meta|o.Keys.Shift|o.Keys.PERIOD,(function(e){return(0,i.changeFontSize)(e,o.FontSizeChange.Increase)})),a(o.Keys.Ctrl|o.Keys.Shift|o.Keys.COMMA,o.Keys.Meta|o.Keys.Shift|o.Keys.COMMA,(function(e){return(0,i.changeFontSize)(e,o.FontSizeChange.Decrease)}))],s={allowFunctionKeys:!0,keys:[o.Keys.B,o.Keys.I,o.Keys.U,o.Keys.Y,o.Keys.Z,o.Keys.COMMA,o.Keys.PERIOD,o.Keys.FORWARD_SLASH],shouldHandleEvent:u,handleEvent:function(e,t){var n=u(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function u(e){return(0,r.cacheGetEventData)(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=e.eventType!=o.PluginEventType.KeyDown||t.altKey?0:t.which|(t.metaKey&&o.Keys.Meta)|(t.shiftKey&&o.Keys.Shift)|(t.ctrlKey&&o.Keys.Ctrl);return n&&l.filter((function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n}))[0]}))}t.ShortcutFeatures={defaultShortcut:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StructuredNodeFeatures=void 0;var r=n(0),o=n(1),i={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},a=Object.keys(i).join(","),l={keys:[r.Keys.ENTER],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e,t),i=(0,o.createElement)(r.KnownCreateElementDataIndex.EmptyLine,t.getDocument());t.addUndoSnapshot((function(){n.parentNode.insertBefore(i,n),"TABLE"==(0,o.getTagOfNode)(n)&&t.select(new o.Position(i,r.PositionType.Begin).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function s(e,t){return(0,o.cacheGetEventData)(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(a);if(n){var r=t.getSelectionRange();if(r&&r.collapsed&&(0,o.isPositionAtBeginningOf)(o.Position.getStart(r),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(i[(0,o.getTagOfNode)(n)])}return null}))}t.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableFeatures=void 0;var r=n(7),o=n(0),i=n(1),a={keys:[o.Keys.TAB],shouldHandleEvent:function(e,t){return u(e,t)&&!c(e,t)},handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,i=d(e,u(e,t)),a=n?-1:1,l=i.row,s=i.col+a;;s+=a){if(s<0||s>=i.cells[l].length){if((l+=a)<0){t.select(i.table,o.PositionType.Before);break}if(l>=i.cells.length){(0,r.editTable)(t,o.TableOperation.InsertBelow);break}s=n?i.cells[l].length-1:0}var c=i.getCell(l,s);if(c.td){t.select(c.td,o.PositionType.Begin);break}}e.rawEvent.preventDefault()}},l={keys:[o.Keys.TAB],shouldHandleEvent:function(e,t){return u(e,t)&&c(e,t)},handleEvent:function(e,t){e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var n=e.rawEvent.shiftKey,i=t.getSelectionRangeEx(),a=u(e,t),l=d(e,a);n&&t.getElementAtCursor("blockquote",l.table,e)?(0,r.setIndentation)(t,o.Indentation.Decrease):n||(0,r.setIndentation)(t,o.Indentation.Increase),t.select(i.table,i.coordinates)}))}},s={keys:[o.Keys.UP,o.Keys.DOWN],shouldHandleEvent:function(e,t){return u(e,t)&&!c(e,t)},handleEvent:function(e,t){var n,r=u(e,t),a=new i.VTable(r),l=e.rawEvent.which==o.Keys.UP,s=l?-1:1,c=e.rawEvent.shiftKey,d=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),f=null;if(d){for(var h=d.anchorNode,p=d.anchorOffset,g=a.row;g>=0&&g<a.cells.length;g+=s){var v=a.getCell(g,a.col);if(v.td&&v.td!=r){f=v.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if((0,i.contains)(a.table,n)&&!(0,i.contains)(r,n,!0)){var s=f?new i.Position(f,o.PositionType.Begin):new i.Position(a.table,l?o.PositionType.Before:o.PositionType.After);if(c){s=s.node.nodeType==o.NodeType.Element&&(0,i.isVoidHtmlElement)(s.node)?new i.Position(s.node,s.isAtEnd?o.PositionType.After:o.PositionType.Before):s;var u=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();null==u||u.setBaseAndExtent(h,p,s.node,s.offset)}else e.select(s)}}))}},defaultDisabled:!i.Browser.isChrome&&!i.Browser.isSafari};function u(e,t){return(0,i.cacheGetEventData)(e,"TABLE_CELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==(0,i.getTagOfNode)(n)?null:n)}))}function c(e,t){return(0,i.cacheGetEventData)(e,"WHOLE_TABLE_SELECTED_FOR_FEATURES",(function(){var n=u(e,t),r=d(e,n),a=t.getSelectionRangeEx();return a.type==o.SelectionRangeTypes.TableSelection&&(0,i.isWholeTableSelected)(r,a.coordinates)}))}function d(e,t){return(0,i.cacheGetEventData)(e,"VTABLE_FOR_TABLE_FEATURES",(function(){return new i.VTable(t)}))}t.TableFeatures={tabInTable:a,upDownInTable:s,indentTableOnTab:l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextFeatures=void 0;var r=n(1),o=n(7),i=n(0),a={keys:[i.Keys.TAB],shouldHandleEvent:function(e,t){return t.isFeatureEnabled(i.ExperimentalFeatures.TabKeyTextFeatures)&&!e.rawEvent.shiftKey&&!t.getElementAtCursor("LI,TABLE",null,e)},handleEvent:function(e,t){var n=t.getSelectionRangeEx();n.type==i.SelectionRangeTypes.Normal&&(t.addUndoSnapshot((function(){if(n.areAllCollapsed)c(t,e);else{var a=n.ranges,l=a[0];if(s(t,l))(0,o.setIndentation)(t,i.Indentation.Increase);else{var u=(0,r.createRange)(l.startContainer,l.startOffset);a.forEach((function(e){return e.deleteContents()})),t.select(u),c(t,e)}}})),e.rawEvent.preventDefault())}},l={keys:[i.Keys.TAB],shouldHandleEvent:function(e,t){if(e.rawEvent.shiftKey&&t.isFeatureEnabled(i.ExperimentalFeatures.TabKeyTextFeatures)){var n=t.getSelectionRangeEx();return n.type==i.SelectionRangeTypes.Normal&&!n.areAllCollapsed&&t.getElementAtCursor("blockquote",null,e)&&!t.getElementAtCursor("LI,TABLE",null,e)&&s(t,n.ranges[0])}return!1},handleEvent:function(e,t){t.addUndoSnapshot((function(){return(0,o.setIndentation)(t,i.Indentation.Decrease)})),e.rawEvent.preventDefault()}};function s(e,t){var n=!1,o=r.Position.getStart(t),a=r.Position.getEnd(t),l=e.getBlockElementAtNode(o.node),s=e.getBlockElementAtNode(a.node);if(l.equals(s)){var c=new r.Position(l.getStartNode(),i.PositionType.Begin),d=new r.Position(l.getEndNode(),i.PositionType.End),f=(0,r.createRange)(c,r.Position.getStart(t)),h=(0,r.createRange)(r.Position.getEnd(t),d);return!n&&u(f)&&u(h)&&(n=!0),n}return!0}function u(e){return""==e.toString()&&0==(0,r.queryElements)(e.commonAncestorContainer,"img,table,ul,ol",null,i.QueryScope.InSelection,e).length}function c(e,t){for(var n,o=e.getDocument().createElement("span"),a=6-e.getContentSearcherOfCursor(t).getSubStringBefore(Number.MAX_SAFE_INTEGER).length%6,l="",s=0;s<a;s++)l+="&ensp;";e.insertNode(o),o.nextElementSibling&&"A"==(0,r.getTagOfNode)(o.nextElementSibling)&&((n=e.getDocument().createElement("span")).textContent=" ",e.insertNode(n),e.select((0,r.createRange)(n,i.PositionType.Before))),e.insertContent(l,{position:i.ContentPosition.Range,range:(0,r.createRange)(o,i.PositionType.Begin),updateCursor:!1}),e.select((0,r.createRange)(o,i.PositionType.After)),n&&e.deleteNode(n)}t.TextFeatures={indentWhenTabText:a,outdentWhenTabText:l}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(253),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContextMenu=void 0;var r=n(254);Object.defineProperty(t,"ContextMenu",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=function(){function e(e){var t=this;this.options=e,this.onDismiss=function(){var e,n;t.container&&t.isMenuShowing&&(null===(n=(e=t.options).dismiss)||void 0===n||n.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.onDismiss(),this.container&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(e.eventType==o.PluginEventType.ContextMenu&&e.items.length>0){var t=e.rawEvent,n=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY),this.options.render(this.container,n,this.onDismiss),this.isMenuShowing=!0}},e.prototype.initContainer=function(e,t){this.container||(this.container=(0,r.createElement)(o.KnownCreateElementDataIndex.ContextMenuWrapper,this.editor.getDocument()),this.editor.getDocument().body.appendChild(this.container)),this.container.style.left=e+"px",this.container.style.top=t+"px"},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(256),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CustomReplace=void 0;var r=n(257);Object.defineProperty(t,"CustomReplace",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e,t,n,r){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:r}},i=[o(":)","🙂",!0),o(";)","😉",!0),o(":O","😲",!0),o(":o","😯",!0),o("<3","❤️",!0)],a=function(){function e(e){void 0===e&&(e=i),this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map((function(e){return e.sourceString.length})))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var o=r[n],i=o.sourceString;if(0!=i.length){var a=i[i.length-1];o.matchSourceCaseSensitive?t.add(a):(t.add(a.toLocaleLowerCase()),t.add(a.toLocaleUpperCase()))}}return t}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(e.eventType==r.PluginEventType.Input&&!this.editor.isInIME()&&(e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange())){var n=this.editor.getContentSearcherOfCursor(e),o=n.getSubStringBefore(this.longestReplacementLength),i=this.getMatchingReplacement(o);if(null!=i&&(!i.shouldReplace||i.shouldReplace(i,n.getWordBefore()))){var a=n.getSubStringBefore(i.sourceString.length),l=n.getRangeFromText(a,!0),s=this.editor.getDocument().createElement("span");s.innerHTML=this.editor.getTrustedHTMLHandler()(i.replacementHTML);var u=1==s.childNodes.length?s.childNodes[0]:s;this.editor.addUndoSnapshot((function(){l.deleteContents(),l.insertNode(u),t.editor.select(u,r.PositionType.End)}),null,!0)}}},e.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.replace(/\s/g," "),n=t.toLocaleLowerCase(),r=0,o=this.replacements;r<o.length;r++){var i=o[r],a=i.matchSourceCaseSensitive?[t,i.sourceString]:[n,i.sourceString.toLocaleLowerCase()],l=a[0],s=a[1];if(l.substring(l.length-s.length)==s)return i}return null},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(259),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CutPasteListChain=void 0;var r=n(260);Object.defineProperty(t,"CutPasteListChain",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(1),i=n(0),a=function(){function e(){var e=this;this.onDrop=function(){e.cacheListChains(i.ChangeSource.Drop)}}return e.prototype.getName=function(){return"CutPasteListChain"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case i.PluginEventType.BeforeCutCopy:e.isCut&&this.cacheListChains(i.ChangeSource.Cut);break;case i.PluginEventType.BeforePaste:this.cacheListChains(i.ChangeSource.Paste);break;case i.PluginEventType.ContentChanged:(null===(t=this.chains)||void 0===t?void 0:t.length)>0&&this.expectedChangeSource==e.source&&((0,r.experimentCommitListChains)(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},e.prototype.cacheListChains=function(e){this.chains=o.VListChain.createListChains(this.editor.getSelectedRegions()),this.expectedChangeSource=e},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(262),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HyperLink=void 0;var r=n(263);Object.defineProperty(t,"HyperLink",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0),i=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.trackedLink=null,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(e.eventType==o.PluginEventType.MouseUp||e.eventType==o.PluginEventType.KeyUp&&(!this.isContentEditValue(e.rawEvent)||e.rawEvent.which==o.Keys.SPACE)||e.eventType==o.PluginEventType.ContentChanged){var t=(n=this.editor.getElementAtCursor("A[href]",null,e))!==this.trackedLink||e.eventType==o.PluginEventType.KeyUp||e.eventType==o.PluginEventType.ContentChanged;this.trackedLink&&(t||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(t&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&this.doesLinkDisplayMatchHref(n)&&(this.trackedLink=n,this.originalHref=this.tryGetHref(n))}var n;if(e.eventType==o.PluginEventType.MouseUp&&(n=this.editor.getElementAtCursor("A",e.rawEvent.srcElement))){if(this.onLinkClick&&!1!==this.onLinkClick(n,e.rawEvent))return;var i=void 0;if(!r.Browser.isFirefox&&(i=this.tryGetHref(n))&&(0,r.isCtrlOrMetaPressed)(e.rawEvent)&&0===e.rawEvent.button)try{var a=this.target||"_blank";this.editor.getDocument().defaultView.open(i,a)}catch(e){}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},e.prototype.isContentEditValue=function(e){return(0,r.isCharacterValue)(e)||e.which==o.Keys.BACKSPACE||e.which==o.Keys.DELETE},e.prototype.updateLinkHrefIfShouldUpdate=function(){this.doesLinkDisplayMatchHref(this.trackedLink)||this.updateLinkHref()},e.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},e.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),r=this.tryGetHref(e);if(null!==r)return n.test(r)}return!1},e.prototype.updateLinkHref=function(){var e=this;if(this.trackedLink){var t=(0,r.matchLink)(this.trackedLink.innerText.trim());null!==t&&this.editor.addUndoSnapshot((function(){e.trackedLink.href=t.normalizedUrl}))}},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(265),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetImage=t.isResizedTo=t.resizeByPercentage=t.canRegenerateImage=t.ImageEdit=void 0;var r=n(98);Object.defineProperty(t,"ImageEdit",{enumerable:!0,get:function(){return r.default}});var o=n(101);Object.defineProperty(t,"canRegenerateImage",{enumerable:!0,get:function(){return o.default}});var i=n(269);Object.defineProperty(t,"resizeByPercentage",{enumerable:!0,get:function(){return i.default}});var a=n(104);Object.defineProperty(t,"isResizedTo",{enumerable:!0,get:function(){return a.default}});var l=n(270);Object.defineProperty(t,"resetImage",{enumerable:!0,get:function(){return l.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(53);t.default=function(e,t){var n=t.angleRad,o=t.widthPx,i=t.heightPx,a=t.bottomPercent,l=t.leftPercent,s=t.rightPercent,u=t.topPercent,c=t.naturalWidth,d=t.naturalHeight,f=c*(1-l-s),h=d*(1-u-a),p=document.createElement("canvas"),g=(0,r.default)(t),v=g.targetWidth,y=g.targetHeight;p.width=v,p.height=y;var m=p.getContext("2d");return m.translate(v/2,y/2),m.rotate(n),m.drawImage(e,c*l,d*u,f,h,-o/2,-i/2,o,i),p.toDataURL("image/png",1)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getCropHTML=t.Cropper=void 0;var o=n(102),i=["w","e"],a=["s","n"],l={sw:0,nw:90,ne:180,se:270};function s(e,t,n,r,o){var i=n*(1-r)-o,a=n*e+t;return Math.max(Math.min(a,i),0)/n}function u(){var e=[];return[0,1].forEach((function(t){return[0,1].forEach((function(n){e.push(function(e,t){return{tag:"div",style:"position:absolute;left:"+e+"px;bottom:"+e+"px;"+(0==t?"right:"+e+"px;height:"+(7-2*e)+"px;":"top:"+e+"px;width:"+(7-2*e)+"px;")+";background-color:"+(0==e?"white":"black")}}(t,n))}))})),e}t.Cropper={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,i){var a,l=e.editInfo,u=e.x,c=e.y,d=e.options;r=(a=(0,o.rotateCoordinate)(r,i,l.angleRad))[0],i=a[1];var f=l.widthPx,h=l.heightPx,p=l.leftPercent,g=l.rightPercent,v=l.topPercent,y=l.bottomPercent,m=d.minWidth,b=d.minHeight,E=1-p-g,C=1-v-y;if(E>0&&C>0){var T=f/E,S=h/C,P="e"!=u?s(n.leftPercent,r,T,g,m):p,w="w"!=u?s(n.rightPercent,-r,T,p,m):g,O="s"!=c?s(n.topPercent,i,S,y,b):v,N="n"!=c?s(n.bottomPercent,-i,S,v,b):y;return l.leftPercent=P,l.rightPercent=w,l.topPercent=O,l.bottomPercent=N,l.widthPx=T*(1-P-w),l.heightPx=S*(1-O-N),!0}return!1}},t.getCropHTML=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},t={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return i.forEach((function(e){return a.forEach((function(n){return t.children.push(function(e,t){return{tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+t+e+"-resize;"+("w"==e?"left":"right")+":0;"+("n"==t?"top":"bottom")+":0;width:22px;height:22px;transform:rotate("+l[t+e]+"deg)",dataset:{x:e,y:t},children:u()}}(e,n))}))})),[t,e,e,e,e]}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.getRotateHTML=t.updateRotateHandlePosition=t.Rotator=void 0;var o=180/Math.PI;function i(e){var t;return{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: 8px 8px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:(t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"},t["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]}}t.Rotator={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,i){var a=e.editInfo,l=e.options,s=a.heightPx/2+31,u=s*Math.sin(n.angleRad)+r,c=s*Math.cos(n.angleRad)-i,d=Math.atan2(u,c);if(!t.altKey){var f=d*o;d=Math.round(f/l.minRotateDeg)*l.minRotateDeg/o}return a.angleRad!=d&&(a.angleRad=d,!0)}},t.updateRotateHandlePosition=function(e,t,n,r,o){if(r&&o&&t){var i=e.angleRad,a=e.heightPx,l=Math.cos(i),s=l<=0?Number.MAX_SAFE_INTEGER:(t[1]+a/2+n)/l-a/2,u=Math.max(Math.min(15,s),0),c=Math.max(Math.min(32,s-u),0);r.style.top=-u+"px",r.style.height=u+"px",o.style.top=-c+"px"}},t.getRotateHTML=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t,children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:32px;height:32px;left:-16px;cursor:move",children:[i(t)]}]}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(99),o=n(103),i=n(104),a=n(0),l=n(27);t.default=function(e,t,n,s,u){var c,d,f,h=(0,l.getEditInfoFromImage)(t);(0,i.default)(t,n)||(c=t,d=h.src,f=function(){if(!e.isDisposed()&&e.contains(t)){var i=t.getAttribute("src"),l=(0,o.default)(h,n),c=l.width,d=l.height;h.widthPx=Math.max(c,s),h.heightPx=Math.max(d,u),e.addUndoSnapshot((function(){(0,r.default)(e,t,h,i,!0)}),a.ChangeSource.ImageResize)}},c.onload=function(){c.onload=null,c.onerror=null,f()},c.onerror=function(){c.onload=null,c.onerror=null,f()},c.src=d)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(27);t.default=function(e,t){e.addUndoSnapshot((function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),(0,o.deleteEditInfo)(t)}),r.ChangeSource.ImageResize)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(272),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageResize=void 0;var r=n(273);Object.defineProperty(t,"ImageResize",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(98),a=n(0),l=function(e){function t(t,n,r,o,i){return void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r="#DB626C"),void 0===o&&(o=!1),void 0===i&&(i="img"),e.call(this,{minHeight:n,minWidth:t,borderColor:r,preserveRatio:o,imageSelector:i})||this}return o(t,e),t.prototype.showResizeHandle=function(e){this.setEditingImage(e,a.ImageEditOperation.Resize)},t.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)},t}(i.default);t.default=l},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(275),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Paste=void 0;var r=n(276);Object.defineProperty(t,"Paste",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(277),o=n(278),i=n(279),a=n(280),l=n(281),s=n(286),u=n(1),c=n(0),d=n(287),f=function(){function e(e){void 0===e&&(e="SPAN"),this.unknownTagReplacement=e}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(e.eventType==c.PluginEventType.BeforePaste){var n=e.htmlAttributes,f=e.fragment,h=e.sanitizingOption,p=e.clipboardData,g=this.editor.getTrustedHTMLHandler(),v=void 0;!function(e){return"urn:schemas-microsoft-com:office:word"==e["xmlns:w"]||"Word.Document"==e.ProgId}(n)?"urn:schemas-microsoft-com:office:excel"==n["xmlns:x"]||"Excel.Sheet"==n.ProgId?(0,i.default)(e,g):"PowerPoint.Slide"==n.ProgId?(0,a.default)(e,g):(v=(0,u.toArray)(f.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer')))&&v.length>0?(v.forEach((function(e){e.style.display=null,e.style.margin=null})),(0,d.isWordOnlineWithList)(f)&&(0,d.default)(f)):f.querySelector("google-sheets-html-origin")?h.additionalTagReplacements["google-sheets-html-origin"]="*":this.editor.isFeatureEnabled(c.ExperimentalFeatures.ConvertSingleImageBody)&&1==(null===(t=p.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==p.htmlFirstLevelChildTags[0]?(0,r.default)(e,g):((0,o.default)(f),(0,s.default)(f)):(0,l.default)(e),h.unknownTagReplacement=this.unknownTagReplacement}},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e,t){var n=e.fragment,o=e.clipboardData,i=o.html,a=o.image;if(i&&a){var l=(new DOMParser).parseFromString(t(i),"text/html");(0,r.moveChildNodes)(n,null==l?void 0:l.body)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);function o(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf((0,r.getTagOfNode)(e))<0){var t=!1;if((0,r.toArray)(e.childNodes).every((function(e){var n;return!(!(0,r.safeInstanceOf)(e,"Text")||(null===(n=e.nodeValue)||void 0===n?void 0:n.trim()))||"LI"==(0,r.getTagOfNode)(e)&&(t=!0,!0)}))&&t)return!0}return!1}t.default=function(e){o(e)?(0,r.wrap)((0,r.toArray)(e.childNodes),"UL"):(0,r.safeInstanceOf)(e.firstChild,"HTMLElement")&&o(e.firstChild)&&(0,r.changeElementTag)(e.firstChild,"UL")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=void 0;var r=n(1),o=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,i=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,a=/<tr[^>]*>[^<]*/i,l=/<table[^>]*>[^<]*/i;function s(e,t){if(e.match(o)){var n=t.match(a);e=(n?n[0]:"<TR>")+e+"</TR>"}if(e.match(i)){var r=t.match(l);e=(r?r[0]:"<TABLE>")+e+"</TABLE>"}return e}t.default=function(e,t){var n=e.fragment,o=e.sanitizingOption,i=e.htmlBefore,a=e.clipboardData,l=s(a.html,i);if(a.html!=l){var u=(new DOMParser).parseFromString(t(l),"text/html");(0,r.moveChildNodes)(n,null==u?void 0:u.body)}(0,r.chainSanitizerCallback)(o.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))},t.excelHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e,t){var n=e.fragment,o=e.clipboardData;if(o.html&&!o.text&&o.image){var i=(new DOMParser).parseFromString(t(o.html),"text/html");(0,r.moveChildNodes)(n,null==i?void 0:i.body)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(282),o=n(1),i=n(283),a=n(284),l=n(285);t.default=function(e){var t=e.sanitizingOption,n=e.fragment;(0,o.chainSanitizerCallback)(t.elementCallbacks,"O:P",(function(e){return(0,o.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}));var s=(0,i.createWordConverter)(),u=n.querySelectorAll("p");u.length>0&&(s.wordConverterArgs=(0,a.createWordConverterArguments)(u),(0,l.processNodesDiscovery)(s)&&(0,l.processNodeConvert)(s)),["OL","UL"].forEach((function(e){(0,o.chainSanitizerCallback)(t.elementCallbacks,e,(function(e){return"0in"==e.style.marginBottom&&(e.style.marginBottom=""),!0}))})),(0,r.default)(t.elementCallbacks)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=/#_msocom_/;t.default=function(e){(0,r.chainSanitizerCallback)(e,"SPAN",(function(e){var t,n=(0,r.getStyles)(e);return("comment"==n["mso-special-character"]||n["mso-comment-continuation"])&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.chainSanitizerCallback)(e,"A",(function(e){var t;return(0,r.getStyles)(e)["mso-comment-reference"]?(0,r.changeElementTag)(e,"span"):(0,r.safeInstanceOf)(e,"HTMLAnchorElement")&&o.test(e.href)&&(null===(t=e.parentElement)||void 0===t||t.removeChild(e)),!0})),(0,r.chainSanitizerCallback)(e,"DIV",(function(e){return"comment-list"==(0,r.getStyles)(e)["mso-element"]&&(0,r.moveChildNodes)(e),!0}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWordConverter=void 0;var r=n(105);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:(0,r.createCustomData)()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createWordConverterArguments=void 0;var r=n(106);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[(0,r.createLevelLists)()],lastProcessedItem:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processNodeConvert=t.processNodesDiscovery=void 0;var r=n(106),o=n(105),i=n(1),a=n(0),l=/[\n|\r]/gi;function s(e,t,n,r){var l=function e(t,n,r){var o,l=null;1==n?o=p(t):(l=e(t,n-1,null),o=l.lastChild);if(o&&o.nodeType==a.NodeType.Element){var s=(0,i.getTagOfNode)(o);if("UL"==s||"OL"==s)return o}var u=t.ownerDocument.createElement(r?r.tagName:"UL");1==n?t.parentNode.insertBefore(u,t):l.appendChild(u);return u}(t,n.level,r),s=(0,o.getObject)(e.wordCustomData,l,"UniqueListId");if(s&&s!=n.uniqueListId||!s&&l.firstChild){var u=t.ownerDocument.createElement(r.tagName);l.parentNode.insertBefore(u,l.nextSibling),l=u}return(0,o.setObject)(e.wordCustomData,l,"UniqueListId",n.uniqueListId),function(e,t,n){if(n.tagName!=(0,i.getTagOfNode)(t)){var r=t.ownerDocument.createElement(n.tagName);(0,o.setObject)(e.wordCustomData,r,"UniqueListId",(0,o.getObject)(e.wordCustomData,t,"UniqueListId")),(0,i.moveChildNodes)(r,t),t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t),t=r}return t}(e,l,r)}function u(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType==a.NodeType.Element&&t>1&&u(r,t-1),(y(r=h(r,!0))||v(r))&&n.push(r);n.forEach((function(t){return e.removeChild(t)}))}function c(e){if(e.nodeType==a.NodeType.Element){var t=m(e,"mso-list");if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function d(e){return["o","·","§","-"].indexOf(e)>=0}function f(e,t){for(var n=null,r=e.firstChild;!n&&r;)v(r=h(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):r.nodeType==a.NodeType.Element&&t>1&&(n=f(r,t-1)),r=r.nextSibling;return n}function h(e,t){if(e.nodeType==a.NodeType.Comment){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,o=null,i=0;i<4&&(r=g(r));i++)if(r.nodeType==a.NodeType.Comment&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){o=r;break}if(o){var l=e.ownerDocument.createElement("span");for(l.setAttribute("style","mso-list: ignore"),r=g(e);r!=o;)r=r.nextSibling,l.appendChild(r.previousSibling);o.parentNode.insertBefore(l,o),t&&(e.parentNode.removeChild(e),o.parentNode.removeChild(o)),e=l}}}return e}function p(e){var t=e;do{t=t.previousSibling}while(t&&b(t));return t}function g(e){var t=e;do{t=t.nextSibling}while(t&&b(t));return t}function v(e){if(e.nodeType==a.NodeType.Element){var t=m(e,"mso-list");if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function y(e){return"SPAN"==(0,i.getTagOfNode)(e)&&!e.firstChild}function m(e,t){return(0,i.getStyles)(e)[t]||null}function b(e){if(!e)return!0;if(e.nodeType==a.NodeType.Text){var t=e.nodeValue;return 0==(t=t.replace(l,"")).trim().length}var n=(0,i.getTagOfNode)(e);return e.firstChild==e.lastChild&&("SPAN"==n||"FONT"==n)&&b(e.firstChild)}function E(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){for(var t,n=e.wordConverterArgs;n.currentIndex<n.nodes.length;){var o=n.nodes.item(n.currentIndex),a=c(o);if(a){var l=n.currentListIdsByLevels[a.level-1]||(0,r.createLevelLists)();n.currentListIdsByLevels[a.level-1]=l,n.lastProcessedItem&&p(o)!=n.lastProcessedItem&&E(n);var s=l.listsMetadata[a.wordListId];if(s){if(!s.ignore&&1==s.numberOfItems){var u=f(o,5);s.tagName=s.firstFakeBullet==u?"UL":"OL"}}else{var h=f(o,5);s={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:h,ignore:!h||0==h.length,tagName:(t=h,d(t)?"UL":"OL")},l.listsMetadata[a.wordListId]=s,n.lists[s.uniqueListId.toString()]=s}a.uniqueListId=s.uniqueListId,s.ignore||"OL"==s.tagName&&s.numberOfItems>0&&l.currentUniqueListId!=a.uniqueListId?(s.ignore=!0,n.currentListIdsByLevels[0].currentUniqueListId=-1,n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,1)):(n.currentListIdsByLevels.length>a.level&&(n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,a.level)),l.currentUniqueListId=a.uniqueListId,n.listItems.push(a),s.numberOfItems++),n.lastProcessedItem=o}else{var g=n.lastProcessedItem;g&&p(o)==g&&o.tagName==g.tagName&&o.className==g.className&&(g.appendChild(g.ownerDocument.createElement("br")),g.appendChild(g.ownerDocument.createElement("br")),(0,i.moveChildNodes)(g,o,!0),o.parentNode.removeChild(o))}n.currentIndex++}return n.listItems.length>0},t.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n=t.listItems[t.currentIndex],r=n.originalNode,o=t.lists[n.uniqueListId.toString()];if(!o.ignore){var a=s(e,r,n,o);if(a){u(r,5);var l=r.ownerDocument.createElement("LI");(0,i.moveChildNodes)(l,r),a.appendChild(l),r.parentNode.removeChild(r),"UL"==o.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}t.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);function o(e){var t,n,o=e.start,i=e.end;if(o==i&&"DIV"==(0,r.getTagOfNode)(o)){var a=(0,r.changeElementTag)(o,"SPAN");e.start=a,e.end=a,"BR"==(0,r.getTagOfNode)(a.lastChild)&&a.removeChild(a.lastChild)}else if("BR"==(0,r.getTagOfNode)(i)){a=i.ownerDocument.createTextNode("");null===(t=i.parentNode)||void 0===t||t.insertBefore(a,i),e.end=a,null===(n=i.parentNode)||void 0===n||n.removeChild(i)}}function i(e,t,n){var o,i=(0,r.getBlockElementAtNode)(e,t.start),a=n?(0,r.getNextLeafSibling)(e,t.end):(0,r.getPreviousLeafSibling)(e,t.start);(null==i?void 0:i.contains(a))&&(null===(o=(n?t.end:t.start).parentNode)||void 0===o||o.insertBefore(t.start.ownerDocument.createElement("br"),n?t.end.nextSibling:t.start))}t.default=function(e){for(var t=r.ContentTraverser.createBodyTraverser(e),n=[],a=null==t?void 0:t.currentBlockElement;a;a=t.getNextBlockElement())n.push({start:a.getStartNode(),end:a.getEndNode()});n.length>0&&(o(n[0]),o(n[n.length-1]),i(e,n[0],!0),i(e,n[n.length-1],!1))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isWordOnlineWithList=void 0;var r=n(288),o=n(1),i='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"],span.WACImageContainer > img';function a(e,t,n){if(e){var r,o=n.insertPositionNode;if(o)(r=o.parentNode)&&r.insertBefore(e,o);else(r=n.startElement.parentNode)?r.appendChild(e):t.appendChild(e)}}t.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(i))},t.default=function(e){!function(e){(0,o.toArray)(e.querySelectorAll(i)).forEach((function(e){var t=new RegExp("\\bListContainerWrapper\\b","g");if(e.previousSibling){var n=(0,o.splitParentNode)(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=(0,o.splitParentNode)(e,!1);r.className=r.className.replace(t,"")}}))}(e),function(e){for(var t,n=e.querySelectorAll(".ListContainerWrapper"),i=[],a=0;a<n.length;a++){var l=n[a];if(t){var s=t.listItemContainers,u=s[s.length-1];l==u.nextSibling||(0,o.getFirstLeafNode)(l)==(0,o.getNextLeafSibling)(u.parentNode,u)?(s.push(l),t.endElement=l):(t.endElement=u,i.push(t),t=(0,r.createListItemBlock)(l))}else t=(0,r.createListItemBlock)(l)}(null==t?void 0:t.listItemContainers.length)>0&&i.push(t);return i}(e).forEach((function(t){var n;!function(e,t){(0,o.collapseNodes)(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==(0,o.getTagOfNode)(e.firstChild)&&(0,o.unwrap)(e)}))}(e,t),t.insertPositionNode=t.endElement.nextSibling;var r=e.ownerDocument;t.listItemContainers.forEach((function(i){var l=function(e){var t=(0,o.getTagOfNode)(e.firstChild);return"UL"==t||"OL"==t?t:null}(i);n||(n=r.createElement(l)),(0,o.toArray)(i.querySelectorAll("li")).forEach((function(i){var s=parseInt(i.getAttribute("data-aria-level"));(0,o.getTagOfNode)(n)!=l&&1==s&&(a(n,e,t),n=r.createElement(l)),function(e,t,n,r){if(!n)return;var i=parseInt(t.getAttribute("data-aria-level")),a=e;for(;i>1;){if(a.firstChild){var l=a.lastElementChild,s=(0,o.getTagOfNode)(l);"UL"==s||"OL"==s?a=l:(a.appendChild(r.createElement(n)),a=a.lastElementChild)}else a.appendChild(r.createElement(n)),a=a.firstElementChild;i--}a.appendChild(t)}(n,i,l,r)}))})),a(n,e,t);var i=t.startElement.parentNode;i&&t.listItemContainers.forEach((function(e){i.removeChild(e)}))})),function(e){return e.querySelectorAll(".WACImageContainer")}(e).forEach((function(e){(0,o.safeInstanceOf)(e,"HTMLSpanElement")&&e.childNodes.forEach((function(e){"IMG"!=(0,o.getTagOfNode)(e)&&e.parentElement.removeChild(e)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItemBlock=void 0,t.createListItemBlock=function(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(290),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PickerPlugin=void 0;var r=n(291);Object.defineProperty(t,"PickerPlugin",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(1),i=n(0),a=o.Browser.isIE?"Esc":"Escape",l=o.Browser.isIE?"Left":"ArrowLeft",s=o.Browser.isIE?"Up":"ArrowUp",u=o.Browser.isIE?"Right":"ArrowRight",c=o.Browser.isIE?"Down":"ArrowDown",d=o.Browser.isIE?"Del":"Delete",f=[0,229],h=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));t.editor.addUndoSnapshot((function(){n?(0,r.replaceWithNode)(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(e.eventType==i.PluginEventType.KeyDown||e.eventType==i.PluginEventType.KeyUp||e.eventType==i.PluginEventType.Input)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case i.PluginEventType.ContentChanged:if(e.source==i.ChangeSource.SetContent&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case i.PluginEventType.KeyDown:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case i.PluginEventType.Input:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case i.PluginEventType.KeyUp:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case i.PluginEventType.MouseUp:this.isSuggesting&&this.setIsSuggesting(!1);break;case i.PluginEventType.Scroll:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,r=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){for(var o=!1,i=e.getTextContent(),a=i?i.length:-1;a>=0;){if(i[a]==r.pickerOptions.triggerCharacter){t=e.getStartPosition().move(a),o=!0;break}a--}return o&&(n=e.getEndPosition()),o})),(0,o.createRange)(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||(0,o.isCharacterValue)(e.rawEvent)||this.isSuggesting&&!(0,o.isModifierKey)(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(r=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var r;t=(r=n.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var o=this.editor.getContentSearcherOfCursor(e),i=this.editor.getDocument().createRange(),a=o.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(i,a,n)){var l=a.previousSibling;this.setRangeStart(i,l,this.pickerOptions.triggerCharacter)}var s=i.getBoundingClientRect();if(0==s.left&&0==s.bottom&&0==s.top&&(s=i.getClientRects()[0]),s){i.detach();var u={x:s.left,y:(s.bottom+s.top)/2},c=(s.bottom-s.top)/2;this.dataProvider.setCursorPoint(u,c)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)if(t.key==a)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if("Backspace"==t.key){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==l||t.key==u:t.key==s||t.key==c)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==u:t.key==c),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==d){var n=this.editor.getContentSearcherOfCursor(e),r=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,o=r?this.getIdValue(r):null;if(o&&0==o.indexOf(this.pickerOptions.elementIdPrefix)){var i=this.dataProvider.onRemove(r,!1);this.replaceNode(r,i),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t.getInlineElementBefore(),r=n?n.getContainerNode():null,a=r?this.getIdValue(r):null,l=t.getInlineElementAfter();if(a&&0==a.indexOf(this.pickerOptions.elementIdPrefix)&&(null==l||!(l instanceof o.PartialInlineElement))){var s=this.dataProvider.onRemove(r,!0);return s?(this.replaceNode(r,s),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(s,i.PositionType.After)})):this.editor.select(s,i.PositionType.After)):this.editor.deleteNode(r),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var r=t?t.textContent.lastIndexOf(n):-1;return r>-1&&(e.setStart(t,r),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&f.indexOf(e.rawEvent.charCode)>-1},e}();t.default=h},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(293),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableResize=void 0;var r=n(294);Object.defineProperty(t,"TableResize",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(295),o=n(1),i=n(0),a=function(){function e(e){var t=this;this.onShowHelperElement=e,this.tableRectMap=null,this.onMouseMove=function(e){var n;if(!(e.buttons>0)){t.ensureTableRects();for(var r=t.editor.getDocument().defaultView,o=e.pageX-r.scrollX,i=e.pageY-r.scrollY,a=null,l=t.tableRectMap.length-1;l>=0;l--){var s=t.tableRectMap[l],u=s.table,c=s.rect;if(o>=c.left-12&&o<=c.right+12&&i>=c.top-12&&i<=c.bottom+12){a=u;break}}t.setTableEditor(a),null===(n=t.tableEditor)||void 0===n||n.onMouseMove(o,i)}},this.invalidateTableRects=function(){t.tableRectMap=null}}return e.prototype.getName=function(){return"TableResize"},e.prototype.initialize=function(e){this.editor=e,this.onMouseMoveDisposer=this.editor.addDomEventHandler({mousemove:this.onMouseMove})},e.prototype.dispose=function(){this.onMouseMoveDisposer(),this.invalidateTableRects(),this.setTableEditor(null),this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case i.PluginEventType.Input:case i.PluginEventType.ContentChanged:case i.PluginEventType.Scroll:case i.PluginEventType.ZoomChanged:this.setTableEditor(null),this.invalidateTableRects()}},e.prototype.setTableEditor=function(e){this.tableEditor&&e!=this.tableEditor.table&&(this.tableEditor.dispose(),this.tableEditor=null),!this.tableEditor&&e&&(this.tableEditor=new r.default(this.editor,e,this.invalidateTableRects,this.onShowHelperElement))},e.prototype.ensureTableRects=function(){var e=this;this.tableRectMap||(this.tableRectMap=[],this.editor.queryElements("table",(function(t){if(t.isContentEditable){var n=(0,o.normalizeRect)(t.getBoundingClientRect());n&&e.tableRectMap.push({table:t,rect:n})}})))},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(296),o=n(297),i=n(298),a=n(299),l=n(300),s=n(1),u=n(0),c=function(){function e(e,t,n,r){var o=this;this.editor=e,this.table=t,this.onChanged=n,this.onShowHelperElement=r,this.onFinishEditing=function(){return o.editor.focus(),o.editor.select(o.start,o.end),o.editor.addUndoSnapshot(null,u.ChangeSource.Format),o.onChanged(),!1},this.onStartTableResize=function(){o.onStartResize()},this.onStartCellResize=function(){o.disposeTableResizer(),o.onStartResize()},this.onInserted=function(e){o.editor.transformToDarkColor(e),o.disposeTableResizer(),o.onFinishEditing()},this.onSelect=function(e){if(o.editor.focus(),e){var t=new s.VTable(e),n=t.cells.length-1,r=0;t.cells[n].forEach((function(e,t){e.td&&(r=t)}));var i={firstCell:{x:0,y:0},lastCell:{y:n,x:r}};o.editor.select(e,i)}},this.isRTL="rtl"==(0,s.getComputedStyle)(t,"direction"),this.tableResizer=(0,i.default)(t,e.getZoomScale(),this.isRTL,this.onStartTableResize,this.onFinishEditing,this.onShowHelperElement),this.tableSelector=(0,a.default)(t,e.getZoomScale(),this.onSelect,this.onShowHelperElement)}return e.prototype.dispose=function(){this.disposeTableResizer(),this.disposeCellResizers(),this.disposeTableInserter(),this.disposeTableSelector()},e.prototype.onMouseMove=function(e,t){for(var n,r=0;r<this.table.rows.length;r++){for(var o=this.table.rows[r],i=0;i<o.cells.length;i++){var a=o.cells[i],l=(0,s.normalizeRect)(a.getBoundingClientRect());if(l){var u=t<=l.bottom;if((this.isRTL?e>=l.right:e<=l.right)&&u){if(0==r&&t<=l.top+5){var c=(l.left+l.right)/2,d=this.isRTL?e<c:e>c;this.setInserterTd(d?a:o.cells[i-1],!1)}else 0==i&&(this.isRTL?e>=l.right-5:e<=l.left+5)?this.setInserterTd(t>(l.top+l.bottom)/2?a:null===(n=this.table.rows[r-1])||void 0===n?void 0:n.cells[0],!0):this.setInserterTd(null);this.setResizingTd(a);break}}}if(i<o.cells.length)break}},e.prototype.setResizingTd=function(e){if(this.horizontalResizer&&this.horizontalResizer.node!=e&&this.disposeCellResizers(),!this.horizontalResizer&&e){var t=this.editor.getZoomScale();this.horizontalResizer=(0,r.default)(e,t,this.isRTL,!0,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement),this.verticalResizer=(0,r.default)(e,t,this.isRTL,!1,this.onStartCellResize,this.onFinishEditing,this.onShowHelperElement)}},e.prototype.setInserterTd=function(e,t){var n=t?this.horizontalInserter:this.verticalInserter;if(n&&n.node!=e&&this.disposeTableInserter(),!this.horizontalInserter&&!this.verticalInserter&&e){var r=(0,o.default)(this.editor,e,this.isRTL,t,this.onInserted,this.onShowHelperElement);t?this.horizontalInserter=r:this.verticalInserter=r}},e.prototype.disposeTableResizer=function(){this.tableResizer&&((0,l.disposeTableEditFeature)(this.tableResizer),this.tableResizer=null)},e.prototype.disposeTableInserter=function(){this.horizontalInserter&&((0,l.disposeTableEditFeature)(this.horizontalInserter),this.horizontalInserter=null),this.verticalInserter&&((0,l.disposeTableEditFeature)(this.verticalInserter),this.verticalInserter=null)},e.prototype.disposeCellResizers=function(){this.horizontalResizer&&((0,l.disposeTableEditFeature)(this.horizontalResizer),this.horizontalResizer=null),this.verticalResizer&&((0,l.disposeTableEditFeature)(this.verticalResizer),this.verticalResizer=null)},e.prototype.disposeTableSelector=function(){this.tableSelector&&((0,l.disposeTableEditFeature)(this.tableSelector),this.tableSelector=null)},e.prototype.onStartResize=function(){var e=this.editor.getSelectionRange();e&&(this.start=s.Position.getStart(e),this.end=s.Position.getEnd(e)),this.editor.addUndoSnapshot()},e}();t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=n(1);function i(e){var t=e.td,n=e.isRTL,r=e.zoomScale,i=e.onStart,a=new o.VTable(t,!0,r),l=(0,o.normalizeRect)(t.getBoundingClientRect());if(l){i();var s=a.getCellsWithBorder(n?l.left:l.right,!n),u=a.getCellsWithBorder(n?l.left:l.right,n);return{vTable:a,currentCells:s,nextCells:u}}return{vTable:a,currentCells:[],nextCells:[]}}function a(e,t,n,r,o){var i=e.td,a=e.zoomScale,l=n.vTable;return l.table.removeAttribute("height"),l.table.style.height=null,l.forEachCellOfCurrentRow((function(e){e.td&&(e.td.style.height=e.td==i?e.height/a+o+"px":null)})),l.writeBack(!0),!0}function l(e,t,n){var r=e.isRTL,i=e.zoomScale,a=n.vTable,l=n.nextCells,u=n.currentCells;if(!function(e,t,n,r,i){for(var a=0;a<t.length;a++){var l=t[a];if(u=(0,o.normalizeRect)(l.getBoundingClientRect()))if((c=s(u,e,!r)/i)<30)return!1}for(a=0;a<n.length;a++){l=n[a];var u,c=Number.MAX_SAFE_INTEGER;if(l)(u=(0,o.normalizeRect)(l.getBoundingClientRect()))&&(c=s(u,e,r)/i);if(c<30)return!1}return!0}(t.pageX,u,l,r,i))return!1;var c=0==l.length,d=t.shiftKey;(c||d)&&(a.table.style.width=null);var f=new Map;return u.forEach((function(e){var n=(0,o.normalizeRect)(e.getBoundingClientRect());if(n){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box";var a=s(n,t.pageX,!r)/i;f.set(e,a)}})),f.forEach((function(e,t){t.style.width=e+"px"})),d||l.forEach((function(e){e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=null})),a.writeBack(!0),!0}function s(e,t,n){return n?t-e.left:e.right-t}function u(e,t){var n=e.td,r=(0,o.normalizeRect)(n.getBoundingClientRect());r&&(t.style.top=r.bottom-4+"px",t.style.left=r.left+"px",t.style.width=r.right-r.left+"px",t.style.height="4px")}function c(e,t){var n=e.td,r=e.isRTL,i=(0,o.normalizeRect)(n.getBoundingClientRect());i&&(t.style.top=i.top+"px",t.style.left=(r?i.left:i.right)-4+1+"px",t.style.width="4px",t.style.height=i.bottom-i.top+"px")}t.default=function(e,t,n,s,d,f,h){var p=e.ownerDocument,g={tag:"div",style:"position: fixed; cursor: "+(s?"row":"col")+"-resize; user-select: none"};null==h||h(g,"CellResizer");var v=(0,o.createElement)(g,p);p.body.appendChild(v);var y={td:e,isRTL:n,zoomScale:t,onStart:d},m=s?u:c;m(y,v);var b={onDragStart:i,onDragging:s?a:l,onDragEnd:f};return{node:e,div:v,featureHandler:new r.default(v,y,m,b,t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(0);t.default=function(e,t,n,o,a,l){var s=e.getElementAtCursor("table",t),u=(0,r.normalizeRect)(t.getBoundingClientRect()),c=s?(0,r.normalizeRect)(s.getBoundingClientRect()):null;if(u&&c){var d=t.ownerDocument,f=function(e,t,n,r){var o=t?"white":"#4A4A4A",i=n?"right":"left";return{tag:"div",style:"position: fixed; width: 12px; height: 12px; font-size: 16px; color: "+o+"; line-height: 10px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+o+"; border-radius: 50%; background-color: "+r,children:[{tag:"div",style:"position: absolute; box-sizing: border-box; background-color: "+r+";"+(e?i+": 12px; top: 5px; height: 3px; border-top: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-right: 1px solid "+o+"; border-left: 0px;":"left: 5px; top: 12px; width: 3px; border-left: 1px solid "+o+"; border-right: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-top: 0px;")},"+"]}}(o,e.isDarkMode(),n,e.getDefaultFormat().backgroundColor||"white");null==l||l(f,"TableInserter");var h=(0,r.createElement)(f,d);return o?(h.style.left=(n?u.right:u.left-13)+"px",h.style.top=u.bottom-8+"px",h.firstChild.style.width=c.right-c.left+"px"):(h.style.left=(n?u.left:u.right-8)+"px",h.style.top=u.top-13+"px",h.firstChild.style.height=c.bottom-c.top+"px"),d.body.appendChild(h),{div:h,featureHandler:new i(h,t,o,e,a),node:t}}};var i=function(){function e(e,t,n,i,a){var l=this;this.div=e,this.td=t,this.isHorizontal=n,this.editor=i,this.onInsert=a,this.insertTd=function(){var e=new r.VTable(l.td);l.isHorizontal||(e.normalizeTableCellSize(l.editor.getZoomScale()),e.table.removeAttribute("width"),e.table.style.width=null),e.edit(l.isHorizontal?o.TableOperation.InsertBelow:o.TableOperation.InsertRight),e.writeBack(),l.onInsert(e.table)},this.div.addEventListener("click",this.insertTd)}return e.prototype.dispose=function(){this.div.removeEventListener("click",this.insertTd),this.div=null,this.editor=null},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=n(1);function i(e){return e.onStart(),{originalRect:e.table.getBoundingClientRect(),vTable:new o.VTable(e.table,!0,e.zoomScale)}}function a(e,t,n,r,o){var i=e.isRTL,a=e.zoomScale,l=n.originalRect,s=n.vTable,u=1+r/l.width*a*(i?-1:1),c=1+o/l.height*a,d=Math.abs(u-1)>.001,f=Math.abs(c-1)>.001;if(d||f){for(var h=0;h<s.cells.length;h++)for(var p=0;p<s.cells[h].length;p++){var g=s.cells[h][p];if(g.td){if(d){s.table.style.width=null;var v=g.width*u/a;g.td.style.boxSizing="border-box",v>=30&&(g.td.style.wordBreak="break-word",g.td.style.whiteSpace="normal",g.td.style.width=v+"px")}if(f)if(s.table.style.height=null,0==p){var y=g.height*c/a;y>=20&&(g.td.style.height=y+"px")}else g.td.style.height=null}}return s.writeBack(!0),!0}return!1}function l(e,t){var n=e.table,r=e.isRTL,i=(0,o.normalizeRect)(n.getBoundingClientRect());i&&(t.style.top=i.bottom+"px",t.style.left=r?i.left-12-2+"px":i.right+"px")}t.default=function(e,t,n,s,u,c){var d=e.ownerDocument,f={tag:"div",style:"position: fixed; cursor: "+(n?"ne":"nw")+"-resize; user-select: none; border: 1px solid #808080"};null==c||c(f,"TableResizer");var h=(0,o.createElement)(f,d);h.style.width="12px",h.style.height="12px",d.body.appendChild(h);var p={isRTL:n,table:e,zoomScale:t,onStart:s};return l(p,h),{node:e,div:h,featureHandler:new r.default(h,p,l,{onDragStart:i,onDragging:a,onDragEnd:u},t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=n(1);function i(e,t){var n=e.table,r=(0,o.normalizeRect)(n.getBoundingClientRect());r&&(t.style.top=r.top-12+"px",t.style.left=r.left-12-2+"px")}t.default=function(e,t,n,a){var l=e.ownerDocument,s={tag:"div",style:"position: fixed; cursor: all-scroll; user-select: none; border: 1px solid #808080"};null==a||a(s,"TableSelector");var u=(0,o.createElement)(s,l);u.id="_Table_Selector",u.style.width="12px",u.style.height="12px",l.body.appendChild(u);var c={table:e,zoomScale:t};i(c,u);var d=new r.default(u,c,i,{onDragEnd:function(e,t){return t.target==u&&n(e.table),!1}},t);return{div:u,featureHandler:d,node:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.disposeTableEditFeature=void 0,t.disposeTableEditFeature=function(e){var t;null===(t=e.div.parentNode)||void 0===t||t.removeChild(e.div),e.div=null,e.featureHandler.dispose(),e.featureHandler=null}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(302),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watermark=void 0;var r=n(303);Object.defineProperty(t,"Watermark",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(7),i=n(0),a=function(){function e(e,t){var n=this;this.watermark=e,this.format=t,this.showHideWatermark=function(){var e=n.editor.hasFocus(),t=n.editor.queryElements((0,r.getEntitySelector)("WATERMARK_WRAPPER")),a=t.length>0;e&&a?(t.forEach(n.removeWatermark),n.editor.focus()):e||a||!n.editor.isEmpty()||(0,o.insertEntity)(n.editor,"WATERMARK_WRAPPER",n.editor.getDocument().createTextNode(n.watermark),!1,!1,i.ContentPosition.Begin)},this.removeWatermark=function(e){var t=e.parentNode;null==t||t.removeChild(e),n.editor.contains(t)&&"DIV"==(0,r.getTagOfNode)(t)&&!t.firstChild&&t.appendChild(n.editor.getDocument().createElement("BR"))},this.format=this.format||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(e.eventType==i.PluginEventType.EditorReady||e.eventType==i.PluginEventType.ContentChanged&&"WATERMARK_WRAPPER"!=(null===(t=e.data)||void 0===t?void 0:t.type))this.showHideWatermark();else if(e.eventType==i.PluginEventType.EntityOperation&&"WATERMARK_WRAPPER"==e.entity.type){var n=e.operation,o=e.entity.wrapper;n==i.EntityOperation.ReplaceTemporaryContent?this.removeWatermark(o):e.operation==i.EntityOperation.NewEntity&&((0,r.applyFormat)(o,this.format,this.editor.isDarkMode()),o.spellcheck=!1)}},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(305),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TableCellSelection=void 0;var r=n(306);Object.defineProperty(t,"TableCellSelection",{enumerable:!0,get:function(){return r.default}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(307),o=n(308),i=n(309),a=n(310),l=n(0),s=n(1),u=function(){function e(){var e=this;this.onMouseMove=function(t){if(e.editor.contains(t.target)){if(e.tableSelection&&(0,s.contains)(e.lastTarget,t.target,!0))return d(e.editor,e.firstTarget,0),void t.preventDefault();if("TABLE"!=(0,s.getTagOfNode)(t.target)){if(e.setData(t.target),!e.firstTarget||e.firstTable)if(e.lastTarget.lastChild==e.lastTarget.firstChild&&"TABLE"==(0,s.getTagOfNode)(e.lastTarget.lastChild)&&"DIV"==(0,s.getTagOfNode)(e.lastTarget)||!e.editor.contains(e.lastTarget))t.preventDefault();else{e.prepareSelection();var n=!!(0,s.safeInstanceOf)(e.lastTarget,"HTMLTableCellElement")&&(0,s.contains)(e.lastTarget,e.firstTable);e.firstTable&&e.firstTable==e.targetTable||n?e.selectionInsideTableMouseMove(t):e.tableSelection&&e.restoreSelection(),e.tableSelection&&(d(e.editor,e.firstTarget,0),t.preventDefault())}}else t.preventDefault()}},this.onMouseUp=function(){e.editor&&e.removeMouseUpEventListener()},this.DeleteTableContents={keys:[l.Keys.DELETE,l.Keys.BACKSPACE],shouldHandleEvent:function(e,t){return t.getSelectionRangeEx().type==l.SelectionRangeTypes.TableSelection},handleEvent:function(e,t){t.getSelectionRangeEx().type==l.SelectionRangeTypes.TableSelection&&t.addUndoSnapshot((function(){t.getSelectedRegions().forEach((function(e){(0,s.safeInstanceOf)(e.rootNode,"HTMLTableCellElement")&&c(e.rootNode,t)}))}))}},this.lastTarget=null,this.firstTarget=null,this.tableSelection=!1,this.tableRange={firstCell:null,lastCell:null},this.startedSelection=!1}return e.prototype.getName=function(){return"TableCellSelection"},e.prototype.initialize=function(e){this.editor=e,this.editor.addContentEditFeature(this.DeleteTableContents)},e.prototype.dispose=function(){this.editor.select(null),this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case l.PluginEventType.EnteredShadowEdit:var t=this.editor.getSelectionRangeEx();t.type==l.SelectionRangeTypes.TableSelection&&(this.tableRange=t.coordinates,this.firstTable=t.table,this.tableSelection=!0,this.editor.select(t.table,null));break;case l.PluginEventType.LeavingShadowEdit:if(this.firstTable&&this.tableSelection&&this.tableRange){var n=this.editor.queryElements("#"+this.firstTable.id);1==n.length&&(this.firstTable=n[0],this.editor.select(this.firstTable,this.tableRange))}break;case l.PluginEventType.BeforeCutCopy:this.handleBeforeCutCopy(e);break;case l.PluginEventType.MouseDown:this.startedSelection||this.handleMouseDownEvent(e);break;case l.PluginEventType.KeyDown:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyDownEvent(e);break;case l.PluginEventType.KeyUp:this.startedSelection?e.rawEvent.preventDefault():this.handleKeyUpEvent(e);break;case l.PluginEventType.Scroll:this.startedSelection&&this.handleScrollEvent();break;case l.PluginEventType.BeforeSetContent:this.tableRange&&(this.tableRange=null,this.firstTable=null,this.tableSelection=!1,this.editor.select(null))}},e.prototype.handleScrollEvent=function(){this.setData(this.editor.getElementAtCursor()),this.firstTable==this.targetTable?this.tableSelection&&(this.vTable.selection.lastCell=(0,i.getCellCoordinates)(this.vTable,this.lastTarget),this.selectTable(),this.tableRange.lastCell=this.vTable.selection.lastCell,d(this.editor,this.firstTarget,0)):this.tableSelection&&this.restoreSelection()},e.prototype.handleBeforeCutCopy=function(e){var t=this,n=this.editor.getSelectionRangeEx();if(n.type==l.SelectionRangeTypes.TableSelection){var r=e.clonedRoot.querySelector("table#"+n.table.id);if(r){this.tableRange=n.coordinates;var i=new s.VTable(r);i.selection=this.tableRange,(0,a.removeCellsOutsideSelection)(i),i.writeBack(),i.table.id="",e.range.selectNode(r),e.isCut&&(0,o.forEachSelectedCell)(this.vTable,(function(e){(null==e?void 0:e.td)&&c(e.td,t.editor)}))}}},e.prototype.handleKeyDownEvent=function(e){var t=this,n=e.rawEvent,r=n.shiftKey,o=n.ctrlKey,i=n.metaKey,a=n.which,u=n.defaultPrevented;if(r&&(o||i)||a==l.Keys.SHIFT||u)this.preventKeyUp=u;else if(r){if(!this.firstTarget){var c=this.editor.getFocusedPosition(),d=f(this.editor,c.node);this.firstTarget=this.firstTarget||d}if(!(0,s.safeInstanceOf)(this.firstTarget,"HTMLTableCellElement"))return;this.editor.runAsync((function(n){var r=n.getFocusedPosition();if(t.setData(t.tableSelection?t.lastTarget:r.node),t.firstTable==t.targetTable){if(!t.shouldConvertToTableSelection()&&!t.tableSelection)return;t.handleKeySelectionInsideTable(e)}else t.tableSelection&&(t.firstTable&&t.editor.select(t.firstTable,null),t.tableSelection=!1)}))}},e.prototype.handleKeyUpEvent=function(e){var t=e.rawEvent,n=t.shiftKey,r=t.which;n||r==l.Keys.SHIFT||!this.firstTarget||this.preventKeyUp||this.clearState(),this.preventKeyUp=!1},e.prototype.handleKeySelectionInsideTable=function(e){if(this.firstTarget=f(this.editor,this.firstTarget),this.lastTarget=f(this.editor,this.lastTarget),d(this.editor,this.firstTarget,0),this.vTable=this.vTable||new s.VTable(this.firstTable),this.tableRange={firstCell:(0,i.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:this.getNextTD(e)},!this.tableRange.lastCell||this.tableRange.lastCell.y>this.vTable.cells.length-1||-1==this.tableRange.lastCell.y){if(this.lastTarget=this.editor.getElementAtCursor("td,th,div",this.firstTable),!(0,s.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement")){var t=new s.Position(this.targetTable,null==this.tableRange.lastCell.y||-1==this.tableRange.lastCell.y?l.PositionType.Before:l.PositionType.After),n=this.editor.getDocument().defaultView.getSelection(),r=n.anchorNode,o=n.anchorOffset;return this.editor.select(n.getRangeAt(0)),n.setBaseAndExtent(r,o,t.node,t.offset),this.lastTarget=t.node,void e.rawEvent.preventDefault()}this.prepareSelection()}this.vTable.selection=this.tableRange,this.selectTable();var a=this.isAfter(this.firstTarget,this.lastTarget),u=new s.Position(this.lastTarget,a?l.PositionType.Begin:l.PositionType.End);d(this.editor,u.node,u.offset),this.tableSelection=!0,e.rawEvent.preventDefault()},e.prototype.handleMouseDownEvent=function(e){var t=this,n=e.rawEvent,o=n.which,a=n.shiftKey;if(3==o&&this.tableSelection){var l=this.editor.getElementAtCursor("td,th"),u=(0,i.getCellCoordinates)(this.vTable,l);if(u){var c=(0,r.default)(this.vTable),p=c.firstCell,g=c.lastCell;if(u.y>=p.y&&u.y<=g.y&&u.x>=p.x&&u.x<=g.x){if(this.firstTarget=this.vTable.getCell(p.y,p.x).td,this.lastTarget=this.vTable.getCell(g.y,g.x).td,this.firstTarget&&this.lastTarget)this.editor.getDocument().defaultView.getSelection().setBaseAndExtent(this.firstTarget,0,this.lastTarget,0),this.selectTable();return}}}1!=o||a||(this.clearState(),h(this.editor,e.rawEvent.target)&&(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().addEventListener("mousemove",this.onMouseMove,!0),this.startedSelection=!0)),1==o&&a&&this.editor.runAsync((function(e){var n=e.getDocument().defaultView.getSelection(),r=f(e,n.anchorNode),o=f(e,n.focusNode),a=h(e,r),l=h(e,r);if(a==l&&(0,s.safeInstanceOf)(r,"HTMLTableCellElement")&&(0,s.safeInstanceOf)(o,"HTMLTableCellElement")){t.vTable=new s.VTable(r);var u=(0,i.getCellCoordinates)(t.vTable,r),c=(0,i.getCellCoordinates)(t.vTable,o);t.vTable.selection={firstCell:u,lastCell:c},t.firstTarget=r,t.lastTarget=o,t.selectTable(),t.tableRange=t.vTable.selection,t.tableSelection=!0,t.firstTable=a,t.targetTable=l,d(e,r,0)}}))},e.prototype.restoreSelection=function(){this.firstTable&&this.editor.select(this.firstTable,null),this.tableSelection=!1;var e=this.isAfter(this.firstTarget,this.lastTarget),t=new s.Position(this.lastTarget,e?l.PositionType.End:l.PositionType.Begin),n=new Range;this.firstTarget&&n.selectNodeContents(this.firstTarget),d(this.editor,this.firstTarget,e?s.Position.getEnd(n).offset:s.Position.getStart(n).offset,t.element,t.offset)},e.prototype.selectionInsideTableMouseMove=function(e){var t;if(this.lastTarget!=this.firstTarget)d(this.editor,this.firstTarget,0),this.firstTable!=this.targetTable&&(null===(t=this.targetTable)||void 0===t?void 0:t.contains(this.firstTable))&&(this.firstTarget=this.editor.getElementAtCursor("td,th",this.lastTarget)),this.firstTable&&(this.tableSelection=!0,this.vTable=this.vTable||new s.VTable(this.firstTable),this.tableRange={firstCell:(0,i.getCellCoordinates)(this.vTable,this.firstTarget),lastCell:(0,i.getCellCoordinates)(this.vTable,this.lastTarget)},this.vTable.selection=this.tableRange,this.selectTable()),e.preventDefault();else if(this.lastTarget==this.firstTarget&&this.tableSelection){this.vTable=new s.VTable(this.firstTable);var n=(0,i.getCellCoordinates)(this.vTable,this.firstTarget);this.tableRange={firstCell:n,lastCell:n},this.vTable.selection=this.tableRange,this.selectTable()}},e.prototype.removeMouseUpEventListener=function(){this.startedSelection&&(this.startedSelection=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0),this.editor.getDocument().removeEventListener("mousemove",this.onMouseMove,!0))},e.prototype.clearState=function(){this.editor.select(null),this.vTable=null,this.firstTarget=null,this.lastTarget=null,this.tableRange={firstCell:null,lastCell:null},this.tableSelection=!1,this.firstTable=null,this.targetTable=null},e.prototype.getNextTD=function(e){if(this.lastTarget=this.editor.getElementAtCursor("td,th",this.lastTarget),(0,s.safeInstanceOf)(this.lastTarget,"HTMLTableCellElement")){var t=(0,i.getCellCoordinates)(this.vTable,this.lastTarget);if(this.tableSelection)switch(e.rawEvent.which){case l.Keys.RIGHT:t.x+=this.lastTarget.colSpan,null==this.vTable.cells[t.y][t.x]&&(t.x=this.vTable.cells[t.y].length-1,t.y++);break;case l.Keys.LEFT:0==t.x?t.y--:t.x--;break;case l.Keys.UP:t.y--;break;case l.Keys.DOWN:t.y++}return t.y>=0&&t.x>=0&&(this.lastTarget=this.vTable.getTd(t.y,t.x)),t}return null},e.prototype.prepareSelection=function(){var e,t,n,r,o=this.lastTarget!=this.firstTarget&&(null===(e=this.firstTable)||void 0===e?void 0:e.contains((0,s.findClosestElementAncestor)(this.targetTable,this.firstTable,"td,th")));if(o&&this.tableSelection)for(;o;)this.lastTarget=(0,s.findClosestElementAncestor)(this.targetTable,this.firstTable,"td,th"),this.targetTable=h(this.editor,this.lastTarget),o=this.lastTarget!=this.firstTarget&&(null===(t=this.firstTable)||void 0===t?void 0:t.contains((0,s.findClosestElementAncestor)(this.targetTable,this.firstTable,"td,th")));var i=this.lastTarget!=this.firstTarget&&(null===(n=this.targetTable)||void 0===n?void 0:n.contains((0,s.findClosestElementAncestor)(this.firstTable,this.targetTable,"td,th")));if(i&&this.tableSelection)for(;i;)this.firstTarget=(0,s.findClosestElementAncestor)(this.firstTable,this.targetTable,"td,th"),this.firstTable=this.editor.getElementAtCursor("table",this.firstTarget),i=this.lastTarget!=this.firstTarget&&(null===(r=this.targetTable)||void 0===r?void 0:r.contains((0,s.findClosestElementAncestor)(this.firstTable,this.targetTable,"td,th")))},e.prototype.setData=function(e){var t=this.editor.getFocusedPosition();t&&(this.firstTarget=this.firstTarget||f(this.editor,t.node),this.firstTarget.nodeType==Node.TEXT_NODE&&(this.firstTarget=this.editor.getElementAtCursor("td,th",this.firstTarget)),!this.editor.contains(this.firstTarget)&&this.lastTarget&&(this.firstTarget=this.lastTarget)),this.firstTable=h(this.editor,this.firstTarget),this.lastTarget=f(this.editor,e),this.targetTable=h(this.editor,this.lastTarget)},e.prototype.isAfter=function(e,t){var n,r,o,i;if(e&&t){if(t.contains(e)){var a=null===(r=(n=e).getBoundingClientRect)||void 0===r?void 0:r.call(n),u=null===(i=(o=t).getBoundingClientRect)||void 0===i?void 0:i.call(o);if(a&&u)return a.top>u.top&&a.bottom<u.bottom}return new s.Position(e,l.PositionType.End).isAfter(new s.Position(t,l.PositionType.End))}return!1},e.prototype.shouldConvertToTableSelection=function(){var e=this;if(!this.firstTable||!this.editor)return!1;var t=this.editor.getSelectedRegions();if(1==t.length)return!1;var n=!0;return t.forEach((function(t){(0,s.contains)(e.firstTable,t.rootNode)||(n=!1)})),n},e.prototype.selectTable=function(){var e;this.editor&&this.vTable&&(null===(e=this.editor)||void 0===e||e.select(this.vTable.table,(0,r.default)(this.vTable)))},e}();function c(e,t){var n=new Range;n.selectNodeContents(e),n.deleteContents(),e.appendChild(t.getDocument().createElement("br"))}function d(e,t,n,r,o){r=r||t,o=o||n,e.getDocument().defaultView.getSelection().setBaseAndExtent(t,n,r,o)}function f(e,t){return e&&e.getElementAtCursor("td,th",t)||t}function h(e,t){return e?e.getElementAtCursor("table",t):null}t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=(null==e?void 0:e.selection)||{},n=t.firstCell,r=t.lastCell;if(!(e&&e.selection&&n&&r))return null;var o=e.table.rows,i={x:Math.min(n.x,r.x),y:Math.min(n.y,r.y)},a={x:Math.max(n.x,r.x),y:Math.max(n.y,r.y)},l=function(e){e.x<0&&(e.x=0),e.y<0&&(e.y=0),e.y>=o.length&&(e.y=o.length-1);var t=o.item(e.y).cells.length;e.x>=t&&(e.x=t-1)};return l(i),l(a),{firstCell:i,lastCell:a}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachSelectedCell=void 0,t.forEachSelectedCell=function(e,t){for(var n,r=e.selection,o=r.lastCell,i=r.firstCell,a=i.y;a<=o.y;a++)for(var l=i.x;l<=o.x;l++)(null===(n=e.cells[a][l])||void 0===n?void 0:n.td)&&t(e.cells[a][l])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellCoordinates=void 0,t.getCellCoordinates=function(e,t){var n;if(null==e?void 0:e.cells)for(var r=0;r<e.cells.length;r++)for(var o=0;o<e.cells[r].length;o++)t==e.cells[r][o].td&&(n={x:o,y:r});return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeCellsOutsideSelection=void 0;var r=n(1);t.removeCellsOutsideSelection=function(e){if(!(0,r.isWholeTableSelected)(e,e.selection)){var t=e.selection,n=t.firstCell,o=t.lastCell,i=[],a=n.x,l=n.y,s=o.x,u=o.y;e.cells.forEach((function(e,t){(e=e.filter((function(e,n){return t>=l&&t<=u&&n>=a&&n<=s}))).length>0&&i.push(e)})),e.cells=i}}}]);
//# sourceMappingURL=rooster-min.js.map