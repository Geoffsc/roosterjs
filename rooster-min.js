var roosterjs=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=105)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.getBlockElementAtNode=r.default;var o=n(55);t.getFirstLastBlockElement=o.default;var i=n(21);t.ContentTraverser=i.default;var a=n(60);t.PositionContentSearcher=a.default;var l=n(16);t.getInlineElementAtNode=l.default;var s=n(56);t.ImageInlineElement=s.default;var u=n(39);t.LinkInlineElement=u.default;var c=n(27);t.NodeInlineElement=c.default;var d=n(29);t.PartialInlineElement=d.default;var f=n(114);t.extractClipboardEvent=f.default;var h=n(61);t.extractClipboardItems=h.default;var p=n(62);t.extractClipboardItemsForIE=p.default;var v=n(42);t.arrayPush=v.default;var g=n(37);t.applyTextStyle=g.default;var m=n(20);t.Browser=m.Browser,t.getBrowserInfo=m.getBrowserInfo;var y=n(115);t.applyFormat=y.default;var b=n(23);t.changeElementTag=b.default;var E=n(17);t.collapseNodes=E.default;var C=n(3);t.contains=C.default;var w=n(11);t.findClosestElementAncestor=w.default;var S=n(54);t.fromHtml=S.default;var P=n(38);t.getComputedStyles=P.default,t.getComputedStyle=P.getComputedStyle;var O=n(116);t.getPendableFormatState=O.default,t.PendableFormatCommandMap=O.PendableFormatCommandMap;var N=n(1);t.getTagOfNode=N.default;var x=n(18);t.isBlockElement=x.default;var T=n(31);t.isNodeEmpty=T.default;var M=n(36);t.isVoidHtmlElement=M.default;var _=n(117);t.matchLink=_.default;var k=n(13);t.queryElements=k.default;var L=n(14);t.splitParentNode=L.default,t.splitBalancedNodeRange=L.splitBalancedNodeRange;var I=n(32);t.unwrap=I.default;var R=n(12);t.wrap=R.default;var A=n(8);t.getNextLeafSibling=A.getNextLeafSibling,t.getPreviousLeafSibling=A.getPreviousLeafSibling;var D=n(58);t.getFirstLeafNode=D.getFirstLeafNode,t.getLastLeafNode=D.getLastLeafNode;var B=n(118);t.getTextContent=B.default;var j=n(28);t.splitTextNode=j.default;var z=n(43);t.normalizeRect=z.default;var F=n(5);t.toArray=F.default;var H=n(2);t.safeInstanceOf=H.default;var U=n(41);t.readFile=U.default;var V=n(64);t.getInnerHTML=V.default;var W=n(63);t.setColor=W.default;var q=n(53);t.matchesSelector=q.default;var K=n(119);t.adjustInsertPosition=K.default;var G=n(19);t.createElement=G.default,t.KnownCreateElementData=G.KnownCreateElementData;var Y=n(30);t.moveChildNodes=Y.default;var X=n(67);t.setListItemStyle=X.default;var $=n(66);t.VTable=$.default;var Q=n(44);t.VList=Q.default;var J=n(68);t.VListItem=J.default;var Z=n(120);t.createVListFromRegion=Z.default;var ee=n(121);t.VListChain=ee.default;var te=n(71);t.getRegionsFromRange=te.default;var ne=n(70);t.getSelectedBlockElementsInRegion=ne.default;var re=n(72);t.collapseNodesInRegion=re.default;var oe=n(24);t.isNodeInRegion=oe.default;var ie=n(46);t.getSelectionRangeInRegion=ie.default;var ae=n(73);t.mergeBlocksInRegion=ae.default;var le=n(4);t.Position=le.default;var se=n(9);t.createRange=se.default;var ue=n(122);t.getPositionRect=ue.default;var ce=n(65);t.isPositionAtBeginningOf=ce.default;var de=n(75);t.getSelectionPath=de.default;var fe=n(123);t.getHtmlWithSelectionPath=fe.default;var he=n(124);t.setHtmlWithSelectionPath=he.default;var pe=n(125);t.addRangeToSelection=pe.default;var ve=n(126);t.deleteSelectedContent=ve.default;var ge=n(127);t.addSnapshot=ge.default;var me=n(47);t.canMoveCurrentSnapshot=me.default;var ye=n(76);t.clearProceedingSnapshots=ye.default;var be=n(128);t.moveCurrentSnapshot=be.default,t.moveCurrentSnapsnot=be.moveCurrentSnapsnot;var Ee=n(129);t.createSnapshots=Ee.default;var Ce=n(130);t.canUndoAutoComplete=Ce.default;var we=n(131);t.HtmlSanitizer=we.default;var Se=n(77);t.getInheritableStyles=Se.default;var Pe=n(133);t.createDefaultHtmlSanitizerOptions=Pe.default;var Oe=n(134);t.chainSanitizerCallback=Oe.default;var Ne=n(135);t.commitEntity=Ne.default;var xe=n(136);t.getEntityFromElement=xe.default;var Te=n(137);t.getEntitySelector=Te.default;var Me=n(138);t.cacheGetEventData=Me.default;var _e=n(139);t.clearEventDataCache=_e.default;var ke=n(79);t.isModifierKey=ke.default;var Le=n(140);t.isCharacterValue=Le.default;var Ie=n(141);t.isCtrlOrMetaPressed=Ie.default;var Re=n(33);t.getStyles=Re.default;var Ae=n(34);t.setStyles=Ae.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e&&1==e.nodeType?e.tagName.toUpperCase():""}},function(e,t,n){"use strict";function r(e){var t=e&&(e.commonAncestorContainer||e),n=t&&(t.ownerDocument||("[object HTMLDocument]"==Object.prototype.toString.apply(t)?t:null));return n&&(n.defaultView||window)}Object.defineProperty(t,"__esModule",{value:!0}),t.getTargetWindow=r,t.default=function(e,t){var n=r(e),o=n&&n[t],i=window,a=i&&i[t];return a&&e instanceof a||o&&e instanceof o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.default=function(e,t,n){return!(!e||!t)&&(!(!n||e!=t)||(r.default(t,"Range")&&(t=t&&t.commonAncestorContainer,n=!0),t&&3==t.nodeType&&(t=t.parentNode,n=!0),1!=e.nodeType&&11!=e.nodeType?!!n&&e==t:!(!n&&e==t)&&function(e,t){if(e.contains)return e.contains(t);for(;t;){if(t==e)return!0;t=t.parentNode}return!1}(e,t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(15),i=function(){function e(e,t,n){switch(this.isFromEndOfRange=n,e.node?(this.node=e.node,t=e.offset):this.node=e,t){case-2:this.offset=a(this.node),this.node=this.node.parentNode,this.isAtEnd=!1;break;case-3:this.offset=a(this.node)+1,this.isAtEnd=!this.node.nextSibling,this.node=this.node.parentNode;break;case-1:this.offset=l(this.node),this.isAtEnd=!0;break;default:var o=l(this.node);this.offset=Math.max(0,Math.min(t,o)),this.isAtEnd=t>0&&t>=o}this.element=r.default(this.node)}return e.prototype.normalize=function(){if(3==this.node.nodeType||!this.node.firstChild)return this;for(var t=this.node,n=this.isAtEnd?-1:this.offset;1==t.nodeType||11==t.nodeType;){var r=this.isFromEndOfRange?-1==n?t.lastChild:t.childNodes[n-1]:0==n?t.firstChild:-1==n?t.lastChild:t.childNodes[n];if(!r)break;t=r,n=this.isAtEnd||this.isFromEndOfRange?-1:0}return new e(t,n,this.isFromEndOfRange)},e.prototype.equalTo=function(e){return e&&(this==e||this.node==e.node&&this.offset==e.offset&&this.isAtEnd==e.isAtEnd)},e.prototype.isAfter=function(e){return this.node==e.node?this.isAtEnd&&!e.isAtEnd||this.offset>e.offset:o.default(this.node,e.node)},e.prototype.move=function(t){return new e(this.node,Math.max(this.offset+t,0))},e.getStart=function(t){return new e(t.startContainer,t.startOffset)},e.getEnd=function(t){return t.collapsed?e.getStart(t):new e(t.endContainer,t.endOffset,!0)},e}();function a(e){for(var t=0;e=e.previousSibling;)t++;return t}function l(e){return 3==e.nodeType?e.nodeValue.length:1==e.nodeType?e.childNodes.length:1}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return[].slice.call(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(3),i=n(1),a=n(18),l=n(52),s=n(110);function u(e,t,n){var r=e;if("BR"==i.default(r)&&n)return r;for(;r;){for(var o=e;!(o=n?e.nextSibling:e.previousSibling);)if((e=e.parentNode)==t)return r;for(;o;){if(a.default(o))return r;if("BR"==i.default(o))return n?o:r;e=o,o=n?e.firstChild:e.lastChild}r=e}return r}t.default=function(e,t){if(!o.default(e,t))return null;var n=s.default.getBlockContext(t);if(n==t)return new l.default(n);var i=u(t,n,!1),c=u(t,n,!0),d=r.default(e,i,c,!1);if(i=d[0],c=d[d.length-1],i.parentNode!=c.parentNode)return new s.default(e,i,c);for(;!i.previousSibling&&!c.nextSibling;){var f=i.parentNode;if(f==n){n!=e&&(i=c=f);break}if(f==e)break;i=c=f}return i==c&&a.default(i)?new l.default(i):new s.default(e,i,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(178);t.changeFontSize=r.default,t.FONT_SIZES=r.FONT_SIZES;var o=n(179);t.clearBlockFormat=o.default;var i=n(86);t.clearFormat=i.default;var a=n(180);t.createLink=a.default;var l=n(181);t.getFormatState=l.default,t.getElementBasedFormatState=l.getElementBasedFormatState;var s=n(182);t.insertEntity=s.default;var u=n(183);t.insertImage=u.default;var c=n(184);t.insertTable=c.default;var d=n(185);t.editTable=d.default;var f=n(186);t.formatTable=f.default;var h=n(187);t.removeLink=h.default;var p=n(188);t.replaceWithNode=p.default;var v=n(189);t.rotateElement=v.default;var g=n(190);t.setAlignment=g.default;var m=n(88);t.setBackgroundColor=m.default;var y=n(91);t.setTextColor=y.default;var b=n(191);t.setDirection=b.default;var E=n(89);t.setFontName=E.default;var C=n(90);t.setFontSize=C.default;var w=n(193);t.setImageAltText=w.default;var S=n(194);t.setIndentation=S.default;var P=n(195);t.changeCapitalization=P.default;var O=n(92);t.toggleBold=O.default;var N=n(196);t.toggleBullet=N.default;var x=n(93);t.toggleItalic=x.default;var T=n(197);t.toggleNumbering=T.default;var M=n(198);t.setOrderedListNumbering=M.default;var _=n(199);t.toggleBlockQuote=_.default;var k=n(200);t.toggleCodeBlock=k.default;var L=n(201);t.toggleStrikethrough=L.default;var I=n(202);t.toggleSubscript=I.default;var R=n(203);t.toggleSuperscript=R.default;var A=n(94);t.toggleUnderline=A.default;var D=n(204);t.toggleHeader=D.default;var B=n(49);t.toggleListType=B.default;var j=n(25);t.blockFormat=j.default;var z=n(87);t.experimentCommitListChains=z.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(1),i=n(22);function a(e,t,n,a,l){var s=null,u=n?function(e){return e.nextSibling}:function(e){return e.previousSibling},c=n?function(e){return e.firstChild}:function(e){return e.lastChild};if(r.default(e,t))for(var d=t,f=!0;f;){var h=d.parentNode;for(d=u(d);!d&&h!=e;)d=u(h),h=h.parentNode;for(;d&&(!a||a.indexOf(o.default(d))<0)&&c(d);)d=c(d);if(!(f=d&&i.default(d,l))){s=d;break}}return s}t.getLeafSibling=a,t.getNextLeafSibling=function(e,t,n){return a(e,t,!0,n)},t.getPreviousLeafSibling=function(e,t,n){return a(e,t,!1,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(36),o=n(4),i=n(2);function a(e){return 1==e.node.nodeType&&r.default(e.node)?new o.default(e.node,e.isAtEnd?-3:-2):e}function l(e){return e&&e.node}function s(e,t){if(!e||!t)return null;for(var n,r=0;r<t.length&&(n=t[r],r<t.length-1&&e&&1==e.nodeType&&e.childNodes.length>n);r++)e=e.childNodes[n];return new o.default(e,n)}t.default=function(e,t,n,r){var u,c;if(l(e)?(u=e,c=l(t)?t:null):i.default(e,"Node")&&(Array.isArray(t)?(u=s(e,t),c=Array.isArray(n)?s(e,n):null):"number"==typeof t?(u=new o.default(e,t),c=i.default(n,"Node")?new o.default(n,r):null):!i.default(t,"Node")&&t||(u=new o.default(e,-2),c=new o.default(t||e,-3))),u&&u.node){var d=u.node.ownerDocument.createRange();return u=a(u),c=a(c||u),d.setStart(u.node,u.offset),d.setEnd(c.node,c.offset),d}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){e.focus();var n=function(){return e.getDocument().execCommand(t,!1,null)},o=e.getSelectionRange();if(o&&o.collapsed){e.addUndoSnapshot();var i=e.getPendableFormatState(!1);n();var a=Object.keys(r.PendableFormatCommandMap).filter((function(e){return r.PendableFormatCommandMap[e]==t}))[0];a&&(i[a]=!i[a],e.triggerPluginEvent(13,{formatState:i}))}else e.addUndoSnapshot(n,"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(53);t.default=function(e,t,n){var i=(e=e?1==e.nodeType?e:e.parentNode:null)&&1==e.nodeType?e:null;if(i&&n)if(i.closest)i=i.closest(n);else for(;i&&i!=t&&!o.default(i,n);)i=i.parentElement;return!t||r.default(t,i)?i:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(54),i=n(2);t.default=function(e,t){if(0==(e=e?i.default(e,"Node")?[e]:e:[]).length||!e[0])return null;if(t||(t="div"),!i.default(t,"HTMLElement")){var n=e[0].ownerDocument;t="string"==typeof t?/^\w+$/.test(t)?n.createElement(t):o.default(t,n)[0]:r.default(t,n)}var a=e[0].parentNode;a&&a.insertBefore(t,e[0]);for(var l=0,s=e;l<s.length;l++){var u=s[l];t.appendChild(u)}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);function o(e,t){return t.some((function(t){return 0==t?0==e:(e&t)==t}))}t.default=function(e,t,n,i,a){if(void 0===i&&(i=0),!e||!t)return[];var l=r.default(e.querySelectorAll(t));if(0!=i&&a){var s=a.startContainer,u=a.startOffset,c=a.endContainer,d=a.endOffset;if(1==s.nodeType&&s.firstChild){var f=s.childNodes[u];s=f||s.lastChild}c=1==c.nodeType&&c.firstChild&&d>0?c.childNodes[d-1]:c,l=l.filter((function(e){return function(e,t,n,r){var i=e.compareDocumentPosition(t),a=e.compareDocumentPosition(n),l=[0,8];r||l.push(16);return o(i,l)||o(a,l)||o(i,[2])&&o(a,[4])&&!o(a,[16])}(e,s,c,2==i)}))}return n&&l.forEach(n),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(15);function o(e,t){if(!e||!e.parentNode)return null;var n=e.parentNode,r=n.cloneNode(!1);if(r.removeAttribute("id"),t)for(;n.firstChild&&n.firstChild!=e;)r.appendChild(n.firstChild);else for(;e.nextSibling;)r.appendChild(e.nextSibling);return r.firstChild&&""!=r.innerHTML?n.parentNode.insertBefore(r,t?n:n.nextSibling):r=null,r}t.default=o,t.splitBalancedNodeRange=function(e){var t=Array.isArray(e)?e[0]:e,n=Array.isArray(e)?e[e.length-1]:e,i=t&&n&&t.parentNode==n.parentNode?t.parentNode:null;if(i){if(r.default(t,n)){var a=n;n=t,t=a}o(t,!0),o(n,!1)}return i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return!(!e||!t||4!=(4&t.compareDocumentPosition(e)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(1),i=n(56),a=n(39),l=n(27),s=n(2);t.default=function(e,t){var n=s.default(e,"Node")?r.default(e,t):e;return t&&n&&function(e,t){for(var n,r=[e],s=e.parentNode;s&&t.contains(s);s=s.parentNode)r.push(s);for(var u=r.length-1;u>=0&&!n;u--){var c=r[u],d=o.default(c);"A"==d?n=new a.default(c,t):"IMG"==d&&(n=new i.default(c,t))}return n||new l.default(e,t)}(t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(14),i=n(5);function a(e,t,n,i,a){for(;t.parentNode!=e&&!r.default(t.parentNode,n);){if(i&&t.previousSibling||!i&&t.nextSibling){if(!a)break;o.default(t,i)}t=t.parentNode}return t}t.default=function(e,t,n,o){if(!r.default(e,t)||!r.default(e,n))return[];if(t=a(e,t,n,!0,o),n=a(e,n,t,!1,o),r.default(t,n,!0))return[t];if(r.default(n,t))return[n];if(t.parentNode==n.parentNode){var l=i.default(t.parentNode.childNodes),s=l.indexOf(t),u=l.indexOf(n);return l.slice(s,u+1)}return[t,n]},t.collapse=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o="ADDRESS,ARTICLE,ASIDE,BLOCKQUOTE,CANVAS,DD,DIV,DL,DT,FIELDSET,FIGCAPTION,FIGURE,FOOTER,FORM,H1,H2,H3,H4,H5,H6,HEADER,HR,LI,MAIN,NAV,NOSCRIPT,OL,OUTPUT,P,PRE,SECTION,TABLE,TD,TH,TFOOT,UL,VIDEO".split(","),i=["block","list-item","table-cell"];t.default=function(e){var t=r.default(e);return!(!t||!(i.indexOf(e.style.display)>=0||o.indexOf(t)>=0))}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),i=n(20);t.KnownCreateElementData=((r={})[0]=null,r[1]=i.Browser.isEdge?{tag:"div",children:[{tag:"span",children:[{tag:"br"}]}]}:{tag:"div",children:[{tag:"br"}]},r[2]={tag:"blockquote",style:"margin-top:0;margin-bottom:0"},r[3]={tag:"div",style:"width: 1px; height: 1px; overflow: hidden; position: fixed; top: 0; left; 0; -webkit-user-select: text",attributes:{contenteditable:"true"}},r[4]={tag:"li",style:"display:block"},r[5]={tag:"div",style:"position: fixed; width: 0; height: 0"},r[6]={tag:"div",style:"width:100%;height:100%;position:relative;overflow:hidden"},r[7]={tag:"div",style:"position: fixed; cursor: row-resize; user-select: none"},r[8]={tag:"div",style:"position: fixed; cursor: col-resize; user-select: none"},r[9]={tag:"div",style:"position: fixed; cursor: nw-resize; user-select: none; border: 1px solid #808080"},r[10]={tag:"div",style:"position: fixed; cursor: ne-resize; user-select: none; border: 1px solid #808080"},r),t.default=function e(n,r){if("number"==typeof n&&(n=t.KnownCreateElementData[n]),!n||!n.tag)return null;var i=n.tag,a=n.namespace,l=n.className,s=n.style,u=n.dataset,c=n.attributes,d=n.children,f=a?r.createElementNS(a,i):r.createElement(i);return s&&f.setAttribute("style",s),l&&(f.className=l),u&&o.default(f,"HTMLElement")&&Object.keys(u).forEach((function(e){f.dataset[e]=u[e]})),c&&Object.keys(c).forEach((function(e){f.setAttribute(e,c[e])})),d&&d.forEach((function(t){"string"==typeof t?f.appendChild(r.createTextNode(t)):t&&f.appendChild(e(t,r))})),f}},function(e,t,n){"use strict";function r(e,t){var n=-1!=e.indexOf("rv:")&&-1!=e.indexOf("Trident"),r=-1!=e.indexOf("MSIE")||n,o=!1,i=!1,a=!1,l=!1,s=-1!=e.indexOf("WebKit");return r||(o=-1!=e.indexOf("Chrome"),i=-1!=e.indexOf("Firefox"),-1!=e.indexOf("Safari")&&(a=-1==e.indexOf("Chrome")&&-1==e.indexOf("Android")),(l=-1!=e.indexOf("Edge"))&&(s=o=i=!1)),{isMac:-1!=t.indexOf("Mac"),isWin:-1!=t.indexOf("Win")||-1!=t.indexOf("NT"),isWebKit:s,isIE:r,isIE11OrGreater:n,isSafari:a,isChrome:o,isFirefox:i,isEdge:l,isIEOrEdge:r||l}}Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserInfo=r,t.Browser=window?r(window.navigator.userAgent,window.navigator.appVersion):{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(111),o=n(59),i=n(6),a=n(16),l=n(29),s=n(112),u=n(113),c=n(40),d=n(8),f=function(){function e(e,t){this.scoper=e,this.skipTags=t}return e.createBodyTraverser=function(t,n,o){return new e(new r.default(t,n))},e.createSelectionTraverser=function(t,n,r){return new e(new u.default(t,n),r)},e.createBlockTraverser=function(t,n,r,o){return void 0===r&&(r=3),new e(new s.default(t,n,r))},Object.defineProperty(e.prototype,"currentBlockElement",{get:function(){return this.currentBlock||(this.currentBlock=this.scoper.getStartBlockElement()),this.currentBlock},enumerable:!0,configurable:!0}),e.prototype.getNextBlockElement=function(){return this.getPreviousNextBlockElement(!0)},e.prototype.getPreviousBlockElement=function(){return this.getPreviousNextBlockElement(!1)},e.prototype.getPreviousNextBlockElement=function(e){var t=this.currentBlockElement;if(!t)return null;var n=d.getLeafSibling(this.scoper.rootNode,e?t.getEndNode():t.getStartNode(),e,this.skipTags),r=n?i.default(this.scoper.rootNode,n):null;return r&&this.scoper.isBlockInScope(r)&&(e&&r.isAfter(t)||!e&&t.isAfter(r))?(this.currentBlock=r,this.currentBlock):null},Object.defineProperty(e.prototype,"currentInlineElement",{get:function(){return this.currentInline||(this.currentInline=this.scoper.getStartInlineElement()),this.currentInline instanceof o.default?null:this.currentInline},enumerable:!0,configurable:!0}),e.prototype.getNextInlineElement=function(){return this.getPreviousNextInlineElement(!0)},e.prototype.getPreviousInlineElement=function(){return this.getPreviousNextInlineElement(!1)},e.prototype.getPreviousNextInlineElement=function(e){var t,n=this.currentInlineElement||this.currentInline;return n?(n instanceof o.default?(t=c.getInlineElementBeforeAfter(this.scoper.rootNode,n.getStartPosition(),e))&&!n.getParentBlock().contains(t.getContainerNode())&&(t=null):t=(t=function(e,t,n){if(!t)return null;if(t instanceof l.default){var r=n?t.nextInlineElement:t.previousInlineElement;if(r)return r}var o=t.getContainerNode();return o=d.getLeafSibling(e,o,n),a.default(e,o)}(this.scoper.rootNode,n,e))&&n&&(e&&t.isAfter(n)||!e&&n.isAfter(t))?t:null,t&&(t=this.scoper.trimInlineElement(t))?(this.currentInline=t,this.currentInline):null):null},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(38),i=/^[\r\n]+$/gm,a=/[\t\r\n\u0020\u200B]/gm;t.default=function e(t,n){if(3==t.nodeType)return!(t.nodeValue&&""!=t.textContent&&!i.test(t.nodeValue))||!(!n||""!=t.nodeValue.replace(a,""));if(1==t.nodeType){if("none"==o.getComputedStyle(t,"display"))return!0;var l=r.default(t);if("DIV"==l||"SPAN"==l){for(var s=t.firstChild;s;s=s.nextSibling)if(!e(s,n))return!1;return!0}return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(38),o=n(1),i=n(30);t.default=function(e,t){var n;if(!e||!t)return null;for(var a=e.ownerDocument.createElement(t),l=0;l<e.attributes.length;l++){var s=e.attributes[l];a.setAttribute(s.name,s.value)}return i.default(a,e),"P"!=o.default(e)&&"P"!=o.default(a)||(n=r.default(e,["margin-top","margin-bottom"]),a.style.marginTop=n[0],a.style.marginBottom=n[1]),e.parentNode&&e.parentNode.replaceChild(a,e),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.default=function(e,t){return!(!e||!r.default(e.rootNode,t)||e.nodeBefore&&4!=e.nodeBefore.compareDocumentPosition(t)||e.nodeAfter&&2!=e.nodeAfter.compareDocumentPosition(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(87),o=n(0);t.default=function(e,t,n){e.focus(),e.addUndoSnapshot((function(i,a){if(!n||n()){var l=e.getSelectedRegions(),s=o.VListChain.createListChains(l,null==i?void 0:i.node);l.forEach((function(e){return t(e,i,a,s)})),r.default(e,s)}e.select(i,a)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(98);t.saveEditInfo=function(e,t){e&&(e.dataset.roosterEditInfo=JSON.stringify(t))},t.deleteEditInfo=function(e){e&&delete e.dataset.roosterEditInfo},t.getEditInfoFromImage=function(e){var t=function(e){try{return JSON.parse(e)}catch(e){return null}}(null==e?void 0:e.dataset.roosterEditInfo);return 0==r.default(t)?function(e){return{src:e.src,widthPx:e.clientWidth,heightPx:e.clientHeight,naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight,leftPercent:0,rightPercent:0,topPercent:0,bottomPercent:0,angleRad:0}}(e):t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=n(15),i=n(4),a=function(){function e(e,t){this.containerNode=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return 3==this.containerNode.nodeType?this.containerNode.nodeValue:this.containerNode.textContent},e.prototype.getContainerNode=function(){return this.containerNode},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return new i.default(this.containerNode,0).normalize()},e.prototype.getEndPosition=function(){return new i.default(this.containerNode,-1).normalize()},e.prototype.isTextualInlineElement=function(){return this.containerNode&&3==this.containerNode.nodeType},e.prototype.isAfter=function(e){return e&&o.default(this.containerNode,e.getContainerNode())},e.prototype.contains=function(e){var t=this.getStartPosition(),n=this.getEndPosition();return e&&e.isAfter(t)&&n.isAfter(e)},e.prototype.applyStyle=function(e){r.default(this.containerNode,e)},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e.nodeValue.substr(0,t),o=e.nodeValue.substr(t),i=e.ownerDocument.createTextNode(n?r:o);return e.nodeValue=n?o:r,e.parentNode.insertBefore(i,n?e:e.nextSibling),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(37),o=n(9),i=n(4),a=n(8),l=function(){function e(e,t,n){this.inlineElement=e,this.start=t,this.end=n}return e.prototype.getDecoratedInline=function(){return this.inlineElement},e.prototype.getContainerNode=function(){return this.inlineElement.getContainerNode()},e.prototype.getParentBlock=function(){return this.inlineElement.getParentBlock()},e.prototype.getTextContent=function(){return o.default(this.getStartPosition(),this.getEndPosition()).toString()},e.prototype.getStartPosition=function(){return this.start||this.inlineElement.getStartPosition()},e.prototype.getEndPosition=function(){return this.end||this.inlineElement.getEndPosition()},Object.defineProperty(e.prototype,"nextInlineElement",{get:function(){return this.end&&new e(this.inlineElement,this.end,null)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousInlineElement",{get:function(){return this.start&&new e(this.inlineElement,null,this.start)},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return e&&e.isAfter(this.getStartPosition())&&this.getEndPosition().isAfter(e)},e.prototype.isTextualInlineElement=function(){return this.inlineElement&&this.inlineElement.isTextualInlineElement()},e.prototype.isAfter=function(e){var t=this.getStartPosition(),n=e&&e.getEndPosition();return n&&(t.isAfter(n)||t.equalTo(n))},e.prototype.applyStyle=function(e){var t=this.getStartPosition().normalize(),n=this.getEndPosition().normalize(),o=this.getContainerNode();if(t.isAtEnd){var l=a.getNextLeafSibling(o,t.node);t=l?new i.default(l,0):null}if(0==n.offset){var s=a.getPreviousLeafSibling(o,n.node);n=s?new i.default(s,-1):null}r.default(o,e,t,n)},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e){for(;!n&&e.firstChild;)e.removeChild(e.firstChild);for(;null==t?void 0:t.firstChild;)e.appendChild(t.firstChild)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=["IMG"],i=["TABLE","IMG","LI"].join(","),a=/\u200b/g;function l(e,t){return e=e.replace(a,""),t?e.trim():e}t.default=function(e,t){if(!e)return!1;if(3==e.nodeType)return""==l(e.nodeValue,t);if(1==e.nodeType){var n=e;if(""!=l(n.textContent,t)||o.indexOf(r.default(n))>=0||n.querySelectorAll(i)[0])return!1}return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e?e.parentNode:null;if(!t)return null;for(;e.firstChild;)t.insertBefore(e.firstChild,e);return t.removeChild(e),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t={};return((null==e?void 0:e.getAttribute("style"))||"").split(";").forEach((function(e){var n=e.indexOf(":"),r=e.slice(0,n),o=e.slice(n+1);r&&o&&(t[r.trim()]=o.trim())})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e){var n=Object.keys(t||{}).map((function(e){var n=t[e];return e=e?e.trim():null,n=n?n.trim():null,e&&n?e+":"+n:null})).filter((function(e){return e})).join(";");n?e.setAttribute("style",n):e.removeAttribute("style")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){e.focus();var n=e.getSelectionRange();if(n&&n.collapsed){var o=n.startContainer;if("SPAN"==r.getTagOfNode(o)&&(!o.firstChild||"BR"==r.getTagOfNode(o.firstChild)&&!o.firstChild.nextSibling))e.addUndoSnapshot(),t(o);else o&&3==o.nodeType&&"​"==o.nodeValue&&"SPAN"==r.getTagOfNode(o.parentNode)||(e.addUndoSnapshot(),o=e.getDocument().createTextNode("​"),n.insertNode(o)),r.applyTextStyle(o,t),e.select(o,-1)}else e.addUndoSnapshot((function(){for(var n,r,o=e.getSelectionTraverser(),i=o&&o.currentInlineElement;i;){var a=o.getNextInlineElement();i.applyStyle((function(e,o){t(e,o),n=n||e,r=e})),i=a}n&&r&&e.select(n,-2,r,-3)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o="AREA,BASE,BR,COL,COMMAND,EMBED,HR,IMG,INPUT,KEYGEN,LINK,META,PARAM,SOURCE,TRACK,WBR".split(",");t.default=function(e){return!!e&&o.indexOf(r.default(e))>=0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(4),i=n(28),a=n(12),l=n(8),s=n(14),u="SPAN,B,I,U,EM,STRONG,STRIKE,S,SMALL".split(",");function c(e,t){e&&1==e.nodeType&&t(e,!0)}t.default=function(e,t,n,d){void 0===n&&(n=new o.default(e,0).normalize()),void 0===d&&(d=new o.default(e,-1).normalize());for(var f=[];n&&d&&d.isAfter(n);){var h=n.node,p=r.default(h.parentNode),v=l.getNextLeafSibling(e,h);3==h.nodeType&&["TR","TABLE"].indexOf(p)<0&&(h!=d.node||d.isAtEnd||(h=i.default(h,d.offset,!0)),n.offset>0&&(h=i.default(h,n.offset,!1)),f.push(h)),n=v&&new o.default(v,0)}if(f.length>0){if(f.every((function(e){return e.parentNode==f[0].parentNode}))){var g=f.shift();f.forEach((function(e){g.nodeValue+=e.nodeValue,e.parentNode.removeChild(e)})),f=[g]}f.forEach((function(e){for(;"SPAN"!=r.default(e)&&u.indexOf(r.default(e.parentNode))>=0;)c(e,t),e=s.splitBalancedNodeRange(e);"SPAN"!=r.default(e)&&(c(e,t),e=a.default(e,"SPAN")),t(e)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);function o(e,t){void 0===t&&(t=["font-family","font-size","color","background-color"]);var n=r.default(e),o=[];if(t=Array.isArray(t)?t:[t],n){var a=(n.ownerDocument.defaultView||window).getComputedStyle(n);if(a)for(var l=0,s=t;l<s.length;l++){var u=s[l],c=a.getPropertyValue(u)||"";c="font-family"!=u?c.toLowerCase():c,c="font-size"==u?i(c):c,o.push(c)}}return o}function i(e){return e&&e.indexOf("px")==e.length-2?Math.round(75*parseFloat(e)+.05)/100+"pt":e}t.default=o,t.getComputedStyle=function(e,t){return o(e,t)[0]||""}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(27).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),o=n(29),i=n(22),a=n(8);function l(e,t,n){if(!e||!t||!t.node)return null;var l=(t=t.normalize()).node,s=t.offset,u=t.isAtEnd,c=!1;!n&&0==s&&!u||n&&u?l=a.getLeafSibling(e,l,n):3==l.nodeType&&(!n&&!u||n&&s>0)&&(c=!0),l&&i.default(l)&&(l=a.getLeafSibling(e,l,n));var d=r.default(e,l);return d&&(c||d.contains(t))&&(d=n?new o.default(d,t,null):new o.default(d,null,t)),d}t.getInlineElementBefore=function(e,t){return l(e,t,!1)},t.getInlineElementAfter=function(e,t){return l(e,t,!0)},t.getInlineElementBeforeAfter=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(e&&t){var n=new FileReader;n.onload=function(){t(n.result)},n.onerror=function(){t(null)},n.readAsDataURL(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Array.prototype.push.apply(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e||{left:0,right:0,top:0,bottom:0},n=t.left,r=t.right,o=t.top,i=t.bottom;return n+r+o+i>0?{left:Math.round(n),right:Math.round(r),top:Math.round(o),bottom:Math.round(i)}:null}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(23),i=n(45),a=n(1),l=n(18),s=n(31),u=n(4),c=n(13),d=n(2),f=n(14),h=n(5),p=n(32),v=n(68),g=n(12),m=function(){function e(e){if(this.rootList=e,this.items=[],!e)throw new Error("rootList must not be null");y(this.rootList),c.default(this.rootList,"ol,ul",y),c.default(this.rootList,"li",b),this.populateItems(this.rootList)}return e.prototype.contains=function(e){return this.items.some((function(t){return t.contains(e)}))},e.prototype.getLastItemNumber=function(){var e=E(this.rootList);return void 0===e?e:e-1+this.items.filter((function(e){return 1==e.getListType()&&1==e.getLevel()&&!e.isDummy()})).length},e.prototype.writeBack=function(){var e=this;if(!this.rootList)throw new Error("rootList must not be null");var t,n=this.rootList.ownerDocument,r=[n.createDocumentFragment()],o=n.createTextNode(""),i=E(this.rootList)||1;this.rootList.parentNode.replaceChild(o,this.rootList),this.items.forEach((function(n){n.getNewListStart()&&n.getNewListStart()!=i&&(r.splice(1,r.length-1),i=n.getNewListStart()),n.writeBack(r,e.rootList);var o=r[1];d.default(o,"HTMLOListElement")&&(t!=o&&(1==i?o.removeAttribute("start"):o.start=i),1==n.getLevel()&&i++),t=o})),o.parentNode.replaceChild(r[0],o),this.rootList=null},e.prototype.split=function(e,t){if(!this.rootList)throw new Error("rootList must not be null");for(var n=0;n<this.items.length;n++)if(this.items[n].getNode()==e)return void this.items[n].setNewListStart(t)},e.prototype.setIndentation=function(e,t,n,r){this.findListItems(e,t,(function(e){return 1==n?r&&!e.isDummy()?e.setIsDummy(!0):e.outdent():e.indent()}))},e.prototype.changeListType=function(e,t,n){var r=!1;this.findListItems(e,t,(function(e){r=r||e.getListType()!=n})),this.findListItems(e,t,(function(e){return r?e.changeListType(n):e.outdent()}))},e.prototype.appendItem=function(e,t){var n=a.default(e);"DIV"==n?e=o.default(e,"LI"):"LI"!=n&&(e=g.default(e,"LI")),this.items.push(0==t?new v.default(e):new v.default(e,t))},e.prototype.mergeVList=function(e){var t,n=this;e&&e!=this&&(e.items.forEach((function(e){return n.items.push(e)})),e.items.splice(0,e.items.length),null===(t=e.rootList.parentNode)||void 0===t||t.removeChild(e.rootList))},e.prototype.findListItems=function(e,t,n){if(0==this.items.length)return[];var r=new u.default(this.items[0].getNode(),0),o=new u.default(this.items[this.items.length-1].getNode(),-1),i=r.isAfter(e)?0:-1,a=this.items.length-(t.isAfter(o)?1:0);this.items.forEach((function(n,r){i=n.contains(e.node)?r:i,a=n.contains(t.node)?r:a})),i=a<this.items.length?Math.max(0,i):i,a=i>=0?Math.min(this.items.length-1,a):a;var l=i<=a?this.items.slice(i,a+1):[];return n&&l.forEach(n),l},e.prototype.populateItems=function(e,t){var n=this;void 0===t&&(t=[]);var o=i.default(e);h.default(e.childNodes).forEach((function(e){var a=r(t,[o]);i.isListElement(e)?n.populateItems(e,a):3==e.nodeType&&""==e.nodeValue.trim()||n.items.push(new(v.default.bind.apply(v.default,r([void 0,e],a))))}))},e}();function y(e){var t=null;h.default(e.childNodes).forEach((function(e){"LI"==a.default(e)?t=e:i.isListElement(e)?t=null:t&&!s.default(e,!0)&&t.appendChild(l.default(e)?e:g.default(e))}))}function b(e){for(;!i.isListElement(e.parentNode);){f.default(e,!0);var t=h.default(e.parentNode.childNodes).slice(1);t.length>0&&(l.default(t[0])||(t=[g.default(t)]),t.forEach((function(t){return e.appendChild(t)}))),p.default(e.parentNode)}}function E(e){return d.default(e,"HTMLOListElement")?e.start:void 0}t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);function o(e){switch(r.default(e)){case"OL":return 1;case"UL":return 2;default:return 0}}t.default=o,t.isListElement=function(e){return 0!=o(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(4),i=n(8);t.default=function(e){if(!e)return null;var t=e.nodeBefore,n=e.nodeAfter,a=e.rootNode,l=e.skipTags,s=t?i.getNextLeafSibling(e.rootNode,t,e.skipTags):a.firstChild,u=n?i.getPreviousLeafSibling(a,n,l):a.lastChild,c=s&&u&&r.default(s,u);if(!function(e){var t=e;return!!t.fullSelectionEnd&&!!t.fullSelectionStart}(e))return c;if(c){var d=o.default.getStart(c).normalize(),f=o.default.getEnd(c).normalize(),h=e.fullSelectionEnd,p=e.fullSelectionStart;if(p.isAfter(f)||d.isAfter(h))return null;var v=p.isAfter(d)?p:d,g=h.isAfter(f)?f:h;return r.default(v,g)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.currentIndex+t;return n>=0&&n<e.snapshots.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),o=n(0);t.default=function(e,t,n){var i=[];r.default(e,(function(t,r){n(t,r);var o=e.getElementAtCursor("LI",t);o&&-1===i.indexOf(o)&&i.push(o)})),function(e,t){e.forEach((function(e){o.safeInstanceOf(e,"HTMLLIElement")&&o.setListItemStyle(e,t)}))}(i,[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),o=n(0);t.default=function(e,t,n,i){void 0===i&&(i=!0),r.default(e,(function(e,r,a,l){var s,u=n>0&&l.filter((function(e){return e.canAppendAtCursor(n)}))[0],c=u&&r.equalTo(a)?u.createVListAtBlock(null===(s=o.getBlockElementAtNode(e.rootNode,r.node))||void 0===s?void 0:s.collapseToSingleElement(),n):o.createVListFromRegion(e,i);c&&(c.changeListType(r,a,t),c.writeBack())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.widthPx,r=e.heightPx,o=e.angleRad,i=n/(1-e.leftPercent-e.rightPercent),a=r/(1-e.topPercent-e.bottomPercent),l=t?i:n,s=t?a:r;return{targetWidth:Math.abs(l*Math.cos(o))+Math.abs(s*Math.sin(o)),targetHeight:Math.abs(l*Math.sin(o))+Math.abs(s*Math.cos(o)),originalWidth:i,originalHeight:a,visibleWidth:l,visibleHeight:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(107);t.Editor=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(15),i=function(){function e(e){this.element=e}return e.prototype.collapseToSingleElement=function(){return this.element},e.prototype.getStartNode=function(){return this.element},e.prototype.getEndNode=function(){return this.element},e.prototype.equals=function(e){return this.element==e.getStartNode()},e.prototype.isAfter=function(e){return o.default(this.element,e.getEndNode())},e.prototype.contains=function(e){return r.default(this.element,e,!0)},e.prototype.getTextContent=function(){return this.element?this.element.textContent:""},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.default=function(e,t){return r.default(e,"HTMLElement")&&(e.matches||e.msMatchesSelector).call(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);t.default=function(e,t){var n=t.createElement("DIV");return n.innerHTML=e,r.default(n.childNodes)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6);t.default=function(e,t){var n=e;do{n=n&&(t?n.firstChild:n.lastChild)}while(n&&n.firstChild);return n&&r.default(e,n)}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t}(n(27).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(16),o=n(58);t.getFirstInlineElement=function(e){var t=o.getFirstLeafNode(e);return t?r.default(e,t):null},t.getLastInlineElement=function(e){var t=o.getLastLeafNode(e);return t?r.default(e,t):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),o=n(8);function i(e,t){for(var n=function(e){return t?e.firstChild:e.lastChild},i=n(e);i&&n(i);)i=n(i);return i&&r.default(i)&&(i=o.getLeafSibling(e,i,t)),i}t.getFirstLeafNode=function(e){return i(e,!0)},t.getLastLeafNode=function(e){return i(e,!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.position=e,this.parentBlock=t}return e.prototype.getTextContent=function(){return""},e.prototype.getContainerNode=function(){return this.position.node},e.prototype.getParentBlock=function(){return this.parentBlock},e.prototype.getStartPosition=function(){return this.position},e.prototype.getEndPosition=function(){return this.position},e.prototype.isAfter=function(e){return e&&this.position.isAfter(e.getEndPosition())},e.prototype.isTextualInlineElement=function(){return!1},e.prototype.contains=function(e){return!1},e.prototype.applyStyle=function(e){},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(9),i=/[\s\u00A0\u200B\u3000]+([^\s\u00A0\u200B\u3000]*)$/i,a=function(){function e(e,t){this.rootNode=e,this.position=t,this.text="",this.inlineElements=[]}return e.prototype.getWordBefore=function(){var e=this;return this.word||this.traverse((function(){return e.word})),this.word},e.prototype.getInlineElementBefore=function(){return this.inlineBefore||this.traverse(null),this.inlineBefore},e.prototype.getInlineElementAfter=function(){return this.inlineAfter||(this.inlineAfter=r.default.createBlockTraverser(this.rootNode,this.position).currentInlineElement),this.inlineAfter},e.prototype.getSubStringBefore=function(e){var t=this;return this.text.length<e&&this.traverse((function(){return t.text.length>=e})),this.text.substr(Math.max(0,this.text.length-e))},e.prototype.getRangeFromText=function(e,t){if(!e)return null;var n,r,i=e.length-1;return this.forEachTextInlineElement((function(o){for(var a=o.getTextContent()||"",l=a.length-1;l>=0&&i>=0;l--)if(e.charCodeAt(i)==a.charCodeAt(l))i--,r||(r=o.getStartPosition().move(l+1));else if(t||r)return!0;return-1==i&&(n=o.getStartPosition().move(l+1),!0)})),n&&r&&o.default(n,r)},e.prototype.forEachTextInlineElement=function(e){this.inlineElements.some(e)||this.traverse(e)},e.prototype.getNearestNonTextInlineElement=function(){var e=this;return this.nearestNonTextInlineElement||this.traverse((function(){return e.nearestNonTextInlineElement})),this.nearestNonTextInlineElement},e.prototype.traverse=function(e){if(this.traverser=this.traverser||r.default.createBlockTraverser(this.rootNode,this.position),this.traverser&&!this.traversingComplete)for(var t=this.traverser.getPreviousInlineElement();!this.traversingComplete;){if(this.inlineBefore=this.inlineBefore||t,!t||!t.isTextualInlineElement()){this.nearestNonTextInlineElement=t,this.traversingComplete=!0,this.word||(this.word=this.text);break}var n=t.getTextContent();if(!this.word){var o=i.exec(n);o&&2==o.length&&(this.word=o[1]+this.text)}if(this.text=n+this.text,this.inlineElements.push(t),e&&e(t))break;t=this.traverser.getPreviousInlineElement()}},e}();t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(41),a=n(20),l=/^Version:[0-9\.]+\s+StartHTML:\s*([0-9]+)\s+EndHTML:\s*([0-9]+)\s+/i,s=((r={})["text/html"]=function(e,t){return e.rawHtml=a.Browser.isEdge?function(e){var t=l.exec(e);if(3==(null==t?void 0:t.length)){var n=parseInt(t[1]),r=parseInt(t[2]);n>0&&r>n&&(e=e.substring(n,r))}return e}(t):t},r["text/plain"]=function(e,t){return e.text=t},r["text/*"]=function(e,t,n){return e.customValues[n]=t},r);function u(e,t){try{e.customValues["link-preview"]=t,e.linkPreview=JSON.parse(t)}catch(e){}}t.default=function(e,t){var n={types:[],text:"",image:null,rawHtml:null,customValues:{}},r=o({},s);return(null==t?void 0:t.allowLinkPreview)&&(r["text/link-preview"]=u),Promise.all((e||[]).map((function(e){var o=e.type;if(0!=o.indexOf("image/")||n.image){var a=function(e,t){var n=0==e.indexOf("text/")?e.substr("text/".length):null;return n&&(null==t?void 0:t.indexOf(n))>=0?n:null}(o,null==t?void 0:t.allowedCustomPasteType),l=r[o]||(a?r["text/*"]:null);return new Promise((function(t){return l?e.getAsString((function(e){n.types.push(o),l(n,e,a),t()})):t()}))}return n.types.push(o),n.image=e.getAsFile(),new Promise((function(e){i.default(n.image,(function(t){n.imageDataUri=t,e()}))}))}))).then((function(){return n}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(41),o=n(5);t.default=function(e,t,n){for(var i,a={types:e.types?o.default(e.types):[],text:e.getData("text"),image:null,rawHtml:null,customValues:{}},l=0;l<(e.files?e.files.length:0);l++){var s=e.files.item(l);if(0==(null===(i=s.type)||void 0===i?void 0:i.indexOf("image/"))){a.image=s;break}}var u=function(){a.image?r.default(a.image,(function(e){a.imageDataUri=e,t(a)})):t(a)};if((null==n?void 0:n.getTempDiv)&&(null==n?void 0:n.removeTempDiv)){var c=n.getTempDiv();c.contentEditable="true",c.innerHTML="",c.focus(),c.ownerDocument.defaultView.setTimeout((function(){a.rawHtml=c.innerHTML,n.removeTempDiv(c),u()}),0)}else a.rawHtml=void 0,u()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r){var o="string"==typeof t?t.trim():"",i="string"==typeof t?null:t;if((o||i)&&(e.style.setProperty(n?"background-color":"color",(r?null==i?void 0:i.darkModeColor:null==i?void 0:i.lightModeColor)||o),e.dataset)){var a=n?"ogsb":"ogsc";r?i&&(e.dataset[a]=i.lightModeColor):delete e.dataset[a]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);t.default=function(e){if(r.default(e,"HTMLElement"))return e.innerHTML;if(e){var t=e.ownerDocument.createElement("span");return t.appendChild(e.cloneNode(!0)),t.innerHTML}return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(1),i=n(31);function a(e){for(;e.previousSibling;)if(e=e.previousSibling,"BR"==o.default(e)||!i.default(e))return!1;return!0}t.default=function(e,t){if(e){var n=e.normalize(),o=n.node;if(0==n.offset){for(;r.default(t,o)&&a(o);)o=o.parentNode;return o==t}}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(30),o=n(43),i=n(2),a=n(5),l=function(){function e(e,t){var n=this;if(this.trs=[],this.table=i.default(e,"HTMLTableElement")?e:function(e){for(var t=e;t&&"TABLE"!=t.tagName;t=t.parentElement);return t}(e),this.table){var r=i.default(e,"HTMLTableElement")?null:e,o=a.default(this.table.rows);this.cells=o.map((function(e){return[]})),o.forEach((function(e,t){n.trs[t%2]=e;for(var o=0,i=0;o<e.cells.length;o++){for(;n.cells[t][i];i++);var a=e.cells[o];a==r&&(n.col=i,n.row=t);for(var l=0;l<a.colSpan;l++,i++)for(var s=0;s<a.rowSpan;s++){var u=l+s==0,c=a.getBoundingClientRect();n.cells[t+s][i]={td:u?a:null,spanLeft:l>0,spanAbove:s>0,width:u?c.width:void 0,height:u?c.height:void 0}}}})),t&&this.normalizeSize()}}return e.prototype.writeBack=function(){var e=this;this.cells?(r.default(this.table),this.cells.forEach((function(t,n){var r=d(e.trs[n%2]||e.trs[0]);e.table.appendChild(r),t.forEach((function(t,o){t.td&&(e.recalculateSpans(n,o),r.appendChild(t.td))}))}))):this.table&&this.table.parentNode.removeChild(this.table)},e.prototype.applyFormat=function(e){e&&this.table&&(this.table.style.borderCollapse="collapse",this.trs[0].style.backgroundColor=e.bgColorOdd||"transparent",this.trs[1]&&(this.trs[1].style.backgroundColor=e.bgColorEven||"transparent"),this.cells.forEach((function(t){return t.filter((function(e){return e.td})).forEach((function(t){t.td.style.borderTop=u(e.topBorderColor),t.td.style.borderBottom=u(e.bottomBorderColor),t.td.style.borderLeft=u(e.verticalBorderColor),t.td.style.borderRight=u(e.verticalBorderColor)}))})))},e.prototype.edit=function(e){var t=this;if(this.table){var n=this.cells[this.row],o=n[this.col],i=o.td.style;switch(e){case 0:this.cells.splice(this.row,0,n.map(c));break;case 1:var a=this.row+this.countSpanAbove(this.row,this.col);this.cells.splice(a,0,this.cells[a-1].map((function(e,n){var r=t.getCell(a,n);if(r.spanAbove)return c(r);if(e.spanLeft){var o=c(e);return o.spanAbove=!1,o}return{td:d(t.getTd(t.row,n))}})));break;case 2:this.forEachCellOfCurrentColumn((function(e,n){n.splice(t.col,0,c(e))}));break;case 3:var l=this.col+this.countSpanLeft(this.row,this.col);this.forEachCellOfColumn(l-1,(function(e,n,r){var o,i=t.getCell(r,l);i.spanLeft?o=c(i):e.spanAbove?(o=c(e)).spanLeft=!1:o={td:d(t.getTd(r,t.col))},n.splice(l,0,o)}));break;case 6:this.forEachCellOfCurrentRow((function(e,n){var r=t.getCell(t.row+1,n);e.td&&e.td.rowSpan>1&&r.spanAbove&&(r.td=e.td)})),this.cells.splice(this.row,1);break;case 5:this.forEachCellOfCurrentColumn((function(e,n,r){var o=t.getCell(r,t.col+1);e.td&&e.td.colSpan>1&&o.spanLeft&&(o.td=e.td),n.splice(t.col,1)}));break;case 7:case 8:for(var s=7==e?-1:1,u=this.row+s;u>=0&&u<this.cells.length;u+=s){if((g=this.getCell(u,this.col)).td&&!g.spanAbove){var f=u<this.row?g:o,h=u<this.row?o:g;f.td.colSpan==h.td.colSpan&&(r.default(f.td,h.td,!0),h.td=null,h.spanAbove=!0);break}}break;case 9:case 10:for(var p=9==e?-1:1,v=this.col+p;v>=0&&v<this.cells[this.row].length;v+=p){var g;if((g=this.getCell(this.row,v)).td&&!g.spanLeft){var m=v<this.col?g:o,y=v<this.col?o:g;m.td.rowSpan==y.td.rowSpan&&(r.default(m.td,y.td,!0),y.td=null,y.spanLeft=!0);break}}break;case 4:this.cells=null;break;case 12:if(o.td.rowSpan>1)this.getCell(this.row+1,this.col).td=d(o.td);else{var b=n.map((function(e){return{td:e==o?d(e.td):null,spanAbove:e!=o,spanLeft:e.spanLeft}}));this.cells.splice(this.row+1,0,b)}break;case 11:o.td.colSpan>1?this.getCell(this.row,this.col+1).td=d(o.td):this.forEachCellOfCurrentColumn((function(e,r){r.splice(t.col+1,0,{td:r==n?d(e.td):null,spanAbove:e.spanAbove,spanLeft:r!=n})}));break;case 13:this.table.setAttribute("align","center");break;case 14:this.table.setAttribute("align","left");break;case 15:this.table.setAttribute("align","right");break;case 17:i.textAlign="center";break;case 16:i.textAlign="left";break;case 18:i.textAlign="right";break;case 19:i.verticalAlign="top";break;case 20:i.verticalAlign="middle";break;case 21:i.verticalAlign="bottom"}}},e.prototype.forEachCellOfCurrentColumn=function(e){this.forEachCellOfColumn(this.col,e)},e.prototype.getCellsWithBorder=function(e,t){for(var n=[],r=0;r<this.cells.length;r++)for(var i=0;i<this.cells[r].length;i++){var a=this.getCell(r,i);if(a.td){var l=o.default(a.td.getBoundingClientRect()),s=!1;if(t){if(l.right==e)s=!0,n.push(a.td);else if(s)break}else if(l.left==e)s=!0,n.push(a.td);else if(s)break}}return n},e.prototype.forEachCellOfCurrentRow=function(e){this.forEachCellOfRow(this.row,e)},e.prototype.getCell=function(e,t){return this.cells&&this.cells[e]&&this.cells[e][t]||{}},e.prototype.getCurrentTd=function(){return this.getTd(this.row,this.col)},e.prototype.getTd=function(e,t){if(this.cells&&(e=Math.min(this.cells.length-1,e),t=this.cells[e]?Math.min(this.cells[e].length-1,t):t,!isNaN(e)&&!isNaN(t)))for(;e>=0&&t>=0;){var n=this.getCell(e,t);if(n.td)return n.td;if(n.spanLeft)t--;else{if(!n.spanAbove)break;e--}}return null},e.prototype.forEachCellOfColumn=function(e,t){for(var n=0;n<this.cells.length;n++)t(this.getCell(n,e),this.cells[n],n)},e.prototype.forEachCellOfRow=function(e,t){for(var n=0;n<this.cells[e].length;n++)t(this.getCell(e,n),n)},e.prototype.recalculateSpans=function(e,t){var n=this.getCell(e,t).td;n&&(n.colSpan=this.countSpanLeft(e,t),n.rowSpan=this.countSpanAbove(e,t),1==n.colSpan&&n.removeAttribute("colSpan"),1==n.rowSpan&&n.removeAttribute("rowSpan"))},e.prototype.countSpanLeft=function(e,t){for(var n=1,r=t+1;r<this.cells[e].length;r++){var o=this.getCell(e,r);if(o.td||!o.spanLeft)break;n++}return n},e.prototype.countSpanAbove=function(e,t){for(var n=1,r=e+1;r<this.cells.length;r++){var o=this.getCell(r,t);if(o.td||!o.spanAbove)break;n++}return n},e.prototype.normalizeEmptyTableCells=function(){for(var e=0,t=void 0;t=this.table.rows[e];e++)for(var n=0,r=void 0;r=t.cells[n];n++)r&&(r.innerHTML&&r.innerHTML.trim()||r.appendChild(document.createElement("br")))},e.prototype.normalizeTableCellSize=function(){for(var e=0,t=void 0;t=this.table.rows[e];e++)t.removeAttribute("width"),t.style.width=null,t.removeAttribute("height"),t.style.height=null;for(e=0;e<this.cells.length;e++)for(var n=0;n<this.cells[e].length;n++){var r=this.cells[e][n];r&&s(r.td,r.width,r.height)}},e.prototype.normalizeSize=function(){this.normalizeEmptyTableCells(),this.normalizeTableCellSize(),s(this.table)},e}();function s(e,t,n){if(e){e.removeAttribute("width"),e.removeAttribute("height"),e.style.boxSizing="border-box";var r=e.getBoundingClientRect();e.style.width=(void 0!==t?t:r.width)+"px",e.style.height=(void 0!==n?n:r.height)+"px"}}function u(e){return"solid 1px "+(e||"transparent")}function c(e){return{td:d(e.td),spanAbove:e.spanAbove,spanLeft:e.spanLeft}}function d(e){var t=e?e.cloneNode(!1):null;return i.default(t,"HTMLTableCellElement")&&(t.removeAttribute("id"),t.firstChild||t.appendChild(e.ownerDocument.createElement("br"))),t}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(11),i=n(33),a=n(2),l=n(34);t.default=function(e,t){var n=function(e){var t,n=[],l=r.default.createBodyTraverser(e);for(;l.currentInlineElement!=t;){var s=(t=l.currentInlineElement).getContainerNode();if(s=o.default(s),a.default(s,"HTMLElement")){var u=i.default(s);u&&n.push(u)}l.getNextInlineElement()}return n}(e),s=i.default(e);t.forEach((function(e){var t=n.map((function(t){return void 0!==t[e]?t[e]:""}));t&&(1==t.length||1==new Set(t).size)&&t[0]&&(s[e]=t[0])})),l.default(e,s)}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(45),a=n(1),l=n(18),s=n(30),u=n(2),c=n(67),d=n(5),f=n(32),h=n(12),p=[null,"lower-alpha","lower-roman"],v=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.newListStart=void 0,!e)throw new Error("node must not be null");this.node=u.default(e,"HTMLLIElement")?e:h.default(e,4);var o=this.node.style.display;this.dummy="list-item"!=o&&""!=o,this.listTypes=r([0],t)}return e.prototype.getListType=function(){return this.listTypes[this.listTypes.length-1]},e.prototype.getLevel=function(){return this.listTypes.length-1},e.prototype.getNode=function(){return this.node},e.prototype.getNewListStart=function(){return this.newListStart},e.prototype.contains=function(e){return o.default(this.node,e,!0)},e.prototype.isDummy=function(){return this.dummy},e.prototype.isOrphanItem=function(){return!1},e.prototype.canMerge=function(e){return!(!(null==e?void 0:e.isOrphanItem())||this.listTypes.length!=e.listTypes.length)&&this.listTypes.every((function(t,n){return e.listTypes[n]==t}))},e.prototype.mergeItems=function(e){var t=this;m((null==e?void 0:e.map((function(e){return e.node})))||[],!0,!1).forEach((function(e){return t.node.appendChild(e)}))},e.prototype.indent=function(){var e=this.getListType();0!=e&&this.listTypes.push(e)},e.prototype.outdent=function(){this.listTypes.length>1&&this.listTypes.pop()},e.prototype.changeListType=function(e){0==e?this.listTypes=[e]:(this.outdent(),this.listTypes.push(e))},e.prototype.setIsDummy=function(e){this.dummy=e},e.prototype.setNewListStart=function(e){this.newListStart=e},e.prototype.writeBack=function(e,t){for(var n,r,o=1;o<e.length;o++)if(i.default(e[o])!==this.listTypes[o]){e.splice(o);break}for(;o<this.listTypes.length;o++){var l=g(e[0],this.listTypes[o],o,t);e[e.length-1].appendChild(l),e.push(l)}if(e[e.length-1].appendChild(this.node),this.node.style.display=this.dummy?"block":null,this.listTypes.length>1&&!(this.node.style.fontSize||this.node.style.color||this.node.style.fontFamily)){c.default(this.node,["font-size","font-family","color"])}this.listTypes.length<=1&&m("LI"==a.default(this.node)?(n=this.node,r=d.default(n.childNodes),f.default(n),r):[this.node],!0,!0)},e}();function g(e,t,n,r){var a,l=e.ownerDocument;return 1==n&&r&&t==i.default(r)?o.default(e,r)?(a=r.cloneNode(!1)).removeAttribute("id"):(s.default(r),a=r):a=l.createElement(1==t?"ol":"ul"),1==t&&n>1&&(a.style.listStyleType=p[(n-1)%p.length]),a}function m(e,t,n){return!(e.length>0)||t&&l.default(e[0])||n&&l.default(e[e.length])||(e=[h.default(e)]),e}t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);t.default=function(e,t,n){var o=e&&r.default(n,e.rootNode,t);if(o)for(var i=void 0;i=r.default(o.parentNode,e.rootNode,t);)o=i;return o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),o=n(19),i=n(6),a=n(46),l=n(22);t.default=function(e,t){var n=a.default(e),s=[];if(n){for(var u=e.rootNode,c=e.skipTags,d=r.default.createSelectionTraverser(u,n,c),f=null==d?void 0:d.currentBlockElement;f;f=d.getNextBlockElement())s.push(f);s=s.filter((function(e){var t,n=e.getStartNode();return n!=e.getEndNode()||!l.default(n,!0)||(null===(t=n.parentNode)||void 0===t||t.removeChild(n),!1)}))}if(0==s.length&&e&&!e.rootNode.firstChild&&t){var h=o.default(1,e.rootNode.ownerDocument);e.rootNode.appendChild(h),s.push(i.default(e.rootNode,h))}return s}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(11),a=n(4),l=n(13),s=n(8),u=((r={})[0]={skipTags:["TABLE"],outerSelector:"table",innerSelector:"td,th"},r);function c(e,t){var n=a.default.getStart(e).normalize(),r=a.default.getEnd(e).normalize();return function(e,i,a){return function(e,t,n,r){if(e){var i=t&&s.getNextLeafSibling(e,t,r),a=n&&s.getPreviousLeafSibling(e,n,r),l=!t||o.default(e,t)&&o.default(e,i),u=!n||o.default(e,n)&&o.default(e,a),c=!(t&&n&&(o.default(t,n,!0)||o.default(t,a,!0)||o.default(n,t,!0)||o.default(n,i,!0)));return l&&u&&c}return!1}(e,i,a,t)?{rootNode:e,nodeBefore:i,nodeAfter:a,skipTags:t,fullSelectionStart:n,fullSelectionEnd:r}:null}}t.default=function(e,t,n){var r=[];if(e&&t){var a=u[n],s=a.innerSelector,d=a.skipTags,f=function(e,t,n){var r=[{innerNode:e,children:[]}],a=u[n],s=a.outerSelector,c=a.innerSelector,d=l.default(e,s,null,2,t);return l.default(e,c,(function(t){var n=i.default(t,e,s);if(n&&d.indexOf(n)<0){for(var a={innerNode:t,children:[]},l=r.length-1;l>=0;l--){var u=r[l],c=u.innerNode,f=u.children;if(o.default(c,n)){var h=f.filter((function(e){return e.outerNode==n}))[0];h||(h={outerNode:n,boundaries:[]},f.push(h)),h.boundaries.push(a);break}}r.push(a)}}),1,t),r[0]}(e,t,n),h=i.default(t.startContainer,e,s)||e,p=i.default(t.endContainer,e,s)||e;r=function e(t,n,r,o,i){var a;i=i||n.innerNode==r;var l=!1,s=n.children,u=n.innerNode,c=[];if(0==s.length)c.push(t(u));else for(var d=0;d<=s.length&&!l;d++){var f=s[d]||{},h=f.outerNode,p=f.boundaries,v=null===(a=s[d-1])||void 0===a?void 0:a.outerNode;i&&c.push(t(u,v,h)),null==p||p.forEach((function(n){var a,s;s=(a=e(t,n,r,o,i))[0],i=a[1],l=a[2],c=c.concat(s)}))}return[c,i,l||u==o]}(c(t,d),f,h,p)[0]}return r.filter((function(e){return!!e}))},t.getRegionCreator=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(24),i=n(2);t.default=function(e,t){if(!t||0==t.length)return[];var n=i.default(t[0],"Node")?t:[t[0].getStartNode(),t[t.length-1].getEndNode()],a=(n=n&&n.filter((function(t){return o.default(e,t)})))[0],l=n[n.length-1];return o.default(e,a)&&o.default(e,l)?r.default(e.rootNode,a,l,!0):[]}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(23),i=n(3),a=n(6),l=n(74),s=n(33),u=n(24),c=n(2),d=n(34),f=n(17);t.default=function(e,t,n){var h,p,v;if(u.default(e,t)&&u.default(e,n)&&(v=a.default(e.rootNode,n))&&!v.contains(t)){for(var g=v.collapseToSingleElement(),m=f.collapse(e.rootNode,g,t,!1,!0),y=g;i.default(m,y);){var b=y.parentNode;if(c.default(b,"HTMLElement")){var E=r(r(r({},l.default(b)||{}),s.default(b)),s.default(g));d.default(g,E)}y=b}var C=null,w=1==g.childNodes.length&&0==g.attributes.length?g.firstChild:o.default(g,"SPAN");for(y=w;i.default(m,y)&&1==y.parentNode.childNodes.length;y=y.parentNode)C=y.parentNode;null===(h=t.parentNode)||void 0===h||h.insertBefore(w,t.nextSibling),null===(p=null==C?void 0:C.parentNode)||void 0===p||p.removeChild(C)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o={B:{"font-weight":"bold"},EM:{"font-style":"italic"},I:{"font-style":"italic"},U:{"text-decoration":"underline"},P:{"margin-top":"1em","margin-bottom":"1em"},PRE:{"white-space":"pre"},S:{"text-decoration":"line-through"},STRIKE:{"text-decoration":"line-through"},SUB:{"vertical-align":"sub","font-size":"smaller"},SUP:{"vertical-align":"super","font-size":"smaller"}};t.default=function(e,t){var n=r.default(e);return o[n]||(t||{})[n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(4);function i(e,t){if(!e||!t)return[];var n,o=e.node,i=e.offset,a=[];if(!r.default(t,o,!0))return[];if(3==o.nodeType){for(n=o.parentNode;o.previousSibling&&3==o.previousSibling.nodeType;)i+=o.previousSibling.nodeValue.length,o=o.previousSibling;a.unshift(i)}else n=o,o=o.childNodes[i];do{i=0;for(var l=!1,s=n.firstChild;s&&s!=o;s=s.nextSibling){if(3==s.nodeType){if(0==s.nodeValue.length||l)continue;l=!0}else l=!1;i++}a.unshift(i),o=n,n=n.parentNode}while(o&&o!=t);return a}t.default=function(e,t){return t?{start:i(o.default.getStart(t),e),end:i(o.default.getEnd(t),e)}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(47);t.default=function(e){if(r.default(e,1)){for(var t=0,n=e.currentIndex+1;n<e.snapshots.length;n++)t+=e.snapshots[n].length;e.snapshots.splice(e.currentIndex+1),e.totalSize-=t,e.autoCompleteIndex=-1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="border-spacing,caption-side,color,cursor,direction,empty-cells,font-family,font-size,font-style,font-variant,font-weight,font,letter-spacing,line-height,list-style-image,list-style-position,list-style-type,list-style,orphans,quotes,text-align,text-indent,text-transform,visibility,white-space,widows,word-spacing".split(",");t.default=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView,n=t&&t.getComputedStyle(e),o={};return r.forEach((function(e){return o[e]=n&&n.getPropertyValue(e)||""})),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign?function(e,t){return Object.assign(t||{},e)}:function(e,t){var n=t||{};if(e)for(var r=0,o=Object.keys(e);r<o.length;r++){var i=o[r];n[i]=e[i]}return n};t.cloneObject=function(e,t){return r(e,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.ctrlKey||"Control"===e.key,n=e.altKey||"Alt"===e.key,r=e.metaKey||"Meta"===e.key;return t||n||r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.hasFocus=function(e){var t=e.contentDiv.ownerDocument.activeElement;return t&&r.contains(e.contentDiv,t,!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(167);t.getDarkColor=r.default},function(e,t,n){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(e,t,n){var r=n(82),o={};for(var i in r)r.hasOwnProperty(i)&&(o[r[i]]=i);var a=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var l in a)if(a.hasOwnProperty(l)){if(!("channels"in a[l]))throw new Error("missing channels property: "+l);if(!("labels"in a[l]))throw new Error("missing channel labels property: "+l);if(a[l].labels.length!==a[l].channels)throw new Error("channel and label counts mismatch: "+l);var s=a[l].channels,u=a[l].labels;delete a[l].channels,delete a[l].labels,Object.defineProperty(a[l],"channels",{value:s}),Object.defineProperty(a[l],"labels",{value:u})}a.rgb.hsl=function(e){var t,n,r=e[0]/255,o=e[1]/255,i=e[2]/255,a=Math.min(r,o,i),l=Math.max(r,o,i),s=l-a;return l===a?t=0:r===l?t=(o-i)/s:o===l?t=2+(i-r)/s:i===l&&(t=4+(r-o)/s),(t=Math.min(60*t,360))<0&&(t+=360),n=(a+l)/2,[t,100*(l===a?0:n<=.5?s/(l+a):s/(2-l-a)),100*n]},a.rgb.hsv=function(e){var t,n,r,o,i,a=e[0]/255,l=e[1]/255,s=e[2]/255,u=Math.max(a,l,s),c=u-Math.min(a,l,s),d=function(e){return(u-e)/6/c+.5};return 0===c?o=i=0:(i=c/u,t=d(a),n=d(l),r=d(s),a===u?o=r-n:l===u?o=1/3+t-r:s===u&&(o=2/3+n-t),o<0?o+=1:o>1&&(o-=1)),[360*o,100*i,100*u]},a.rgb.hwb=function(e){var t=e[0],n=e[1],r=e[2];return[a.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(n,r))),100*(r=1-1/255*Math.max(t,Math.max(n,r)))]},a.rgb.cmyk=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-r,1-o)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-o-t)/(1-t)||0),100*t]},a.rgb.keyword=function(e){var t=o[e];if(t)return t;var n,i,a,l=1/0;for(var s in r)if(r.hasOwnProperty(s)){var u=r[s],c=(i=e,a=u,Math.pow(i[0]-a[0],2)+Math.pow(i[1]-a[1],2)+Math.pow(i[2]-a[2],2));c<l&&(l=c,n=s)}return n},a.keyword.rgb=function(e){return r[e]},a.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*n+.0722*r),100*(.0193*t+.1192*n+.9505*r)]},a.rgb.lab=function(e){var t=a.rgb.xyz(e),n=t[0],r=t[1],o=t[2];return r/=100,o/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(n-r),200*(r-(o=o>.008856?Math.pow(o,1/3):7.787*o+16/116))]},a.hsl.rgb=function(e){var t,n,r,o,i,a=e[0]/360,l=e[1]/100,s=e[2]/100;if(0===l)return[i=255*s,i,i];t=2*s-(n=s<.5?s*(1+l):s+l-s*l),o=[0,0,0];for(var u=0;u<3;u++)(r=a+1/3*-(u-1))<0&&r++,r>1&&r--,i=6*r<1?t+6*(n-t)*r:2*r<1?n:3*r<2?t+(n-t)*(2/3-r)*6:t,o[u]=255*i;return o},a.hsl.hsv=function(e){var t=e[0],n=e[1]/100,r=e[2]/100,o=n,i=Math.max(r,.01);return n*=(r*=2)<=1?r:2-r,o*=i<=1?i:2-i,[t,100*(0===r?2*o/(i+o):2*n/(r+n)),100*((r+n)/2)]},a.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,o=Math.floor(t)%6,i=t-Math.floor(t),a=255*r*(1-n),l=255*r*(1-n*i),s=255*r*(1-n*(1-i));switch(r*=255,o){case 0:return[r,s,a];case 1:return[l,r,a];case 2:return[a,r,s];case 3:return[a,l,r];case 4:return[s,a,r];case 5:return[r,a,l]}},a.hsv.hsl=function(e){var t,n,r,o=e[0],i=e[1]/100,a=e[2]/100,l=Math.max(a,.01);return r=(2-i)*a,n=i*l,[o,100*(n=(n/=(t=(2-i)*l)<=1?t:2-t)||0),100*(r/=2)]},a.hwb.rgb=function(e){var t,n,r,o,i,a,l,s=e[0]/360,u=e[1]/100,c=e[2]/100,d=u+c;switch(d>1&&(u/=d,c/=d),r=6*s-(t=Math.floor(6*s)),0!=(1&t)&&(r=1-r),o=u+r*((n=1-c)-u),t){default:case 6:case 0:i=n,a=o,l=u;break;case 1:i=o,a=n,l=u;break;case 2:i=u,a=n,l=o;break;case 3:i=u,a=o,l=n;break;case 4:i=o,a=u,l=n;break;case 5:i=n,a=u,l=o}return[255*i,255*a,255*l]},a.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,r=e[2]/100,o=e[3]/100;return[255*(1-Math.min(1,t*(1-o)+o)),255*(1-Math.min(1,n*(1-o)+o)),255*(1-Math.min(1,r*(1-o)+o))]},a.xyz.rgb=function(e){var t,n,r,o=e[0]/100,i=e[1]/100,a=e[2]/100;return n=-.9689*o+1.8758*i+.0415*a,r=.0557*o+-.204*i+1.057*a,t=(t=3.2406*o+-1.5372*i+-.4986*a)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(r=Math.min(Math.max(0,r),1))]},a.xyz.lab=function(e){var t=e[0],n=e[1],r=e[2];return n/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},a.lab.xyz=function(e){var t,n,r,o=e[0];t=e[1]/500+(n=(o+16)/116),r=n-e[2]/200;var i=Math.pow(n,3),a=Math.pow(t,3),l=Math.pow(r,3);return n=i>.008856?i:(n-16/116)/7.787,t=a>.008856?a:(t-16/116)/7.787,r=l>.008856?l:(r-16/116)/7.787,[t*=95.047,n*=100,r*=108.883]},a.lab.lch=function(e){var t,n=e[0],r=e[1],o=e[2];return(t=360*Math.atan2(o,r)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(r*r+o*o),t]},a.lch.lab=function(e){var t,n=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[n,r*Math.cos(t),r*Math.sin(t)]},a.rgb.ansi16=function(e){var t=e[0],n=e[1],r=e[2],o=1 in arguments?arguments[1]:a.rgb.hsv(e)[2];if(0===(o=Math.round(o/50)))return 30;var i=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===o&&(i+=60),i},a.hsv.ansi16=function(e){return a.rgb.ansi16(a.hsv.rgb(e),e[2])},a.rgb.ansi256=function(e){var t=e[0],n=e[1],r=e[2];return t===n&&n===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(r/255*5)},a.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(e>50));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},a.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},a.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},a.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map((function(e){return e+e})).join(""));var r=parseInt(n,16);return[r>>16&255,r>>8&255,255&r]},a.rgb.hcg=function(e){var t,n=e[0]/255,r=e[1]/255,o=e[2]/255,i=Math.max(Math.max(n,r),o),a=Math.min(Math.min(n,r),o),l=i-a;return t=l<=0?0:i===n?(r-o)/l%6:i===r?2+(o-n)/l:4+(n-r)/l+4,t/=6,[360*(t%=1),100*l,100*(l<1?a/(1-l):0)]},a.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=1,o=0;return(r=n<.5?2*t*n:2*t*(1-n))<1&&(o=(n-.5*r)/(1-r)),[e[0],100*r,100*o]},a.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,r=t*n,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,r=e[2]/100;if(0===n)return[255*r,255*r,255*r];var o,i=[0,0,0],a=t%1*6,l=a%1,s=1-l;switch(Math.floor(a)){case 0:i[0]=1,i[1]=l,i[2]=0;break;case 1:i[0]=s,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=l;break;case 3:i[0]=0,i[1]=s,i[2]=1;break;case 4:i[0]=l,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=s}return o=(1-n)*r,[255*(n*i[0]+o),255*(n*i[1]+o),255*(n*i[2]+o)]},a.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),r=0;return n>0&&(r=t/n),[e[0],100*r,100*n]},a.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,r=0;return n>0&&n<.5?r=t/(2*n):n>=.5&&n<1&&(r=t/(2*(1-n))),[e[0],100*r,100*n]},a.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},a.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,r=n-t,o=0;return r<1&&(o=(n-r)/(1-r)),[e[0],100*r,100*o]},a.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},a.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},a.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},a.gray.hsl=a.gray.hsv=function(e){return[0,0,e[0]]},a.gray.hwb=function(e){return[0,100,e[0]]},a.gray.cmyk=function(e){return[0,0,0,e[0]]},a.gray.lab=function(e){return[e[0],0,0]},a.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},a.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(174)),r(n(213)),r(n(216)),r(n(219)),r(n(222)),r(n(225)),r(n(233)),r(n(236)),r(n(250)),r(n(253)),r(n(256))},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(177),i=n(205),a=n(206),l=n(207),s=n(208),u=n(209),c=n(210),d=n(211),f=n(212),h=r(r(r(r(r(r(r(r(r({},l.ListFeatures),u.QuoteFeatures),f.TableFeatures),d.StructuredNodeFeatures),o.AutoLinkFeatures),c.ShortcutFeatures),i.CursorFeatures),s.MarkdownFeatures),a.EntityFeatures);t.default=function(){return h}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),o=n(10),i=n(88),a=n(89),l=n(90),s=n(91),u=n(92),c=n(93),d=n(94),f=n(0),h=["font","text-decoration","color","background"],p="B,I,U,STRONG,EM,SUB,SUP,STRIKE,FONT,CENTER,H1,H2,H3,H4,H5,H6,UL,OL,LI,SPAN,P,BLOCKQUOTE,CODE,S,PRE".split(","),v=["href","src"],g=["TD","TH","TR","TABLE","TBODY","THEAD"];function m(e){var t=f.toArray(e.childNodes).map(m).every((function(e){return e})),n=f.isBlockElement(e),r=f.getTagOfNode(e);return r&&(p.indexOf(r)>=0||t&&!f.isVoidHtmlElement(e)&&g.indexOf(r)<0?(n&&!t&&f.wrap(e),f.unwrap(e)):function(e){for(var t=f.safeInstanceOf(e,"HTMLTableCellElement"),n=0,r=f.toArray(e.attributes);n<r.length;n++){var o=r[n];t&&"style"==o.name?y(e):v.indexOf(o.name.toLowerCase())<0&&0!=o.name.indexOf("data-")&&e.removeAttribute(o.name)}}(e)),n}function y(e){var t=f.getStyles(e),n={};return Object.keys(t).forEach((function(e){e.indexOf("border")<0&&(n[e]=t[e],delete t[e])})),f.setStyles(e,t),n}function b(e){r.default(e,(function(t){var n=f.getSelectedBlockElementsInRegion(t),r=f.collapseNodesInRegion(t,n);if(e.contains(t.rootNode)){var o=y(t.rootNode);if(Object.keys(o).length>0){var i=f.wrap(f.toArray(t.rootNode.childNodes));f.setStyles(i,o)}}for(;r.length>0&&f.isNodeInRegion(t,r[0].parentNode);)r=[f.splitBalancedNodeRange(r)];r.forEach(m)}))}function E(e,t){switch(void 0===t&&(t=0),t){case 0:!function(e){e.focus(),e.addUndoSnapshot((function(){o.default(e,"removeFormat"),e.queryElements("[class]",1,(function(e){return e.removeAttribute("class")}));var t=e.getDefaultFormat(),n=0===Object.keys(t).length;if(e.queryElements("[style]",2,(function(e){h.forEach((function(t){return e.style.removeProperty(t)})),n&&""===e.getAttribute("style")&&e.removeAttribute("style")})),!n){if(t.fontFamily&&a.default(e,t.fontFamily),t.fontSize&&l.default(e,t.fontSize),t.textColor){var r=e.queryElements("a *, a",1),f=r.length>0?function(e){return-1==r.indexOf(e)}:null;t.textColors?s.default(e,t.textColors,f):s.default(e,t.textColor,f)}t.backgroundColor&&(t.backgroundColors?i.default(e,t.backgroundColors):i.default(e,t.backgroundColor)),t.bold&&u.default(e),t.italic&&c.default(e),t.underline&&d.default(e)}}),"Format")}(e);break;case 1:b(e);break;default:!function(e){if(!function(e){var t=e.getSelectionTraverser();return!!t.currentBlockElement&&!!t.getNextBlockElement()}(e)&&e.getSelectionTraverser().currentInlineElement instanceof f.PartialInlineElement)return void E(e);b(e)}(e)}}t.default=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){if((null==t?void 0:t.length)>0){var n=e.getSelectionRange(),o=n&&r.Position.getStart(n),i=n&&r.Position.getEnd(n);t.forEach((function(e){return e.commit()})),e.select(o,i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),o=n(0);t.default=function(e,t){r.default(e,(function(n,r){o.setColor(n,r?"":t,!0,e.isDarkMode())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(48);t.default=function(e,t){r.default(e,"font-family",(function(e,n){e.style.fontFamily=n?"":t}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(48),o=n(0);t.default=function(e,t){r.default(e,"font-size",(function(e,n){e.style.fontSize=n?"":t,"normal"!=o.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(48),o=n(0);t.default=function(e,t,n){r.default(e,"color",(function(r,i){n&&!n(r)||o.setColor(r,i?"":t,!1,e.isDarkMode())}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"bold")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"italic")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"underline")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),o=n(0);t.default=function(e,t,n){r.default(e,(function(e){var n=o.getSelectedBlockElementsInRegion(e,!0),r=o.collapseNodesInRegion(e,n);if(r.length>0){if(1==r.length){var i=o.getTagOfNode(r[0]);"BR"==i?r=[o.wrap(r[0])]:"LI"!=i&&"TD"!=i||(r=o.toArray(r[0].childNodes))}for(;r[0]&&o.isNodeInRegion(e,r[0].parentNode)&&r.some((function(e){return"LI"==o.getTagOfNode(e)}));)r=[o.splitBalancedNodeRange(r)];t(r)}}),n)}},function(e,t,n){"use strict";var r,o,i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var l=n(97),s=n(99),u=n(228),c=n(50),d=n(229),f=n(26),h=n(230),p=n(7),v=n(0),g=n(100),m=2*Math.PI/8,y=["nw","n","ne","e","se","s","sw","w"],b=((r={}).SingleDirectionResize=2,r.ImageRotate=4,r.ImageCrop=8,r),E={borderColor:"#DB626C",minWidth:10,minHeight:10,preserveRatio:!1,minRotateDeg:5,imageSelector:"img",rotateIconHTML:null},C=((o={})[1]=g.getCornerResizeHTML,o[2]=g.getSideResizeHTML,o[4]=h.getRotateHTML,o[8]=d.getCropHTML,o),w=function(){function e(e){var t=this;this.allowedOperations=1,this.onBlur=function(){t.setEditingImage(null)},this.removeWrapper=function(e){var t=null==e?void 0:e.parentNode,n=null==e?void 0:e.querySelector("img");n&&t&&(n.style.position="",n.style.margin=null,n.style.textAlign=null,t.insertBefore(n,e),t.removeChild(e))},this.updateWrapper=function(e){var n,r=t.getImageWrapper(t.image);if(r){var o=O(r,"r_cropC"),i=O(r,"r_cropO"),a=O(r,"r_rotateC")[0],l=O(r,"r_rotateH")[0],s=O(r,"r_resizeH"),u=O(r,"r_cropH"),d=1==o.length&&4==i.length,f=t.editInfo,p=f.angleRad,m=f.bottomPercent,y=f.leftPercent,b=f.rightPercent,E=f.topPercent,C=c.default(t.editInfo,d),w=C.targetWidth,N=C.targetHeight,T=C.originalWidth,M=C.originalHeight,_=C.visibleWidth,k=C.visibleHeight,L=(w-_)/2,I=(N-k)/2,R=T*y,A=T*b,D=M*E,B=M*m;if(r.style.width=P(_),r.style.height=P(k),r.style.margin=I+"px "+L+"px",r.style.transform="rotate("+p+"rad)",r.style.textAlign=(n=r.parentNode,v.safeInstanceOf(n,"HTMLElement")&&"rtl"==v.getComputedStyle(n,"direction")?"right":"left"),t.image.style.width=P(T),t.image.style.height=P(M),d)S(o[0],R,D,A,B,void 0,void 0),S(i[0],0,0,A,void 0,void 0,D),S(i[1],void 0,0,0,B,A,void 0),S(i[2],R,void 0,0,0,void 0,B),S(i[3],0,D,void 0,0,R,void 0),x(u,p);else{if(t.image.style.margin=-D+"px 0 0 "+-R+"px","r_resizeH"==(null==e?void 0:e.elementClass)){var j=r.clientWidth,z=r.clientHeight;t.wasResized=!0,g.doubleCheckResize(t.editInfo,t.options.preserveRatio,j,z),t.updateWrapper()}h.updateRotateHandlePosition(t.editInfo,t.editor.getRelativeDistanceToEditor(r,!0),I,a,l),x(s,p)}}},this.options=i(i({},E),e||{})}return e.prototype.getName=function(){return"ImageEdit"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=e.addDomEventHandler("blur",this.onBlur),Object.keys(b).forEach((function(e){t.allowedOperations|=t.editor.isFeatureEnabled(e)?b[e]:0}))},e.prototype.dispose=function(){this.clearDndHelpers(),this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 5:this.setEditingImage(null);break;case 6:var t=e.rawEvent.target;e.isClicking&&0==e.rawEvent.button&&v.safeInstanceOf(t,"HTMLImageElement")&&t.isContentEditable&&v.matchesSelector(t,this.options.imageSelector)&&this.setEditingImage(t,7);break;case 0:var n=e.rawEvent.which;46==n||8==n?this.setEditingImage(null,!0):27==n&&this.image?(this.editInfo=f.getEditInfoFromImage(this.image),this.setEditingImage(null),e.rawEvent.preventDefault()):16!=n&&17!=n&&18!=n&&this.setEditingImage(null,!0);break;case 7:"InsertEntity"==e.source&&"IMAGE_EDIT_WRAPPER"==e.data.type||this.editor.queryElements(v.getEntitySelector("IMAGE_EDIT_WRAPPER"),this.removeWrapper);break;case 15:"IMAGE_EDIT_WRAPPER"==e.entity.type&&(8==e.operation?this.removeWrapper(e.entity.wrapper):1==e.operation&&e.rawEvent.preventDefault());break;case 8:v.toArray(e.clonedRoot.querySelectorAll(this.options.imageSelector)).forEach((function(e){f.deleteEditInfo(e)}))}},e.prototype.setEditingImage=function(e,t){var n=this,r="number"==typeof t?t:0,o="number"!=typeof t&&!!t;this.image&&(this.clearDndHelpers(),l.default(this.editor,this.image,this.editInfo,this.lastSrc,this.wasResized)&&this.editor.addUndoSnapshot((function(){return n.image}),"ImageResize"),(i=this.getImageWrapper(this.image))&&this.removeWrapper(i),o&&this.editor.select(this.image),this.image=null,this.editInfo=null,this.lastSrc=null);if(!this.image&&(null==e?void 0:e.isContentEditable)){this.editor.addUndoSnapshot(),this.image=e,this.editInfo=f.getEditInfoFromImage(e),this.wasResized=function(e){var t=e.width,n=e.height,r=e.style;return!(""!==r.maxWidth&&"initial"!==r.maxWidth&&"auto"!==r.maxWidth||!(T(r.height)||T(r.width)||T(t)||T(n)))}(this.image),r=(s.default(e)?r:3)&this.allowedOperations;var i=this.createWrapper(r);this.updateWrapper(),this.dndHelpers=a(this.createDndHelpers("r_resizeH",g.Resizer),this.createDndHelpers("r_rotateH",h.Rotator),this.createDndHelpers("r_cropH",d.Cropper),this.createDndHelpers("r_cropC",d.Cropper)),this.editor.select(i,-3)}},e.prototype.createWrapper=function(e){var t=this,n=p.insertEntity(this.editor,"IMAGE_EDIT_WRAPPER",v.wrap(this.image,6),!1,!0).wrapper;n.style.position="relative",n.style.maxWidth="100%",n.style.verticalAlign="bottom",n.style.display=v.Browser.isSafari?"inline-block":"inline-flex",this.lastSrc=this.image.src,this.image.src=this.editInfo.src,this.image.style.position="absolute",this.image.style.maxWidth=null;var r={borderColor:this.options.borderColor,rotateIconHTML:this.options.rotateIconHTML,rotateHandleBackColor:this.editor.isDarkMode()?"#333":"white"},o=[];return Object.keys(C).forEach((function(t){(e&t)==t&&v.arrayPush(o,C[t](r))})),o.forEach((function(e){var r=v.createElement(e,t.image.ownerDocument);r&&n.appendChild(r)})),n},e.prototype.getImageWrapper=function(e){var t,n=v.getEntityFromElement(null===(t=null==e?void 0:e.parentNode)||void 0===t?void 0:t.parentNode);return"IMAGE_EDIT_WRAPPER"==(null==n?void 0:n.type)?n.wrapper:null},e.prototype.createDndHelpers=function(e,t){var n=this,r={editInfo:this.editInfo,options:this.options,elementClass:e},o=this.getImageWrapper(this.image);return o?O(o,e).map((function(e){return new u.default(e,i(i({},r),{x:e.dataset.x,y:e.dataset.y}),n.updateWrapper,t)})):[]},e.prototype.clearDndHelpers=function(){var e;null===(e=this.dndHelpers)||void 0===e||e.forEach((function(e){return e.dispose()})),this.dndHelpers=null},e}();function S(e,t,n,r,o,i,a){e.style.left=P(t),e.style.top=P(n),e.style.right=P(r),e.style.bottom=P(o),e.style.width=P(i),e.style.height=P(a)}function P(e){return void 0===e?null:e+"px"}function O(e,t){return v.toArray(e.querySelectorAll("."+t))}function N(e,t){var n=function(e){var t=Math.round(e/m)%8;return t<0?t+8:t}(t),r=e.dataset.y+e.dataset.x,o=y.indexOf(r);return y[(o>=0&&o+n)%8]}function x(e,t){e.map((function(e){e.style.cursor=N(e,t)+"-resize"}))}function T(e){var t="string"==typeof e?parseInt(e):e;return!isNaN(t)}t.default=w},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(98),o=n(227),i=n(50),a=n(26);t.default=function(e,t,n,l,s){var u="",c=a.getEditInfoFromImage(t);switch(r.default(n,c)){case 1:u=n.src;break;case 2:u=l;break;case 3:u=o.default(t,n)}var d=u!=l;d&&(u=e.triggerPluginEvent(19,{image:t,originalSrc:n.src,previousSrc:l,newSrc:u}).newSrc),u==n.src?a.deleteEditInfo(t):a.saveEditInfo(t,n);var f=i.default(n),h=f.targetWidth,p=f.targetHeight;return t.src=u,function(e,t,n,r){t?(e.style.maxWidth="initial",e.width=n,e.height=r,e.style.width=n+"px",e.style.height=r+"px"):(e.style.maxWidth="100%",e.style.height="initial",e.style.width="initial",e.removeAttribute("height"),e.removeAttribute("width"))}(t,s,h,p),d||n.widthPx!=c.widthPx||n.heightPx!=c.heightPx}},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=["angleRad"],i=["leftPercent","rightPercent","topPercent","bottomPercent"],a=r(o,i),l=r(a,["widthPx","heightPx"]);function s(e,t){return Math.abs(e-t)<.001}t.default=function(e,t){return e&&e.src&&!l.some((function(t){return!("number"==typeof e[t])}))?a.every((function(t){return s(e[t],0)}))?1:t&&o.every((function(t){return s(e[t],0)}))&&o.every((function(e){return s(t[e],0)}))&&i.every((function(n){return s(e[n],t[n])}))?2:3:0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return!1;try{var t=e.ownerDocument.createElement("canvas");t.width=10,t.height=10;var n=t.getContext("2d");return n.drawImage(e,0,0),n.getImageData(0,0,1,1),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=["w","","e"],i=["s","","n"];function a(e,t,n){if(0==e&&0==t)return[0,0];var r=Math.sqrt(e*e+t*t);return n=Math.atan2(t,e)-n,[r*Math.cos(n),r*Math.sin(n)]}function l(e,t,n){var r="w"==e?"left":"right",o="n"==t?"top":"bottom";return""==e&&""==t?{tag:"div",style:"position:absolute;left:0;right:0;top:0;bottom:0;border:solid 1px "+n+";pointer-events:none"}:{tag:"div",style:"position:absolute;"+r+":"+(""==e?"50%":"0px")+";"+o+":"+(""==t?"50%":"0px"),children:[{tag:"div",style:"position:relative;width:7px;height:7px;background-color: "+n+";cursor:"+(t+e)+"-resize;"+o+":-3px;"+r+":-3px",className:"r_resizeH",dataset:{x:e,y:t}}]}}t.Resizer={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,o){var i,l=e.x,s=e.y,u=e.editInfo,c=e.options,d=n.widthPx>0&&n.heightPx>0?1*n.widthPx/n.heightPx:0;r=(i=a(r,o,u.angleRad))[0],o=i[1];var f=""==l,h=""==s,p=!(f||h)&&(c.preserveRatio||t.shiftKey),v=f?n.widthPx:Math.max(n.widthPx+r*("w"==l?-1:1),c.minWidth),g=h?n.heightPx:Math.max(n.heightPx+o*("n"==s?-1:1),c.minHeight);return p&&d>0&&(g=Math.min(g,v/d),(v=Math.min(v,g*d))<g*d?v=g*d:g=v/d),u.widthPx=v,u.heightPx=g,!0}},t.rotateCoordinate=a,t.doubleCheckResize=function(e,t,n,r){var o=e.widthPx,i=e.heightPx,a=i>0?o/i:0;n=Math.floor(n),r=Math.floor(r),o=Math.floor(o),i=Math.floor(i),e.widthPx=n,e.heightPx=r,t&&a>0&&(o!==n||i!==r)&&(n<o?e.heightPx=n/a:e.widthPx=r*a)},t.getCornerResizeHTML=function(e){var t=e.borderColor,n=[];return o.forEach((function(e){return i.forEach((function(r){return n.push(""==e==(""==r)?l(e,r,t):null)}))})),n},t.getSideResizeHTML=function(e){var t=e.borderColor,n=[];return o.forEach((function(e){return i.forEach((function(r){return n.push(""==e!=(""==r)?l(e,r,t):null)}))})),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.naturalWidth,r=e.naturalHeight,o=e.leftPercent,i=e.topPercent;return{width:n*(1-o-e.rightPercent)*t,height:r*(1-i-e.bottomPercent)*t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(101),o=n(26);t.default=function(e,t){var n=o.getEditInfoFromImage(e),i=r.default(n,t),a=i.width,l=i.height;return Math.round(a)==Math.round(n.widthPx)&&Math.round(l)==Math.round(n.heightPx)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){var n=t.getAttribute("NodeId");return n||(n=e.nextNodeId.toString(),e.nextNodeId++,t.setAttribute("NodeId",n)),n}t.createCustomData=function(){return{dict:{},nextNodeId:1}},t.setObject=function(e,t,n,o){if(1==t.nodeType){var i=r(e,t);""!=i&&(e.dict[i]||(e.dict[i]={}),e.dict[i][n]=o)}},t.getObject=function(e,t,n){if(1==t.nodeType){var o=r(e,t);if(""!=o)return e.dict[o]&&e.dict[o][n]}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLevelLists=function(){return{listsMetadata:{},currentUniqueListId:-1}}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var o=n(106);t.createEditor=o.default,r(n(259)),r(n(0)),r(n(51)),r(n(7)),r(n(84)),r(n(81))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(51),o=n(81),i=n(84);t.default=function(e,t,n){var a=[new i.HyperLink,new i.Paste,new i.ContentEdit];t&&(a=a.concat(t));var l={plugins:a,initialContent:n,getDarkColor:o.getDarkColor,defaultFormat:{fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000"}};return new r.Editor(e,l)}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(108),i=n(157),a=n(0),l=function(){function e(e,t){var n=this;if(void 0===t&&(t={}),"DIV"!=a.getTagOfNode(e))throw new Error("contentDiv must be an HTML DIV element");var l=i.default(e,t),s=[];Object.keys(l).forEach((function(e){"_placeholder"==e?a.arrayPush(s,t.plugins):s.push(l[e])})),this.core=r(r({contentDiv:e,api:r(r({},o.coreApiMap),t.coreApiOverride||{}),plugins:s.filter((function(e){return!!e}))},i.getPluginState(l)),{trustedHTMLHandler:t.trustedHTMLHandler||function(e){return e}}),this.core.plugins.forEach((function(e){return e.initialize(n)})),this.ensureTypeInContainer(new a.Position(this.core.contentDiv,0).normalize())}return e.prototype.dispose=function(){this.core.plugins.reverse().forEach((function(e){return e.dispose()})),this.core=null},e.prototype.isDisposed=function(){return!this.core},e.prototype.insertNode=function(e,t){return!!e&&this.core.api.insertNode(this.core,e,t)},e.prototype.deleteNode=function(e){return!(!e||!this.contains(e))&&(e.parentNode.removeChild(e),!0)},e.prototype.replaceNode=function(e,t,n){return!(!this.contains(e)||!t)&&(this.core.api.transformColor(this.core,n?t:null,!0,(function(){return e.parentNode.replaceChild(t,e)}),0),!0)},e.prototype.getBlockElementAtNode=function(e){return a.getBlockElementAtNode(this.core.contentDiv,e)},e.prototype.contains=function(e){return a.contains(this.core.contentDiv,e)},e.prototype.queryElements=function(e,t,n){void 0===t&&(t=0);var r=t instanceof Function?0:t;n=t instanceof Function?t:n;var o=0==r?null:this.getSelectionRange();return a.queryElements(this.core.contentDiv,e,n,r,o)},e.prototype.collapseNodes=function(e,t,n){return a.collapseNodes(this.core.contentDiv,e,t,n)},e.prototype.isEmpty=function(e){return a.isNodeEmpty(this.core.contentDiv,e)},e.prototype.getContent=function(e){return void 0===e&&(e=0),this.core.api.getContent(this.core,e)},e.prototype.setContent=function(e,t){void 0===t&&(t=!0),this.core.api.setContent(this.core,e,t)},e.prototype.insertContent=function(e,t){var n;if(e){var r=this.getDocument(),o=null===(n=(new DOMParser).parseFromString(this.core.trustedHTMLHandler(e),"text/html"))||void 0===n?void 0:n.body,i=(null==o?void 0:o.childNodes)?a.toArray(o.childNodes):[];t&&t.insertOnNewLine&&i.length>1&&(i=[a.wrap(i)]);var l=r.createDocumentFragment();i.forEach((function(e){return l.appendChild(e)})),this.insertNode(l,t)}},e.prototype.deleteSelectedContent=function(){var e=this.getSelectionRange();return e&&!e.collapsed&&a.deleteSelectedContent(this.core.contentDiv,e)},e.prototype.paste=function(e,t,n){var r=this;if(e){e.snapshotBeforePaste?this.setContent(e.snapshotBeforePaste):e.snapshotBeforePaste=this.getContent(2);var o=this.getSelectionRange(),i=o&&a.Position.getStart(o),l=this.core.api.createPasteFragment(this.core,e,i,t,n);this.addUndoSnapshot((function(){return r.insertNode(l),e}),"Paste")}},e.prototype.getSelectionRange=function(e){return void 0===e&&(e=!0),this.core.api.getSelectionRange(this.core,e)},e.prototype.getSelectionPath=function(){var e=this.getSelectionRange();return e&&a.getSelectionPath(this.core.contentDiv,e)},e.prototype.hasFocus=function(){return this.core.api.hasFocus(this.core)},e.prototype.focus=function(){this.core.api.focus(this.core)},e.prototype.select=function(e,t,n,r){var o=e?a.safeInstanceOf(e,"Range")?e:Array.isArray(e.start)&&Array.isArray(e.end)?a.createRange(this.core.contentDiv,e.start,e.end):a.createRange(e,t,n,r):null;return this.contains(o)&&this.core.api.selectRange(this.core,o)},e.prototype.getFocusedPosition=function(){var e,t=null===(e=this.getDocument().defaultView)||void 0===e?void 0:e.getSelection();if(this.contains(t&&t.focusNode))return new a.Position(t.focusNode,t.focusOffset);var n=this.getSelectionRange();return n?a.Position.getStart(n):null},e.prototype.getElementAtCursor=function(e,t,n){var r=this;return n=t?null:n,a.cacheGetEventData(n,"GET_ELEMENT_AT_CURSOR_"+e,(function(){if(!t){var n=r.getFocusedPosition();t=n&&n.node}return t&&a.findClosestElementAncestor(t,r.core.contentDiv,e)}))},e.prototype.isPositionAtBeginning=function(e){return a.isPositionAtBeginningOf(e,this.core.contentDiv)},e.prototype.getSelectedRegions=function(e){void 0===e&&(e=0);var t=this.getSelectionRange();return t?a.getRegionsFromRange(this.core.contentDiv,t,e):[]},e.prototype.addDomEventHandler=function(e,t){var n,r="string"==typeof e?((n={})[e]=t,n):e;return this.core.api.attachDomEvent(this.core,r)},e.prototype.triggerPluginEvent=function(e,t,n){var o=r({eventType:e},t);return this.core.api.triggerEvent(this.core,o,n),o},e.prototype.triggerContentChangedEvent=function(e,t){void 0===e&&(e="SetContent"),this.triggerPluginEvent(7,{source:e,data:t})},e.prototype.undo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,-1)},e.prototype.redo=function(){this.focus(),this.core.api.restoreUndoSnapshot(this.core,1)},e.prototype.addUndoSnapshot=function(e,t,n){this.core.api.addUndoSnapshot(this.core,e,t,n)},e.prototype.getUndoState=function(){var e=this.core.undo,t=e.hasNewContent,n=e.snapshotsService;return{canUndo:t||n.canMove(-1),canRedo:n.canMove(1)}},e.prototype.getDocument=function(){return this.core.contentDiv.ownerDocument},e.prototype.getScrollContainer=function(){return this.core.domEvent.scrollContainer},e.prototype.getCustomData=function(e,t,n){return(this.core.lifecycle.customData[e]=this.core.lifecycle.customData[e]||{value:t?t():void 0,disposer:n}).value},e.prototype.isInIME=function(){return this.core.domEvent.isInIME},e.prototype.getDefaultFormat=function(){return this.core.lifecycle.defaultFormat},e.prototype.getBodyTraverser=function(e){return a.ContentTraverser.createBodyTraverser(this.core.contentDiv,e)},e.prototype.getSelectionTraverser=function(){return this.getSelectionRange()&&a.ContentTraverser.createSelectionTraverser(this.core.contentDiv,this.getSelectionRange())},e.prototype.getBlockTraverser=function(e){void 0===e&&(e=3);var t=this.getSelectionRange();return t&&a.ContentTraverser.createBlockTraverser(this.core.contentDiv,t,e)},e.prototype.getContentSearcherOfCursor=function(e){var t=this;return a.cacheGetEventData(e,"CONTENTSEARCHER",(function(){var e=t.getSelectionRange();return e&&new a.PositionContentSearcher(t.core.contentDiv,a.Position.getStart(e))}))},e.prototype.runAsync=function(e){var t=this,n=this.core.contentDiv.ownerDocument.defaultView||window,r=n.requestAnimationFrame((function(){!t.isDisposed()&&e&&e(t)}));return function(){n.cancelAnimationFrame(r)}},e.prototype.setEditorDomAttribute=function(e,t){null===t?this.core.contentDiv.removeAttribute(e):this.core.contentDiv.setAttribute(e,t)},e.prototype.getEditorDomAttribute=function(e){return this.core.contentDiv.getAttribute(e)},e.prototype.getRelativeDistanceToEditor=function(e,t){if(this.contains(e)){var n=this.core.contentDiv,r=n.getBoundingClientRect(),o=e.getBoundingClientRect();if(r&&o){var i=o.left-(null==r?void 0:r.left),a=o.top-(null==r?void 0:r.top);return t&&(i+=n.scrollLeft,a+=n.scrollTop),[i,a]}}return null},e.prototype.addContentEditFeature=function(e){var t=this;null==e||e.keys.forEach((function(n){var r=t.core.edit.features[n]||[];r.push(e),t.core.edit.features[n]=r}))},e.prototype.getStyleBasedFormatState=function(e){if(!e){var t=this.getSelectionRange();e=t&&a.Position.getStart(t).normalize().node}return this.core.api.getStyleBasedFormatState(this.core,e)},e.prototype.getPendableFormatState=function(e){return this.core.api.getPendableFormatState(this.core,e)},e.prototype.ensureTypeInContainer=function(e,t){this.core.api.ensureTypeInContainer(this.core,e,t)},e.prototype.setDarkModeState=function(e){if(this.isDarkMode()!=e){var t=this.getContent(0);this.triggerContentChangedEvent(e?"SwitchToDarkMode":"SwitchToLightMode"),this.setContent(t)}},e.prototype.isDarkMode=function(){return this.core.lifecycle.isDarkMode},e.prototype.startShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!0)},e.prototype.stopShadowEdit=function(){this.core.api.switchShadowEdit(this.core,!1)},e.prototype.isInShadowEdit=function(){return!!this.core.lifecycle.shadowEditFragment},e.prototype.isFeatureEnabled=function(e){return this.core.lifecycle.experimentalFeatures.indexOf(e)>=0},e.prototype.getTrustedHTMLHandler=function(){return this.core.trustedHTMLHandler},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(109),o=n(142),i=n(143),a=n(144),l=n(145),s=n(146),u=n(147),c=n(148),d=n(149),f=n(80),h=n(150),p=n(151),v=n(152),g=n(153),m=n(154),y=n(155),b=n(156);t.coreApiMap={attachDomEvent:o.attachDomEvent,addUndoSnapshot:r.addUndoSnapshot,createPasteFragment:i.createPasteFragment,ensureTypeInContainer:a.ensureTypeInContainer,focus:l.focus,getContent:s.getContent,getSelectionRange:c.getSelectionRange,getStyleBasedFormatState:d.getStyleBasedFormatState,getPendableFormatState:u.getPendableFormatState,hasFocus:f.hasFocus,insertNode:h.insertNode,restoreUndoSnapshot:p.restoreUndoSnapshot,selectRange:v.selectRange,setContent:g.setContent,switchShadowEdit:m.switchShadowEdit,transformColor:y.transformColor,triggerEvent:b.triggerEvent}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.addUndoSnapshot=function(e,t,n,o){var i,a=e.undo,l=a.isNested,s=!!e.lifecycle.shadowEditFragment;l||(a.isNested=!0,s||(a.snapshotsService.addSnapshot(e.api.getContent(e,2),o),a.hasNewContent=!1));try{var u;if(t)i=t((u=e.api.getSelectionRange(e,!0))&&r.Position.getStart(u).normalize(),u&&r.Position.getEnd(u).normalize()),l||s||(a.snapshotsService.addSnapshot(e.api.getContent(e,2),!1),a.hasNewContent=!1)}finally{l||(a.isNested=!1)}if(t&&n){var c={eventType:7,source:n,data:i};e.api.triggerEvent(e,c,!0)}o&&((u=e.api.getSelectionRange(e,!1))&&(e.undo.hasNewContent=!1,e.undo.autoCompletePosition=r.Position.getStart(u)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(17),o=n(3),i=n(9),a=n(1),l=n(18),s=n(15),u=n(12),c=n(14),d=["TD","TH","LI","BLOCKQUOTE"],f=function(){function e(e,t,n){this.rootNode=e,this.startNode=t,this.endNode=n}return e.getBlockContext=function(e){for(;e&&!l.default(e);)e=e.parentNode;return e},e.prototype.collapseToSingleElement=function(){for(var t=r.default(e.getBlockContext(this.startNode),this.startNode,this.endNode,!0),n=e.getBlockContext(this.startNode);t[0]&&t[0]!=n&&t[0].parentNode!=this.rootNode&&d.indexOf(a.default(t[0].parentNode))<0;)t=[c.splitBalancedNodeRange(t)];return 1==t.length&&l.default(t[0])?t[0]:u.default(t)},e.prototype.getStartNode=function(){return this.startNode},e.prototype.getEndNode=function(){return this.endNode},e.prototype.equals=function(e){return this.startNode==e.getStartNode()&&this.endNode==e.getEndNode()},e.prototype.isAfter=function(e){return s.default(this.getStartNode(),e.getEndNode())},e.prototype.contains=function(e){return o.default(this.startNode,e,!0)||o.default(this.endNode,e,!0)||s.default(e,this.startNode)&&s.default(this.endNode,e)},e.prototype.getTextContent=function(){var e=i.default(this.getStartNode(),this.getEndNode());return e?e.toString():""},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(6),i=n(55),a=n(16),l=n(57),s=function(){function e(e,t){this.rootNode=e,this.startNode=r.default(e,t)?t:null}return e.prototype.getStartBlockElement=function(){return this.startNode?o.default(this.rootNode,this.startNode):i.default(this.rootNode,!0)},e.prototype.getStartInlineElement=function(){return this.startNode?a.default(this.rootNode,this.startNode):l.getFirstInlineElement(this.rootNode)},e.prototype.isBlockInScope=function(e){return r.default(this.rootNode,e.getStartNode())},e.prototype.trimInlineElement=function(e){return e},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(59),o=n(6),i=n(16),a=n(52),l=n(4),s=n(2),u=n(40),c=n(57),d=function(){function e(e,t,n){this.rootNode=e,this.startFrom=n,t=s.default(t,"Range")?l.default.getStart(t):t,this.position=t.normalize(),this.block=o.default(this.rootNode,this.position.node)}return e.prototype.getStartBlockElement=function(){return this.block},e.prototype.getStartInlineElement=function(){if(this.block)switch(this.startFrom){case 0:case 1:case 2:return function(e,t){if(e instanceof a.default){var n=e.getStartNode();return t?c.getFirstInlineElement(n):c.getLastInlineElement(n)}return i.default(e,t?e.getStartNode():e.getEndNode())}(this.block,0==this.startFrom);case 3:var e=u.getInlineElementAfter(this.rootNode,this.position);return e&&this.block.contains(e.getContainerNode())?e:new r.default(this.position,this.block)}return null},e.prototype.isBlockInScope=function(e){return!(!this.block||!e)&&this.block.equals(e)},e.prototype.trimInlineElement=function(e){return this.block&&e&&this.block.contains(e.getContainerNode())?e:null},e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),o=n(29),i=n(4),a=n(40),l=function(){function e(e,t){this.rootNode=e,this.start=i.default.getStart(t).normalize(),this.end=i.default.getEnd(t).normalize()}return e.prototype.getStartBlockElement=function(){return this.startBlock||(this.startBlock=r.default(this.rootNode,this.start.node)),this.startBlock},e.prototype.getStartInlineElement=function(){return this.startInline||(this.startInline=this.trimInlineElement(a.getInlineElementAfter(this.rootNode,this.start))),this.startInline},e.prototype.isBlockInScope=function(e){if(!e)return!1;var t=!1,n=this.getStartBlockElement();if(this.start.equalTo(this.end))t=n&&n.equals(e);else{var o=r.default(this.rootNode,this.end.node);t=n&&o&&(e.equals(n)||e.equals(o)||e.isAfter(n)&&o.isAfter(e))}return t},e.prototype.trimInlineElement=function(e){if(!e||this.start.equalTo(this.end))return null;var t=e.getStartPosition(),n=e.getEndPosition();if(t.isAfter(this.end)||this.start.isAfter(n))return null;var r=!1,i=!1;return this.start.isAfter(t)&&(t=this.start,r=!0),n.isAfter(this.end)&&(n=this.end,i=!0),t.isAfter(n)||t.equalTo(n)?null:r||i?new o.default(e,r&&t,i&&n):e},e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(61),o=n(62),i=n(5);t.default=function(e,t,n){var a=e.clipboardData||e.target.ownerDocument.defaultView.clipboardData;a.items?(e.preventDefault(),r.default(i.default(a.items),n).then(t)):o.default(a,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(63);t.default=function(e,t,n){if(t){var o=e.style,i=t.fontFamily,a=t.fontSize,l=t.textColor,s=t.textColors,u=t.backgroundColor,c=t.backgroundColors,d=t.bold,f=t.italic,h=t.underline;i&&(o.fontFamily=i),a&&(o.fontSize=a),r.default(e,s||l,!1,n),r.default(e,c||u,!0,n),d&&(o.fontWeight="bold"),f&&(o.fontStyle="italic"),h&&(o.textDecoration="underline")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PendableFormatCommandMap={isBold:"bold",isItalic:"italic",isUnderline:"underline",isStrikeThrough:"strikeThrough",isSubscript:"subscript",isSuperscript:"superscript"},t.default=function(e){return Object.keys(t.PendableFormatCommandMap).reduce((function(n,r){return n[r]=e.queryCommandState(t.PendableFormatCommandMap[r]),n}),{})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=/^[^?]+%[^0-9a-f]+|^[^?]+%[0-9a-f][^0-9a-f]+|^[^?]+%00|^[^?]+%$|^https?:\/\/[^?\/]+@|^www\.[^?\/]+@/i,o="(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)*[a-z0-9](?:[a-z0-9-]*[a-z0-9])?(?:\\:[0-9]+)?(?:[\\/\\?]\\S*)?",i={http:{match:new RegExp("^(?:microsoft-edge:)?http:\\/\\/"+o+"|www\\."+o,"i"),except:r,normalizeUrl:function(e){return new RegExp("^(?:microsoft-edge:)?http:\\/\\/","i").test(e)?e:"http://"+e}},https:{match:new RegExp("^(?:microsoft-edge:)?https:\\/\\/"+o,"i"),except:r},mailto:{match:new RegExp("^mailto:\\S+@\\S+\\.\\S+","i")},notes:{match:new RegExp("^notes:\\/\\/\\S+","i")},file:{match:new RegExp("^file:\\/\\/\\/?\\S+","i")},unc:{match:new RegExp("^\\\\\\\\\\S+","i")},ftp:{match:new RegExp("^ftp:\\/\\/"+o+"|ftp\\."+o,"i"),normalizeUrl:function(e){return new RegExp("^ftp:\\/\\/","i").test(e)?e:"ftp://"+e}},news:{match:new RegExp("^news:(\\/\\/)?"+o,"i")},telnet:{match:new RegExp("^telnet:(\\/\\/)?"+o,"i")},gopher:{match:new RegExp("^gopher:\\/\\/"+o,"i")},wais:{match:new RegExp("^wais:(\\/\\/)?"+o,"i")}};t.default=function(e){if(e)for(var t=0,n=Object.keys(i);t<n.length;t++){var r=n[t],o=i[r],a=e.match(o.match);if(a&&a[0]==e&&(!o.except||!o.except.test(e)))return{scheme:r,originalUrl:e,normalizedUrl:o.normalizeUrl?o.normalizeUrl(e):e}}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(21);t.default=function(e){for(var t=r.default.createBodyTraverser(e),n=t&&t.currentBlockElement,o=[];n;)o.push(n.getTextContent()),n=t.getNextBlockElement();return o.join("\n")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(3),i=n(9),a=n(11),l=n(6),s=n(1),u=n(31),c=n(65),d=n(36),f=n(39),h=n(4),p=n(60),v=n(13),g=n(28),m=n(5),y=n(32),b=n(66),E=n(12),C=n(14),w=[function(e,t,n,r){var a,s,c=l.default(e,n.node);if(c){var d=v.default(e,"a[href]",null,1,i.default(n)).filter((function(e){return c.contains(e)}))[0];if(d&&u.default(d)&&(n=new h.default(d,-2),S(d),d=null),d&&(null===(a=t)||void 0===a?void 0:a.querySelector)&&(null===(s=t)||void 0===s?void 0:s.querySelector("a[href]"))){var f=n.normalize(),p=f.node.parentNode,m=3==f.node.nodeType?g.default(f.node,f.offset,!1):f.isAtEnd?f.node.nextSibling:f.node,y=e.ownerDocument.createTextNode("");for(p.insertBefore(y,m);o.default(d,y);)y=C.splitBalancedNodeRange(y);n=new h.default(y,-2),S(y)}}return n},function(e,t,n,r){var o=t;if(11==o.nodeType){var i=m.default(o.childNodes).filter((function(e){return"BR"!=s.default(e)}));o=1==i.length?i[0]:null}var l=s.default(o),u=l&&"BR"==s.default(o.nextSibling),d=a.default(n.node,e,"LI"),f=d&&a.default(d,e,"OL,UL"),p=a.default(n.node,e,"TD,TH"),v=p&&a.default(p,e,"TR");"LI"==l&&(l=f?s.default(f):"UL",o=E.default(o,l));if("OL"!=l&&"UL"!=l||"LI"!=s.default(o.firstChild)){if("TABLE"==l&&v){var g=new b.default(o),C=new b.default(p);0==C.col&&p==C.getCell(C.row,0).td&&g.cells[0]&&g.cells[0].length==C.cells[0].length&&c.default(n,p)&&("TBODY"!=s.default(o.firstChild)||o.firstChild.nextSibling||y.default(o.firstChild),y.default(o),n=new h.default(v,-3))}}else{var w=!o.firstChild.nextSibling&&!u;u&&o.parentNode&&S(o.nextSibling),w?(y.default(o.firstChild),y.default(o)):s.default(f)==l&&(y.default(o),n=new h.default(d,c.default(n,d)?-2:-3))}return n},function(e,t,n,o){if("P"==s.default(n.node)){var i=n.normalize(),a=r.default(n.node,"div");i.node!=a&&(n=i)}return n},function(e,t,n,r){d.default(n.node)&&(n=new h.default(n.node,n.isAtEnd?-3:-2));return n},function(e,t,n,r){if(r&&r.collapsed){var o=new p.default(e,h.default.getStart(r)),i=o.getInlineElementBefore(),a=o.getInlineElementAfter();i instanceof f.default?n=new h.default(i.getContainerNode(),-3):a instanceof f.default&&(n=new h.default(a.getContainerNode(),-2))}return n}];function S(e){var t;null===(t=null==e?void 0:e.parentNode)||void 0===t||t.removeChild(e)}t.default=function(e,t,n,r){return w.forEach((function(o){n=o(e,t,n,r)})),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(69),i=n(70),a=n(24),l=n(4),s=n(2),u=n(22),c=n(5),d=n(44),f=n(12),h=n(8),p=n(45);function v(e,t,n){var r=t[n?t.length-1:0];r=h.getLeafSibling(e.rootNode,r,n,e.skipTags,!0),r=o.default(e,"ol,ul",r),a.default(e,r)&&p.isListElement(r)&&(n?s.default(r,"HTMLOListElement")&&1!=r.start||t.push(r):t.unshift(r))}t.default=function(e,t,n){if(!e)return null;var a=[];if(n){var h=o.default(e,"ol,ul",n);h&&a.push(h)}else{if(i.default(e).forEach((function(n){var r=o.default(e,"ol,ul",n.getStartNode());r?(a[a.length-1]!=r&&a.push(r),1==a.length&&s.default(r,"HTMLOListElement")&&r.start>1&&(t=!1)):a.push(n.collapseToSingleElement())})),0==a.length&&!e.rootNode.firstChild){var g=r.default(1,e.rootNode.ownerDocument);e.rootNode.appendChild(g),a.push(g),e.fullSelectionStart=new l.default(g,0),e.fullSelectionEnd=new l.default(g,-1)}t&&(v(e,a,!1),v(e,a,!0)),a=a.filter((function(e){return!u.default(e,!0)}))}var m=null;if(a.length>0){var y=a.shift();m=p.isListElement(y)?new d.default(y):function(e){var t=c.default(e.childNodes),n=1==t.length?t[0]:f.default(t,"SPAN"),r=e.ownerDocument.createElement("ol");e.appendChild(r);var o=new d.default(r);return o.appendItem(n,0),o}(y),a.forEach((function(e){p.isListElement(e)?m.mergeVList(new d.default(e)):m.appendItem(e,0)}))}return m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),o=n(69),i=n(15),a=n(24),l=n(13),s=n(44),u=0,c=function(){function e(e,t){this.region=e,this.name=t,this.lastNumber=0,this.lastNumberBeforeCursor=0}return e.createListChains=function(t,n,a){var s=Array.isArray(t)?t:t?[t]:[],u=[];return s.forEach((function(t){var s,c=[];l.default(t.rootNode,"ol",(function(r){var l=o.default(t,"ol",r);if(s!=l){var u=c.filter((function(e){return e.canAppendToTail(l)}))[0]||new e(t,(a||d)()),f=c.indexOf(u),h=n&&i.default(l,n);h?f<0&&c.push(u):(f>=0&&c.splice(f,1),c.unshift(u)),u.append(l,h),s=l}})),r.default(u,c)})),u},e.prototype.canAppendAtCursor=function(e){return e>1&&this.lastNumberBeforeCursor+1==e},e.prototype.createVListAtBlock=function(e,t){if(e){var n=e.ownerDocument.createElement("ol");n.start=t,this.applyChainName(n),e.parentNode.insertBefore(n,e);var r=new s.default(n);return r.appendItem(e,0),r}return null},e.prototype.commit=function(){for(var e=this.getLists(),t=0,n=0;n<e.length;n++){var r=e[n];r.start=t+1;var o=new s.default(r);t=o.getLastItemNumber(),delete r.dataset.listchain,delete r.dataset.listchainafter,o.writeBack()}},e.prototype.canAppendToTail=function(e){return this.lastNumber+1==e.start},e.prototype.append=function(e,t){this.applyChainName(e),this.lastNumber=new s.default(e).getLastItemNumber(),t?e.dataset.listchainafter="true":this.lastNumberBeforeCursor=this.lastNumber},e.prototype.applyChainName=function(e){e.dataset.listchain=this.name},e.prototype.getLists=function(){var e=this;return l.default(this.region.rootNode,"ol[data-listchain="+this.name+"]").filter((function(t){return a.default(e.region,t)}))},e}();function d(){return"__List_Chain_"+u++}t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(19),o=n(9),i=n(43);t.default=function(e){if(!e)return null;var t=o.default(e),n=t.getBoundingClientRect&&i.default(t.getBoundingClientRect());if(n)return n;e=e.normalize();var a=t.getClientRects&&t.getClientRects();if(n=a&&1==a.length&&i.default(a[0]))return n;if(3==e.node.nodeType){var l=r.default({tag:"span",children:["​"]},e.node.ownerDocument);if((t=o.default(e)).insertNode(l),n=l.getBoundingClientRect&&i.default(l.getBoundingClientRect()),l.parentNode.removeChild(l),n)return n}var s=e.element;return s&&s.getBoundingClientRect&&(n=i.default(s.getBoundingClientRect()))?n:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(64),o=n(75),i=n(1),a=n(13);t.default=function(e,t){if(!e)return"";var n=t||{},l=n.startContainer,s=n.endContainer,u=n.startOffset,c=n.endOffset,d=!1;if(a.default(e,"table",(function(e){for(var t=null,n=e.firstChild;n;n=n.nextSibling)"TR"==i.default(n)?(t||(t=e.ownerDocument.createElement("tbody"),e.insertBefore(t,n)),t.appendChild(n),n=t,d=!0):t=null})),t&&d)try{t.setStart(l,u),t.setEnd(s,c)}catch(e){}var f=r.default(e),h=t&&o.default(e,t);return h?f+"\x3c!--"+JSON.stringify(h)+"--\x3e":f}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=/<!--([^-]+)-->$/;t.default=function(e,t,n){if(!e)return null;t=t||"";var i=o.exec(t);e.innerHTML=(null==n?void 0:n(t))||t;var a=function(e,t){var n,r,o,i="",a=null,l=null;8==(null===(n=e.lastChild)||void 0===n?void 0:n.nodeType)?(a=e.lastChild,i=a.nodeValue):i=t;if(i)try{(l=JSON.parse(i))&&(null===(r=l.start)||void 0===r?void 0:r.length)>0&&(null===(o=l.end)||void 0===o?void 0:o.length)>0?a&&e.removeChild(a):l=null}catch(e){}return l}(e,null==i?void 0:i[1]);return a&&r.default(e,a.start,a.end)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20);t.default=function(e,t){var n,o,i,a=null===(i=null===(o=null===(n=null==e?void 0:e.commonAncestorContainer)||void 0===n?void 0:n.ownerDocument)||void 0===o?void 0:o.defaultView)||void 0===i?void 0:i.getSelection();if(a){var l=!0;if(a.rangeCount>0)try{var s=void 0;(t||r.Browser.isEdge)&&(s=1==a.rangeCount?a.getRangeAt(0):null)&&s.startContainer==e.startContainer&&s.startOffset==e.startOffset&&s.endContainer==e.endContainer&&s.endOffset==e.endOffset?l=!1:a.removeAllRanges()}catch(e){}l&&a.addRange(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),o=n(72),i=n(71),a=n(46),l=n(73),s=n(4),u=n(13),c=n(2),d=n(28);function f(e,t,n){var r;if(c.default(e,"Text")){var o=d.default(e,t,n);return n?[o,e]:[e,o]}var i=e.childNodes[t-1],a=e.childNodes[t];if(i||a||(n?i=(a=e).previousSibling:a=(i=e).nextSibling),(i||a)&&(!i||!a)){var l=e.ownerDocument.createTextNode("");null===(r=(i||a).parentNode)||void 0===r||r.insertBefore(l,a),i?a=l:i=l}return[i,a]}t.default=function(e,t){var n=null,c=u.default(e,"table,tr",null,2,t),d=i.default(e,t,0).map((function(e){var t=a.default(e);if(!t)return null;var i=t.startContainer,l=t.endContainer,s=t.startOffset,u=f(l,t.endOffset,!1),d=u[0],h=u[1],p=f(i,s,!0),v=p[0],g=p[1];n=n||v;var m=o.default(e,[g,d]);return r.default(c,m),{region:e,beforeStart:v,afterEnd:h}})).filter((function(e){return!!e}));return c.forEach((function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})),d.forEach((function(e){return l.default(e.region,e.beforeStart,e.afterEnd)})),n&&new s.default(n,-1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(76);t.default=function(e,t,n){if(e.currentIndex<0||t!=e.snapshots[e.currentIndex]){r.default(e),e.snapshots.push(t),e.currentIndex++,e.totalSize+=t.length;for(var o=0;o<e.snapshots.length&&e.totalSize>e.maxSize;)e.totalSize-=e.snapshots[o].length,o++;o>0&&(e.snapshots.splice(0,o),e.currentIndex-=o,e.autoCompleteIndex-=o),n&&(e.autoCompleteIndex=e.currentIndex)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(47);function o(e,t){return r.default(e,t)?(e.currentIndex+=t,e.autoCompleteIndex=-1,e.snapshots[e.currentIndex]):null}t.default=o,t.moveCurrentSnapsnot=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return{snapshots:[],totalSize:0,currentIndex:-1,autoCompleteIndex:-1,maxSize:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.autoCompleteIndex>=0&&e.currentIndex-e.autoCompleteIndex==1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),o=n(77),i=n(74),a=n(33),l=n(1),s=n(2),u=n(34),c=n(5),d=n(78),f=n(132),h=function(){function e(e){e=e||{},this.elementCallbacks=d.cloneObject(e.elementCallbacks),this.styleCallbacks=f.getStyleCallbacks(e.cssStyleCallbacks),this.attributeCallbacks=d.cloneObject(e.attributeCallbacks),this.tagReplacements=f.getTagReplacement(e.additionalTagReplacements),this.allowedAttributes=f.getAllowedAttributes(e.additionalAllowedAttributes),this.allowedCssClassesRegex=f.getAllowedCssClassesRegex(e.additionalAllowedCssClasses),this.defaultStyleValues=f.getDefaultStyleValues(e.additionalDefaultStyleValues),this.additionalPredefinedCssForElement=e.additionalPredefinedCssForElement,this.additionalGlobalStyleNodes=e.additionalGlobalStyleNodes||[],this.preserveHtmlComments=e.preserveHtmlComments,this.unknownTagReplacement=e.unknownTagReplacement}return e.convertInlineCss=function(t,n){return new e({additionalGlobalStyleNodes:n}).exec(t,!0)},e.sanitizeHtml=function(t,n){var r=new e(n=n||{}),i=s.default(n.currentElementOrStyle,"HTMLElement")?o.default(n.currentElementOrStyle):n.currentElementOrStyle;return r.exec(t,n.convertCssOnly,i)},e.prototype.exec=function(e,t,n){var r=(new DOMParser).parseFromString(g(e)||"","text/html");return r&&r.body&&r.body.firstChild&&(this.convertGlobalCssToInlineCss(r),t||this.sanitize(r.body,n)),r&&r.body&&r.body.innerHTML||""},e.prototype.sanitize=function(e,t){if(!e)return"";t=d.cloneObject(t,o.default(null)),this.processNode(e,t,{})},e.prototype.convertGlobalCssToInlineCss=function(e){for(var t=c.default(e.querySelectorAll("style")),n=0,r=this.additionalGlobalStyleNodes.reverse().map((function(e){return e.sheet})).concat(t.map((function(e){return e.sheet})).reverse()).filter((function(e){return e}));n<r.length;n++)for(var o=r[n],i=function(t){var n=o.cssRules[t],r=n&&n.style?n.style.cssText:null;if(n.type!=CSSRule.STYLE_RULE||!r||!n.selectorText)return"continue";for(var i=0,a=n.selectorText.split(",");i<a.length;i++){var l=a[i];if(l&&l.trim()&&!(l.indexOf(":")>=0))c.default(e.querySelectorAll(l)).forEach((function(e){return e.setAttribute("style",r+(e.getAttribute("style")||""))}))}},a=o.cssRules.length-1;a>=0;a--)i(a);t.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))},e.prototype.processNode=function(e,t,n){var o=e.nodeType,i=1==o,a=3==o,s=11==o,u=8==o,c=!1;if(i){var f=l.default(e),h=this.elementCallbacks[f],p=this.tagReplacements[f.toLowerCase()];void 0===p&&(p=this.unknownTagReplacement),h?c=h(e,n):f.indexOf(":")>0||f==p||"*"==p?c=!0:p&&/^[a-zA-Z][\w\-]*$/.test(p)&&(e=r.default(e,p),c=!0)}else if(a){var v=t["white-space"];c="pre"==v||"pre-line"==v||"pre-wrap"==v||!/^[\r\n]*$/g.test(e.nodeValue)}else c=!!s||!!u&&this.preserveHtmlComments;if(c)if(!a||"pre"!=t["white-space"]&&"pre-wrap"!=t["white-space"]){if(i||s){var g=d.cloneObject(t),m=e;i&&(this.processAttributes(m,n),this.preprocessCss(m,g),this.processCss(m,g,n));for(var y=m.firstChild,b=void 0;y;y=b)b=y.nextSibling,this.processNode(y,g,n)}}else e.nodeValue=e.nodeValue.replace(/^ /gm," ").replace(/ {2}/g,"  ");else e.parentNode.removeChild(e)},e.prototype.preprocessCss=function(e,t){var n=i.default(e,this.additionalPredefinedCssForElement);n&&Object.keys(n).forEach((function(e){t[e]=n[e]}))},e.prototype.processCss=function(e,t,n){var r=this,o=a.default(e);Object.keys(o).forEach((function(i){var a=o[i],l=r.styleCallbacks[i],s=null!=t[i],u=(!l||l(a,e,t,n))&&"inherit"!=a&&a.indexOf("expression")<0&&"-"!=i.substr(0,1)&&r.defaultStyleValues[i]!=a&&(s&&a!=t[i]||!s&&"initial"!=a&&"normal"!=a);u&&s&&(t[i]=a),u||delete o[i]})),u.default(e,o)},e.prototype.processAttributes=function(e,t){for(var n=e.attributes.length-1;n>=0;n--){var r=e.attributes[n],o=r.name.toLowerCase().trim(),i=r.value,a=this.attributeCallbacks[o],l=a?a(i,e,t):this.allowedAttributes.indexOf(o)>=0||0==o.indexOf("data-")?i:null;"class"==o&&this.allowedCssClassesRegex&&(l=this.processCssClass(i,l)),null==l||l.match(/s\n*c\n*r\n*i\n*p\n*t\n*:/i)?e.removeAttribute(o):r.value=l}},e.prototype.processCssClass=function(e,t){var n=this,r=e?e.split(" "):[],o=t?t.split(" "):[];return r.forEach((function(e){n.allowedCssClassesRegex.test(e)&&o.indexOf(e)<0&&o.push(e)})),o.length>0?o.join(" "):null},e}();t.default=h;var p=window.trustedTypes,v=null==p?void 0:p.createPolicy("roosterjsUnsafeConvertHTML",{createHTML:function(e){return e}}),g=v?function(e){return v.createHTML(e||"")}:function(e){return e}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(78),i={a:"*",abbr:"*",address:"*",area:"*",article:"*",aside:"*",b:"*",bdi:"*",bdo:"*",blockquote:"*",body:"*",br:"*",button:"*",canvas:"*",caption:"*",center:"*",cite:"*",code:"*",col:"*",colgroup:"*",data:"*",datalist:"*",dd:"*",del:"*",details:"*",dfn:"*",dialog:"*",dir:"*",div:"*",dl:"*",dt:"*",em:"*",fieldset:"*",figcaption:"*",figure:"*",font:"*",footer:"*",h1:"*",h2:"*",h3:"*",h4:"*",h5:"*",h6:"*",head:"*",header:"*",hgroup:"*",hr:"*",html:"*",i:"*",img:"*",input:"*",ins:"*",kbd:"*",label:"*",legend:"*",li:"*",main:"*",map:"*",mark:"*",menu:"*",menuitem:"*",meter:"*",nav:"*",ol:"*",optgroup:"*",option:"*",output:"*",p:"*",picture:"*",pre:"*",progress:"*",q:"*",rp:"*",rt:"*",ruby:"*",s:"*",samp:"*",section:"*",select:"*",small:"*",span:"*",strike:"*",strong:"*",sub:"*",summary:"*",sup:"*",table:"*",tbody:"*",td:"*",template:"*",textarea:"*",tfoot:"*",th:"*",thead:"*",time:"*",tr:"*",tt:"*",u:"*",ul:"*",var:"*",wbr:"*",xmp:"*",form:"SPAN",applet:null,audio:null,base:null,basefont:null,embed:null,frame:null,frameset:null,iframe:null,link:null,meta:null,noscript:null,object:null,param:null,script:null,slot:null,source:null,style:null,title:null,track:null,video:null},a="accept,align,alt,checked,cite,color,cols,colspan,contextmenu,coords,datetime,default,dir,dirname,disabled,download,face,headers,height,hidden,high,href,hreflang,ismap,kind,label,lang,list,low,max,maxlength,media,min,multiple,open,optimum,pattern,placeholder,readonly,rel,required,reversed,rows,rowspan,scope,selected,shape,size,sizes,span,spellcheck,src,srclang,srcset,start,step,style,tabindex,target,title,translate,type,usemap,valign,value,width,wrap".split(","),l={"background-color":"transparent","border-bottom-color":"rgb(0, 0, 0)","border-bottom-style":"none","border-bottom-width":"0px","border-image-outset":"0","border-image-repeat":"stretch","border-image-slice":"100%","border-image-source":"none","border-image-width":"1","border-left-color":"rgb(0, 0, 0)","border-left-style":"none","border-left-width":"0px","border-right-color":"rgb(0, 0, 0)","border-right-style":"none","border-right-width":"0px","border-top-color":"rgb(0, 0, 0)","border-top-style":"none","border-top-width":"0px","outline-color":"transparent","outline-style":"none","outline-width":"0px",overflow:"visible","text-decoration":"none","-webkit-text-stroke-width":"0px","word-wrap":"break-word","margin-left":"0px","margin-right":"0px",padding:"0px","padding-top":"0px","padding-left":"0px","padding-right":"0px","padding-bottom":"0px",border:"0px","border-top":"0px","border-left":"0px","border-right":"0px","border-bottom":"0px","vertical-align":"baseline",float:"none"},s=[];function u(){return null}function c(e,t){var n=t.tagName;return!("LI"==n||"DIV"==n)}t.getTagReplacement=function(e){var t=r({},i),n=e||{};return Object.keys(n).forEach((function(e){e&&(t[e.toLowerCase()]=n[e])})),t},t.getAllowedAttributes=function(e){return(t=a.concat(e||[]),t.filter((function(e,t,n){return n.indexOf(e)==t}))).map((function(e){return e.toLocaleLowerCase()}));var t},t.getAllowedCssClassesRegex=function(e){var t=s.concat(e||[]);return t.length>0?new RegExp(t.join("|")):null},t.getDefaultStyleValues=function(e){var t=o.cloneObject(l);return e&&Object.keys(e).forEach((function(n){var r=e[n];null!=r?t[n]=r:delete t[n]})),t},t.getStyleCallbacks=function(e){var t=o.cloneObject(e);return t.position=t.position||u,t.width=t.width||c,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return{elementCallbacks:{},attributeCallbacks:{},cssStyleCallbacks:{},additionalTagReplacements:{},additionalAllowedAttributes:[],additionalAllowedCssClasses:[],additionalDefaultStyleValues:{},additionalGlobalStyleNodes:[],additionalPredefinedCssForElement:{},preserveHtmlComments:!1,unknownTagReplacement:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e[t]){var r=e[t];e[t]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,e),n.apply(void 0,e)}}else e[t]=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,n,r){e&&(e.className="_Entity _EType_"+t+" "+(r?"_EId_"+r+" ":"")+"_EReadonly_"+(n?"1":"0"),n?e.contentEditable="false":e.getAttribute("contenteditable")&&e.removeAttribute("contenteditable"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t,n,r=!1,o="",i=!1;return null===(t=null==e?void 0:e.className)||void 0===t||t.split(" ").forEach((function(e){"_Entity"==e?r=!0:0==e.indexOf("_EType_")?n=e.substr("_EType_".length):0==e.indexOf("_EId_")?o=e.substr("_EId_".length):0==e.indexOf("_EReadonly_")&&(i="1"==e.substr("_EReadonly_".length))})),r?{wrapper:e,id:o,type:n,isReadonly:i}:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return"._Entity"+(e?"._EType_"+e:"")+(t?"._EId_"+t:"")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=e&&e.eventDataCache&&e.eventDataCache.hasOwnProperty(t)?e.eventDataCache[t]:n();return e&&(e.eventDataCache=e.eventDataCache||{},e.eventDataCache[t]=r),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e&&e.eventDataCache&&(t&&e.eventDataCache.hasOwnProperty(t)?delete e.eventDataCache[t]:t||(e.eventDataCache={}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(79);t.default=function(e){return!r.default(e)&&e.key&&1==e.key.length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(20).Browser.isMac?function(e){return e.metaKey}:function(e){return e.ctrlKey};t.default=function(e){return r(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attachDomEvent=function(e,t){var n=Object.keys(t||{}).map((function(n){var r=function(e){var t={pluginEventType:null,beforeDispatch:null};"number"==typeof e?t.pluginEventType=e:"function"==typeof e?t.beforeDispatch=e:"object"==typeof e&&(t=e);return t}(t[n]),o=r.pluginEventType,i=r.beforeDispatch,a=function(t){i&&i(t),null!=o&&e.api.triggerEvent(e,{eventType:o,rawEvent:t},!1)};return e.contentDiv.addEventListener(n,a),function(){e.contentDiv.removeEventListener(n,a)}}));return function(){return n.forEach((function(e){return e()}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e,t){r.toArray(e.querySelectorAll("style")).forEach(t)}t.createPasteFragment=function(e,t,n,i,a){var l,s;if(!t)return null;var u,c=function(e,t){return{eventType:10,clipboardData:t,fragment:e.contentDiv.ownerDocument.createDocumentFragment(),sanitizingOption:r.createDefaultHtmlSanitizerOptions(),htmlBefore:"",htmlAfter:"",htmlAttributes:{}}}(e,t),d=c.fragment,f=c.sanitizingOption,h=t.rawHtml,p=t.text,v=t.imageDataUri,g=e.contentDiv.ownerDocument;if(h&&(null===(l=u=(new DOMParser).parseFromString(e.trustedHTMLHandler(h),"text/html"))||void 0===l?void 0:l.body)){var m=null===(s=u.querySelector("html"))||void 0===s?void 0:s.attributes;(m?r.toArray(m):[]).reduce((function(e,t){return e[t.name]=t.value,e}),c.htmlAttributes),r.toArray(u.querySelectorAll("meta")).reduce((function(e,t){return e[t.name]=t.content,e}),c.htmlAttributes),t.htmlFirstLevelChildTags=[],null==u||u.body.normalize(),null==u||u.body.childNodes.forEach((function(e){if(e.nodeType==Node.TEXT_NODE&&!e.nodeValue.replace(/(\r\n|\r|\n)/gm,"").trim())return;var n=r.getTagOfNode(e);t.htmlFirstLevelChildTags.push(n)})),o(u,(function(e){u.head.appendChild(e),f.additionalGlobalStyleNodes.push(e)}));var y=h.indexOf("\x3c!--StartFragment--\x3e"),b=h.lastIndexOf("\x3c!--EndFragment--\x3e");y>=0&&b>=y+"\x3c!--StartFragment--\x3e".length&&(c.htmlBefore=h.substr(0,y),c.htmlAfter=h.substr(b+"\x3c!--EndFragment--\x3e".length),t.html=h.substring(y+"\x3c!--StartFragment--\x3e".length,b),u.body.innerHTML=e.trustedHTMLHandler(t.html),o(u.body,(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)})))}if(i||p||!v)if(!i&&h&&u&&u.body){if(r.moveChildNodes(d,u.body),a&&n){var E=function(e,t){var n=e.api.getPendableFormatState(e,!0),r=e.api.getStyleBasedFormatState(e,t);return{fontFamily:r.fontName,fontSize:r.fontSize,textColor:r.textColor,backgroundColor:r.backgroundColor,textColors:r.textColors,backgroundColors:r.backgroundColors,bold:n.isBold,italic:n.isItalic,underline:n.isUnderline}}(e,n.node);r.applyTextStyle(d,(function(e){return r.applyFormat(e,E)}))}}else p&&p.split("\n").forEach((function(e,t,n){e=e.replace(/^ /g," ").replace(/\r/g,"").replace(/ {2}/g,"  ");var o=g.createTextNode(e);2==n.length&&0==t?(d.appendChild(o),d.appendChild(g.createElement("br"))):t>0&&t<n.length-1?d.appendChild(r.wrap(""==e?g.createElement("br"):o)):d.appendChild(o)}));else{var C=g.createElement("img");C.style.maxWidth="100%",C.src=v,d.appendChild(C)}e.api.triggerEvent(e,c,!0);var w=new r.HtmlSanitizer(c.sanitizingOption);return w.convertGlobalCssToInlineCss(d),w.sanitize(d,n&&r.getInheritableStyles(n.element)),d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.ensureTypeInContainer=function(e,t,n){t=t.normalize();var o,i=r.getBlockElementAtNode(e.contentDiv,t.node);if(i){o=i.collapseToSingleElement();var a=r.isNodeEmpty(o)||n&&function(e,t){return r.safeInstanceOf(e.target,"Node")&&e.target.contains(t)&&e.key===t.innerText}(n,o);o=o&&a?o:null}else o=r.createElement(1,e.contentDiv.ownerDocument),e.api.insertNode(e,o,{position:1,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1}),t=new r.Position(o.firstChild,0);o&&r.applyFormat(o,e.lifecycle.defaultFormat,e.lifecycle.isDarkMode),n&&e.api.selectRange(e,r.createRange(t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.focus=function(e){if(!e.lifecycle.shadowEditFragment){if(!(e.api.hasFocus(e)&&e.api.getSelectionRange(e,!1)||e.domEvent.selectionRange&&e.api.selectRange(e,e.domEvent.selectionRange,!0))){var t=r.getFirstLeafNode(e.contentDiv)||e.contentDiv;e.api.selectRange(e,r.createRange(t,0),!0)}e.domEvent.selectionRange=null,e.api.hasFocus(e)||e.contentDiv.focus()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getContent=function(e,t){var n="",o=0==t,i=2==t,a=e.lifecycle.shadowEditFragment||e.contentDiv;if(3==t)n=r.getTextContent(a);else if(o||e.lifecycle.isDarkMode){var l=function(e){var t;r.safeInstanceOf(e,"DocumentFragment")?(t=e.ownerDocument.createElement("div")).appendChild(e.cloneNode(!0)):t=e.cloneNode(!0);return t}(a);l.normalize();var s=e.api.getSelectionRange(e,!0),u=i?e.lifecycle.shadowEditFragment?e.lifecycle.shadowEditSelectionPath:s?r.getSelectionPath(e.contentDiv,s):null:null,c=u&&r.createRange(l,u.start,u.end);e.lifecycle.isDarkMode&&e.api.transformColor(e,l,!1,null,1),o?(e.api.triggerEvent(e,{eventType:8,clonedRoot:l},!0),n=l.innerHTML):n=c?r.getHtmlWithSelectionPath(l,c):l.innerHTML}else n=r.getHtmlWithSelectionPath(a,i&&e.api.getSelectionRange(e,!0));return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getPendableFormatState=function(e,t){var n,a=e.api.getSelectionRange(e,!0),l=e.pendingFormatState.pendableFormatState,s=null===(n=e.pendingFormatState.pendableFormatPosition)||void 0===n?void 0:n.normalize(),u=a&&r.Position.getStart(a).normalize(),c=u&&a.collapsed&&u.equalTo(s);return a&&l&&c&&!t?l:u?function(e,t){var n=t.node,a={},l=[],s=function(){var e=r.getTagOfNode(n),t=1==n.nodeType&&n.style;e&&t&&Object.keys(o).forEach((function(n){l.indexOf(n)>=0||(a[n]=a[n]||o[n](e,t),i[n](t)&&l.push(n))})),n=n.parentNode};for(;r.contains(e.contentDiv,n);)s();return a}(e,u):{}};var o={isBold:function(e,t){return"B"==e||"STRONG"==e||parseInt(t.fontWeight)>=700||["bold","bolder"].indexOf(t.fontWeight)>=0},isUnderline:function(e,t){return"U"==e||t.textDecoration.indexOf("underline")>=0},isItalic:function(e,t){return"I"==e||"EM"==e||"italic"===t.fontStyle},isSubscript:function(e,t){return"SUB"==e||"sub"===t.verticalAlign},isSuperscript:function(e,t){return"SUP"==e||"super"===t.verticalAlign},isStrikeThrough:function(e,t){return"S"==e||"STRIKE"==e||t.textDecoration.indexOf("line-through")>=0}},i={isBold:function(e){return""!==e.fontWeight&&parseInt(e.fontWeight)<700||"normal"===e.fontWeight},isUnderline:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("underline")<0},isItalic:function(e){return""!==e.fontStyle&&"italic"!==e.fontStyle},isSubscript:function(e){return""!==e.verticalAlign&&"sub"!==e.verticalAlign},isSuperscript:function(e){return""!==e.verticalAlign&&"super"!==e.verticalAlign},isStrikeThrough:function(e){return""!==e.textDecoration&&e.textDecoration.indexOf("line-through")<0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getSelectionRange=function(e,t){var n,o=null;if(e.lifecycle.shadowEditFragment)return o=e.lifecycle.shadowEditSelectionPath&&r.createRange(e.contentDiv,e.lifecycle.shadowEditSelectionPath.start,e.lifecycle.shadowEditSelectionPath.end);if(!t||e.api.hasFocus(e)){var i=null===(n=e.contentDiv.ownerDocument.defaultView)||void 0===n?void 0:n.getSelection();if(i&&i.rangeCount>0){var a=i.getRangeAt(0);r.contains(e.contentDiv,a)&&(o=a)}}return!o&&t&&(o=e.domEvent.selectionRange),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.getStyleBasedFormatState=function(e,t){if(!t)return{};var n=t?r.getComputedStyles(t):[],o=e.lifecycle.isDarkMode,i=e.contentDiv,a=o&&r.findClosestElementAncestor(t,i,"[data-ogsc],[data-ogac]"),l=o&&r.findClosestElementAncestor(t,i,"[data-ogsb],[data-ogab]");return{fontName:n[0],fontSize:n[1],textColor:n[2],backgroundColor:n[3],textColors:a?{darkModeColor:n[2],lightModeColor:a.dataset.ogsc||a.dataset.ogac}:void 0,backgroundColors:l?{darkModeColor:n[3],lightModeColor:l.dataset.ogsb||l.dataset.ogab}:void 0}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.insertNode=function(e,t,n){n=n||{position:3,insertOnNewLine:!1,updateCursor:!0,replaceSelection:!0};var o=e.contentDiv;return n.updateCursor&&e.api.focus(e),4==n.position?(o.parentNode.insertBefore(t,o.nextSibling),!0):(e.api.transformColor(e,t,!0,(function(){switch(n.position){case 0:case 1:var i,a=0==n.position,l=r.getFirstLastBlockElement(o,a);if(l){var s=a?l.getStartNode():l.getEndNode();n.insertOnNewLine||3==s.nodeType||r.isVoidHtmlElement(s)?r.safeInstanceOf(t,"DocumentFragment")?(i=r.toArray(t.childNodes),s.parentNode.insertBefore(t,a?s:s.nextSibling)):i=s.parentNode.insertBefore(t,a?s:s.nextSibling):i=s.insertBefore(t,a?s.firstChild:null)}else i=o.appendChild(t);if(i&&n.insertOnNewLine){var u=Array.isArray(i)?i:[i];r.isBlockElement(u[0])&&r.isBlockElement(u[u.length-1])||r.wrap(u)}break;case 2:var c=o.appendChild(t);c&&n.insertOnNewLine&&!r.isBlockElement(c)&&r.wrap(c);break;case 5:case 3:var d=function(e,t){var n=e.api.getSelectionRange(e,!0),r=null;return 5==t.position?(r=n,n=t.range):n&&(r=n.cloneRange()),{range:n,rangeToRestore:r}}(e,n),f=d.range,h=d.rangeToRestore;if(!f)return;n.replaceSelection&&!f.collapsed&&f.deleteContents();var p=r.Position.getStart(f),v=void 0;p=n.insertOnNewLine&&(v=r.getBlockElementAtNode(o,p.normalize().node))?new r.Position(v.getEndNode(),-3):r.adjustInsertPosition(o,t,p,f);var g=11==t.nodeType?t.lastChild:t;(f=r.createRange(p)).insertNode(t),n.updateCursor&&g&&(h=r.createRange(new r.Position(g,-3).normalize())),e.api.selectRange(e,h)}}),0),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.restoreUndoSnapshot=function(e,t){e.undo.hasNewContent&&t<0&&e.api.addUndoSnapshot(e,null,null,!1);var n=e.undo.snapshotsService.move(t);if(null!=n)try{e.undo.isRestoring=!0,e.api.setContent(e,n,!0)}finally{e.undo.isRestoring=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(80),o=n(0);t.selectRange=function(e,t,n){return!(e.lifecycle.shadowEditSelectionPath||!o.contains(e.contentDiv,t))&&(o.addRangeToSelection(t,n),r.hasFocus(e)||(e.domEvent.selectionRange=t),t.collapsed&&function(e){var t=e.contentDiv,n=e.pendingFormatState,r=e.api.getSelectionRange;if(n.pendableFormatState){var i=t.ownerDocument,a=o.getPendableFormatState(i);Object.keys(o.PendableFormatCommandMap).forEach((function(e){!!n.pendableFormatState[e]!=a[e]&&i.execCommand(o.PendableFormatCommandMap[e],!1,null)}));var l=r(e,!0);n.pendableFormatPosition=l&&o.Position.getStart(l)}}(e),!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.setContent=function(e,t,n){var o=!1;if(e.contentDiv.innerHTML!=t){e.api.triggerEvent(e,{eventType:20,newContent:t},!0);var i=r.setHtmlWithSelectionPath(e.contentDiv,t,e.trustedHTMLHandler);e.api.selectRange(e,i),o=!0}e.api.transformColor(e,e.contentDiv,!1,null,0),n&&(o||e.lifecycle.isDarkMode)&&e.api.triggerEvent(e,{eventType:7,source:"SetContent"},!1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.switchShadowEdit=function(e,t){var n=e.lifecycle,o=e.contentDiv,i=n.shadowEditFragment,a=n.shadowEditSelectionPath,l=!!i;if(t){if(!l){var s=e.api.getSelectionRange(e,!0);a=s&&r.getSelectionPath(o,s),i=e.contentDiv.ownerDocument.createDocumentFragment(),r.moveChildNodes(i,o),i.normalize(),e.api.triggerEvent(e,{eventType:17,fragment:i,selectionPath:a},!1),n.shadowEditFragment=i,n.shadowEditSelectionPath=a}r.moveChildNodes(o),o.appendChild(n.shadowEditFragment.cloneNode(!0))}else n.shadowEditFragment=null,n.shadowEditSelectionPath=null,l&&(e.api.triggerEvent(e,{eventType:18},!1),r.moveChildNodes(o),o.appendChild(i),e.api.focus(e),a&&e.api.selectRange(e,r.createRange(o,a.start,a.end)))}},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=[(r={},r[0]="color",r[1]="color",r[2]="ogsc",r[3]="ogac",r),(o={},o[0]="background-color",o[1]="bgcolor",o[2]="ogsb",o[3]="ogab",o)];function l(e){a.forEach((function(t){e.style.setProperty(t[0],s(e.dataset[t[2]],"")),delete e.dataset[t[2]];var n=e.dataset[t[3]];s(n,null)?e.setAttribute(t[1],n):e.removeAttribute(t[1]),delete e.dataset[t[3]]}))}function s(e,t){return e&&"undefined"!=e&&"null"!=e?e:t}t.transformColor=function(e,t,n,r,o){var s=e.lifecycle.isDarkMode?function(e,t){var n=[];if(i.safeInstanceOf(e,"HTMLElement")){t&&n.push(e);var r=e.getElementsByTagName("*");i.arrayPush(n,i.toArray(r))}else if(i.safeInstanceOf(e,"DocumentFragment")){r=e.querySelectorAll("*");i.arrayPush(n,i.toArray(r))}return n}(t,n):[],u=1==o?l:e.lifecycle.onExternalContentTransform||function(t){return function(e,t){var n=i.getComputedStyles(e,["color","background-color"]);a.forEach((function(r,o){var i=e.style.getPropertyValue(r[0]),a=e.getAttribute(r[1]);if(!e.dataset[r[2]]&&!e.dataset[r[3]]&&(i||a)){var l=t(n[o]||i||a);e.style.setProperty(r[0],l,"important"),e.dataset[r[2]]=i||"",a&&(e.setAttribute(r[1],l),e.dataset[r[3]]=a)}}))}(t,e.lifecycle.getDarkColor)};null==r||r(),s.forEach((function(e){return(null==e?void 0:e.dataset)&&e.style&&u(e)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.triggerEvent=function(e,t,n){e.lifecycle.shadowEditFragment||!n&&e.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(t,e)}))||e.plugins.forEach((function(e){e.onPluginEvent&&e.onPluginEvent(t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(158),o=n(159),i=n(160),a=n(161),l=n(162),s=n(163),u=n(164),c=n(165),d=n(166);t.default=function(e,t){var n=t.corePluginOverride||{};return{typeInContainer:n.typeInContainer||new c.default,edit:n.edit||new i.default,_placeholder:null,typeAfterLink:null,undo:n.undo||new d.default(t),domEvent:n.domEvent||new o.default(t,e),pendingFormatState:n.pendingFormatState||new u.default,mouseUp:n.mouseUp||new s.default,copyPaste:n.copyPaste||new r.default(t),entity:n.entity||new a.default,lifecycle:n.lifecycle||new l.default(t,e)}},t.getPluginState=function(e){return{domEvent:e.domEvent.getState(),pendingFormatState:e.pendingFormatState.getState(),edit:e.edit.getState(),lifecycle:e.lifecycle.getState(),undo:e.undo.getState(),entity:e.entity.getState(),copyPaste:e.copyPaste.getState()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){var t=this;this.onPaste=function(e){var n;r.extractClipboardEvent(e,(function(e){return t.editor.paste(e)}),{allowLinkPreview:t.editor.isFeatureEnabled("PasteWithLinkPreview"),allowedCustomPasteType:t.state.allowedCustomPasteType,getTempDiv:function(){return n=t.editor.getSelectionRange(),t.getTempDiv()},removeTempDiv:function(e){t.cleanUpAndRestoreSelection(e,n)}})},this.state={allowedCustomPasteType:e.allowedCustomPasteType||[]}}return e.prototype.getName=function(){return"CopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:this.onPaste,copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,t){var n=this,o=this.editor.getSelectionRange();if(o&&!o.collapsed){var i=this.editor.getContent(2),a=this.getTempDiv(!0),l=r.setHtmlWithSelectionPath(a,i,this.editor.getTrustedHTMLHandler());l&&r.addRangeToSelection(l),this.editor.triggerPluginEvent(9,{clonedRoot:a,range:l,rawEvent:e,isCut:t}),this.editor.runAsync((function(e){n.cleanUpAndRestoreSelection(a,o),t&&e.addUndoSnapshot((function(){var t=n.editor.deleteSelectedContent();e.focus(),e.select(t)}),"Cut")}))}},e.prototype.getTempDiv=function(e){var t=this,n=this.editor.getCustomData("CopyPasteTempDiv",(function(){var e=r.createElement(3,t.editor.getDocument());return t.editor.insertNode(e,{position:4}),e}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return e&&(n.style.backgroundColor="white",n.style.color="black"),n.style.display="",n.focus(),n},e.prototype.cleanUpAndRestoreSelection=function(e,t){this.editor.select(t),e.style.backgroundColor="",e.style.color="",e.style.display="none",r.moveChildNodes(e)},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e,t){var n,o=this;this.onDrop=function(e){o.editor.runAsync((function(e){e.addUndoSnapshot((function(){}),"Drop")}))},this.onFocus=function(){o.editor.select(o.state.selectionRange),o.state.selectionRange=null},this.onKeyDownDocument=function(e){9!=e.which||e.defaultPrevented||o.cacheSelection()},this.onMouseDownDocument=function(e){o.state.selectionRange||o.editor.contains(e.target)||o.cacheSelection()},this.cacheSelection=function(){o.state.selectionRange||(o.state.selectionRange=o.editor.getSelectionRange(!1))},this.onScroll=function(e){o.editor.triggerPluginEvent(14,{rawEvent:e,scrollContainer:o.state.scrollContainer})},this.onKeyboardEvent=function(e){r.isCharacterValue(e)&&e.stopPropagation()},this.onInputEvent=function(e){e.stopPropagation()},this.onContextMenuEvent=function(e){var t=[],n=o.editor.getContentSearcherOfCursor(),i=null==n?void 0:n.getInlineElementBefore(),a=e.target;2!=e.button&&(a=null==i?void 0:i.getContainerNode()),o.state.contextMenuProviders.forEach((function(e){var n=e.getContextMenuItems(a);(null==n?void 0:n.length)>0&&(t.length>0&&t.push(null),r.arrayPush(t,n))})),o.editor.triggerPluginEvent(16,{rawEvent:e,items:t})},this.state={isInIME:!1,scrollContainer:e.scrollContainer||t,selectionRange:null,stopPrintableKeyboardEventPropagation:!e.allowKeyboardEventPropagation,contextMenuProviders:(null===(n=e.plugins)||void 0===n?void 0:n.filter(i))||[]}}return e.prototype.getName=function(){return"DOMEvent"},e.prototype.initialize=function(e){var t,n,o,i,a=this;this.editor=e;var l=this.editor.getDocument(),s=((t={keypress:this.getEventHandler(1),keydown:this.getEventHandler(0),keyup:this.getEventHandler(2),mousedown:5,contextmenu:this.onContextMenuEvent,compositionstart:function(){return a.state.isInIME=!0},compositionend:function(t){a.state.isInIME=!1,e.triggerPluginEvent(4,{rawEvent:t})},drop:this.onDrop,focus:this.onFocus})[r.Browser.isIE?"textinput":"input"]=this.getEventHandler(3),t);r.Browser.isSafari?(l.addEventListener("mousedown",this.onMouseDownDocument,!0),l.addEventListener("keydown",this.onKeyDownDocument),null===(n=l.defaultView)||void 0===n||n.addEventListener("blur",this.cacheSelection)):s[r.Browser.isIEOrEdge?"beforedeactivate":"blur"]=this.cacheSelection,this.disposer=e.addDomEventHandler(s),this.state.scrollContainer.addEventListener("scroll",this.onScroll),null===(o=l.defaultView)||void 0===o||o.addEventListener("scroll",this.onScroll),null===(i=l.defaultView)||void 0===i||i.addEventListener("resize",this.onScroll)},e.prototype.dispose=function(){var e,t,n,o=this.editor.getDocument();r.Browser.isSafari&&(o.removeEventListener("mousedown",this.onMouseDownDocument,!0),o.removeEventListener("keydown",this.onKeyDownDocument),null===(e=o.defaultView)||void 0===e||e.removeEventListener("blur",this.cacheSelection)),null===(t=o.defaultView)||void 0===t||t.removeEventListener("resize",this.onScroll),null===(n=o.defaultView)||void 0===n||n.removeEventListener("scroll",this.onScroll),this.state.scrollContainer.removeEventListener("scroll",this.onScroll),this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.getEventHandler=function(e){return this.state.stopPrintableKeyboardEventPropagation?{pluginEventType:e,beforeDispatch:3==e?this.onInputEvent:this.onKeyboardEvent}:e},e}();function i(e){var t;return!!(null===(t=e)||void 0===t?void 0:t.getContextMenuItems)}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(){this.state={features:{}}}return e.prototype.getName=function(){return"Edit"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){var t,n=!1,o=!1;if(0==e.eventType){var i=e.rawEvent,a=this.editor.getSelectionRange();n=(o=r.isCtrlOrMetaPressed(i))||i.altKey,t=this.state.features[i.which]||a&&!a.collapsed&&this.state.features[258]}else 7==e.eventType&&(t=this.state.features[257]);for(var l=0;l<(null==t?void 0:t.length);l++){var s=t[l];if((s.allowFunctionKeys||!n)&&s.shouldHandleEvent(e,this.editor,o)){s.handleEvent(e,this.editor);break}}},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=/_(\d{1,8})$/,i=["^_Entity$","^_EId_","^_EType_","^_EReadonly_"],a=[6,7,4,5],l=function(){function e(){var e=this;this.handleCutEvent=function(t){var n=e.editor.getSelectionRange();n&&!n.collapsed&&e.checkRemoveEntityForRange(t)},this.state={knownEntityElements:[],shadowEntityCache:{}}}return e.prototype.getName=function(){return"Entity"},e.prototype.initialize=function(e){this.editor=e},e.prototype.willHandleEventExclusively=function(e){var t;return 1==e.eventType&&!!(null===(t=e.rawEvent.target)||void 0===t?void 0:t.shadowRoot)},e.prototype.dispose=function(){this.editor=null,this.state.knownEntityElements=[]},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 6:this.handleMouseUpEvent(e);break;case 0:this.handleKeyDownEvent(e.rawEvent);break;case 9:e.isCut&&this.handleCutEvent(e.rawEvent);break;case 10:this.handleBeforePasteEvent(e.sanitizingOption);break;case 7:this.handleContentChangedEvent(e);break;case 11:this.handleContentChangedEvent();break;case 8:this.handleExtractContentWithDomEvent(e.clonedRoot);break;case 16:this.handleContextMenuEvent(e.rawEvent);break;case 20:this.handleBeforeSetContentEvent();break;case 15:this.handleEntityOperationEvent(e)}},e.prototype.handleContextMenuEvent=function(e){var t=e.target,n=t&&this.editor.getElementAtCursor(r.getEntitySelector(),t);n&&(e.preventDefault(),this.triggerEvent(n,2,e))},e.prototype.handleMouseUpEvent=function(e){var t,n=e.rawEvent,o=e.isClicking,i=n.target;o&&i&&(t=this.editor.getElementAtCursor(r.getEntitySelector(),i))&&(this.triggerEvent(t,1,n),s(this.editor))},e.prototype.handleKeyDownEvent=function(e){if(r.isCharacterValue(e)||8==e.which||46==e.which||13==e.which){var t=this.editor.getSelectionRange();t&&!t.collapsed&&this.checkRemoveEntityForRange(e)}},e.prototype.handleBeforePasteEvent=function(e){this.editor.getSelectionRange().collapsed||this.checkRemoveEntityForRange(null),r.arrayPush(e.additionalAllowedCssClasses,i)},e.prototype.handleBeforeSetContentEvent=function(){this.cacheShadowEntities(this.state.shadowEntityCache)},e.prototype.handleContentChangedEvent=function(e){for(var t=this,n=this.state.knownEntityElements.length-1;n>=0;n--){var o=this.state.knownEntityElements[n];this.editor.contains(o)||(this.setIsEntityKnown(o,!1),o.shadowRoot&&this.triggerEvent(o,10))}var i=this.state.knownEntityElements.map((function(e){var t;return null===(t=r.getEntityFromElement(e))||void 0===t?void 0:t.id})).filter((function(e){return!!e}));("InsertEntity"==(null==e?void 0:e.source)&&e.data?[e.data]:this.getExistingEntities().filter((function(e){var n=e.wrapper;return!t.isEntityKnown(n)}))).forEach((function(e){var n=e.wrapper,o=e.type,a=e.id,l=e.isReadonly;e.id=t.ensureUniqueId(o,a,i),r.commitEntity(n,o,l,e.id),t.handleNewEntity(e)})),Object.keys(this.state.shadowEntityCache).forEach((function(e){t.triggerEvent(t.state.shadowEntityCache[e],6),delete t.state.shadowEntityCache[e]}))},e.prototype.handleEntityOperationEvent=function(e){var t,n=this;a.indexOf(e.operation)>=0&&(null===(t=this.cancelAsyncRun)||void 0===t||t.call(this),this.cancelAsyncRun=this.editor.runAsync((function(){n.cancelAsyncRun=null,n.handleContentChangedEvent()})))},e.prototype.handleExtractContentWithDomEvent=function(e){var t=this;r.toArray(e.querySelectorAll(r.getEntitySelector())).forEach((function(e){e.removeAttribute("contentEditable"),t.triggerEvent(e,8)}))},e.prototype.checkRemoveEntityForRange=function(e){var t=this,n=[],o=r.getEntitySelector();if(this.editor.queryElements(o,1,(function(r){r.isContentEditable?n.push(r):t.triggerEvent(r,6,e)})),n.length>0){var i=this.editor.queryElements(o,2);n.forEach((function(n){var r=i.indexOf(n)>=0;t.triggerEvent(n,r?6:7,e)}))}},e.prototype.triggerEvent=function(e,t,n,o){var i=e&&r.getEntityFromElement(e);i&&this.editor.triggerPluginEvent(15,{operation:t,rawEvent:n,entity:i,contentForShadowEntity:o})},e.prototype.handleNewEntity=function(e){var t=e.wrapper,n=this.editor.getDocument().createDocumentFragment(),o=this.state.shadowEntityCache[e.id];if(delete this.state.shadowEntityCache[e.id],(null==o?void 0:o.shadowRoot)&&r.moveChildNodes(n,o.shadowRoot),this.triggerEvent(t,0,void 0,n),n.firstChild)t.shadowRoot?r.moveChildNodes(t.shadowRoot,n):this.createShadowRoot(t,n);else if(t.shadowRoot){this.triggerEvent(t,10);var i=t.cloneNode();r.moveChildNodes(i,t),this.editor.replaceNode(t,i),e.wrapper=i}this.setIsEntityKnown(e.wrapper,!0)},e.prototype.getExistingEntities=function(e){return this.editor.queryElements(r.getEntitySelector()).map(r.getEntityFromElement).filter((function(t){return!(!t||e&&!t.wrapper.shadowRoot)}))},e.prototype.createShadowRoot=function(e,t){if(e.attachShadow){var n=e.attachShadow({mode:"open",delegatesFocus:!0});return e.contentEditable="false",this.triggerEvent(e,9),r.moveChildNodes(n,t),n}},e.prototype.cacheShadowEntities=function(e){this.getExistingEntities(!0).forEach((function(t){var n=t.wrapper,r=t.id;e[r]=n}))},e.prototype.ensureUniqueId=function(e,t,n){for(var r=o.exec(t),i=(r?t.substr(0,t.length-r[0].length):t)||e,a="",l=r&&parseInt(r[1])||0;;l++)if(a=l>0?i+"_"+l:i,n.indexOf(a)<0){n.push(a);break}return a},e.prototype.setIsEntityKnown=function(e,t){var n=this.state.knownEntityElements.indexOf(e);t&&n<0?this.state.knownEntityElements.push(e):!t&&n>=0&&this.state.knownEntityElements.splice(n,1)},e.prototype.isEntityKnown=function(e){return this.state.knownEntityElements.indexOf(e)>=0},e}();t.default=l;var s=r.Browser.isIE?function(e){e.runAsync((function(e){var t=e.getCustomData("ENTITY_IE_FOCUS_BUTTON",(function(){var t=r.createElement({tag:"button",style:"overflow:hidden;position:fixed;width:0;height:0;top:-1000px"},e.getDocument());return t.onblur=function(){t.style.display="none"},e.insertNode(t,{position:4}),t}));t.style.display="",r.addRangeToSelection(r.createRange(t,0))}))}:function(){}},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=i.Browser.isFirefox?((r={}).enableObjectResizing=!1,r.enableInlineTableEditing=!1,r):i.Browser.isIE?((o={}).defaultParagraphSeparator="div",o.AutoUrlDetect=!1,o):{},l={darkModeColor:"rgb(51,51,51)",lightModeColor:"rgb(255,255,255)"},s={darkModeColor:"rgb(255,255,255)",lightModeColor:"rgb(0,0,0)"},u=function(){function e(e,t){var n=this;this.initialContent=e.initialContent||t.innerHTML||"",this.contentDivFormat=i.getComputedStyles(t),null===t.getAttribute("contenteditable")&&(this.initializer=function(){t.contentEditable="true",n.setSelectStyle(t,"text")},this.disposer=function(){n.setSelectStyle(t,""),t.removeAttribute("contenteditable")}),this.adjustColor=e.doNotAdjustEditorColor?function(){}:function(){var e=s,r=l,o=n.state.isDarkMode;i.setColor(t,e,!1,o),i.setColor(t,r,!0,o)},this.state={customData:{},defaultFormat:e.defaultFormat||null,isDarkMode:!!e.inDarkMode,getDarkColor:e.getDarkColor||function(e){return e},onExternalContentTransform:e.onExternalContentTransform,experimentalFeatures:e.experimentalFeatures||[],shadowEditFragment:null,shadowEditSelectionPath:null}}return e.prototype.getName=function(){return"Lifecycle"},e.prototype.initialize=function(e){var t;this.editor=e,this.recalculateDefaultFormat(),this.editor.setContent(this.initialContent,!1),null===(t=this.initializer)||void 0===t||t.call(this),this.adjustColor(),this.adjustBrowserBehavior(),this.editor.triggerPluginEvent(11,{},!0)},e.prototype.dispose=function(){var e=this;this.editor.triggerPluginEvent(12,{},!0),Object.keys(this.state.customData).forEach((function(t){var n=e.state.customData[t];n&&n.disposer&&n.disposer(n.value),delete e.state.customData[t]})),this.disposer&&(this.disposer(),this.disposer=null,this.initializer=null),this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){7!=e.eventType||"SwitchToDarkMode"!=e.source&&"SwitchToLightMode"!=e.source||(this.state.isDarkMode="SwitchToDarkMode"==e.source,this.recalculateDefaultFormat(),this.adjustColor())},e.prototype.adjustBrowserBehavior=function(){var e=this;Object.keys(a).forEach((function(t){try{e.editor.getDocument().execCommand(t,!1,a[t])}catch(e){}}))},e.prototype.setSelectStyle=function(e,t){e.style.userSelect=t,e.style.msUserSelect=t,e.style.webkitUserSelect=t},e.prototype.recalculateDefaultFormat=function(){var e=this.state,t=e.defaultFormat,n=e.isDarkMode;if(n&&t&&(t.backgroundColors||(t.backgroundColors=l),t.textColors||(t.textColors=s)),!t||0!==Object.keys(t).length){var r=t||{},o=r.fontFamily,i=r.fontSize,a=r.textColor,u=r.textColors,c=r.backgroundColor,d=r.backgroundColors,f=r.bold,h=r.italic,p=r.underline,v=this.contentDivFormat;this.state.defaultFormat={fontFamily:o||v[0],fontSize:i||v[1],get textColor(){return u?n?u.darkModeColor:u.lightModeColor:a||v[2]},textColors:u,get backgroundColor(){return d?n?d.darkModeColor:d.lightModeColor:c||""},backgroundColors:d,bold:f,italic:h,underline:p}}},e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.onMouseUp=function(t){e.editor&&(e.removeMouseUpEventListener(),e.editor.triggerPluginEvent(6,{rawEvent:t,isClicking:e.mouseDownX==t.pageX&&e.mouseDownY==t.pageY}))}}return e.prototype.getName=function(){return"MouseUp"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.removeMouseUpEventListener(),this.editor=null},e.prototype.onPluginEvent=function(e){5!=e.eventType||this.mouseUpEventListerAdded||(this.editor.getDocument().addEventListener("mouseup",this.onMouseUp,!0),this.mouseUpEventListerAdded=!0,this.mouseDownX=e.rawEvent.pageX,this.mouseDownY=e.rawEvent.pageY)},e.prototype.removeMouseUpEventListener=function(){this.mouseUpEventListerAdded&&(this.mouseUpEventListerAdded=!1,this.editor.getDocument().removeEventListener("mouseup",this.onMouseUp,!0))},e}();t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(){this.state={pendableFormatPosition:null,pendableFormatState:null}}return e.prototype.getName=function(){return"PendingFormatState"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null,this.clear()},e.prototype.getState=function(){return this.state},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 13:this.state.pendableFormatPosition=this.getCurrentPosition(),this.state.pendableFormatState=e.formatState;break;case 0:case 5:case 7:this.state.pendableFormatPosition&&!this.state.pendableFormatPosition.equalTo(this.getCurrentPosition())&&this.clear()}},e.prototype.clear=function(){this.state.pendableFormatPosition=null,this.state.pendableFormatState=null},e.prototype.getCurrentPosition=function(){var e=this.editor.getSelectionRange();return e&&r.Position.getStart(e).normalize()},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(){}return e.prototype.getName=function(){return"TypeInContainer"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(1==e.eventType){var t=this.editor.getSelectionRange(),n=this.editor.isFeatureEnabled("AlwaysApplyDefaultFormat");if(!t||this.editor.contains(r.findClosestElementAncestor(t.startContainer,null,n?"[style]":null)))return;t.collapsed?this.editor.ensureTypeInContainer(r.Position.getStart(t),e.rawEvent):this.editor.runAsync((function(t){t.ensureTypeInContainer(t.getFocusedPosition(),e.rawEvent)}))}},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){var t;this.state={snapshotsService:e.undoSnapshotService||(t=r.createSnapshots(1e7),{canMove:function(e){return r.canMoveCurrentSnapshot(t,e)},move:function(e){return r.moveCurrentSnapshot(t,e)},addSnapshot:function(e,n){return r.addSnapshot(t,e,n)},clearRedo:function(){return r.clearProceedingSnapshots(t)},canUndoAutoComplete:function(){return r.canUndoAutoComplete(t)}}),isRestoring:!1,hasNewContent:!1,isNested:!1,autoCompletePosition:null}}return e.prototype.getName=function(){return"Undo"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.willHandleEventExclusively=function(e){return 0==e.eventType&&8==e.rawEvent.which&&this.canUndoAutoComplete()},e.prototype.onPluginEvent=function(e){if(this.editor&&!this.editor.isInIME())switch(e.eventType){case 11:var t=this.editor.getUndoState();t.canUndo||t.canRedo||this.addUndoSnapshot();break;case 0:this.onKeyDown(e.rawEvent);break;case 1:this.onKeyPress(e.rawEvent);break;case 4:this.clearRedoForInput(),this.addUndoSnapshot();break;case 7:this.state.isRestoring||this.clearRedoForInput()}},e.prototype.onKeyDown=function(e){if(8==e.which||46==e.which)if(8==e.which&&this.canUndoAutoComplete())e.preventDefault(),this.editor.undo(),this.state.autoCompletePosition=null,this.lastKeyPress=e.which;else{var t=this.editor.getSelectionRange();!t||t.collapsed&&this.lastKeyPress==e.which&&!r.isCtrlOrMetaPressed(e)||this.addUndoSnapshot(),this.state.hasNewContent=!0,this.lastKeyPress=e.which}else e.which>=33&&e.which<=40&&(this.state.hasNewContent&&this.addUndoSnapshot(),this.lastKeyPress=0)},e.prototype.onKeyPress=function(e){if(!e.metaKey){var t=this.editor.getSelectionRange();t&&!t.collapsed||32==e.which&&32!=this.lastKeyPress||13==e.which?(this.addUndoSnapshot(),13==e.which&&(this.state.hasNewContent=!0)):this.clearRedoForInput(),this.lastKeyPress=e.which}},e.prototype.clearRedoForInput=function(){this.state.snapshotsService.clearRedo(),this.lastKeyPress=0,this.state.hasNewContent=!0},e.prototype.canUndoAutoComplete=function(){var e;return this.state.snapshotsService.canUndoAutoComplete()&&(null===(e=this.state.autoCompletePosition)||void 0===e?void 0:e.equalTo(this.editor.getFocusedPosition()))},e.prototype.addUndoSnapshot=function(){this.editor.addUndoSnapshot(),this.state.autoCompletePosition=null},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(168);t.default=function(e){try{var t=r(e||void 0),n=t.lab().array(),o=.78753*(100-n[0])+21.247;e=r.lab(o,n[1],n[2]).rgb().alpha(t.alpha()).toString()}catch(e){}return e}},function(e,t,n){"use strict";var r=n(169),o=n(172),i=[].slice,a=["keyword","gray","hex"],l={};Object.keys(o).forEach((function(e){l[i.call(o[e].labels).sort().join("")]=e}));var s={};function u(e,t){if(!(this instanceof u))return new u(e,t);if(t&&t in a&&(t=null),t&&!(t in o))throw new Error("Unknown model: "+t);var n,c;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof u)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var d=r.get(e);if(null===d)throw new Error("Unable to parse color from string: "+e);this.model=d.model,c=o[this.model].channels,this.color=d.value.slice(0,c),this.valpha="number"==typeof d.value[c]?d.value[c]:1}else if(e.length){this.model=t||"rgb",c=o[this.model].channels;var f=i.call(e,0,c);this.color=h(f,c),this.valpha="number"==typeof e[c]?e[c]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var p=Object.keys(e);"alpha"in e&&(p.splice(p.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var v=p.sort().join("");if(!(v in l))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=l[v];var g=o[this.model].labels,m=[];for(n=0;n<g.length;n++)m.push(e[g[n]]);this.color=h(m)}if(s[this.model])for(c=o[this.model].channels,n=0;n<c;n++){var y=s[this.model][n];y&&(this.color[n]=y(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function c(e,t,n){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(s[e]||(s[e]=[]))[t]=n})),e=e[0],function(r){var o;return arguments.length?(n&&(r=n(r)),(o=this[e]()).color[t]=r,o):(o=this[e]().color[t],n&&(o=n(o)),o)}}function d(e){return function(t){return Math.max(0,Math.min(e,t))}}function f(e){return Array.isArray(e)?e:[e]}function h(e,t){for(var n=0;n<t;n++)"number"!=typeof e[n]&&(e[n]=0);return e}u.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in r.to?this:this.rgb(),n=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return r.to[t.model](n)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),n=1===t.valpha?t.color:t.color.concat(this.valpha);return r.to.rgb.percent(n)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=o[this.model].channels,n=o[this.model].labels,r=0;r<t;r++)e[n[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new u(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new u(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:c("rgb",0,d(255)),green:c("rgb",1,d(255)),blue:c("rgb",2,d(255)),hue:c(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:c("hsl",1,d(100)),lightness:c("hsl",2,d(100)),saturationv:c("hsv",1,d(100)),value:c("hsv",2,d(100)),chroma:c("hcg",1,d(100)),gray:c("hcg",2,d(100)),white:c("hwb",1,d(100)),wblack:c("hwb",2,d(100)),cyan:c("cmyk",0,d(100)),magenta:c("cmyk",1,d(100)),yellow:c("cmyk",2,d(100)),black:c("cmyk",3,d(100)),x:c("xyz",0,d(100)),y:c("xyz",1,d(100)),z:c("xyz",2,d(100)),l:c("lab",0,d(100)),a:c("lab",1),b:c("lab",2),keyword:function(e){return arguments.length?new u(e):o[this.model].keyword(this.color)},hex:function(e){return arguments.length?new u(e):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},isDark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},isLight:function(){return!this.isDark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return u.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),n=t.color[0];return n=(n=(n+e)%360)<0?360+n:n,t.color[0]=n,t},mix:function(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);var n=e.rgb(),r=this.rgb(),o=void 0===t?.5:t,i=2*o-1,a=n.alpha()-r.alpha(),l=((i*a==-1?i:(i+a)/(1+i*a))+1)/2,s=1-l;return u.rgb(l*n.red()+s*r.red(),l*n.green()+s*r.green(),l*n.blue()+s*r.blue(),n.alpha()*o+r.alpha()*(1-o))}},Object.keys(o).forEach((function(e){if(-1===a.indexOf(e)){var t=o[e].channels;u.prototype[e]=function(){if(this.model===e)return new u(this);if(arguments.length)return new u(arguments,e);var n="number"==typeof arguments[t]?t:this.valpha;return new u(f(o[this.model][e].raw(this.color)).concat(n),e)},u[e]=function(n){return"number"==typeof n&&(n=h(i.call(arguments),t)),new u(n,e)}}})),e.exports=u},function(e,t,n){var r=n(82),o=n(170),i={};for(var a in r)r.hasOwnProperty(a)&&(i[r[a]]=a);var l=e.exports={to:{},get:{}};function s(e,t,n){return Math.min(Math.max(t,e),n)}function u(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}l.get=function(e){var t,n;switch(e.substring(0,3).toLowerCase()){case"hsl":t=l.get.hsl(e),n="hsl";break;case"hwb":t=l.get.hwb(e),n="hwb";break;default:t=l.get.rgb(e),n="rgb"}return t?{model:n,value:t}:null},l.get.rgb=function(e){if(!e)return null;var t,n,o,i=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(o=t[2],t=t[1],n=0;n<3;n++){var a=2*n;i[n]=parseInt(t.slice(a,a+2),16)}o&&(i[3]=parseInt(o,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(o=(t=t[1])[3],n=0;n<3;n++)i[n]=parseInt(t[n]+t[n],16);o&&(i[3]=parseInt(o+o,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(n=0;n<3;n++)i[n]=parseInt(t[n+1],0);t[4]&&(i[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(i=r[t[1]])?(i[3]=1,i):null:null;for(n=0;n<3;n++)i[n]=Math.round(2.55*parseFloat(t[n+1]));t[4]&&(i[3]=parseFloat(t[4]))}for(n=0;n<3;n++)i[n]=s(i[n],0,255);return i[3]=s(i[3],0,1),i},l.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(n)?1:n,0,1)]}return null},l.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var n=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,s(parseFloat(t[2]),0,100),s(parseFloat(t[3]),0,100),s(isNaN(n)?1:n,0,1)]}return null},l.to.hex=function(){var e=o(arguments);return"#"+u(e[0])+u(e[1])+u(e[2])+(e[3]<1?u(Math.round(255*e[3])):"")},l.to.rgb=function(){var e=o(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},l.to.rgb.percent=function(){var e=o(arguments),t=Math.round(e[0]/255*100),n=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+n+"%, "+r+"%)":"rgba("+t+"%, "+n+"%, "+r+"%, "+e[3]+")"},l.to.hsl=function(){var e=o(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},l.to.hwb=function(){var e=o(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},l.to.keyword=function(e){return i[e.slice(0,3)]}},function(e,t,n){"use strict";var r=n(171),o=Array.prototype.concat,i=Array.prototype.slice,a=e.exports=function(e){for(var t=[],n=0,a=e.length;n<a;n++){var l=e[n];r(l)?t=o.call(t,i.call(l)):t.push(l)}return t};a.wrap=function(e){return function(){return e(a(arguments))}}},function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},function(e,t,n){var r=n(83),o=n(173),i={};Object.keys(r).forEach((function(e){i[e]={},Object.defineProperty(i[e],"channels",{value:r[e].channels}),Object.defineProperty(i[e],"labels",{value:r[e].labels});var t=o(e);Object.keys(t).forEach((function(n){var r=t[n];i[e][n]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var n=e(t);if("object"==typeof n)for(var r=n.length,o=0;o<r;o++)n[o]=Math.round(n[o]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(r),i[e][n].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=i},function(e,t,n){var r=n(83);function o(e){var t=function(){for(var e={},t=Object.keys(r),n=t.length,o=0;o<n;o++)e[t[o]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var o=n.pop(),i=Object.keys(r[o]),a=i.length,l=0;l<a;l++){var s=i[l],u=t[s];-1===u.distance&&(u.distance=t[o].distance+1,u.parent=o,n.unshift(s))}return t}function i(e,t){return function(n){return t(e(n))}}function a(e,t){for(var n=[t[e].parent,e],o=r[t[e].parent][e],a=t[e].parent;t[a].parent;)n.unshift(t[a].parent),o=i(r[t[a].parent][a],o),a=t[a].parent;return o.conversion=n,o}e.exports=function(e){for(var t=o(e),n={},r=Object.keys(t),i=r.length,l=0;l<i;l++){var s=r[l];null!==t[s].parent&&(n[s]=a(s,t))}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(175))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(176);t.ContentEdit=r.default;var o=n(85);t.getAllFeatures=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(85),o=function(){function e(e,t){this.settingsOverride=e,this.additionalFeatures=t}return e.prototype.getName=function(){return"ContentEdit"},e.prototype.initialize=function(e){var t=this,n=[],o=r.default();Object.keys(o).forEach((function(e){var r=o[e],i=t.settingsOverride&&void 0!==t.settingsOverride[e];(i&&t.settingsOverride[e]||!i&&!r.defaultDisabled)&&n.push(r)})),n.concat(this.additionalFeatures||[]).forEach((function(t){return e.addContentEditFeature(t)}))},e.prototype.dispose=function(){},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(0),i=/[.+=\s:;"',>]+$/i,a={keys:[13,32,257],shouldHandleEvent:s,handleEvent:function(e,t){var n=t.getDocument().createElement("a"),i=s(e,t),a=t.getContentSearcherOfCursor();n.textContent=i.originalUrl,n.href=i.normalizedUrl,t.runAsync((function(t){t.addUndoSnapshot((function(){return r.replaceWithNode(t,i.originalUrl,n,!1,a),o.clearEventDataCache(e),n}),"AutoLink",!0)}))}},l={keys:[8],shouldHandleEvent:function(e,t){return t.getContentSearcherOfCursor(e).getInlineElementBefore()instanceof o.LinkInlineElement},handleEvent:function(e,t){e.rawEvent.preventDefault(),r.removeLink(t)},defaultDisabled:!0};function s(e,t){return 0==e.eventType||7==e.eventType&&"Paste"==e.source?o.cacheGetEventData(e,"LINK_DATA",(function(){var n=7==e.eventType&&"Paste"==e.source&&e.data,r=o.matchLink((n.text||"").trim()),a=t.getContentSearcherOfCursor(e);if(r&&a.getRangeFromText(r.originalUrl,!1))return r;var l=a&&a.getWordBefore();if(l&&l.length>5){var s=(l.match(i)||[])[0]||"",u=l.substring(0,l.length-s.length);return["()","{}","[]"].forEach((function(e){u[u.length-1]==e[1]&&u.indexOf(e[0])<0&&(u=u.substr(0,u.length-1))})),o.matchLink(u)}return null})):null}t.AutoLinkFeatures={autoLink:a,unlinkWhenBackspaceAfterLink:l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),o=n(0);t.FONT_SIZES=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];function i(e,t,n){e=1==t?Math.floor(e):Math.ceil(e);var r=n[n.length-1];if(e<=n[0])e=Math.max(e+t,1);else if(e>r||e==r&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),r),1e3);else if(1==t){for(var o=0;o<n.length;o++)if(e<n[o]){e=n[o];break}}else for(o=n.length-1;o>=0;o--)if(e>n[o]){e=n[o];break}return e}t.default=function(e,n,a){void 0===a&&(a=t.FONT_SIZES);var l=0==n?1:-1;r.default(e,(function(e){var t=parseFloat(o.getComputedStyle(e,"font-size"));e.style.fontSize=i(t,l,a)+"pt","normal"!=o.getComputedStyle(e,"line-height")&&(e.style.lineHeight="normal")}))},t.getNewFontSize=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(86);t.default=function(e){r.default(e,1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=/^[a-zA-Z]+:/i,i=/^[\w.%+-]+@/i,a=/^ftp\./i;function l(e){return e.queryElements("a[href]",1)[0]}function s(e,t){t&&e.textContent!=t&&(e.textContent=t)}t.default=function(e,t,n,u){e.focus();var c=(function(e){var t=new r.HtmlSanitizer,n=document.createElement("a");return n.href=e||"",t.sanitize(n),n.getAttribute("href")}(t)||"").trim();if(c){var d=r.matchLink(c),f=d?d.normalizedUrl:function(e){if(!e)return e;var t="";return e.search(o)<0&&(t=0==e.search(i)?"mailto:":0==e.search(a)?"ftp://":"http://"),t+e}(c),h=d?d.originalUrl:c;e.addUndoSnapshot((function(){var t=e.getSelectionRange(),r=null;return t&&t.collapsed?(r=l(e))?(r.href=f,s(r,u)):((r=e.getDocument().createElement("A")).textContent=u||h,r.href=f,e.insertNode(r)):(e.getDocument().execCommand("createLink",!1,f),s(r=l(e),u)),n&&r&&(r.removeAttribute("istemptitle"),r.title=n),r}),"CreateLink")}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);function i(e,t){var n=o.getTagOfNode(e.getElementAtCursor("OL,UL",null,t)),r=o.getTagOfNode(e.getElementAtCursor("H1,H2,H3,H4,H5,H6",null,t));return{isBullet:"UL"==n,isNumbering:"OL"==n,headerLevel:r&&parseInt(r[1])||0,canUnlink:!!e.queryElements("a[href]",1)[0],canAddImageAltText:!!e.queryElements("img",1)[0],isBlockQuote:!!e.queryElements("blockquote",1)[0]}}t.getElementBasedFormatState=i,t.default=function(e,t){return r(r(r(r({},e.getPendableFormatState(!1)),i(e,t)),e.getStyleBasedFormatState()),e.getUndoState())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n,o,i,a){var l=r.wrap(n,o?"DIV":"SPAN");if(!o&&i&&(l.style.display="inline-block"),r.commitEntity(l,t,i),!e.contains(l)){var s=void 0,u=void 0;if("number"==typeof a)u=a;else if(a){s=e.getSelectionRange();var c=a.normalize().node,d=c&&e.getElementAtCursor(r.getEntitySelector(),c);d&&(a=new r.Position(d,-3)),e.select(a),u=3}else e.focus(),u=3;e.insertNode(l,{updateCursor:!1,insertOnNewLine:o,replaceSelection:!0,position:u}),3==u&&(s?e.select(s):o||e.select(l,-3))}if(o){var f=e.getDocument().createElement("BR");l.parentNode.insertBefore(f,l.nextSibling)}var h=r.getEntityFromElement(l);return e.triggerContentChangedEvent("InsertEntity",h),h}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e,t){e.addUndoSnapshot((function(){var n=e.getDocument().createElement("img");n.src=t,n.style.maxWidth="100%",e.insertNode(n)}),"Format")}t.default=function(e,t){"string"==typeof t?o(e,t):r.readFile(t,(function(t){t&&!e.isDisposed()&&o(e,t)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e){return e<=4?"120px":e<=6?"100px":"70px"}t.default=function(e,t,n,i){var a=e.getDocument(),l=a.createDocumentFragment(),s=a.createElement("table");l.appendChild(s),s.cellSpacing="0",s.cellPadding="1";for(var u=0;u<n;u++){var c=a.createElement("tr");s.appendChild(c);for(var d=0;d<t;d++){var f=a.createElement("td");c.appendChild(f),f.appendChild(a.createElement("br")),f.style.width=o(t)}}e.focus(),e.addUndoSnapshot((function(){var t=new r.VTable(s);t.applyFormat(i||{bgColorEven:"#FFF",bgColorOdd:"#FFF",topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB"}),t.writeBack(),e.insertNode(l),e.runAsync((function(e){return e.select(new r.Position(s,0).normalize())}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.getElementAtCursor("TD,TH");n&&e.addUndoSnapshot((function(o,i){var a=new r.VTable(n);a.edit(t),a.writeBack(),e.focus();var l=function(e,t,n){var r=t,o=n;switch(e){case 0:o=0;break;case 1:r+=1,o=0;break;case 2:r=0;break;case 3:r=0,o+=1}return{newRow:r,newCol:o}}(t,a.row,a.col);e.select(a.getCell(l.newRow,l.newCol).td,0)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n){(n=n||e.getElementAtCursor("TABLE"))&&e.addUndoSnapshot((function(o,i){var a=new r.VTable(n);a.applyFormat(t),a.writeBack(),e.focus(),e.select(o,i)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){e.focus(),e.addUndoSnapshot((function(t,n){e.queryElements("a[href]",1,r.unwrap),e.select(t,n)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,o){if(!t||!n)return!1;var i;if(i="string"==typeof t?(o=o||e.getContentSearcherOfCursor())&&o.getRangeFromText(t,r):t){var a=e.getSelectionRange();return a.collapsed&&i.endContainer==a.startContainer&&i.endOffset==a.startOffset&&(r=!0),e.insertNode(n,{position:5,updateCursor:r,replaceSelection:!0,insertOnNewLine:!1,range:i}),!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){t&&e.addUndoSnapshot((function(){t.style.transform="rotate("+n+"deg)"}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e,t){var n="justifyLeft",o="left";1==t?(n="justifyCenter",o="center"):2==t&&(n="justifyRight",o="right"),e.addUndoSnapshot((function(){r.default(e,n),e.queryElements("[align]",1,(function(e){return e.style.textAlign=o}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(192);t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(n,o){r.default(e,(function(e){e.setAttribute("dir",0==t?"ltr":"rtl"),e.style.textAlign=0==t?"left":"right"})),e.select(n,o)}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e){var t=e.getStartNode();return t==e.getEndNode()&&3==t.nodeType&&["TR","TABLE"].indexOf(r.getTagOfNode(t.parentNode))>=0}t.default=function(e,t){for(var n=e.getSelectionTraverser(),r=n&&n.currentBlockElement,i=[];r;)o(r)||i.push(r),r=n.getNextBlockElement();i.forEach((function(e){var n=e.collapseToSingleElement();t(n)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){e.focus(),e.addUndoSnapshot((function(){e.queryElements("img",1,(function(e){return e.setAttribute("alt",t)}))}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(25),o=n(0);function i(e,t){var n=o.collapseNodesInRegion(e,t);o.wrap(n,2)}function a(e,t){t.forEach((function(t){var n=t.collapseToSingleElement(),r=o.findClosestElementAncestor(n,e.rootNode,"blockquote");if(r){for(n==r&&(n=o.wrap(o.toArray(n.childNodes)));o.isNodeInRegion(e,n)&&"BLOCKQUOTE"!=o.getTagOfNode(n);)n=o.splitBalancedNodeRange(n);o.isNodeInRegion(e,n)&&o.unwrap(n)}}))}t.default=function(e,t){var n=0==t?i:a;r.default(e,(function(e,r,i){for(var a=o.getSelectedBlockElementsInRegion(e,!0),l=[[]],s=0;s<a.length;s++){var u=a[s].getStartNode(),c=o.createVListFromRegion(e,!0,u);if(c){for(l.push([]);a[s+1]&&c.contains(a[s+1].getStartNode());)s++;c.setIndentation(r,i,t),c.writeBack()}else l[l.length-1].push(a[s])}l.forEach((function(t){return n(e,t)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),o=n(0);t.default=function(e,t,n){function i(e,n){switch(t){case"lowercase":return e.toLocaleLowerCase(n);case"uppercase":return e.toLocaleUpperCase(n);case"capitalize":for(var r=e.toLocaleLowerCase(n).split(" "),o=0;o<r.length;o++)r[o]=r[o].charAt(0).toLocaleUpperCase(n)+r[o].slice(1);return r.join(" ");case"sentence":var i=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");return e.toLocaleLowerCase(n).replace(i,(function(e){return e.toLocaleUpperCase(n)}))}}r.default(e,(function(e){for(var t=o.getFirstLeafNode(e);t;t=o.getNextLeafSibling(e,t))if(3==t.nodeType)try{t.textContent=i(t.textContent,n)}catch(e){t.textContent=i(t.textContent,void 0)}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49);t.default=function(e){r.default(e,2)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(49);t.default=function(e,t){r.default(e,1,t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t,n){void 0===n&&(n=1),e.addUndoSnapshot((function(){e.focus();var o=e.getSelectedRegions();if(o[0]){var i=r.createVListFromRegion(o[0],!1,t);i&&(i.split(t,n),i.writeBack())}}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95),o=n(0),i=function(e){e.style.borderLeft="3px solid",e.style.borderColor="#C8C8C8",e.style.paddingLeft="10px",e.style.color="#666666"};t.default=function(e,t){r.default(e,(function(e){var n=o.wrap(e,"blockquote");(t||i)(n)}),(function(){return 0==e.queryElements("blockquote",1,o.unwrap).length}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(95),o=n(0);t.default=function(e,t){r.default(e,(function(e){var n=o.wrap(e,"code"),r=o.wrap(n,"pre");null==t||t(r)}),(function(){return 0==e.queryElements("pre>code",1,(function(e){if(!e.previousSibling&&!e.nextSibling){var t=e.parentNode;o.unwrap(e),o.unwrap(t)}})).length}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"strikeThrough")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"subscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.default=function(e){r.default(e,"superscript")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){t=Math.min(Math.max(Math.round(t),0),6),e.addUndoSnapshot((function(){e.focus();var n=!1;if(e.queryElements("H1,H2,H3,H4,H5,H6",1,(function(t){n||(e.getDocument().execCommand("formatBlock",!1,"<DIV>"),n=!0);var o=e.getDocument().createElement("div");r.moveChildNodes(o,t),e.replaceNode(t,o)})),t>0){for(var o=e.getSelectionTraverser(),i=o?o.currentBlockElement:null,a=new r.HtmlSanitizer({cssStyleCallbacks:{"font-size":function(){return!1}}});i;){var l=i.collapseToSingleElement();a.sanitize(l),i=o.getNextBlockElement()}e.getDocument().execCommand("formatBlock",!1,"<H"+t+">")}}),"Format")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o={keys:[37,39],allowFunctionKeys:!0,shouldHandleEvent:function(e,t,n){var o,i;if(!(n&&(o=t.getSelectionRange())&&o.collapsed&&(i=r.Position.getStart(o))&&t.isPositionAtBeginning(i)))return!1;var a="rtl"==r.getComputedStyle(i.element,"direction"),l=e.rawEvent;return!a&&37==l.which||a&&39==l.which},handleEvent:function(e){e.rawEvent.preventDefault()},defaultDisabled:!r.Browser.isChrome};t.CursorFeatures={noCycleCursorMove:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o={keys:[13],shouldHandleEvent:function(e,t){return a(e,t)},handleEvent:function(e,t){a(e,t,1)}},i={keys:[27],shouldHandleEvent:function(e,t){return a(e,t)},handleEvent:function(e,t){a(e,t,3)}};function a(e,t,n){var o=r.cacheGetEventData(e,"READONLY_ENTITY_ELEMENT",(function(){var n=e.rawEvent.target,o=n&&t.getElementAtCursor(r.getEntitySelector(),n);return o&&!o.isContentEditable?o:null}));return o&&void 0!==n&&t.triggerPluginEvent(15,{operation:n,rawEvent:e.rawEvent,entity:r.getEntityFromElement(o)}),o}var l={keys:[13],shouldHandleEvent:function(e,t){return c(e,t,!0,!1)},handleEvent:function(e,t){var n;e.rawEvent.preventDefault();var o=t.getSelectionRange(),i=r.Position.getEnd(o).normalize().node,a=t.getDocument().createElement("BR");i.parentNode.insertBefore(a,i.nextSibling);var l,s=t.getBlockElementAtNode(i);s&&(l=s.collapseToSingleElement(),null===(n=a.parentNode)||void 0===n||n.removeChild(a)),t.getSelectionRange().deleteContents(),l.nextSibling&&t.select(l.nextSibling,0)}},s={keys:[8],shouldHandleEvent:function(e,t){return c(e,t,!1,!0)},handleEvent:function(e,t){c(e,t,!1,!0,5)}},u={keys:[46],shouldHandleEvent:function(e,t){return c(e,t,!0,!0)},handleEvent:function(e,t){c(e,t,!0,!0,4)}};function c(e,t,n,o,i){var a=r.cacheGetEventData(e,"NEIGHBOR_ENTITY_ELEMENT_"+n+"_"+o,(function(){var e=t.getSelectionRange();if(o&&!e.collapsed)return null;e.commonAncestorContainer.normalize();var i=r.Position.getEnd(e).normalize(),a=null;if(0==i.offset||i.isAtEnd){var l=t.getBodyTraverser(i.node),s=n?0==i.offset?l.currentInlineElement:l.getNextInlineElement():i.isAtEnd?l.currentInlineElement:l.getPreviousInlineElement(),u=s&&s.getContainerNode();if(!o){var c=t.getBlockElementAtNode(i.node);c&&c.contains(u)||(u=null)}a=u&&t.getElementAtCursor(r.getEntitySelector(),u)}return a}));return a&&void 0!==i&&t.triggerPluginEvent(15,{operation:i,rawEvent:e.rawEvent,entity:r.getEntityFromElement(a)}),a}t.EntityFeatures={clickOnEntity:o,escapeFromEntity:i,enterBeforeReadonlyEntity:l,backspaceAfterEntity:s,deleteBeforeEntity:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(0),i={keys:[9],shouldHandleEvent:function(e,t){return!e.rawEvent.shiftKey&&m(e,t)},handleEvent:function(e,t){r.setIndentation(t,0),e.rawEvent.preventDefault()}},a={keys:[9],shouldHandleEvent:function(e,t){return e.rawEvent.shiftKey&&m(e,t)},handleEvent:function(e,t){r.setIndentation(t,1),e.rawEvent.preventDefault()}},l={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e),r=t.getSelectionRange();return n&&(null==r?void 0:r.collapsed)&&o.isPositionAtBeginningOf(o.Position.getStart(r),n)},handleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);n.previousSibling?r.blockFormat(t,(function(t,r,i){var a=o.createVListFromRegion(t,!1,n);a.setIndentation(r,i,1,!0),a.writeBack(),e.rawEvent.preventDefault()})):g(e,t)},defaultDisabled:!0},s={keys:[8],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return n&&o.isNodeEmpty(n)&&!n.previousSibling},handleEvent:g},u={keys:[46],shouldHandleEvent:function(e,t){if(t.getElementAtCursor("LI",null,e))return!1;var n=o.Position.getEnd(t.getSelectionRange()).isAtEnd?function(e,t){return o.cacheGetEventData(e,"nextSibiling",(function(){var e,n=t.getSelectionRange(),r=o.Position.getEnd(n).normalize(),i=t.getBodyTraverser(r.node);return null===(e=null==i?void 0:i.getNextBlockElement())||void 0===e?void 0:e.getStartNode()}))}(e,t):null;return t.getElementAtCursor("LI",n,e)},handleEvent:function(e,t){var n=p(t);t.runAsync((function(e){return r.experimentCommitListChains(e,n)}))}},c={keys:[13],shouldHandleEvent:function(e,t){var n=t.getElementAtCursor("LI",null,e);return!e.rawEvent.shiftKey&&n&&o.isNodeEmpty(n)},handleEvent:function(e,t){t.addUndoSnapshot((function(){return g(e,t,!1)}),null,!0)},defaultDisabled:!o.Browser.isIE&&!o.Browser.isChrome},d={keys:[32],shouldHandleEvent:function(e,t){if(!m(e,t)){var n=t.getContentSearcherOfCursor(e);return h(n.getSubStringBefore(4))&&!n.getNearestNonTextInlineElement()}return!1},handleEvent:function(e,t){t.insertContent("&nbsp;"),e.rawEvent.preventDefault(),t.addUndoSnapshot((function(){var e,n,o=t.getContentSearcherOfCursor(),i=o.getSubStringBefore(4),a=o.getRangeFromText(i,!0);if(a){if(0==i.indexOf("*")||0==i.indexOf("-"))v(t,a),r.toggleBullet(t);else if(h(i))v(t,a),r.toggleNumbering(t);else if((n=t.getSelectedRegions())&&1==n.length){var l=parseInt(i);v(t,a),r.toggleNumbering(t,l)}}else;null===(e=o.getRangeFromText(i,!0))||void 0===e||e.deleteContents()}),null,!0)}},f={keys:[13,9,46,8,258],shouldHandleEvent:function(e,t){return t.queryElements("li",1).length>0},handleEvent:function(e,t){var n=p(t);t.runAsync((function(e){return r.experimentCommitListChains(e,n)}))}};function h(e){return/^(\*|-|[0-9]{1,2}\.|[0-9]{1,2}\>|[0-9]{1,2}\)|[0-9]{1,2}\-|\([0-9]{1,2}\))$/.test(e)}function p(e){return o.VListChain.createListChains(e.getSelectedRegions())}function v(e,t){var n=e.getBlockElementAtNode(t.startContainer),r=null==n?void 0:n.getEndNode();if(r&&"BR"!=o.getTagOfNode(r)&&""===(null==n?void 0:n.getTextContent().trim())){var i=e.getDocument().createElement("BR");o.isBlockElement(r)?r.appendChild(i):r.parentNode.insertBefore(i,r.nextSibling),e.select(t.startContainer,t.startOffset)}}function g(e,t,n){void 0===n&&(n=!0);var i=m(e,t);if(i){var a=i[0],l=o.getTagOfNode(a);"UL"!=l&&"OL"!=l||r.toggleListType(t,"UL"==l?2:1,null,n),t.focus(),e.rawEvent.preventDefault()}}function m(e,t){var n=t.getElementAtCursor("LI,TABLE",null,e),r=n&&"LI"==o.getTagOfNode(n)&&t.getElementAtCursor("UL,OL",n);return r?[r,n]:null}t.ListFeatures={autoBullet:d,indentWhenTab:i,outdentWhenShiftTab:a,outdentWhenBackspaceOnEmptyFirstLine:s,outdentWhenEnterOnEmptyLine:c,mergeInNewLineWhenBackspaceOnFirstChar:l,maintainListChain:f,maintainListChainWhenDelete:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e,t,n,r){return{keys:[e],shouldHandleEvent:function(e,n){return e.rawEvent.shiftKey===r&&!!i(e,n,t)},handleEvent:function(e,r){r.runAsync((function(r){!function(e,t,n,r){t.addUndoSnapshot((function(){var o=i(e,t,n);if(o){var a=o.cloneRange();a.setStart(a.startContainer,a.startOffset+1),o.setEnd(o.endContainer,o.endOffset+1);var l=t.getDocument().createElement(r);l.appendChild(a.extractContents()),o.deleteContents();var s=t.getDocument().createTextNode("​");o.insertNode(s),o.insertNode(l),t.select(s,-1)}}),"Format",!0)}(e,r,t,n)}))}}}function i(e,t,n){return r.cacheGetEventData(e,"MARKDOWN_RANGE",(function(){var o,i;return t.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){if(i&&o)return!0;var t=e.getTextContent();if(0==t[t.length-1].trim().length)return!1;if(t[t.length-1]===n)return!1;if(i||(i=e.getStartPosition().move(t.length)),t[0]==n)o=e.getStartPosition();else for(var r=t.length-1;r>0;r--){if(o)return!0;if(t[r]==n&&0==t[r-1].trim().length)return o=e.getStartPosition().move(r),!0}})),!!o&&!!i&&r.createRange(o,i)}))}var a=o(56,"*","b",!0),l=o(189,"_","i",!0),s=o(192,"~","s",!0),u=o(192,"`","code",!1);t.MarkdownFeatures={markdownBold:a,markdownItalic:l,markdownStrikethru:s,markdownInlineCode:u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(0),i="BLOCKQUOTE",a=[i,"LI","TD","TH"].join(","),l={keys:[8],shouldHandleEvent:function(e,t){var n=u(e,t);return n&&o.isNodeEmpty(n)&&!n.previousSibling},handleEvent:c},s={keys:[13],shouldHandleEvent:function(e,t){var n=u(e,t);return!e.rawEvent.shiftKey&&n&&o.isNodeEmpty(n)},handleEvent:function(e,t){return t.addUndoSnapshot((function(){return c(e,t)}),null,!0)}};function u(e,t){return o.cacheGetEventData(e,"QUOTE_CHILD",(function(){var e=t.getElementAtCursor(a);if(e&&o.getTagOfNode(e)==i){var n=t.getFocusedPosition(),r=n&&t.getBlockElementAtNode(n.normalize().node);if(r){var l=r.getStartNode()==e?r.getStartNode():r.collapseToSingleElement();return o.isNodeEmpty(l)?l:null}}return null}))}function c(e,t){t.addUndoSnapshot((function(){var n,a,l=u(e,t);o.getTagOfNode(l)==i&&(l=o.wrap(o.toArray(l.childNodes))),n=o.splitBalancedNodeRange(l),a=d(n),o.unwrap(n),t.select(l,0),a&&r.clearFormat(t)})),e.rawEvent.preventDefault()}var d=function(e){return!!(e&&o.safeInstanceOf(e,"HTMLQuoteElement")&&e.style.borderLeft&&e.style.borderColor&&e.style.paddingLeft&&e.style.color)};t.QuoteFeatures={unquoteWhenBackspaceOnEmptyFirstLine:l,unquoteWhenEnterOnEmptyLine:s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(7);function i(e,t,n){return{winKey:e,macKey:t,action:n}}var a=[i(4162,8258,o.toggleBold),i(4169,8265,o.toggleItalic),i(4181,8277,o.toggleUnderline),i(4186,8282,(function(e){return e.undo()})),i(4185,24666,(function(e){return e.redo()})),i(4286,8382,o.toggleBullet),i(4287,8383,o.toggleNumbering),i(20670,24766,(function(e){return o.changeFontSize(e,0)})),i(20668,24764,(function(e){return o.changeFontSize(e,1)}))],l={allowFunctionKeys:!0,keys:[66,73,85,89,90,188,190,191],shouldHandleEvent:s,handleEvent:function(e,t){var n=s(e);n&&(n.action(t),e.rawEvent.preventDefault(),e.rawEvent.stopPropagation())}};function s(e){return r.cacheGetEventData(e,"DEFAULT_SHORT_COMMAND",(function(){var t=e.rawEvent,n=0!=e.eventType||t.altKey?0:t.which|(t.metaKey&&8192)|(t.shiftKey&&16384)|(t.ctrlKey&&4096);return n&&a.filter((function(e){return(r.Browser.isMac?e.macKey:e.winKey)==n}))[0]}))}t.ShortcutFeatures={defaultShortcut:l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o={TD:"TABLE",TH:"TABLE",LI:"OL,UL"},i=Object.keys(o).join(","),a={keys:[13],shouldHandleEvent:l,handleEvent:function(e,t){var n=l(e,t),o=r.createElement(1,t.getDocument());t.addUndoSnapshot((function(){n.parentNode.insertBefore(o,n),"TABLE"==r.getTagOfNode(n)&&t.select(new r.Position(o,0).normalize())})),e.rawEvent.preventDefault()},defaultDisabled:!0};function l(e,t){return r.cacheGetEventData(e,"FIRST_STRUCTURE",(function(){var n=e.rawEvent.shiftKey?null:t.getElementAtCursor(i);if(n){var a=t.getSelectionRange();if(a&&a.collapsed&&r.isPositionAtBeginningOf(r.Position.getStart(a),n)&&!t.getBodyTraverser(n).getPreviousBlockElement())return t.getElementAtCursor(o[r.getTagOfNode(n)])}return null}))}t.StructuredNodeFeatures={insertLineBeforeStructuredNodeFeature:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(0),i={keys:[9],shouldHandleEvent:l,handleEvent:function(e,t){for(var n=e.rawEvent.shiftKey,i=l(e,t),a=new o.VTable(i),s=n?-1:1,u=a.row,c=a.col+s;;c+=s){if(c<0||c>=a.cells[u].length){if((u+=s)<0){t.select(a.table,-2);break}if(u>=a.cells.length){r.editTable(t,1);break}c=n?a.cells[u].length-1:0}var d=a.getCell(u,c);if(d.td){t.select(d.td,0);break}}e.rawEvent.preventDefault()}},a={keys:[38,40],shouldHandleEvent:l,handleEvent:function(e,t){var n,r=l(e,t),i=new o.VTable(r),a=38==e.rawEvent.which,s=a?-1:1,u=e.rawEvent.shiftKey,c=null===(n=t.getDocument().defaultView)||void 0===n?void 0:n.getSelection(),d=null;if(c){for(var f=c.anchorNode,h=c.anchorOffset,p=i.row;p>=0&&p<i.cells.length;p+=s){var v=i.getCell(p,i.col);if(v.td&&v.td!=r){d=v.td;break}}t.runAsync((function(e){var t,n=e.getElementAtCursor();if(o.contains(i.table,n)&&!o.contains(r,n,!0)){var l=d?new o.Position(d,0):new o.Position(i.table,a?-2:-3);if(u){l=1==l.node.nodeType&&o.isVoidHtmlElement(l.node)?new o.Position(l.node,l.isAtEnd?-3:-2):l;var s=null===(t=e.getDocument().defaultView)||void 0===t?void 0:t.getSelection();null==s||s.setBaseAndExtent(f,h,l.node,l.offset)}else e.select(l)}}))}},defaultDisabled:!o.Browser.isChrome&&!o.Browser.isSafari};function l(e,t){return o.cacheGetEventData(e,"TABLE_CELL_FOR_TABLE_FEATURES",(function(){var e=t.getFocusedPosition(),n=e&&t.getElementAtCursor("TD,TH,LI",e.node);return n&&("LI"==o.getTagOfNode(n)?null:n)}))}t.TableFeatures={tabInTable:i,upDownInTable:a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(214))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(215);t.ContextMenu=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e){var t=this;this.options=e,this.onDismiss=function(){var e,n;t.container&&t.isMenuShowing&&(null===(n=(e=t.options).dismiss)||void 0===n||n.call(e,t.container),t.isMenuShowing=!1)}}return e.prototype.getName=function(){return"ContextMenu"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.onDismiss(),this.container&&(this.container.parentNode.removeChild(this.container),this.container=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(16==e.eventType&&e.items.length>0){var t=e.rawEvent,n=e.items;this.onDismiss(),this.options.allowDefaultMenu||t.preventDefault(),this.initContainer(t.pageX,t.pageY),this.options.render(this.container,n,this.onDismiss),this.isMenuShowing=!0}},e.prototype.initContainer=function(e,t){this.container||(this.container=r.createElement(5,this.editor.getDocument()),this.editor.insertNode(this.container,{position:4})),this.container.style.left=e+"px",this.container.style.top=t+"px"},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(217))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(218);t.CustomReplace=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t,n,r){return{sourceString:e,replacementHTML:t,matchSourceCaseSensitive:n,shouldReplace:r}},o=[r(":)","🙂",!0),r(";)","😉",!0),r(":O","😲",!0),r(":o","😯",!0),r("<3","❤️",!0)],i=function(){function e(e){void 0===e&&(e=o),this.updateReplacements(e)}return e.prototype.updateReplacements=function(e){var t;this.replacements=e,this.longestReplacementLength=(t=this.replacements,Math.max.apply(null,t.map((function(e){return e.sourceString.length})))),this.replacementEndCharacters=function(e){for(var t=new Set,n=0,r=e;n<r.length;n++){var o=r[n],i=o.sourceString;if(0!=i.length){var a=i[i.length-1];o.matchSourceCaseSensitive?t.add(a):(t.add(a.toLocaleLowerCase()),t.add(a.toLocaleUpperCase()))}}return t}(this.replacements)},e.prototype.getName=function(){return"CustomReplace"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t=this;if(!this.editor.isInIME()&&3==e.eventType&&(e.rawEvent.data&&this.replacementEndCharacters.has(e.rawEvent.data)&&null!=this.editor.getSelectionRange())){var n=this.editor.getContentSearcherOfCursor(e),r=n.getSubStringBefore(this.longestReplacementLength),o=this.getMatchingReplacement(r);if(null!=o&&(!o.shouldReplace||o.shouldReplace(o,n.getWordBefore()))){var i=n.getSubStringBefore(o.sourceString.length),a=n.getRangeFromText(i,!0),l=this.editor.getDocument().createElement("span");l.innerHTML=this.editor.getTrustedHTMLHandler()(o.replacementHTML);var s=1==l.childNodes.length?l.childNodes[0]:l;this.editor.addUndoSnapshot((function(){a.deleteContents(),a.insertNode(s),t.editor.select(s,-1)}),null,!0)}}},e.prototype.getMatchingReplacement=function(e){if(0==e.length)return null;for(var t=e.replace(/\s/g," "),n=t.toLocaleLowerCase(),r=0,o=this.replacements;r<o.length;r++){var i=o[r],a=i.matchSourceCaseSensitive?[t,i.sourceString]:[n,i.sourceString.toLocaleLowerCase()],l=a[0],s=a[1];if(l.substring(l.length-s.length)==s)return i}return null},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(220))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(221);t.CutPasteListChain=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(0),i=function(){function e(){var e=this;this.onDrop=function(){e.cacheListChains("Drop")}}return e.prototype.getName=function(){return"CutPasteListChain"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler("drop",this.onDrop)},e.prototype.dispose=function(){var e;null===(e=this.disposer)||void 0===e||e.call(this),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;switch(e.eventType){case 9:e.isCut&&this.cacheListChains("Cut");break;case 10:this.cacheListChains("Paste");break;case 7:(null===(t=this.chains)||void 0===t?void 0:t.length)>0&&this.expectedChangeSource==e.source&&(r.experimentCommitListChains(this.editor,this.chains),this.chains=null,this.expectedChangeSource=null)}},e.prototype.cacheListChains=function(e){this.chains=o.VListChain.createListChains(this.editor.getSelectedRegions()),this.expectedChangeSource=e},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(223))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(224);t.HyperLink=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(){function e(e,t,n){var r=this;void 0===e&&(e=function(e){return e}),this.getTooltipCallback=e,this.target=t,this.onLinkClick=n,this.trackedLink=null,this.onMouse=function(e){var t=r.editor.getElementAtCursor("a[href]",e.target),n=r.tryGetHref(t);n&&r.editor.setEditorDomAttribute("title","mouseover"==e.type?r.getTooltipCallback(n,t):null)},this.onBlur=function(e){r.trackedLink&&r.updateLinkHrefIfShouldUpdate(),r.resetLinkTracking()}}return e.prototype.getName=function(){return"Hyperlink"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.getTooltipCallback&&e.addDomEventHandler({mouseover:this.onMouse,mouseout:this.onMouse,blur:this.onBlur})},e.prototype.dispose=function(){this.disposer&&(this.disposer(),this.disposer=null),this.editor=null},e.prototype.onPluginEvent=function(e){if(6==e.eventType||2==e.eventType&&(!this.isContentEditValue(e.rawEvent)||32==e.rawEvent.which)||7==e.eventType){var t=(n=this.editor.getElementAtCursor("A[href]",null,e))!==this.trackedLink||2==e.eventType||7==e.eventType;this.trackedLink&&(t||this.tryGetHref(this.trackedLink)!==this.originalHref)&&(t&&this.updateLinkHrefIfShouldUpdate(),this.resetLinkTracking()),!this.trackedLink&&this.doesLinkDisplayMatchHref(n)&&(this.trackedLink=n,this.originalHref=this.tryGetHref(n))}var n;if(6==e.eventType&&(n=this.editor.getElementAtCursor("A",e.rawEvent.srcElement))){if(this.onLinkClick&&!1!==this.onLinkClick(n,e.rawEvent))return;var o=void 0;if(!r.Browser.isFirefox&&(o=this.tryGetHref(n))&&r.isCtrlOrMetaPressed(e.rawEvent)&&0===e.rawEvent.button)try{var i=this.target||"_blank";this.editor.getDocument().defaultView.open(o,i)}catch(e){}}},e.prototype.tryGetHref=function(e){try{return e?e.href:null}catch(e){}},e.prototype.isContentEditValue=function(e){return r.isCharacterValue(e)||8==e.which||46==e.which},e.prototype.updateLinkHrefIfShouldUpdate=function(){this.doesLinkDisplayMatchHref(this.trackedLink)||this.updateLinkHref()},e.prototype.resetLinkTracking=function(){this.trackedLink=null,this.originalHref=""},e.prototype.doesLinkDisplayMatchHref=function(e){if(e){var t=e.innerText.trim().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp("^(?:https?:\\/\\/)?"+t+"\\/?","i"),r=this.tryGetHref(e);if(null!==r)return n.test(r)}return!1},e.prototype.updateLinkHref=function(){var e=this;if(this.trackedLink){var t=r.matchLink(this.trackedLink.innerText.trim());null!==t&&this.editor.addUndoSnapshot((function(){e.trackedLink.href=t.normalizedUrl}))}},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(226))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96);t.ImageEdit=r.default;var o=n(99);t.canRegenerateImage=o.default;var i=n(231);t.resizeByPercentage=i.default;var a=n(102);t.isResizedTo=a.default;var l=n(232);t.resetImage=l.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(50);t.default=function(e,t){var n=t.angleRad,o=t.widthPx,i=t.heightPx,a=t.bottomPercent,l=t.leftPercent,s=t.rightPercent,u=t.topPercent,c=t.naturalWidth,d=t.naturalHeight,f=c*(1-l-s),h=d*(1-u-a),p=document.createElement("canvas"),v=r.default(t),g=v.targetWidth,m=v.targetHeight;p.width=g,p.height=m;var y=p.getContext("2d");return y.translate(g/2,m/2),y.rotate(n),y.drawImage(e,c*l,d*u,f,h,-o/2,-i/2,o,i),p.toDataURL("image/png",1)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,n,r){var o=this;this.trigger=e,this.context=t,this.onSubmit=n,this.handler=r,this.onMouseDown=function(e){var t,n;e.preventDefault(),e.stopPropagation(),o.addDocumentEvents(),o.initX=e.pageX,o.initY=e.pageY,o.initValue=null===(n=(t=o.handler).onDragStart)||void 0===n?void 0:n.call(t,o.context,e)},this.onMouseMove=function(e){var t,n,r;e.preventDefault();var i=e.pageX-o.initX,a=e.pageY-o.initY;(null===(n=(t=o.handler).onDragging)||void 0===n?void 0:n.call(t,o.context,e,o.initValue,i,a))&&(null===(r=o.onSubmit)||void 0===r||r.call(o,o.context))},this.onMouseUp=function(e){var t,n,r;e.preventDefault(),o.removeDocumentEvents(),(null===(n=(t=o.handler).onDragEnd)||void 0===n?void 0:n.call(t,o.context,e,o.initValue))&&(null===(r=o.onSubmit)||void 0===r||r.call(o,o.context))},e.addEventListener("mousedown",this.onMouseDown)}return e.prototype.dispose=function(){this.trigger.removeEventListener("mousedown",this.onMouseDown),this.removeDocumentEvents()},e.prototype.addDocumentEvents=function(){var e=this.trigger.ownerDocument;e.addEventListener("mousemove",this.onMouseMove,!0),e.addEventListener("mouseup",this.onMouseUp,!0)},e.prototype.removeDocumentEvents=function(){var e=this.trigger.ownerDocument;e.removeEventListener("mousemove",this.onMouseMove,!0),e.removeEventListener("mouseup",this.onMouseUp,!0)},e}();t.default=r},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(100),i=["w","e"],a=["s","n"],l={sw:0,nw:90,ne:180,se:270};function s(e,t,n,r,o){var i=n*(1-r)-o,a=n*e+t;return Math.max(Math.min(a,i),0)/n}function u(){var e=[];return[0,1].forEach((function(t){return[0,1].forEach((function(n){e.push(function(e,t){return{tag:"div",style:"position:absolute;left:"+e+"px;bottom:"+e+"px;"+(0==t?"right:"+e+"px;height:"+(7-2*e)+"px;":"top:"+e+"px;width:"+(7-2*e)+"px;")+";background-color:"+(0==e?"white":"black")}}(t,n))}))})),e}t.Cropper={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,i){var a,l=e.editInfo,u=e.x,c=e.y,d=e.options;r=(a=o.rotateCoordinate(r,i,l.angleRad))[0],i=a[1];var f=l.widthPx,h=l.heightPx,p=l.leftPercent,v=l.rightPercent,g=l.topPercent,m=l.bottomPercent,y=d.minWidth,b=d.minHeight,E=1-p-v,C=1-g-m;if(E>0&&C>0){var w=f/E,S=h/C,P="e"!=u?s(n.leftPercent,r,w,v,y):p,O="w"!=u?s(n.rightPercent,-r,w,p,y):v,N="s"!=c?s(n.topPercent,i,S,m,b):g,x="n"!=c?s(n.bottomPercent,-i,S,g,b):m;return l.leftPercent=P,l.rightPercent=O,l.topPercent=N,l.bottomPercent=x,l.widthPx=w*(1-P-O),l.heightPx=S*(1-N-x),!0}return!1}},t.getCropHTML=function(){var e={tag:"div",style:"position:absolute;background-color:rgb(0,0,0,0.5);pointer-events:none",className:"r_cropO"},t={tag:"div",style:"position:absolute;overflow:hidden",className:"r_cropC",children:[]};return i.forEach((function(e){return a.forEach((function(n){return t.children.push(function(e,t){return{tag:"div",className:"r_cropH",style:"position:absolute;pointer-events:auto;cursor:"+t+e+"-resize;"+("w"==e?"left":"right")+":0;"+("n"==t?"top":"bottom")+":0;width:22px;height:22px;transform:rotate("+l[t+e]+"deg)",dataset:{x:e,y:t},children:u()}}(e,n))}))})),[t,e,e,e,e]}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=180/Math.PI;function i(e){var t;return{tag:"svg",namespace:"http://www.w3.org/2000/svg",style:"width:16px;height:16px;margin: 8px 8px",children:[{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:(t={d:"M 10.5,10.0 A 3.8,3.8 0 1 1 6.7,6.3",transform:"matrix(1.1 1.1 -1.1 1.1 11.6 -10.8)"},t["fill-opacity"]="0",t.stroke=e,t)},{tag:"path",namespace:"http://www.w3.org/2000/svg",attributes:{d:"M12.0 3.648l.884-.884.53 2.298-2.298-.53z",stroke:e}}]}}t.Rotator={onDragStart:function(e){var t=e.editInfo;return r({},t)},onDragging:function(e,t,n,r,i){var a=e.editInfo,l=e.options,s=a.heightPx/2+31,u=s*Math.sin(n.angleRad)+r,c=s*Math.cos(n.angleRad)-i,d=Math.atan2(u,c);if(!t.altKey){var f=d*o;d=Math.round(f/l.minRotateDeg)*l.minRotateDeg/o}return a.angleRad!=d&&(a.angleRad=d,!0)}},t.updateRotateHandlePosition=function(e,t,n,r,o){if(r&&o&&t){var i=e.angleRad,a=e.heightPx,l=Math.cos(i),s=l<=0?Number.MAX_SAFE_INTEGER:(t[1]+a/2+n)/l-a/2,u=Math.max(Math.min(15,s),0),c=Math.max(Math.min(32,s-u),0);r.style.top=-u+"px",r.style.height=u+"px",o.style.top=-c+"px"}},t.getRotateHTML=function(e){var t=e.borderColor;return[{tag:"div",className:"r_rotateC",style:"position:absolute;left:50%;width:1px;background-color:"+t,children:[{tag:"div",className:"r_rotateH",style:"position:absolute;background-color:"+e.rotateHandleBackColor+";border:solid 1px "+t+";border-radius:50%;width:32px;height:32px;left:-16px;cursor:move",children:[i(t)]}]}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97),o=n(101),i=n(102),a=n(26);t.default=function(e,t,n,l,s){var u,c,d,f=a.getEditInfoFromImage(t);i.default(t,n)||(u=t,c=f.src,d=function(){if(!e.isDisposed()&&e.contains(t)){var i=t.src,a=o.default(f,n),u=a.width,c=a.height;f.widthPx=Math.max(u,l),f.heightPx=Math.max(c,s),e.addUndoSnapshot((function(){r.default(e,t,f,i,!0)}),"ImageResize")}},u.onload=function(){u.onload=null,u.onerror=null,d()},u.onerror=function(){u.onload=null,u.onerror=null,d()},u.src=c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(26);t.default=function(e,t){e.addUndoSnapshot((function(){t.style.width="",t.style.height="",t.style.maxWidth="100%",t.removeAttribute("width"),t.removeAttribute("height"),r.deleteEditInfo(t)}),"ImageResize")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(234))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(235);t.ImageResize=r.default},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t,n,r,o,i){return void 0===t&&(t=10),void 0===n&&(n=10),void 0===r&&(r="#DB626C"),void 0===o&&(o=!1),void 0===i&&(i="img"),e.call(this,{minHeight:n,minWidth:t,borderColor:r,preserveRatio:o,imageSelector:i})||this}return o(t,e),t.prototype.showResizeHandle=function(e){this.setEditingImage(e,3)},t.prototype.hideResizeHandle=function(e){this.setEditingImage(null,e)},t}(n(96).default);t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(237))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(238);t.Paste=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(239),o=n(240),i=n(241),a=n(242),l=n(243),s=n(247),u=n(0),c=n(248),d=function(){function e(e){void 0===e&&(e="SPAN"),this.unknownTagReplacement=e}return e.prototype.getName=function(){return"Paste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(10==e.eventType){var n=e.htmlAttributes,d=e.fragment,f=e.sanitizingOption,h=e.clipboardData,p=this.editor.getTrustedHTMLHandler(),v=void 0;"urn:schemas-microsoft-com:office:word"==n["xmlns:w"]?l.default(e):"urn:schemas-microsoft-com:office:excel"==n["xmlns:x"]||"Excel.Sheet"==n.ProgId?i.default(e,p):"PowerPoint.Slide"==n.ProgId?a.default(e,p):(v=u.toArray(d.querySelectorAll('ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement')))&&v.length>0?(v.forEach((function(e){e.style.display=null,e.style.margin=null})),c.isWordOnlineWithList(d)&&c.default(d)):d.querySelector("google-sheets-html-origin")?f.additionalTagReplacements["google-sheets-html-origin"]="*":this.editor.isFeatureEnabled("ConvertSingleImageBody")&&1==(null===(t=h.htmlFirstLevelChildTags)||void 0===t?void 0:t.length)&&"IMG"==h.htmlFirstLevelChildTags[0]?r.default(e,p):(o.default(d),s.default(d)),f.unknownTagReplacement=this.unknownTagReplacement}},e}();t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.fragment,o=e.clipboardData,i=o.html,a=o.image;if(i&&a){var l=(new DOMParser).parseFromString(t(i),"text/html");r.moveChildNodes(n,null==l?void 0:l.body)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e){if(e&&!e.nextSibling&&["OL","UL","MENU"].indexOf(r.getTagOfNode(e))<0){var t=!1;if(r.toArray(e.childNodes).every((function(e){var n;return!(!r.safeInstanceOf(e,"Text")||(null===(n=e.nodeValue)||void 0===n?void 0:n.trim()))||"LI"==r.getTagOfNode(e)&&(t=!0,!0)}))&&t)return!0}return!1}t.default=function(e){o(e)?r.wrap(r.toArray(e.childNodes),"UL"):r.safeInstanceOf(e.firstChild,"HTMLElement")&&o(e.firstChild)&&r.changeElementTag(e.firstChild,"UL")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,i=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,a=/<tr[^>]*>[^<]*/i,l=/<table[^>]*>[^<]*/i;function s(e,t){if(e.match(o)){var n=t.match(a);e=(n?n[0]:"<TR>")+e+"</TR>"}if(e.match(i)){var r=t.match(l);e=(r?r[0]:"<TABLE>")+e+"</TABLE>"}return e}t.default=function(e,t){var n=e.fragment,o=e.sanitizingOption,i=e.htmlBefore,a=e.clipboardData,l=s(a.html,i);if(a.html!=l){var u=(new DOMParser).parseFromString(t(l),"text/html");r.moveChildNodes(n,null==u?void 0:u.body)}r.chainSanitizerCallback(o.elementCallbacks,"TD",(function(e){return"none"==e.style.borderStyle&&(e.style.border="solid 1px #d4d4d4"),!0}))},t.excelHandler=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e,t){var n=e.fragment,o=e.clipboardData;if(o.html&&!o.text&&o.image){var i=(new DOMParser).parseFromString(t(o.html),"text/html");r.moveChildNodes(n,null==i?void 0:i.body)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(244),i=n(245),a=n(246);t.default=function(e){var t=e.sanitizingOption,n=e.fragment;r.chainSanitizerCallback(t.elementCallbacks,"O:P",(function(e){return r.moveChildNodes(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}));var l=o.createWordConverter(),s=n.querySelectorAll("p");s.length>0&&(l.wordConverterArgs=i.createWordConverterArguments(s),a.processNodesDiscovery(l)&&a.processNodeConvert(l))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(103);t.createWordConverter=function(){return{nextUniqueId:1,numBulletsConverted:0,numNumberedConverted:0,wordConverterArgs:null,wordCustomData:r.createCustomData()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(104);t.createWordConverterArguments=function(e){return{nodes:e,currentIndex:0,lists:{},listItems:[],currentListIdsByLevels:[r.createLevelLists()],lastProcessedItem:null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(104),o=n(103),i=n(0),a=/[\n|\r]/gi;function l(e,t,n,r){var a=function e(t,n,r){var o,a=null;1==n?o=h(t):(a=e(t,n-1,null),o=a.lastChild);if(o&&1==o.nodeType){var l=i.getTagOfNode(o);if("UL"==l||"OL"==l)return o}var s=t.ownerDocument.createElement(r?r.tagName:"UL");1==n?t.parentNode.insertBefore(s,t):a.appendChild(s);return s}(t,n.level,r),l=o.getObject(e.wordCustomData,a,"UniqueListId");if(l&&l!=n.uniqueListId||!l&&a.firstChild){var s=t.ownerDocument.createElement(r.tagName);a.parentNode.insertBefore(s,a.nextSibling),a=s}return o.setObject(e.wordCustomData,a,"UniqueListId",n.uniqueListId),function(e,t,n){if(n.tagName!=i.getTagOfNode(t)){var r=t.ownerDocument.createElement(n.tagName);o.setObject(e.wordCustomData,r,"UniqueListId",o.getObject(e.wordCustomData,t,"UniqueListId")),i.moveChildNodes(r,t),t.parentNode.insertBefore(r,t),t.parentNode.removeChild(t),t=r}return t}(e,a,r)}function s(e,t){for(var n=[],r=e.firstChild;r;r=r.nextSibling)1==r.nodeType&&t>1&&s(r,t-1),(g(r=f(r,!0))||v(r))&&n.push(r);n.forEach((function(t){return e.removeChild(t)}))}function u(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0)try{var n=t.split(" ");if(3==n.length)return{level:parseInt(n[1].substr("level".length)),wordListId:t,originalNode:e,uniqueListId:0}}catch(e){}}return null}function c(e){return["o","·","§","-"].indexOf(e)>=0}function d(e,t){for(var n=null,r=e.firstChild;!n&&r;)v(r=f(r,!0))?0==(n=r.textContent.trim()).length&&(n="o"):1==r.nodeType&&t>1&&(n=d(r,t-1)),r=r.nextSibling;return n}function f(e,t){if(8==e.nodeType){var n=e.data;if(n&&"[if !supportlists]"==n.trim().toLowerCase()){for(var r=e,o=null,i=0;i<4&&(r=p(r));i++)if(8==r.nodeType&&(n=r.data)&&"[endif]"==n.trim().toLowerCase()){o=r;break}if(o){var a=e.ownerDocument.createElement("span");for(a.setAttribute("style","mso-list: ignore"),r=p(e);r!=o;)r=r.nextSibling,a.appendChild(r.previousSibling);o.parentNode.insertBefore(a,o),t&&(e.parentNode.removeChild(e),o.parentNode.removeChild(o)),e=a}}}return e}function h(e){var t=e;do{t=t.previousSibling}while(t&&y(t));return t}function p(e){var t=e;do{t=t.nextSibling}while(t&&y(t));return t}function v(e){if(1==e.nodeType){var t=m(e,"mso-list");if(t&&t.length>0&&"ignore"==t.trim().toLowerCase())return!0}return!1}function g(e){return"SPAN"==i.getTagOfNode(e)&&!e.firstChild}function m(e,t){return i.getStyles(e)[t]||null}function y(e){if(!e)return!0;if(3==e.nodeType){var t=e.nodeValue;return 0==(t=t.replace(a,"")).trim().length}var n=i.getTagOfNode(e);return e.firstChild==e.lastChild&&("SPAN"==n||"FONT"==n)&&y(e.firstChild)}function b(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}}t.processNodesDiscovery=function(e){for(var t,n=e.wordConverterArgs;n.currentIndex<n.nodes.length;){var o=n.nodes.item(n.currentIndex),a=u(o);if(a){var l=n.currentListIdsByLevels[a.level-1]||r.createLevelLists();n.currentListIdsByLevels[a.level-1]=l,n.lastProcessedItem&&h(o)!=n.lastProcessedItem&&b(n);var s=l.listsMetadata[a.wordListId];if(s){if(!s.ignore&&1==s.numberOfItems){var f=d(o,5);s.tagName=s.firstFakeBullet==f?"UL":"OL"}}else{var p=d(o,5);s={numberOfItems:0,uniqueListId:e.nextUniqueId++,firstFakeBullet:p,ignore:!p||0==p.length,tagName:(t=p,c(t)?"UL":"OL")},l.listsMetadata[a.wordListId]=s,n.lists[s.uniqueListId.toString()]=s}a.uniqueListId=s.uniqueListId,s.ignore||"OL"==s.tagName&&s.numberOfItems>0&&l.currentUniqueListId!=a.uniqueListId?(s.ignore=!0,n.currentListIdsByLevels[0].currentUniqueListId=-1,n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,1)):(n.currentListIdsByLevels.length>a.level&&(n.currentListIdsByLevels=n.currentListIdsByLevels.slice(0,a.level)),l.currentUniqueListId=a.uniqueListId,n.listItems.push(a),s.numberOfItems++),n.lastProcessedItem=o}else{var v=n.lastProcessedItem;v&&h(o)==v&&o.tagName==v.tagName&&o.className==v.className&&(v.appendChild(v.ownerDocument.createElement("br")),v.appendChild(v.ownerDocument.createElement("br")),i.moveChildNodes(v,o,!0),o.parentNode.removeChild(o))}n.currentIndex++}return n.listItems.length>0},t.processNodeConvert=function(e){var t=e.wordConverterArgs;for(t.currentIndex=0;t.currentIndex<t.listItems.length;){var n=t.listItems[t.currentIndex],r=n.originalNode,o=t.lists[n.uniqueListId.toString()];if(!o.ignore){var a=l(e,r,n,o);if(a){s(r,5);var u=r.ownerDocument.createElement("LI");i.moveChildNodes(u,r),a.appendChild(u),r.parentNode.removeChild(r),"UL"==o.tagName?e.numBulletsConverted++:e.numNumberedConverted++}}t.currentIndex++}return e.numBulletsConverted>0||e.numNumberedConverted>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e){var t,n,o=e.start,i=e.end;if(o==i&&"DIV"==r.getTagOfNode(o)){var a=r.changeElementTag(o,"SPAN");e.start=a,e.end=a,"BR"==r.getTagOfNode(a.lastChild)&&a.removeChild(a.lastChild)}else if("BR"==r.getTagOfNode(i)){a=i.ownerDocument.createTextNode("");null===(t=i.parentNode)||void 0===t||t.insertBefore(a,i),e.end=a,null===(n=i.parentNode)||void 0===n||n.removeChild(i)}}function i(e,t,n){var o,i=r.getBlockElementAtNode(e,t.start),a=n?r.getNextLeafSibling(e,t.end):r.getPreviousLeafSibling(e,t.start);(null==i?void 0:i.contains(a))&&(null===(o=(n?t.end:t.start).parentNode)||void 0===o||o.insertBefore(t.start.ownerDocument.createElement("br"),n?t.end.nextSibling:t.start))}t.default=function(e){for(var t=r.ContentTraverser.createBodyTraverser(e),n=[],a=null==t?void 0:t.currentBlockElement;a;a=t.getNextBlockElement())n.push({start:a.getStartNode(),end:a.getEndNode()});n.length>0&&(o(n[0]),o(n[n.length-1]),i(e,n[0],!0),i(e,n[n.length-1],!1))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(249),o=n(0),i='div.ListContainerWrapper>ul[class^="BulletListStyle"],div.ListContainerWrapper>ol[class^="NumberListStyle"]';function a(e,t,n){if(e){var r,o=n.insertPositionNode;if(o)(r=o.parentNode)&&r.insertBefore(e,o);else(r=n.startElement.parentNode)?r.appendChild(e):t.appendChild(e)}}t.isWordOnlineWithList=function(e){return!(!e||!e.querySelector(i))},t.default=function(e){!function(e){o.toArray(e.querySelectorAll(i)).forEach((function(e){var t=new RegExp("\\bListContainerWrapper\\b","g");if(e.previousSibling){var n=o.splitParentNode(e,!0);n.className=n.className.replace(t,"")}if(e.nextSibling){var r=o.splitParentNode(e,!1);r.className=r.className.replace(t,"")}}))}(e),function(e){for(var t,n=e.querySelectorAll(".ListContainerWrapper"),i=[],a=0;a<n.length;a++){var l=n[a];if(t){var s=t.listItemContainers,u=s[s.length-1];l==u.nextSibling||o.getFirstLeafNode(l)==o.getNextLeafSibling(u.parentNode,u)?(s.push(l),t.endElement=l):(t.endElement=u,i.push(t),t=r.createListItemBlock(l))}else t=r.createListItemBlock(l)}(null==t?void 0:t.listItemContainers.length)>0&&i.push(t);return i}(e).forEach((function(t){var n;!function(e,t){o.collapseNodes(e,t.startElement,t.endElement,!0).forEach((function(e){"DIV"==o.getTagOfNode(e.firstChild)&&o.unwrap(e)}))}(e,t),t.insertPositionNode=t.endElement.nextSibling;var r=e.ownerDocument;t.listItemContainers.forEach((function(i){var l=function(e){var t=o.getTagOfNode(e.firstChild);return"UL"==t||"OL"==t?t:null}(i);n||(n=r.createElement(l)),o.toArray(i.querySelectorAll("li")).forEach((function(i){var s=parseInt(i.getAttribute("data-aria-level"));o.getTagOfNode(n)!=l&&1==s&&(a(n,e,t),n=r.createElement(l)),function(e,t,n,r){if(!n)return;var i=parseInt(t.getAttribute("data-aria-level")),a=e;for(;i>1;){if(a.firstChild){var l=a.lastElementChild,s=o.getTagOfNode(l);"UL"==s||"OL"==s?a=l:(a.appendChild(r.createElement(n)),a=a.lastElementChild)}else a.appendChild(r.createElement(n)),a=a.firstElementChild;i--}a.appendChild(t)}(n,i,l,r)}))})),a(n,e,t);var i=t.startElement.parentNode;i&&t.listItemContainers.forEach((function(e){i.removeChild(e)}))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createListItemBlock=function(e){return void 0===e&&(e=null),{startElement:e,endElement:e,insertPositionNode:null,listItemContainers:e?[e]:[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(251))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(252);t.PickerPlugin=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),o=n(0),i=o.Browser.isIE?"Esc":"Escape",a=o.Browser.isIE?"Left":"ArrowLeft",l=o.Browser.isIE?"Up":"ArrowUp",s=o.Browser.isIE?"Right":"ArrowRight",u=o.Browser.isIE?"Down":"ArrowDown",c=o.Browser.isIE?"Del":"Delete",d=[0,229],f=function(){function e(e,t){this.dataProvider=e,this.pickerOptions=t,this.isPendingInputEventHandling=!1}return e.prototype.getName=function(){return"Picker"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.dataProvider.onInitalize((function(e){t.editor.focus();var n=t.getWord(null);n&&0!=n.length||!t.lastKnownRange||(t.editor.select(t.lastKnownRange),n=t.getWord(null));t.editor.addUndoSnapshot((function(){n?r.replaceWithNode(t.editor,n,e,!0):t.editor.insertNode(e),t.setIsSuggesting(!1)}),t.pickerOptions.changeSource,t.pickerOptions.handleAutoComplete)}),(function(e){t.setIsSuggesting(e)}),e)},e.prototype.dispose=function(){this.editor=null,this.dataProvider.onDispose()},e.prototype.willHandleEventExclusively=function(e){return this.isSuggesting&&(0==e.eventType||2==e.eventType||3==e.eventType)},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 7:if("SetContent"==e.source&&this.dataProvider.onContentChanged){this.isSuggesting&&this.setIsSuggesting(!1);var t=[];this.editor.queryElements("[id^='"+this.pickerOptions.elementIdPrefix+"']",(function(e){e.id&&t.push(e.id)})),this.dataProvider.onContentChanged(t)}break;case 0:this.eventHandledOnKeyDown=!1,this.isAndroidKeyboardEvent(e)?(this.currentInputLength=this.calcInputLength(e),this.isPendingInputEventHandling=!0):(this.onKeyDownEvent(e),this.isPendingInputEventHandling=!1);break;case 3:this.isPendingInputEventHandling&&this.onAndroidInputEvent(e);break;case 2:!this.eventHandledOnKeyDown&&this.shouldHandleKeyUpEvent(e)&&(this.onKeyUpDomEvent(e),this.isPendingInputEventHandling=!1);break;case 6:this.isSuggesting&&this.setIsSuggesting(!1);break;case 14:this.dataProvider.onScroll&&this.dataProvider.onScroll(e.scrollContainer)}},e.prototype.setLastKnownRange=function(e){this.lastKnownRange=e},e.prototype.setIsSuggesting=function(e){this.isSuggesting=e,e||this.setLastKnownRange(null),this.dataProvider.onIsSuggestingChanged(e),this.setAriaOwns(e),this.setAriaActiveDescendant(e?0:null)},e.prototype.cancelDefaultKeyDownEvent=function(e){this.eventHandledOnKeyDown=!0,e.rawEvent.preventDefault(),e.rawEvent.stopImmediatePropagation()},e.prototype.getIdValue=function(e){var t=e;return t.attributes&&t.attributes.getNamedItem("id")?t.attributes.getNamedItem("id").value:null},e.prototype.getWordBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e);return t?t.getWordBefore():null},e.prototype.replaceNode=function(e,t){e&&this.editor.deleteNode(e),t&&this.editor.insertNode(t)},e.prototype.getRangeUntilAt=function(e){var t,n,r=this;return this.editor.getContentSearcherOfCursor(e).forEachTextInlineElement((function(e){for(var o=!1,i=e.getTextContent(),a=i?i.length:-1;a>=0;){if(i[a]==r.pickerOptions.triggerCharacter){t=e.getStartPosition().move(a),o=!0;break}a--}return o&&(n=e.getEndPosition()),o})),o.createRange(t,n)||this.editor.getDocument().createRange()},e.prototype.shouldHandleKeyUpEvent=function(e){return this.isAndroidKeyboardEvent(e)||o.isCharacterValue(e.rawEvent)||this.isSuggesting&&!o.isModifierKey(e.rawEvent)},e.prototype.onKeyUpDomEvent=function(e){if(this.isSuggesting){var t=(r=(n=this.getWord(e)).substring(1)).trim();n==this.pickerOptions.triggerCharacter||t&&t.length>0&&t.split(" ").length<=4?(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange())):this.setIsSuggesting(!1)}else{var n=this.getWordBeforeCursor(e);if(this.blockSuggestions)null!=n&&n[0]!=this.pickerOptions.triggerCharacter&&(this.blockSuggestions=!1);else if(null!=n&&n.split(" ").length<=4&&n[0]==this.pickerOptions.triggerCharacter){this.setIsSuggesting(!0);var r;t=(r=n.substring(1)).trim();if(this.dataProvider.queryStringUpdated(t,r==t),this.setLastKnownRange(this.editor.getSelectionRange()),this.dataProvider.setCursorPoint){var o=this.editor.getContentSearcherOfCursor(e),i=this.editor.getDocument().createRange(),a=o.getInlineElementBefore().getContainerNode();if(!this.setRangeStart(i,a,n)){var l=a.previousSibling;this.setRangeStart(i,l,this.pickerOptions.triggerCharacter)}var s=i.getBoundingClientRect();if(0==s.left&&0==s.bottom&&0==s.top&&(s=i.getClientRects()[0]),s){i.detach();var u={x:s.left,y:(s.bottom+s.top)/2},c=(s.bottom-s.top)/2;this.dataProvider.setCursorPoint(u,c)}}}}},e.prototype.onKeyDownEvent=function(e){var t=e.rawEvent;if(this.isSuggesting)if(t.key==i)this.setIsSuggesting(!1),this.blockSuggestions=!0,this.cancelDefaultKeyDownEvent(e);else if("Backspace"==t.key){this.getWord(e)==this.pickerOptions.triggerCharacter&&this.setIsSuggesting(!1)}else this.dataProvider.shiftHighlight&&(this.pickerOptions.isHorizontal?t.key==a||t.key==s:t.key==l||t.key==u)?(this.dataProvider.shiftHighlight(this.pickerOptions.isHorizontal?t.key==s:t.key==u),this.dataProvider.getSelectedIndex&&this.setAriaActiveDescendant(this.dataProvider.getSelectedIndex()),this.cancelDefaultKeyDownEvent(e)):!this.dataProvider.selectOption||"Enter"!=t.key&&"Tab"!=t.key||(this.dataProvider.selectOption(),this.cancelDefaultKeyDownEvent(e));else if("Backspace"==t.key)this.tryRemoveNode(e)&&this.cancelDefaultKeyDownEvent(e);else if(t.key==c){var n=this.editor.getContentSearcherOfCursor(e),r=n.getInlineElementAfter()?n.getInlineElementAfter().getContainerNode():null,o=r?this.getIdValue(r):null;if(o&&0==o.indexOf(this.pickerOptions.elementIdPrefix)){var d=this.dataProvider.onRemove(r,!1);this.replaceNode(r,d),this.cancelDefaultKeyDownEvent(e)}}},e.prototype.onAndroidInputEvent=function(e){(this.newInputLength=this.calcInputLength(e),this.newInputLength<this.currentInputLength||"deleteContentBackwards"===e.rawEvent.inputType)&&(this.tryRemoveNode(e)&&(this.eventHandledOnKeyDown=!0))},e.prototype.calcInputLength=function(e){var t=this.getInlineElementBeforeCursor(e);return t?t.length:0},e.prototype.tryRemoveNode=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t.getInlineElementBefore(),r=n?n.getContainerNode():null,i=r?this.getIdValue(r):null,a=t.getInlineElementAfter();if(i&&0==i.indexOf(this.pickerOptions.elementIdPrefix)&&(null==a||!(a instanceof o.PartialInlineElement))){var l=this.dataProvider.onRemove(r,!0);return l?(this.replaceNode(r,l),this.isPendingInputEventHandling?this.editor.runAsync((function(e){e.select(l,-3)})):this.editor.select(l,-3)):this.editor.deleteNode(r),!0}return!1},e.prototype.getWord=function(e){var t=this.getRangeUntilAt(e).toString(),n=this.getWordBeforeCursor(e);return t==this.pickerOptions.triggerCharacter&&t!=n?n:t},e.prototype.setRangeStart=function(e,t,n){var r=t?t.textContent.lastIndexOf(n):-1;return r>-1&&(e.setStart(t,r),!0)},e.prototype.setAriaOwns=function(e){this.editor.setEditorDomAttribute("aria-owns",e&&this.pickerOptions.suggestionsLabel?this.pickerOptions.suggestionsLabel:null)},e.prototype.setAriaActiveDescendant=function(e){this.editor.setEditorDomAttribute("aria-activedescendant",null!=e&&this.pickerOptions.suggestionLabelPrefix?this.pickerOptions.suggestionLabelPrefix+e.toString():null)},e.prototype.getInlineElementBeforeCursor=function(e){var t=this.editor.getContentSearcherOfCursor(e),n=t?t.getInlineElementBefore():null;return n?n.getTextContent():null},e.prototype.isAndroidKeyboardEvent=function(e){return"Unidentified"==e.rawEvent.key||null==e.rawEvent.key&&d.indexOf(e.rawEvent.charCode)>-1},e}();t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(254))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(255);t.TableResize=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e,t,n){return n?t-e.left:e.right-t}var i=function(){function e(){var e=this;this.tableRectMap=null,this.currentCellsToResize=[],this.nextCellsToResize=[],this.resizingState=0,this.insertingState=0,this.onMouseOutInserter=function(){e.setCurrentInsertTd(0)},this.onMouseMove=function(t){var n;if(0==e.resizingState&&(e.tableRectMap||e.cacheRects(),e.tableRectMap)){e.setCurrentTable(null);for(var o=e.tableRectMap.length-1;o>=0;o--){var i=e.tableRectMap[o],a=i.table,l=i.rect;if(t.pageX<=l.right+(e.isRTL,12)&&t.pageX>=l.left-(e.isRTL,12)&&t.pageY>=l.top-12&&t.pageY<=l.bottom+12){e.setCurrentTable(a);break}}if(e.currentTable){var s=e.tableRectMap.filter((function(t){return t.table==e.currentTable}))[0];e.setTableResizer(s.rect);for(o=0;o<e.currentTable.rows.length;o++){for(var u=e.currentTable.rows[o],c=0;c<u.cells.length;c++){var d=u.cells[c],f=r.normalizeRect(d.getBoundingClientRect());if(f&&(e.isRTL?t.pageX>=f.left:t.pageX<=f.right)&&t.pageY<=f.bottom)if(0==o&&t.pageY>=f.top-5&&t.pageY<=f.top+5){var h=null;if(e.isRTL?t.pageX<=f.left+(f.right-f.left)/2:t.pageX>=f.left+(f.right-f.left)/2)h=d;else if(e.isRTL?t.pageX<=f.right:t.pageX>=f.left){(v=d.previousElementSibling)&&(h=v)}if(h){e.setCurrentTd(null),0==t.buttons&&e.setCurrentInsertTd(2,h,s.rect);break}}else{if(0!=c||!(e.isRTL?t.pageX>=f.right-5:t.pageX<=f.left+5)){e.setCurrentTd(d,s.rect,e.isRTL?f.left:f.right,f.bottom),e.setCurrentInsertTd(0);break}var p=null;if(t.pageY>=f.top+(f.bottom-f.top)/2)p=d;else if(t.pageY>=f.top){var v;(v=null===(n=e.currentTable.rows[o-1])||void 0===n?void 0:n.cells[0])&&(p=v)}if(p){e.setCurrentTd(null),0==t.buttons&&e.setCurrentInsertTd(1,p,s.rect);break}}}if(c<u.cells.length)break}}else e.setTableResizer(null)}},this.insertTd=function(){var t=new r.VTable(e.currentInsertTd);2===e.insertingState&&(t.normalizeTableCellSize(),t.table.removeAttribute("width"),t.table.style.width=null),e.editor.addUndoSnapshot((function(n,o){if(t.edit(1==e.insertingState?1:3),t.writeBack(),e.editor.select(n,o),e.setCurrentInsertTd(0),e.currentTable){var i=r.normalizeRect(e.currentTable.getBoundingClientRect());e.setTableResizer(i)}}),"Format")},this.startResizingTable=function(t){if(e.currentTable){e.resizingVtable=new r.VTable(e.currentTable,!0),e.resizingState=3;var n=e.resizingVtable.table.getBoundingClientRect();e.currentTableVerticalBorder=e.isRTL?n.left:n.right,e.currentTableHorizontalBorder=n.bottom,e.startResizeCells(t)}},this.startHorizontalResizeCells=function(t){e.currentTd&&(e.resizingVtable=new r.VTable(e.currentTd,!0),e.resizingState=1,e.startResizeCells(t))},this.startVerticalResizeCells=function(t){if(e.currentTd){if(e.resizingVtable=new r.VTable(e.currentTd,!0),e.resizingState=2,e.resizingVtable){var n=r.normalizeRect(e.currentTd.getBoundingClientRect());e.currentCellsToResize=e.resizingVtable.getCellsWithBorder(e.isRTL?n.left:n.right,!e.isRTL),e.nextCellsToResize=e.resizingVtable.getCellsWithBorder(e.isRTL?n.left:n.right,e.isRTL)}e.startResizeCells(t)}},this.frameAnimateResizeCells=function(t){e.editor.runAsync((function(){return e.resizeCells(t)}))},this.resizeTable=function(t,n){var o=r.normalizeRect(e.resizingVtable.table.getBoundingClientRect()),i=1+(e.isRTL?(e.currentTableVerticalBorder-t)/(o.right-e.currentTableVerticalBorder):(t-e.currentTableVerticalBorder)/(e.currentTableVerticalBorder-o.left)),a=1+(n-e.currentTableHorizontalBorder)/(e.currentTableHorizontalBorder-o.top),l=Math.abs(i-1)>.001,s=Math.abs(a-1)>.001;if(l||s)for(var u=0;u<e.resizingVtable.cells.length;u++)for(var c=0;c<e.resizingVtable.cells[u].length;c++){var d=e.resizingVtable.cells[u][c];if(d.td){if(l){e.resizingVtable.table.style.width=null;var f=d.width*i;d.td.style.boxSizing="border-box",f>=30&&(d.td.style.wordBreak="break-word",d.td.style.whiteSpace="normal",d.td.style.width=f+"px")}if(s)if(e.resizingVtable.table.style.height=null,0==c){var h=d.height*a;h>=20&&(d.td.style.height=h+"px")}else d.td.style.height=null}}},this.resizeRows=function(t,n){e.resizingVtable.table.removeAttribute("height"),e.resizingVtable.table.style.height=null,e.resizingVtable.forEachCellOfCurrentRow((function(r){r.td&&(r.td.style.height=r.td==e.currentTd?t-n.top+"px":null)}))},this.canResizeColumns=function(t){for(var n=0;n<e.currentCellsToResize.length;n++){var i=e.currentCellsToResize[n];if((a=o(r.normalizeRect(i.getBoundingClientRect()),t,!e.isRTL))<30)return!1}for(n=0;n<e.nextCellsToResize.length;n++){i=e.nextCellsToResize[n];var a=Number.MAX_SAFE_INTEGER;if(i)a=o(r.normalizeRect(i.getBoundingClientRect()),t,e.isRTL);if(a<30)return!1}return!0},this.resizeColumns=function(t,n){if(e.canResizeColumns(t)){(0==e.nextCellsToResize.length||n)&&(e.resizingVtable.table.style.width=null);var i=new Map;e.currentCellsToResize.forEach((function(n){var a=r.normalizeRect(n.getBoundingClientRect());n.style.wordBreak="break-word",n.style.whiteSpace="normal",n.style.boxSizing="border-box";var l=o(a,t,!e.isRTL);i.set(n,l)})),i.forEach((function(e,t){t.style.width=e+"px"})),e.nextCellsToResize.forEach((function(e){n||(e.style.wordBreak="break-word",e.style.whiteSpace="normal",e.style.boxSizing="border-box",e.style.width=null)}))}},this.resizeCells=function(t){if(e.setTableResizer(null),0!==e.resizingState)if(3===e.resizingState)e.resizeTable(t.pageX,t.pageY),e.resizingVtable.writeBack();else if(e.currentTd){var n=r.normalizeRect(e.currentTd.getBoundingClientRect());if(n){var o=1==e.resizingState?t.pageY:t.pageX;1===e.resizingState?e.resizeRows(o,n):e.resizeColumns(o,t.shiftKey),e.resizingVtable.writeBack()}}},this.endResizeCells=function(t){var n=e.editor.getDocument();n.removeEventListener("mousemove",e.frameAnimateResizeCells,!0),n.removeEventListener("mouseup",e.endResizeCells,!0),e.currentCellsToResize=[],e.nextCellsToResize=[],e.editor.addUndoSnapshot((function(n,r){e.frameAnimateResizeCells(t),e.editor.select(n,r)}),"Format"),e.setCurrentTd(null),e.setTableResizer(null),e.resizingVtable=null,e.resizingState=0}}return e.prototype.getName=function(){return"TableResize"},e.prototype.initialize=function(e){this.editor=e,this.setupResizerContainer(),this.onMouseMoveDisposer=this.editor.addDomEventHandler("mousemove",this.onMouseMove)},e.prototype.dispose=function(){this.onMouseMoveDisposer(),this.tableRectMap=null,this.removeResizerContainer(),this.setCurrentTable(null),this.editor=null},e.prototype.onPluginEvent=function(e){switch(e.eventType){case 3:case 7:case 14:this.setTableResizer(null),this.tableRectMap=null}},e.prototype.setupResizerContainer=function(){var e=this.editor.getDocument();this.resizerContainer=e.createElement("div"),this.editor.insertNode(this.resizerContainer,{updateCursor:!1,insertOnNewLine:!1,replaceSelection:!1,position:4}),this.tableResizerContainer=e.createElement("div"),this.editor.insertNode(this.tableResizerContainer,{updateCursor:!1,insertOnNewLine:!1,replaceSelection:!1,position:4})},e.prototype.removeResizerContainer=function(){var e,t,n,r;null===(t=null===(e=this.resizerContainer)||void 0===e?void 0:e.parentNode)||void 0===t||t.removeChild(this.resizerContainer),this.resizerContainer=null,null===(r=null===(n=this.tableResizerContainer)||void 0===n?void 0:n.parentNode)||void 0===r||r.removeChild(this.tableResizerContainer),this.tableResizerContainer=null},e.prototype.setCurrentInsertTd=function(e,t,n){var r,o;t==this.currentInsertTd&&e==this.insertingState||(this.currentInsertTd&&(null===(o=null===(r=this.inserter)||void 0===r?void 0:r.parentNode)||void 0===o||o.removeChild(this.inserter),this.inserter=null),this.insertingState=e,this.currentInsertTd=t,this.currentInsertTd&&(this.inserter=this.createInserter(n),this.resizerContainer.appendChild(this.inserter)))},e.prototype.createInserter=function(e){if(0!=this.insertingState){var t=r.normalizeRect(this.currentInsertTd.getBoundingClientRect()),n=this.editor.getDefaultFormat().backgroundColor||"white",o=this.editor.isDarkMode()?"white":"#4A4A4A",i="position: fixed; width: 12px; height: 12px; font-size: 16px; color: "+o+"; line-height: 10px; vertical-align: middle; text-align: center; cursor: pointer; border: solid 1px "+o+"; border-radius: 50%; background-color: "+n,a={tag:"div",style:i,children:[{tag:"div",style:"position: absolute; "+(this.isRTL?"right":"left")+": 12px; top: 5px; height: 3px; border-top: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-right: 1px solid "+o+"; border-left: 0px; box-sizing: border-box; background-color: "+n+";"},"+"]},l={tag:"div",style:i,children:[{tag:"div",style:"position: absolute; left: 5px; top: 12px; width: 3px; border-left: 1px solid "+o+"; border-right: 1px solid "+o+"; border-bottom: 1px solid "+o+"; border-top: 0px; box-sizing: border-box; background-color: "+n},"+"]},s=r.createElement(1==this.insertingState?a:l,this.editor.getDocument());return s.id=1==this.insertingState?"horizontalInserter":"verticalInserter",t&&(1==this.insertingState?(this.isRTL?s.style.left=t.right+"px":s.style.left=t.left-13+"px",s.style.top=t.bottom-8+"px",s.firstChild.style.width=e.right-e.left+"px"):(this.isRTL?s.style.left=t.left-8+"px":s.style.left=t.right-8+"px",s.style.top=t.top-13+"px",s.firstChild.style.height=e.bottom-e.top+"px")),s.addEventListener("click",this.insertTd),s.addEventListener("mouseout",this.onMouseOutInserter),s}},e.prototype.setCurrentTable=function(e){this.currentTable!=e&&(this.setCurrentTd(null),this.setCurrentInsertTd(0),this.currentTable=e)},e.prototype.setCurrentTd=function(e,t,n,r){var o,i,a,l;this.currentTd!=e&&(this.currentTd&&(null===(i=null===(o=this.horizontalResizer)||void 0===o?void 0:o.parentNode)||void 0===i||i.removeChild(this.horizontalResizer),null===(l=null===(a=this.verticalResizer)||void 0===a?void 0:a.parentNode)||void 0===l||l.removeChild(this.verticalResizer),this.horizontalResizer=null,this.verticalResizer=null),this.currentTd=e,this.currentTd&&(this.horizontalResizer=this.createCellsResizer(!0,t.left,r-4+1,t.right-t.left,4),this.verticalResizer=this.createCellsResizer(!1,n-4+1,t.top,4,t.bottom-t.top),this.resizerContainer.appendChild(this.horizontalResizer),this.resizerContainer.appendChild(this.verticalResizer)))},e.prototype.setTableResizer=function(e){for(var t;null===(t=this.tableResizerContainer)||void 0===t?void 0:t.hasChildNodes();)this.tableResizerContainer.removeChild(this.tableResizerContainer.lastChild);this.tableResizer=null,e&&(this.tableResizer=this.createTableResizer(e),this.tableResizerContainer.appendChild(this.tableResizer))},e.prototype.createTableResizer=function(e){var t=r.createElement(this.isRTL?10:9,this.editor.getDocument());return t.id="tableResizer",t.style.top=e.bottom+"px",t.style.left=this.isRTL?e.left-12-2+"px":e.right+"px",t.style.width="12px",t.style.height="12px",t.addEventListener("mousedown",this.startResizingTable),t},e.prototype.createCellsResizer=function(e,t,n,o,i){var a=r.createElement(e?7:8,this.editor.getDocument());return a.id=e?"horizontalResizer":"verticalResizer",a.style.top=n+"px",a.style.left=t+"px",a.style.width=o+"px",a.style.height=i+"px",a.addEventListener("mousedown",e?this.startHorizontalResizeCells:this.startVerticalResizeCells),a},e.prototype.startResizeCells=function(e){var t=this.editor.getDocument();t.addEventListener("mousemove",this.frameAnimateResizeCells,!0),t.addEventListener("mouseup",this.endResizeCells,!0)},e.prototype.cacheRects=function(){var e=this;this.tableRectMap=[],this.editor.queryElements("table",(function(t){if(t.isContentEditable){var n=r.normalizeRect(t.getBoundingClientRect());n&&e.tableRectMap.push({table:t,rect:n})}})),this.isRTL="rtl"==r.getComputedStyle(this.editor.getDocument().body,"direction")},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(257))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(258);t.Watermark=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(7),i=function(){function e(e,t){var n=this;this.watermark=e,this.format=t,this.showHideWatermark=function(){var e=n.editor.hasFocus(),t=n.editor.queryElements(r.getEntitySelector("WATERMARK_WRAPPER")),i=t.length>0;e&&i?(t.forEach(n.removeWatermark),n.editor.focus()):e||i||!n.editor.isEmpty()||o.insertEntity(n.editor,"WATERMARK_WRAPPER",n.editor.getDocument().createTextNode(n.watermark),!1,!1,0)},this.removeWatermark=function(e){var t=e.parentNode;null==t||t.removeChild(e),n.editor.contains(t)&&"DIV"==r.getTagOfNode(t)&&!t.firstChild&&t.appendChild(n.editor.getDocument().createElement("BR"))},this.format=this.format||{fontSize:"14px",textColors:{lightModeColor:"#AAAAAA",darkModeColor:"#6B6B6B"}}}return e.prototype.getName=function(){return"Watermark"},e.prototype.initialize=function(e){this.editor=e,this.disposer=this.editor.addDomEventHandler({focus:this.showHideWatermark,blur:this.showHideWatermark})},e.prototype.dispose=function(){this.disposer(),this.disposer=null,this.editor=null},e.prototype.onPluginEvent=function(e){var t;if(11==e.eventType||7==e.eventType&&"WATERMARK_WRAPPER"!=(null===(t=e.data)||void 0===t?void 0:t.type))this.showHideWatermark();else if(15==e.eventType&&"WATERMARK_WRAPPER"==e.entity.type){var n=e.operation,o=e.entity.wrapper;8==n?this.removeWatermark(o):0==e.operation&&(r.applyFormat(o,this.format,this.editor.isDarkMode()),o.spellcheck=!1)}},e}();t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}]);
//# sourceMappingURL=rooster-min.js.map