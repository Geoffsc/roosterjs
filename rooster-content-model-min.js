var roosterjsContentModel;(()=>{"use strict";var e={2345:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDomToModelContext=void 0;var o=r(7582),n=r(8596),a=r(5182),l=r(6681);t.createDomToModelContext=function(e,t){var r,i=(0,o.__assign)((0,o.__assign)({},e||{isDarkMode:!1}),{blockFormat:{},segmentFormat:{},zoomScaleFormat:{},isInSelection:!1,listFormat:{levels:[],threadItemCounts:[]},link:{format:{},dataset:{}},code:{format:{}},blockDecorator:{format:{},tagName:""},elementProcessors:(0,o.__assign)((0,o.__assign)({},a.defaultProcessorMap),(null==t?void 0:t.processorOverride)||{}),defaultStyles:(0,o.__assign)((0,o.__assign)({},l.defaultStyleMap),(null==t?void 0:t.defaultStyleOverride)||{}),formatParsers:(0,n.getFormatParsers)(null==t?void 0:t.formatParserOverride,null==t?void 0:t.additionalFormatParsers),defaultElementProcessors:a.defaultProcessorMap,defaultFormatParsers:n.defaultFormatParsers,allowCacheElement:!(null==t?void 0:t.disableCacheElement)}),s=null==t?void 0:t.selectionRange;switch(null==s?void 0:s.type){case 0:var d=s.ranges[0];d&&(r=d.commonAncestorContainer,i.regularSelection={startContainer:d.startContainer,startOffset:d.startOffset,endContainer:d.endContainer,endOffset:d.endOffset,isSelectionCollapsed:d.collapsed});break;case 1:s.coordinates&&s.table&&(r=s.table,i.tableSelection={table:s.table,firstCell:(0,o.__assign)({},s.coordinates.firstCell),lastCell:(0,o.__assign)({},s.coordinates.lastCell)});break;case 2:r=s.image,i.imageSelection={image:s.image}}return r&&(i.selectionRootNode=r),i}},5182:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultProcessorMap=void 0;var o=r(27),n=r(6058),a=r(3734),l=r(1293),i=r(8263),s=r(3662),d=r(8095),c=r(4992),u=r(5029),f=r(2342),m=r(2563),p=r(5807),v=r(2953),g=r(2850),h=r(5710),b=r(2293),y=r(1932),_=r(6252),k=r(8672);t.defaultProcessorMap={a:g.linkProcessor,b:v.knownElementProcessor,blockquote:v.knownElementProcessor,br:o.brProcessor,code:a.codeProcessor,div:v.knownElementProcessor,em:v.knownElementProcessor,font:d.fontProcessor,i:v.knownElementProcessor,img:p.imageProcessor,h1:f.headingProcessor,h2:f.headingProcessor,h3:f.headingProcessor,h4:f.headingProcessor,h5:f.headingProcessor,h6:f.headingProcessor,hr:m.hrProcessor,li:h.listItemProcessor,ol:b.listProcessor,p:y.pProcessor,pre:c.formatContainerProcessor,s:v.knownElementProcessor,span:v.knownElementProcessor,strike:v.knownElementProcessor,strong:v.knownElementProcessor,sub:v.knownElementProcessor,sup:v.knownElementProcessor,table:_.tableProcessor,u:v.knownElementProcessor,ul:b.listProcessor,"*":u.generalProcessor,"#text":k.textProcessor,element:i.elementProcessor,entity:s.entityProcessor,child:n.childProcessor,delimiter:l.delimiterProcessor}},1940:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(3106),n=r(2345),a=r(5568),l=r(5255),i=r(6673),s=r(2594),d=r(5946);t.default=function(e,t,r){var c=(0,o.createContentModelDocument)(t.defaultFormat),u=(0,n.createDomToModelContext)(t,r);return(0,s.safeInstanceOf)(e,"DocumentFragment")?u.elementProcessors.child(c,e,u):((0,l.parseFormat)(e,[i.rootDirectionFormatHandler.parse],u.blockFormat,u),(0,l.parseFormat)(e,[d.zoomScaleFormatHandler.parse],u.zoomScaleFormat,u),(r.includeRoot?u.elementProcessors.element:u.elementProcessors.child)(c,e,u)),(0,a.normalizeContentModel)(c),c}},9797:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.blockProcessor=void 0;var o=r(7582),n=r(3958),a=r(4992),l=r(4186),i=r(5255),s=["A","CODE"];t.blockProcessor=function(e,t,r,d){var c=r.blockDecorator.tagName?r.blockDecorator:void 0,u=s.indexOf(t.tagName)>=0;(0,i.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var f=(0,o.__assign)({},r.blockFormat);if((0,i.parseFormat)(t,r.formatParsers.container,f,r),a.ContextStyles.forEach((function(e){f[e]&&(r.blockFormat[e]=f[e])})),!u){var m=(0,l.createParagraph)(!1,f,d,c);(0,n.addBlock)(e,m)}r.elementProcessors.child(e,t,r)}},27:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.brProcessor=void 0;var o=r(3394),n=r(2914);t.brProcessor=function(e,t,r){var a=(0,n.createBr)(r.segmentFormat);r.isInSelection&&(a.isSelected=!0),(0,o.addSegment)(e,a,r.blockFormat)}},6058:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleRegularSelection=t.processChildNode=t.childProcessor=void 0;var o=r(7582),n=r(3980),a=r(8152),l=r(455);function i(e,t,r){(0,l.isNodeOfType)(t,1)&&"none"!=t.style.display?r.elementProcessors.element(e,t,r):(0,l.isNodeOfType)(t,3)&&r.elementProcessors["#text"](e,t,r)}function s(e,t,r,o,a){e==o&&(t.isInSelection=!0,(0,n.addSelectionMarker)(r,t)),e==a&&(t.regularSelection.isSelectionCollapsed||(0,n.addSelectionMarker)(r,t),t.isInSelection=!1)}t.childProcessor=function(e,t,r){for(var n=(0,o.__read)((0,a.getRegularSelectionOffsets)(r,t),2),l=n[0],d=n[1],c=0,u=t.firstChild;u;u=u.nextSibling)s(c,r,e,l,d),i(e,u,r),c++;s(c,r,e,l,d)},t.processChildNode=i,t.handleRegularSelection=s},3734:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.codeProcessor=void 0;var o=r(2953),n=r(5255),a=r(4106);t.codeProcessor=function(e,t,r){(0,a.stackFormat)(r,{code:"codeDefault"},(function(){(0,n.parseFormat)(t,r.formatParsers.code,r.code.format,r),(0,o.knownElementProcessor)(e,t,r)}))}},1293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delimiterProcessor=void 0;var o=r(7582),n=r(8152),a=r(6058);t.delimiterProcessor=function(e,t,r){for(var l=0,i=(0,o.__read)((0,n.getRegularSelectionOffsets)(r,t),2),s=i[0],d=i[1],c=t.firstChild;c;c=c.nextSibling)(0,a.handleRegularSelection)(l,r,e,s,d),l++;(0,a.handleRegularSelection)(l,r,e,s,d)}},8263:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.elementProcessor=void 0;var o=r(2594);t.elementProcessor=function(e,t,r){var n=t.tagName.toLowerCase(),a=function(e,t){return e.className&&(0,o.getEntityFromElement)(e)||"false"==e.contentEditable?t.elementProcessors.entity:null}(t,r)||function(e,t){return(0,o.getDelimiterFromElement)(e)?t.elementProcessors.delimiter:null}(t,r)||r.elementProcessors[n]||n.indexOf(":")>=0&&r.elementProcessors.child||r.elementProcessors["*"];a(e,t,r)}},3662:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.entityProcessor=void 0;var o=r(3958),n=r(3394),a=r(6400),l=r(2594),i=r(9668),s=r(4106);t.entityProcessor=function(e,t,r){var d=(0,l.getEntityFromElement)(t)||{isReadonly:!0},c=d.id,u=d.type,f=d.isReadonly,m=(0,i.isBlockElement)(t,r);(0,s.stackFormat)(r,{segment:m?"empty":void 0,paragraph:"empty"},(function(){var l=r.allowCacheElement?t:t.cloneNode(!0);r.allowCacheElement||(l.style.backgroundColor=t.style.backgroundColor||"inherit",l.style.color=t.style.color||"inherit");var i=(0,a.createEntity)(l,f,r.segmentFormat,c,u);r.isInSelection&&(i.isSelected=!0),m?(0,o.addBlock)(e,i):(0,n.addSegment)(e,i)}))}},8095:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontProcessor=void 0;var o=r(9668),n=r(5255),a=r(4106),l=["10px","13px","16px","18px","24px","32px","48px"];t.fontProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:(0,o.isBlockElement)(t,r)?"shallowCloneForBlock":"shallowClone"},(function(){var o,a,i=t.getAttribute("face"),s=(o=t.getAttribute("size"),a=parseInt(o||""),Number.isNaN(a)?void 0:a<1?l[0]:a>l.length?l[l.length-1]:l[a-1]),d=t.getAttribute("color"),c=r.segmentFormat;i&&(c.fontFamily=i),s&&(c.fontSize=s),d&&(c.textColor=d),(0,n.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.elementProcessors.child(e,t,r)}))}},4992:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatContainerProcessor=t.ContextStyles=void 0;var o=r(7582),n=r(3958),a=r(9664),l=r(4186),i=r(8313),s=r(5255),d=r(5378),c=r(4106);t.ContextStyles=["marginLeft","marginRight","paddingLeft","paddingRight"],t.formatContainerProcessor=function(e,r,u){(0,c.stackFormat)(u,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){(0,s.parseFormat)(r,u.formatParsers.block,u.blockFormat,u),(0,s.parseFormat)(r,u.formatParsers.segmentOnBlock,u.segmentFormat,u);var l=(0,o.__assign)({},u.blockFormat);(0,s.parseFormat)(r,u.formatParsers.container,l,u);var c="block"==(0,i.getDefaultStyle)(r,u).display?r.tagName.toLowerCase():"div",f=(0,a.createFormatContainer)(c,l);if(t.ContextStyles.forEach((function(e){delete u.blockFormat[e]})),u.elementProcessors.child(f,r,u),r.style.fontSize&&0==parseInt(r.style.fontSize)&&(f.zeroFontSize=!0),function(e){var t=e.blocks[0];return"div"==e.tagName&&1==e.blocks.length&&"Paragraph"==t.blockType&&t.isImplicit}(f)){var m=f.blocks[0];f.zeroFontSize&&(m.segmentFormat=Object.assign({},m.segmentFormat,{fontSize:"0"})),Object.assign(m.format,f.format),(0,d.setParagraphNotImplicit)(m),(0,n.addBlock)(e,m)}else(0,n.addBlock)(e,f)})),(0,n.addBlock)(e,(0,l.createParagraph)(!0,u.blockFormat))}},5029:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generalProcessor=void 0;var o=r(3958),n=r(7978),a=r(3394),l=r(1965),i=r(7522),s=r(9668),d=r(4106),c=function(e,t,r){var n=(0,l.createGeneralBlock)(t),a=r.isInSelection;(0,d.stackFormat)(r,{segment:"empty",paragraph:"empty",link:"empty"},(function(){(0,o.addBlock)(e,n),r.elementProcessors.child(n,t,r)})),a&&r.isInSelection&&(n.isSelected=!0)},u=function(e,t,r){var o=(0,i.createGeneralSegment)(t,r.segmentFormat),l=r.isInSelection;(0,n.addDecorators)(o,r),(0,a.addSegment)(e,o),(0,d.stackFormat)(r,{segment:"empty"},(function(){r.elementProcessors.child(o,t,r)})),l&&r.isInSelection&&(o.isSelected=!0)};t.generalProcessor=function(e,t,r){((0,s.isBlockElement)(t,r)?c:u)(e,t,r)}},2342:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.headingProcessor=void 0;var o=r(3958),n=r(9797),a=r(4186),l=r(1309),i=r(5255),s=r(4106);t.headingProcessor=function(e,t,r){(0,s.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone",blockDecorator:"empty"},(function(){var o={};(0,i.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),r.blockDecorator=(0,l.createParagraphDecorator)(t.tagName,o),(0,n.blockProcessor)(e,t,r)})),(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},2563:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hrProcessor=void 0;var o=r(3958),n=r(9907),a=r(5255),l=r(4106);t.hrProcessor=function(e,t,r){(0,l.stackFormat)(r,{paragraph:"shallowClone"},(function(){(0,a.parseFormat)(t,r.formatParsers.divider,r.blockFormat,r);var l=(0,n.createDivider)("hr",r.blockFormat);t.size&&(l.size=t.size),r.isInSelection&&(l.isSelected=!0),(0,o.addBlock)(e,l)}))}},5807:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.imageProcessor=void 0;var o=r(7978),n=r(3394),a=r(4109),l=r(5255),i=r(4106);t.imageProcessor=function(e,t,r){(0,i.stackFormat)(r,{segment:"shallowClone"},(function(){var i,s=r.segmentFormat;(0,l.parseFormat)(t,r.formatParsers.segment,s,r),(0,l.parseFormat)(t,r.formatParsers.image,s,r),(0,l.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var d=(0,a.createImage)(t.src,s),c=t.alt,u=t.title;(0,l.parseFormat)(t,r.formatParsers.dataset,d.dataset,r),(0,o.addDecorators)(d,r),c&&(d.alt=c),u&&(d.title=u),r.isInSelection&&(d.isSelected=!0),(null===(i=r.imageSelection)||void 0===i?void 0:i.image)==t&&(d.isSelectedAsImageSelection=!0,d.isSelected=!0),(0,n.addSegment)(e,d)}))}},2953:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.knownElementProcessor=void 0;var o=r(3958),n=r(9797),a=r(4186),l=r(4992),i=r(8313),s=r(9668),d=r(5255),c=r(4106),u=["marginBottom","marginTop","paddingBottom","paddingTop","paddingLeft","paddingRight","borderTopWidth","borderBottomWidth","borderLeftWidth","borderRightWidth","width","height","maxWidth","maxHeight","minWidth","minHeight"],f=["H1","H2","H3","H4","H5","H6","P","A"],m=["A","CODE"];t.knownElementProcessor=function(e,t,r){var p=(0,s.isBlockElement)(t,r);if((p||"inline-block"==t.style.display)&&function(e,t){if(f.indexOf(e.tagName)>=0)return!1;var r=e.style,o=(0,i.getDefaultStyle)(e,t),n=r.getPropertyValue("background-color");return!(!n||"transparent"==n)||(!!u.some((function(e){return parseInt(r[e]||o[e]||"")>0}))||("auto"==r.marginLeft||"auto"==r.marginRight||!!e.getAttribute("align")))}(t,r))(0,l.formatContainerProcessor)(e,t,r);else if(p){var v=r.blockDecorator.tagName?r.blockDecorator:void 0,g=m.indexOf(t.tagName)>=0;(0,c.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){var o={};(0,d.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),(0,n.blockProcessor)(e,t,r,o)})),p&&!g&&(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat,void 0,v))}else(0,c.stackFormat)(r,{segment:"shallowClone",paragraph:"shallowClone",link:"cloneFormat"},(function(){(0,d.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r),r.link.format.href&&"A"!=t.tagName&&(0,d.parseFormat)(t,r.formatParsers.segmentUnderLink,r.link.format,r),r.elementProcessors.child(e,t,r)}))}},2850:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.linkProcessor=void 0;var o=r(2953),n=r(5255),a=r(4106);t.linkProcessor=function(e,t,r){t.hasAttribute("href")?(0,a.stackFormat)(r,{link:"linkDefault"},(function(){(0,n.parseFormat)(t,r.formatParsers.link,r.link.format,r),(0,n.parseFormat)(t,r.formatParsers.dataset,r.link.dataset,r),(0,o.knownElementProcessor)(e,t,r)})):(0,o.knownElementProcessor)(e,t,r)}},5710:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listItemProcessor=void 0;var o=r(518),n=r(5255),a=r(4106);t.listItemProcessor=function(e,t,r){var l,i=r.listFormat;if(i.listParent&&i.levels.length>0)(0,a.stackFormat)(r,{segment:"shallowCloneForBlock"},(function(){(0,n.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r);var e=(0,o.createListItem)(i.levels,r.segmentFormat);(0,n.parseFormat)(t,r.formatParsers.listItemElement,e.format,r),i.listParent.blocks.push(e),(0,n.parseFormat)(t,r.formatParsers.listItem,e.levels[e.levels.length-1],r),r.elementProcessors.child(e,t,r);var a=e.blocks[0];1==e.blocks.length&&"Paragraph"==a.blockType&&a.isImplicit&&(Object.assign(e.format,a.format),a.format={})}));else{var s=null===(l=i.listParent)||void 0===l?void 0:l.blocks,d=null==s?void 0:s[(null==s?void 0:s.length)-1];r.elementProcessors["*"]("BlockGroup"==(null==d?void 0:d.blockType)?d:e,t,r)}}},2293:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listProcessor=void 0;var o=r(7582),n=r(5255),a=r(4106),l=r(7274);t.listProcessor=function(e,t,r){(0,a.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){var a=(0,o.__assign)({},r.blockFormat),i=r.listFormat;!function(e,t,r){var o={};(0,n.parseFormat)(e,t.formatParsers.dataset,o,t),(0,l.updateListMetadata)({dataset:o},(function(e){return Object.assign(r,e||{}),null}))}(t,r,a),(0,n.parseFormat)(t,r.formatParsers.listLevel,a,r),(0,n.parseFormat)(t,r.formatParsers.segment,r.segmentFormat,r);var s=i.listParent;i.listParent=i.listParent||e,i.levels.push(a);try{r.elementProcessors.child(e,t,r)}finally{i.levels.pop(),i.listParent=s}}))}},1932:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pProcessor=void 0;var o=r(3958),n=r(9797),a=r(4186),l=r(1309),i=r(5255),s=r(4106);t.pProcessor=function(e,t,r){(0,s.stackFormat)(r,{blockDecorator:"empty",segment:"shallowCloneForBlock",paragraph:"shallowClone"},(function(){r.blockDecorator=(0,l.createParagraphDecorator)(t.tagName);var o={};(0,i.parseFormat)(t,r.formatParsers.segmentOnBlock,o,r),Object.assign(r.segmentFormat,o),(0,n.blockProcessor)(e,t,r,o)})),(0,o.addBlock)(e,(0,a.createParagraph)(!0,r.blockFormat))}},5441:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reducedModelChildProcessor=void 0;var o=r(7582),n=r(2594),a=r(8152),l=r(6058);t.reducedModelChildProcessor=function(e,t,r){if(r.selectionRootNode){r.nodeStack||(r.nodeStack=function(e,t){for(var r=[],o=t;o&&(0,n.contains)(e,o);)"TABLE"==(0,n.getTagOfNode)(o)?r.splice(0,r.length,o):r.push(o),o=o.parentNode;return r}(t,r.selectionRootNode));var i=r.nodeStack.pop();if(i){var s=(0,o.__read)((0,a.getRegularSelectionOffsets)(r,t),2),d=s[0],c=s[1],u=d>=0||c>=0?function(e,t){for(var r=0,o=e.firstChild;o&&o!=t;)r++,o=o.nextSibling;return r}(t,i):-1;u>=0&&(0,l.handleRegularSelection)(u,r,e,d,c),(0,l.processChildNode)(e,i,r),u>=0&&(0,l.handleRegularSelection)(u+1,r,e,d,c)}else r.defaultElementProcessors.child(e,t,r)}}},6600:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tablePreProcessor=void 0;var o=r(2594),n=r(3662),a=r(1774),l=r(6252);t.tablePreProcessor=function(e,t,r){var i=function(e,t){return(0,a.hasMetadata)(e)||t.isInSelection||function(e,t){var r,n,a,l;return[null===(r=t.imageSelection)||void 0===r?void 0:r.image,null===(n=t.tableSelection)||void 0===n?void 0:n.table,null===(a=t.regularSelection)||void 0===a?void 0:a.startContainer,null===(l=t.regularSelection)||void 0===l?void 0:l.endContainer].some((function(t){return(0,o.contains)(e,t,!0)}))}(e,t)}(t,r)?l.tableProcessor:n.entityProcessor;i(e,t,r)}},6252:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableProcessor=void 0;var o=r(7582),n=r(3958),a=r(189),l=r(7520),i=r(8883),s=r(5255),d=r(4106);function c(e){for(var t=[],r=e[e.length-1],o=e.length-2;o>=0;o--)void 0===e[o]?t[o]=0:(t[o]=r-e[o],r=e[o]);return t}t.tableProcessor=function(e,t,r){(0,d.stackFormat)(r,{segment:"shallowCloneForBlock",paragraph:"shallowCloneForGroup"},(function(){(0,s.parseFormat)(t,r.formatParsers.block,r.blockFormat,r);var u=(0,a.createTable)(t.rows.length,r.blockFormat),f=r.tableSelection||{},m=f.table,p=f.firstCell,v=f.lastCell,g=m==t&&!!p&&!!v;r.allowCacheElement&&(u.cachedElement=t),(0,s.parseFormat)(t,r.formatParsers.table,u.format,r),(0,s.parseFormat)(t,r.formatParsers.tableBorder,u.format,r),(0,s.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r),(0,s.parseFormat)(t,r.formatParsers.dataset,u.dataset,r),(0,n.addBlock)(e,u);for(var h=[0],b=[0],y=r.zoomScaleFormat.zoomScale||1,_=function(e){var n=t.rows[e],a=u.rows[e];r.allowCacheElement&&(a.cachedElement=n),(0,s.parseFormat)(n,r.formatParsers.tableRow,a.format,r),(0,d.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){var t=n.parentElement,c=null==t?void 0:t.tagName;!t||"TBODY"!=c&&"THEAD"!=c&&"TFOOT"!=c||((0,s.parseFormat)(t,r.formatParsers.block,r.blockFormat,r),(0,s.parseFormat)(t,r.formatParsers.segmentOnBlock,r.segmentFormat,r)),(0,s.parseFormat)(n,r.formatParsers.block,r.blockFormat,r),(0,s.parseFormat)(n,r.formatParsers.segmentOnBlock,r.segmentFormat,r);for(var f,m=function(t,c){for(;a.cells[c];c++);var m=n.cells[t],_=r.isInSelection,k=c+m.colSpan,C=e+m.rowSpan,S=void 0===h[k],P=void 0===b[C];if(S||P){var O=(0,i.getBoundingClientRect)(m);(O.width>0||O.height>0)&&(S&&(h[k]=h[c]+O.width/y),P&&(b[C]=b[e]+O.height/y))}(0,d.stackFormat)(r,{paragraph:"shallowClone",segment:"shallowClone"},(function(){(0,s.parseFormat)(m,r.formatParsers.block,r.blockFormat,r),(0,s.parseFormat)(m,r.formatParsers.segmentOnTableCell,r.segmentFormat,r);var t=(0,o.__assign)({},r.blockFormat),n={};(0,s.parseFormat)(m,r.formatParsers.tableCell,t,r),(0,s.parseFormat)(m,r.formatParsers.tableBorder,t,r),(0,s.parseFormat)(m,r.formatParsers.dataset,n,r);for(var a=1;a<=m.colSpan;a++,c++)for(var i=1;i<=m.rowSpan;i++){var d=1==a&&1==i,f=(0,l.createTableCell)(a>1,i>1,"TH"==m.tagName,t);f.dataset=(0,o.__assign)({},n);var h=u.rows[e+i-1];if(h&&(h.cells[c]=f),d){r.allowCacheElement&&(f.cachedElement=m);var b=r.listFormat,y=b.listParent,k=b.levels;r.listFormat.listParent=void 0,r.listFormat.levels=[];try{r.elementProcessors.child(f,m,r)}finally{r.listFormat.listParent=y,r.listFormat.levels=k}}var C=r.isInSelection;(_&&C||g&&e>=p.y&&e<=v.y&&c>=p.x&&c<=v.x)&&(f.isSelected=!0)}})),f=c},_=0,k=0;_<n.cells.length;_++)m(_,k),k=f}))},k=0;k<t.rows.length;k++)_(k);u.widths=c(h);var C=c(b);u.rows.forEach((function(e,t){C[t]>0&&(e.height=C[t])}))}))}},8672:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textProcessor=void 0;var o=r(7582),n=r(7978),a=r(3394),l=r(3980),i=r(7143),s=r(7014),d=r(8152),c=r(7646);t.textProcessor=function(e,t,r){var n=t.nodeValue||"",a=(0,o.__read)((0,d.getRegularSelectionOffsets)(r,t),2),i=a[0],s=a[1];i>=0&&(f(e,n.substring(0,i),r),r.isInSelection=!0,(0,l.addSelectionMarker)(e,r),n=n.substring(i),s-=i),s>=0&&(f(e,n.substring(0,s),r),r.regularSelection.isSelectionCollapsed||(0,l.addSelectionMarker)(e,r),r.isInSelection=!1,n=n.substring(s)),f(e,n,r)};var u=["pre","pre-wrap","pre-line","break-spaces"];function f(e,t,r){if(t){var o=e.blocks[e.blocks.length-1],l="Paragraph"==(null==o?void 0:o.blockType)?o:null,d=null==l?void 0:l.segments[l.segments.length-1];if("Text"==(null==d?void 0:d.segmentType)&&!!d.isSelected==!!r.isInSelection&&(0,i.areSameFormats)(d.format,r.segmentFormat)&&(0,i.areSameFormats)(d.link||{},r.link.format||{})&&(0,i.areSameFormats)(d.code||{},r.code.format||{}))d.text+=t;else if(!(0,c.hasSpacesOnly)(t)||(null==l?void 0:l.segments.length)>0||u.indexOf((null==l?void 0:l.format.whiteSpace)||"")>=0){var f=(0,s.createText)(t,r.segmentFormat);r.isInSelection&&(f.isSelected=!0),(0,n.addDecorators)(f,r),(0,a.addSegment)(e,f,r.blockFormat)}}}},3980:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSelectionMarker=void 0;var o=r(7978),n=r(3394),a=r(8996);t.addSelectionMarker=function(e,t){var r=(0,a.createSelectionMarker)(t.segmentFormat);(0,o.addDecorators)(r,t),(0,n.addSegment)(e,r,t.blockFormat)}},7143:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.areSameFormats=void 0;var o=r(2594);t.areSameFormats=function(e,t){if(e==t)return!0;var r=(0,o.getObjectKeys)(e),n=(0,o.getObjectKeys)(t);return r.length==n.length&&r.every((function(r){return e[r]==t[r]}))}},8883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingClientRect=void 0,t.getBoundingClientRect=function(e){return e.getBoundingClientRect()}},8313:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultStyle=void 0,t.getDefaultStyle=function(e,t){var r=e.tagName.toLowerCase();return t.defaultStyles[r]||{}}},8152:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRegularSelectionOffsets=void 0,t.getRegularSelectionOffsets=function(e,t){var r,o;return[(null===(r=e.regularSelection)||void 0===r?void 0:r.startContainer)==t?e.regularSelection.startOffset:-1,(null===(o=e.regularSelection)||void 0===o?void 0:o.endContainer)==t?e.regularSelection.endOffset:-1]}},9668:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockElement=void 0;var o=r(8313),n=["block","list-item","table","table-cell","flex"];t.isBlockElement=function(e,t){var r=e.style.display||(0,o.getDefaultStyle)(e,t).display||"";return n.indexOf(r)>=0}},5255:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseFormat=void 0;var o=r(8313);t.parseFormat=function(e,t,r,n){var a=(0,o.getDefaultStyle)(e,n);t.forEach((function(t){null==t||t(r,e,n,a)}))}},4106:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var o=r(7582),n=r(2594),a=["backgroundColor"],l=["marginLeft","marginRight","paddingLeft","paddingRight"];function i(e,t){switch(t){case"empty":return{};case void 0:return e;default:var r=(0,o.__assign)({},e);return(0,n.getObjectKeys)(e).forEach((function(e){("shallowCloneForBlock"==t&&a.indexOf(e)>=0||"shallowCloneForGroup"==t&&l.indexOf(e)>=0)&&delete r[e]})),r}}t.stackFormat=function(e,t,r){var n,a=e.segmentFormat,l=e.blockFormat,s=e.link,d=e.code,c=e.blockDecorator,u=t.segment,f=t.paragraph,m=t.link,p=t.code,v=t.blockDecorator;try{e.segmentFormat=i(a,u),e.blockFormat=i(l,f),e.link=function(e,t){switch(t){case"linkDefault":return{format:{underline:!0},dataset:{}};case"empty":return{format:{},dataset:{}};default:return{dataset:e.dataset,format:(0,o.__assign)({},e.format)}}}(s,m),e.code=function(e,t){switch(t){case"codeDefault":return{format:{fontFamily:"monospace"}};case"empty":return{format:{}};default:return e}}(d,p),e.blockDecorator=(n=c,"empty"===v?{format:{},tagName:""}:n),r()}finally{e.segmentFormat=a,e.blockFormat=l,e.link=s,e.code=d,e.blockDecorator=c}}},8117:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.combineBorderValue=t.extractBorderValues=void 0;var r=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"],o=/^(thin|medium|thick|[\d\.]+\w*)$/;t.extractBorderValues=function(e){var t={};return(e||"").replace(/, /g,",").split(" ").forEach((function(e){r.indexOf(e)>=0&&!t.style?t.style=e:o.test(e)&&!t.width?t.width=e:e&&!t.color&&(t.color=e)})),t},t.combineBorderValue=function(e){return[e.width||"",e.style||"",e.color||""].join(" ").trim()||"none"}},3870:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableMetadata=t.updateTableCellMetadata=t.updateMetadata=t.updateListMetadata=t.updateImageMetadata=t.extractBorderValues=t.combineBorderValue=void 0;var o=r(8117);Object.defineProperty(t,"combineBorderValue",{enumerable:!0,get:function(){return o.combineBorderValue}}),Object.defineProperty(t,"extractBorderValues",{enumerable:!0,get:function(){return o.extractBorderValues}});var n=r(2005);Object.defineProperty(t,"updateImageMetadata",{enumerable:!0,get:function(){return n.updateImageMetadata}});var a=r(7274);Object.defineProperty(t,"updateListMetadata",{enumerable:!0,get:function(){return a.updateListMetadata}});var l=r(1774);Object.defineProperty(t,"updateMetadata",{enumerable:!0,get:function(){return l.updateMetadata}});var i=r(5311);Object.defineProperty(t,"updateTableCellMetadata",{enumerable:!0,get:function(){return i.updateTableCellMetadata}});var s=r(6110);Object.defineProperty(t,"updateTableMetadata",{enumerable:!0,get:function(){return s.updateTableMetadata}})},455:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeOfType=void 0,t.isNodeOfType=function(e,t){return!!e&&e.nodeType==t}},2005:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateImageMetadata=void 0;var o=r(1774),n=r(2594),a=(0,n.createNumberDefinition)(),l=(0,n.createObjectDefinition)({widthPx:a,heightPx:a,leftPercent:a,rightPercent:a,topPercent:a,bottomPercent:a,angleRad:a,src:(0,n.createStringDefinition)(),naturalHeight:a,naturalWidth:a});t.updateImageMetadata=function(e,t){return(0,o.updateMetadata)(e,t,l)}},7274:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateListMetadata=void 0;var o=r(2594),n=r(1774),a=(0,o.createObjectDefinition)({orderedStyleType:(0,o.createNumberDefinition)(!0,void 0,1,20),unorderedStyleType:(0,o.createNumberDefinition)(!0,void 0,1,9)},!0,!0);t.updateListMetadata=function(e,t){return(0,n.updateMetadata)(e,t,a)}},1774:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.hasMetadata=t.updateMetadata=void 0;var o=r(2594),n="editingInfo";t.updateMetadata=function(e,t,r){var a=e.dataset[n],l=null;try{l=JSON.parse(a)}catch(e){}return r&&!(0,o.validate)(l,r)&&(l=null),t&&((l=t(l))?r&&!(0,o.validate)(l,r)||(e.dataset[n]=JSON.stringify(l)):delete e.dataset[n]),l},t.hasMetadata=function(e){return!!e.dataset[n]}},5311:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableCellMetadata=void 0;var o=r(2594),n=r(1774),a=(0,o.createObjectDefinition)({bgColorOverride:(0,o.createBooleanDefinition)(!0)},!1,!0);t.updateTableCellMetadata=function(e,t){return(0,n.updateMetadata)(e,t,a)}},6110:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateTableMetadata=void 0;var o=r(1774),n=r(2594),a=(0,n.createStringDefinition)(!1,void 0,!0),l=(0,n.createBooleanDefinition)(!1),i=(0,n.createObjectDefinition)({topBorderColor:a,bottomBorderColor:a,verticalBorderColor:a,hasHeaderRow:l,headerRowColor:a,hasFirstColumn:l,hasBandedColumns:l,hasBandedRows:l,bgColorEven:a,bgColorOdd:a,tableBorderFormat:(0,n.createNumberDefinition)(!1,void 0,0,8)},!1,!0);t.updateTableMetadata=function(e,t){return(0,o.updateMetadata)(e,t,i)}},7646:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeText=t.hasSpacesOnly=t.isSpace=t.isPunctuation=void 0;var r=/^[\r\n\t ]*$/,o=/[\u2000\u2009\u200a​\u200b​\u202f\u205f​\u3000\s\t\r\n]/gm;t.isPunctuation=function(e){return'.,?!:"()[]\\/'.indexOf(e)>=0},t.isSpace=function(e){var t,r=null!==(t=null==e?void 0:e.charCodeAt(0))&&void 0!==t?t:0;return 160==r||32==r||o.test(e)},t.hasSpacesOnly=function(e){return r.test(e)},t.normalizeText=function(e,t){return e.replace(t?/^\u0020+/:/\u0020+$/," ")}},8844:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(1319),a=function(e){function t(t,r){return void 0===r&&(r={}),e.call(this,t,r,n.createContentModelEditorCore)||this}return(0,o.__extends)(t,e),t.prototype.createContentModel=function(e){var t=this.getCore();return t.api.createContentModel(t,e)},t.prototype.setContentModel=function(e,t){var r=this.getCore();r.api.setContentModel(r,e,t)},t.prototype.cacheContentModel=function(e){var t=this.getCore();t.reuseModel&&!t.lifecycle.shadowEditFragment&&(t.cachedModel=e||void 0)},t.prototype.getContentModelDefaultFormat=function(){return this.getCore().defaultFormat},t}(r(2594).EditorBase);t.default=a},4243:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModel=void 0;var o=r(7582),n=r(1940),a=r(1392),l=r(6600);t.createContentModel=function(e,t){var r=e.reuseModel?e.cachedModel:null;return r&&e.lifecycle.shadowEditFragment&&(r=(0,a.cloneModel)(r)),r||function(e,t){var r=(0,o.__assign)((0,o.__assign)((0,o.__assign)({selectionRange:e.api.getSelectionRangeEx(e)},e.defaultDomToModelOptions),t||{}),{processorOverride:(0,o.__assign)({table:l.tablePreProcessor},(null==t?void 0:t.processorOverride)||{})});return e.reuseModel||(r.disableCacheElement=!0),(0,n.default)(e.contentDiv,e.api.createEditorContext(e),r)}(e,t)}},6561:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEditorContext=void 0,t.createEditorContext=function(e){return{isDarkMode:e.lifecycle.isDarkMode,defaultFormat:e.defaultFormat,darkColorHandler:e.darkColorHandler,addDelimiterForEntity:e.addDelimiterForEntity}}},8633:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setContentModel=void 0;var o=r(7582),n=r(3556);t.setContentModel=function(e,t,r){var a=(0,n.default)(e.contentDiv.ownerDocument,e.contentDiv,t,e.api.createEditorContext(e),(0,o.__assign)((0,o.__assign)({},e.defaultModelToDomOptions),r||{}));e.lifecycle.shadowEditFragment||e.api.select(e,a)}},8590:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.switchShadowEdit=void 0;var o=r(2594);t.switchShadowEdit=function(e,t){var r=e;if(t!=!!r.lifecycle.shadowEditFragment)if(t){r.cachedModel||(r.cachedModel=r.api.createContentModel(r));var n=r.api.getSelectionRange(r,!0);r.lifecycle.shadowEditSelectionPath=n&&(0,o.getSelectionPath)(r.contentDiv,n),r.lifecycle.shadowEditFragment=r.contentDiv.ownerDocument.createDocumentFragment()}else r.cachedModel&&r.api.setContentModel(r,r.cachedModel),r.lifecycle.shadowEditFragment=null,r.lifecycle.shadowEditSelectionPath=null}},7653:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.onNodeCreated=void 0;var o=r(7582),n=r(3556),a=r(5985),l=r(1392),i=r(1242),s=r(8252),d=r(2537),c=r(2594),u=function(){function e(e){var t=this;this.state=e,this.editor=null,this.disposer=null,this.onPaste=function(e){if(t.editor&&function(e){return!!e.clipboardData}(e)){var r=t.editor,o=e.clipboardData;(null==o?void 0:o.items)&&(e.preventDefault(),(0,c.extractClipboardItems)((0,c.toArray)(o.items),{allowedCustomPasteType:t.state.allowedCustomPasteType}).then((function(e){r.isDisposed()||(function(e){if(c.Browser.isAndroid){var t=e.createContentModel();(0,i.deleteSelection)(t,(0,s.getOnDeleteEntityCallback)(e)),e.setContentModel(t)}}(r),(0,a.default)(r,e))})))}}}return e.prototype.getName=function(){return"ContentModelCopyPaste"},e.prototype.initialize=function(e){var t=this;this.editor=e,this.disposer=this.editor.addDomEventHandler({paste:function(e){return t.onPaste(e)},copy:function(e){return t.onCutCopy(e,!1)},cut:function(e){return t.onCutCopy(e,!0)}})},e.prototype.dispose=function(){this.disposer&&this.disposer(),this.disposer=null,this.editor=null},e.prototype.getState=function(){return this.state},e.prototype.onCutCopy=function(e,r){var a=this;if(this.editor){var u=this.editor.getSelectionRangeEx();if(u&&!u.areAllCollapsed){var f=this.editor.createContentModel({disableCacheElement:!0}),m=(0,l.cloneModel)(f);1===u.type&&(0,d.iterateSelections)([m],(function(e,t){if(null==t?void 0:t.table){var r=null==t?void 0:t.table;return r.rows=r.rows.map((function(e){return(0,o.__assign)((0,o.__assign)({},e),{cells:e.cells.filter((function(e){return e.isSelected}))})})).filter((function(e){return e.cells.length>0})),!0}return!1}));var p=this.getTempDiv(this.editor),v=(0,n.default)(p.ownerDocument,p,m,{isDarkMode:!1,darkColorHandler:this.editor.getDarkColorHandler()},{onNodeCreated:t.onNodeCreated}),g=function(e,t){var r;if(!e)return null;var o=null;if(1===e.type&&e.coordinates){var n=t.querySelector("#"+e.table.id),a=1==(null===(r=n.parentElement)||void 0===r?void 0:r.childElementCount)?n.parentElement:n;o=(0,c.createRange)(a)}else if(2===e.type){var l=t.querySelector("#"+e.image.id);l&&(o=(0,c.createRange)(l))}else o=e.ranges[0];return o}(v,p);g&&(this.editor.triggerPluginEvent(9,{clonedRoot:p,range:g,rawEvent:e,isCut:r}).range&&(0,c.addRangeToSelection)(g),this.editor.runAsync((function(e){var t,o;(o=p).style.backgroundColor="",o.style.color="",o.style.display="none",(0,c.moveChildNodes)(o),e.focus(),v&&(null===(t=a.editor)||void 0===t||t.select(v)),r&&e.addUndoSnapshot((function(){var t;(0,i.deleteSelection)(f,(0,s.getOnDeleteEntityCallback)(e)),null===(t=a.editor)||void 0===t||t.setContentModel(f)}),"Cut")})))}}},e.prototype.getTempDiv=function(e){var t=e.getCustomData("CopyPasteTempDiv",(function(){var t=(0,c.createElement)(3,e.getDocument());return e.getDocument().body.appendChild(t),t}),(function(e){var t;return null===(t=e.parentNode)||void 0===t?void 0:t.removeChild(e)}));return t.style.backgroundColor="white",t.style.color="black",t.childNodes.forEach((function(e){return t.removeChild(e)})),t.style.display="",t.focus(),t},e}();t.default=u,t.onNodeCreated=function(e,t){(0,c.safeInstanceOf)(t,"HTMLTableElement")&&(0,c.wrap)(t,"div")}},4413:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getName=function(){return"ContentModelTypeInContainer"},e.prototype.initialize=function(){},e.prototype.dispose=function(){},e}();t.default=r},1319:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.promoteToContentModelEditorCore=t.createContentModelEditorCore=void 0;var o=r(7582),n=r(7653),a=r(3019),l=r(4140),i=r(4413),s=r(4243),d=r(6561),c=r(2594),u=r(8633),f=r(8590);function m(e,t){var r=e;!function(e){e.lifecycle.defaultFormat=e.lifecycle.defaultFormat||{},e.defaultFormat=function(e){var t,r,o,n=null!==(t=e.lifecycle.defaultFormat)&&void 0!==t?t:{};return{fontWeight:n.bold?"bold":void 0,italic:n.italic||void 0,underline:n.underline||void 0,fontFamily:n.fontFamily||void 0,fontSize:n.fontSize||void 0,textColor:(null===(r=n.textColors)||void 0===r?void 0:r.lightModeColor)||n.textColor||void 0,backgroundColor:(null===(o=n.backgroundColors)||void 0===o?void 0:o.lightModeColor)||n.backgroundColor||void 0}}(e)}(r),function(e,t){var r=e.lifecycle.experimentalFeatures;e.defaultDomToModelOptions=t.defaultDomToModelOptions||{},e.defaultModelToDomOptions=t.defaultModelToDomOptions||{},e.reuseModel=(0,c.isFeatureEnabled)(r,"ReusableContentModel"),e.addDelimiterForEntity=(0,c.isFeatureEnabled)(r,"InlineEntityReadOnlyDelimiters")}(r,t),function(e){e.api.createEditorContext=d.createEditorContext,e.api.createContentModel=s.createContentModel,e.api.setContentModel=u.setContentModel,(0,c.isFeatureEnabled)(e.lifecycle.experimentalFeatures,"ReusableContentModel")&&(e.api.switchShadowEdit=f.switchShadowEdit),e.originalApi.createEditorContext=d.createEditorContext,e.originalApi.createContentModel=s.createContentModel,e.originalApi.setContentModel=u.setContentModel}(r)}t.createContentModelEditorCore=function(e,t){var r=(0,o.__assign)((0,o.__assign)({},t),{plugins:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(t.plugins||[]),!1),[new l.default,new a.default],!1),corePluginOverride:(0,o.__assign)({typeInContainer:(0,c.isFeatureEnabled)(t.experimentalFeatures,"EditWithContentModel")?new i.default:void 0,copyPaste:(0,c.isFeatureEnabled)(t.experimentalFeatures,"ContentModelPaste")?new n.default({allowedCustomPasteType:t.allowedCustomPasteType||[]}):void 0},t.corePluginOverride||{})}),s=(0,c.createEditorCore)(e,r);return m(s,r),s},t.promoteToContentModelEditorCore=m},517:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.promoteToContentModelEditorCore=t.createContentModelEditorCore=t.ContentModelCopyPastePlugin=t.ContentModelTypeInContainerPlugin=t.ContentModelPastePlugin=t.ContentModelEditPlugin=t.ContentModelFormatPlugin=t.isContentModelEditor=t.ContentModelEditor=void 0;var o=r(8844);Object.defineProperty(t,"ContentModelEditor",{enumerable:!0,get:function(){return o.default}});var n=r(6294);Object.defineProperty(t,"isContentModelEditor",{enumerable:!0,get:function(){return n.default}});var a=r(4140);Object.defineProperty(t,"ContentModelFormatPlugin",{enumerable:!0,get:function(){return a.default}});var l=r(3019);Object.defineProperty(t,"ContentModelEditPlugin",{enumerable:!0,get:function(){return l.default}});var i=r(5597);Object.defineProperty(t,"ContentModelPastePlugin",{enumerable:!0,get:function(){return i.default}});var s=r(4413);Object.defineProperty(t,"ContentModelTypeInContainerPlugin",{enumerable:!0,get:function(){return s.default}});var d=r(7653);Object.defineProperty(t,"ContentModelCopyPastePlugin",{enumerable:!0,get:function(){return d.default}});var c=r(1319);Object.defineProperty(t,"createContentModelEditorCore",{enumerable:!0,get:function(){return c.createContentModelEditorCore}}),Object.defineProperty(t,"promoteToContentModelEditorCore",{enumerable:!0,get:function(){return c.promoteToContentModelEditorCore}})},6294:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return!!e.createContentModel}},3019:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(6334),a=r(1242),l=r(7342),i=r(8252),s=r(13),d=r(455),c=r(5568),u=r(2594),f=function(){function e(){this.editor=null,this.triggeredEntityEvents=[],this.editWithContentModel=!1,this.hasDefaultFormat=!1}return e.prototype.getName=function(){return"ContentModelEdit"},e.prototype.initialize=function(e){this.editor=e,this.editWithContentModel=this.editor.isFeatureEnabled("EditWithContentModel");var t=this.editor.getContentModelDefaultFormat();this.hasDefaultFormat=(0,u.getObjectKeys)(t).filter((function(e){return void 0!==t[e]})).length>0},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 15:this.handleEntityOperationEvent(this.editor,e);break;case 0:this.handleKeyDownEvent(this.editor,e.rawEvent);break;case 7:case 6:this.editor.cacheContentModel(null)}},e.prototype.handleEntityOperationEvent=function(e,t){var r;"keydown"==(null===(r=t.rawEvent)||void 0===r?void 0:r.type)&&this.triggeredEntityEvents.push(t)},e.prototype.handleKeyDownEvent=function(e,t){var r=t.which;if(!this.editWithContentModel||t.defaultPrevented)e.cacheContentModel(null);else if(!t.defaultPrevented)switch(r){case 8:case 46:var o=e.getSelectionRangeEx(),a=0==o.type?o.ranges[0]:null;this.shouldDeleteWithContentModel(a,t)?(0,n.default)(e,t,this.triggeredEntityEvents):e.cacheContentModel(null);break;default:((0,u.isCharacterValue)(t)||"Process"==t.key)&&this.hasDefaultFormat&&this.tryApplyDefaultFormat(e),e.cacheContentModel(null)}this.triggeredEntityEvents.length>0&&(this.triggeredEntityEvents=[])},e.prototype.tryApplyDefaultFormat=function(e){for(var t,r,o=this,n=e.getSelectionRangeEx(),s=0==(null==n?void 0:n.type)?n.ranges[0]:null,f=s?u.Position.getStart(s):null,m=null!==(t=null==f?void 0:f.node)&&void 0!==t?t:null;m&&e.contains(m);){if((0,d.isNodeOfType)(m,1)&&(null===(r=m.getAttribute)||void 0===r?void 0:r.call(m,"style")))return;if((0,u.isBlockElement)(m))break;m=m.parentNode}(0,l.formatWithContentModel)(e,"input",(function(t){var r=(0,a.deleteSelection)(t,(0,i.getOnDeleteEntityCallback)(e,void 0,o.triggeredEntityEvents));if(2==r.deleteResult)return(0,c.normalizeContentModel)(t),e.addUndoSnapshot(),!0;if(0==r.deleteResult&&r.insertPoint&&f){var n=r.insertPoint,l=n.paragraph,s=n.path,d=n.marker,u=s[0].blocks,m=u.length,p=u.indexOf(l);if(l.isImplicit&&1==l.segments.length&&l.segments[0]==d&&m>0&&p==m-1){var v=u[p-1];"Paragraph"!=(null==v?void 0:v.blockType)&&o.applyDefaultFormat(e,d.format,f)}else l.segments.every((function(e){return"Text"!=e.segmentType}))&&o.applyDefaultFormat(e,d.format,f);return!1}return!1}))},e.prototype.applyDefaultFormat=function(e,t,r){var n=(0,s.getPendingFormat)(e)||{},a=e.getContentModelDefaultFormat(),l=(0,o.__assign)((0,o.__assign)((0,o.__assign)({},a),n),t);(0,s.setPendingFormat)(e,l,r)},e.prototype.shouldDeleteWithContentModel=function(e,t){return!((null==e?void 0:e.collapsed)&&3==e.startContainer.nodeType&&!(0,u.isModifierKey)(t)&&(this.canDeleteBefore(t,e)||this.canDeleteAfter(t,e)))},e.prototype.canDeleteBefore=function(e,t){return 8==e.which&&(t.startOffset>1||t.startContainer.previousSibling)},e.prototype.canDeleteAfter=function(e,t){var r,o;return 46==e.which&&(t.startOffset<(null!==(o=null===(r=t.startContainer.nodeValue)||void 0===r?void 0:r.length)&&void 0!==o?o:0)-1||t.startContainer.nextSibling)},e}();t.default=f},4140:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(3744),n=r(13),a=function(){function e(){this.editor=null}return e.prototype.getName=function(){return"ContentModelFormat"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor)switch(e.eventType){case 3:e.rawEvent.isComposing||this.editor.isInIME()||this.checkAndApplyPendingFormat(e.rawEvent.data);break;case 4:this.checkAndApplyPendingFormat(e.rawEvent.data);break;case 0:e.rawEvent.which>=33&&e.rawEvent.which<=40&&(0,n.clearPendingFormat)(this.editor);break;case 6:case 7:(0,n.canApplyPendingFormat)(this.editor)||(0,n.clearPendingFormat)(this.editor)}},e.prototype.checkAndApplyPendingFormat=function(e){this.editor&&e&&((0,o.default)(this.editor,e),(0,n.clearPendingFormat)(this.editor))},e}();t.default=a},5597:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(5e3),n=r(2594),a=r(1475),l=r(1418),i=r(4336),s=r(732),d=r(1286),c=r(5764),u=function(){function e(e){void 0===e&&(e="SPAN"),this.unknownTagReplacement=e,this.editor=null}return e.prototype.getName=function(){return"ContentModelPaste"},e.prototype.initialize=function(e){this.editor=e},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(this.editor&&10==e.eventType){var t=e;if(t.domToModelOption){switch((0,n.getPasteSource)(e,!1)){case 0:(0,d.processPastedContentFromWordDesktop)(t);break;case 5:(0,c.processPastedContentWacComponents)(t);break;case 2:0!==e.pasteType&&2!==e.pasteType||(0,i.processPastedContentFromExcel)(t,this.editor.getTrustedHTMLHandler());break;case 4:e.sanitizingOption.additionalTagReplacements["google-sheets-html-origin"]="*";break;case 3:(0,s.processPastedContentFromPowerPoint)(t,this.editor.getTrustedHTMLHandler())}(0,o.default)(t.domToModelOption,"link",l.parseLink),(0,a.parseDeprecatedColor)(t.sanitizingOption),e.sanitizingOption.unknownTagReplacement=this.unknownTagReplacement}}},e}();t.default=u},4336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.excelHandler=t.processPastedContentFromExcel=void 0;var o=r(5e3),n=r(2594),a=/<\/\s*td\s*>((?!<\/\s*tr\s*>)[\s\S])*$/i,l=/<\/\s*tr\s*>((?!<\/\s*table\s*>)[\s\S])*$/i,i=/<tr[^>]*>[^<]*/i,s=/<table[^>]*>[^<]*/i,d="solid 1px #d4d4d4";function c(e,t){if(e.match(a)){var r=t.match(i);e=(r?r[0]:"<TR>")+e+"</TR>"}if(e.match(l)){var o=t.match(s);e=(o?o[0]:"<TABLE>")+e+"</TABLE>"}return e}t.processPastedContentFromExcel=function(e,t){var r=e.fragment,a=e.htmlBefore,l=e.clipboardData,i=l.html?c(l.html,a):void 0;if(i&&l.html!=i){var s=(new DOMParser).parseFromString(t(i),"text/html");(0,n.moveChildNodes)(r,null==s?void 0:s.body)}var u=r.firstChild;u&&u.childNodes.length>0&&"DIV"==(0,n.getTagOfNode)(u)&&Array.from(u.childNodes).every((function(e){return"META"==(0,n.getTagOfNode)(e)||"TABLE"==(0,n.getTagOfNode)(e)&&e==u.lastChild}))&&u.lastChild&&e.fragment.replaceChildren(u.lastChild),(0,o.default)(e.domToModelOption,"tableCell",(function(e,t){"none"===t.style.borderStyle&&(e.borderBottom=d,e.borderLeft=d,e.borderRight=d,e.borderTop=d)}))},t.excelHandler=c},732:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentFromPowerPoint=void 0;var o=r(2594);t.processPastedContentFromPowerPoint=function(e,t){var r=e.fragment,n=e.clipboardData;if(n.html&&!n.text&&n.image){var a=(new DOMParser).parseFromString(t(n.html),"text/html");(0,o.moveChildNodes)(r,null==a?void 0:a.body)}}},5764:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processPastedContentWacComponents=void 0;var o=r(7582),n=r(5e3),a=r(2594),l=r(4232),i="ListContainerWrapper",s="EmptyTextRun",d=["TableInsertRowGapBlank","TableColumnResizeHandle","TableCellTopBorderHandle","TableCellLeftBorderHandle","TableHoverColumnHandle","TableHoverRowHandle","ListMarkerWrappingSpan"],c=(0,o.__spreadArray)((0,o.__spreadArray)(["OutlineElement","NumberListStyle","WACImageContainer","ListContainerWrapper","BulletListStyle","EOP",s],(0,o.__read)(d),!1),["TableCellContent","Paragraph","WACImageContainer","WACImageBorder"],!1),u=["UL","OL","LI"],f=u.join(","),m=function(e,t){var r=t.style.verticalAlign;"super"===r&&(e.superOrSubScriptSequence="super"),"sub"===r&&(e.superOrSubScriptSequence="sub")},p=function(e,t,r){var o,n=(0,a.getTagOfNode)(t);if((0,a.matchesSelector)(t,'ul[class^="BulletListStyle"]>.OutlineElement,ol[class^="NumberListStyle"]>.OutlineElement,span.WACImageContainer,span.WACImageBorder')&&(t.style.removeProperty("display"),t.style.removeProperty("margin")),t.classList.contains(i))r.elementProcessors.child(e,t,r);else if(!(t.classList.contains("EOP")&&(null===(o=t.previousElementSibling)||void 0===o?void 0:o.classList.contains(s))||d.some((function(e){return t.classList.contains(e)})))){if(function(e,t,r){return r.listFormat.levels.length>0&&u.every((function(t){return t!=e}))&&!(0,a.findClosestElementAncestor)(t,void 0,f)}(n,t,r)){var l=r.listFormat;l.levels=[],l.listParent=void 0}r.defaultElementProcessors.element(e,t,r)}},v=function(e,t,r){var o,n,a;null===(n=(o=r.defaultElementProcessors).li)||void 0===n||n.call(o,e,t,r);var l=r.listFormat.listParent;if(l){var i=l.blocks[l.blocks.length-1];if("BlockGroup"==i.blockType&&"ListItem"==i.blockGroupType&&r.listFormat.listParent!==i){var s=i.levels[i.levels.length-1],d=parseInt(null!==(a=t.getAttribute("data-aria-level"))&&void 0!==a?a:"");if(d>0)if(d>i.levels.length)for(;d!=i.levels.length;)i.levels.push(s);else i.levels.splice(d,i.levels.length-1),i.levels[d-1]=s}}},g=function(e,t){"block"===t.style.display&&(e.displayForDummyItem=void 0),e.marginLeft=void 0},h=function(e){e.marginLeft=void 0,e.paddingLeft=void 0};t.processPastedContentWacComponents=function(e){var t;(0,n.default)(e.domToModelOption,"segment",m),(0,n.default)(e.domToModelOption,"listItem",g),(0,n.default)(e.domToModelOption,"listLevel",h),(0,l.setProcessor)(e.domToModelOption,"element",p),(0,l.setProcessor)(e.domToModelOption,"li",v),(0,l.setProcessor)(e.domToModelOption,"ol",b),(0,l.setProcessor)(e.domToModelOption,"ul",b),(t=e.sanitizingOption.additionalAllowedCssClasses).push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(c),!1))};var b=function(e,t,r){var o,n,l,s,d,c=e.blocks[e.blocks.length-1],u=(0,a.findClosestElementAncestor)(t,void 0,"."+i);(null===(o=null==u?void 0:u.previousElementSibling)||void 0===o?void 0:o.classList.contains(i))&&"BlockGroup"===(null==c?void 0:c.blockType)&&"ListItem"==c.blockGroupType&&(r.listFormat={threadItemCounts:[],levels:c.levels,listParent:e}),"OL"===t.tagName.toUpperCase()?null===(l=(n=r.defaultElementProcessors).ol)||void 0===l||l.call(n,e,t,r):null===(d=(s=r.defaultElementProcessors).ul)||void 0===d||d.call(s,e,t,r)}},1286:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wordDesktopElementProcessor=t.processPastedContentFromWordDesktop=void 0;var o=r(5e3),n=r(2594),a=r(5053),l=r(1013),i=r(4232),s=/%/;function d(e,t,r,o){var n;s.test(t.style.lineHeight)&&!isNaN(n=parseInt(t.style.lineHeight))&&n<120&&(e.lineHeight=o.lineHeight)}function c(e,t,r,o){""!=t.style.marginLeft&&(e.marginLeft=o.marginLeft),e.marginBottom=void 0}t.processPastedContentFromWordDesktop=function(e){(0,i.setProcessor)(e.domToModelOption,"element",t.wordDesktopElementProcessor),(0,o.default)(e.domToModelOption,"block",d),(0,o.default)(e.domToModelOption,"listLevel",c),(0,o.default)(e.domToModelOption,"listItemElement",u),(0,n.chainSanitizerCallback)(e.sanitizingOption.cssStyleCallbacks,"border",(function(e,t){return"IMG"!=t.tagName||"none"!=e})),(0,n.chainSanitizerCallback)(e.sanitizingOption.elementCallbacks,"O:P",(function(e){return(0,n.moveChildNodes)(e),e.appendChild(e.ownerDocument.createTextNode(" ")),!0}))},t.wordDesktopElementProcessor=function(e,t,r){var o=(0,n.getStyles)(t);(0,l.processWordList)(o,e,t,r)||(0,a.processWordComments)(o,t)||r.defaultElementProcessors.element(e,t,r)};var u=function(e,t){t.style.marginLeft&&(e.marginLeft=void 0),t.style.marginRight&&(e.marginRight=void 0)}},5053:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processWordComments=void 0;var o=r(2594),n=/#_msocom_/;t.processWordComments=function(e,t){return"comment"==e["mso-special-character"]||(0,o.safeInstanceOf)(t,"HTMLAnchorElement")&&n.test(t.href)||"comment-list"==e["mso-element"]}},1013:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.processWordList=void 0;var o=r(7582),n=r(3958),a=r(518),l=r(2594),i=r(5255),s="mso-list",d="ignore";function c(e){return function(t,r,o){var n=o.listFormat,a=n.wordKnownLevels,l=n.wordLevel,i=n.wordList;if("OL"==t.listType&&"number"==typeof l&&i){var s=parseInt(e);null==s||isNaN(s)||(null==a?void 0:a.has(i))||(t.startNumberOverride=s)}}}function u(e,t){var r,o,n="";t=t||5;for(var a=e.firstChild;!n&&a;)f(a)?0==(n=null!==(o=null===(r=a.textContent)||void 0===r?void 0:r.trim())&&void 0!==o?o:"").length&&(n="o"):1==a.nodeType&&t>1&&(n=u(a,t-1)),a=a.nextSibling;return n}function f(e){if(1==e.nodeType){var t=(0,l.getStyles)(e)[s];if(t&&t.length>0&&t.trim().toLowerCase()==d)return!0}return!1}t.processWordList=function(e,t,r,l){var f=l.listFormat;f.wordKnownLevels||(f.wordKnownLevels=new Map);var m=e[s]||"";if(m.toLowerCase()===d)return!0;var p=m.split(" ");if(f.wordLevel=p[1]&&parseInt(p[1].substr(5)),f.wordList=p[0]||"l0",0==f.levels.length&&(f.levels=f.wordKnownLevels.get(f.wordList)||[]),m&&t&&"number"==typeof f.wordLevel){var v=f.wordLevel,g=u(r),h=function(e){return function(e){return["o","·","§","-"].indexOf(e)>=0}(e)?"UL":"OL"}(g),b={listType:h};if((0,i.parseFormat)(r,l.formatParsers.listLevel,b,l),v>f.levels.length)for(;v!=f.levels.length;)f.levels.push(b);else f.levels.splice(v,f.levels.length-1),f.levels[v-1]=b;return f.listParent=t,function(e,t,r,o,l){var s=(0,a.createListItem)(e.levels,t.segmentFormat);(0,i.parseFormat)(r,t.formatParsers.segmentOnBlock,t.segmentFormat,t),(0,i.parseFormat)(r,t.formatParsers.listItemElement,s.format,t),(0,i.parseFormat)(r,[c(l)],s.levels[s.levels.length-1],t),t.elementProcessors.child(s,r,t),(0,n.addBlock)(o,s)}(f,l,r,t,g),f.levels.length>0&&f.wordKnownLevels.get(f.wordList)!=f.levels&&f.wordKnownLevels.set(f.wordList,(0,o.__spreadArray)([],(0,o.__read)(f.levels),!1)),!0}return!1}},5e3:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){var o;e.additionalFormatParsers||(e.additionalFormatParsers={}),e.additionalFormatParsers[t]||(e.additionalFormatParsers[t]=[]),null===(o=e.additionalFormatParsers[t])||void 0===o||o.push(r)}},1475:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseDeprecatedColor=void 0;var o=r(2594),n=["activeborder","activecaption","appworkspace","background","buttonhighlight","buttonshadow","captiontext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedfhadow","window","windowframe","windowtext"];t.parseDeprecatedColor=function(e){["color","background-color"].forEach((function(t){(0,o.chainSanitizerCallback)(e.cssStyleCallbacks,t,(function(e){return n.indexOf(e)<0}))}))}},1418:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseLink=void 0;var o=r(2594),n=["http:","https:","notes:","mailto:","onenote:"],a=/^file:\/\/\/[a-zA-Z\/]/i;t.parseLink=function(e,t){if((0,o.safeInstanceOf)(t,"HTMLAnchorElement")){var r;try{r=new URL(t.href)}catch(e){r=void 0}(r&&-1===n.indexOf(r.protocol)||a.test(t.href))&&(t.removeAttribute("href"),e.href="")}}},4232:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setProcessor=void 0,t.setProcessor=function(e,t,r){e.processorOverride||(e.processorOverride={}),e.processorOverride[t]=r}},8252:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.shouldDeleteAllSegmentsBefore=t.shouldDeleteWord=t.handleKeyboardEventResult=t.getOnDeleteEntityCallback=void 0;var o=r(5568);t.getOnDeleteEntityCallback=function(e,t,r){return void 0===r&&(r=[]),function(o,n){return o.id&&o.type&&(r.some((function(e){return e.entity.wrapper==o.wrapper}))||e.triggerPluginEvent(15,{entity:{id:o.id,isReadonly:o.isReadonly,type:o.type,wrapper:o.wrapper},operation:n,rawEvent:t})),!!(null==t?void 0:t.defaultPrevented)&&e.contains(o.wrapper)}},t.handleKeyboardEventResult=function(e,t,r,n){switch(n){case 0:return e.cacheContentModel(null),!1;case 3:return r.preventDefault(),!1;case 2:case 1:return r.preventDefault(),(0,o.normalizeContentModel)(t),2==n&&e.addUndoSnapshot(),e.triggerPluginEvent(23,{rawEvent:r}),!0}},t.shouldDeleteWord=function(e,t){return t&&e.altKey&&!e.metaKey||!t&&e.ctrlKey&&!e.altKey},t.shouldDeleteAllSegmentsBefore=function(e){return e.metaKey&&!e.altKey}},6305:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.directionFormatHandler=void 0,t.directionFormatHandler={parse:function(e,t,r,o){var n=t.style.direction||t.dir||o.direction;n&&(e.direction="rtl"==n?"rtl":"ltr")},apply:function(e,t){e.direction&&(t.style.direction=e.direction)}}},8433:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.displayFormatHandler=void 0,t.displayFormatHandler={parse:function(e,t){var r=t.style.display;r&&(e.display=r)},apply:function(e,t){e.display&&(t.style.display=e.display)}}},7429:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.htmlAlignFormatHandler=void 0;var o=r(3101),n=r(6305);t.htmlAlignFormatHandler={parse:function(e,t,r,a){n.directionFormatHandler.parse(e,t,r,a);var l=t.getAttribute("align");l&&(e.htmlAlign=(0,o.calcAlign)(l,e.direction),delete e.textAlign,delete r.blockFormat.textAlign)},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";e.htmlAlign&&t.setAttribute("align",o.ResultMap[e.htmlAlign][r])}}},9823:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.lineHeightFormatHandler=void 0,t.lineHeightFormatHandler={parse:function(e,t,r,o){var n=t.style.lineHeight||o.lineHeight;n&&"inherit"!=n&&(e.lineHeight=n)},apply:function(e,t){e.lineHeight&&(t.style.lineHeight=e.lineHeight)}}},6895:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textAlignFormatHandler=void 0;var o=r(3101),n=r(6305);t.textAlignFormatHandler={parse:function(e,t,r,a){var l;n.directionFormatHandler.parse(e,t,r,a);var i=t.style.textAlign||a.textAlign;"LI"==t.tagName&&"flex"===(null===(l=t.parentElement)||void 0===l?void 0:l.style.display)&&"column"===t.parentElement.style.flexDirection&&t.style.alignSelf&&(i=t.style.alignSelf),i&&(e.textAlign=(0,o.calcAlign)(i,e.direction))},apply:function(e,t){var r="rtl"==e.direction?"rtl":"ltr";if(e.textAlign){var n=t.parentElement,a=null==n?void 0:n.tagName;"LI"!=t.tagName||!n||"OL"!=a&&"UL"!=a?t.style.textAlign=o.ResultMap[e.textAlign][r]:(t.style.alignSelf=e.textAlign,t.parentElement.style.flexDirection="column",t.parentElement.style.display="flex")}}}},8816:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.whiteSpaceFormatHandler=void 0,t.whiteSpaceFormatHandler={parse:function(e,t,r,o){var n=t.style.whiteSpace||o.whiteSpace;n&&(e.whiteSpace=n)},apply:function(e,t,r){var o=r.implicitFormat.whiteSpace;e.whiteSpace!=o&&(t.style.whiteSpace=e.whiteSpace||"normal")}}},6383:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backgroundColorFormatHandler=void 0;var o=r(6620);t.backgroundColorFormatHandler={parse:function(e,t,r,n){var a=(0,o.getColor)(t,!0,r.darkColorHandler,r.isDarkMode)||n.backgroundColor;a&&(e.backgroundColor=a)},apply:function(e,t,r){e.backgroundColor&&(0,o.setColor)(t,e.backgroundColor,!0,r.darkColorHandler,r.isDarkMode)}}},5018:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.borderBoxFormatHandler=void 0,t.borderBoxFormatHandler={parse:function(e,t){var r;"border-box"==(null===(r=t.style)||void 0===r?void 0:r.boxSizing)&&(e.useBorderBox=!0)},apply:function(e,t){e.useBorderBox&&(t.style.boxSizing="border-box")}}},4192:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.borderFormatHandler=t.BorderKeys=void 0,t.BorderKeys=["borderTop","borderRight","borderBottom","borderLeft","borderRadius"],t.borderFormatHandler={parse:function(e,r){t.BorderKeys.forEach((function(t){var o=r.style[t];o&&(e[t]="none"==o?"":o)}))},apply:function(e,r){t.BorderKeys.forEach((function(t){var o=e[t];o&&(r.style[t]=o)}))}}},5928:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.boxShadowFormatHandler=void 0,t.boxShadowFormatHandler={parse:function(e,t){var r;(null===(r=t.style)||void 0===r?void 0:r.boxShadow)&&(e.boxShadow=t.style.boxShadow)},apply:function(e,t){e.boxShadow&&(t.style.boxShadow=e.boxShadow)}}},7049:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.datasetFormatHandler=void 0;var o=r(2594);t.datasetFormatHandler={parse:function(e,t){var r=t.dataset;(0,o.getObjectKeys)(r).forEach((function(t){e[t]=r[t]||""}))},apply:function(e,t){(0,o.getObjectKeys)(e).forEach((function(r){t.dataset[r]=e[r]}))}}},2539:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.idFormatHandler=void 0,t.idFormatHandler={parse:function(e,t){t.id&&(e.id=t.id)},apply:function(e,t){e.id&&(t.id=e.id)}}},2132:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sizeFormatHandler=void 0;var r=/[\d\.]+%/;function o(e,t){var o=e.getAttribute(t),n=parseInt(o||"");return o&&r.test(o)?o:Number.isNaN(n)?void 0:n+"px"}t.sizeFormatHandler={parse:function(e,t,r){var n=t.style.width||o(t,"width"),a=t.style.height||o(t,"height"),l=t.style.maxWidth,i=t.style.maxHeight,s=t.style.minWidth,d=t.style.minHeight;n&&(e.width=n),a&&(e.height=a),l&&(e.maxWidth=l),i&&(e.maxHeight=i),s&&(e.minWidth=s),d&&(e.minHeight=d)},apply:function(e,t){e.width&&(t.style.width=e.width),e.height&&(t.style.height=e.height),e.maxWidth&&(t.style.maxWidth=e.maxWidth),e.maxHeight&&(t.style.maxHeight=e.maxHeight),e.minWidth&&(t.style.minWidth=e.minWidth),e.minHeight&&(t.style.minHeight=e.minHeight)}}},4531:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.verticalAlignFormatHandler=void 0,t.verticalAlignFormatHandler={parse:function(e,t){switch(t.style.verticalAlign||t.getAttribute("valign")){case"baseline":case"initial":case"super":case"sub":case"text-top":case"text-bottom":case"top":e.verticalAlign="top";break;case"bottom":e.verticalAlign="bottom"}},apply:function(e,t){e.verticalAlign&&(t.style.verticalAlign=e.verticalAlign)}}},9227:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wordBreakFormatHandler=void 0,t.wordBreakFormatHandler={parse:function(e,t,r,o){var n=t.style.wordBreak||o.wordBreak;n&&(e.wordBreak=n)},apply:function(e,t){e.wordBreak&&(t.style.wordBreak=e.wordBreak)}}},8596:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFormatAppliers=t.getFormatParsers=t.defaultFormatAppliers=t.defaultFormatParsers=void 0;var o=r(7582),n=r(6383),a=r(9105),l=r(5018),i=r(4192),s=r(5928),d=r(7049),c=r(6305),u=r(8433),f=r(283),m=r(5499),p=r(2594),v=r(7429),g=r(2539),h=r(2552),b=r(8157),y=r(9823),_=r(9056),k=r(4746),C=r(5238),S=r(6446),P=r(9299),O=r(8966),M=r(9623),w=r(755),F=r(938),T=r(2132),x=r(7956),E=r(5905),j=r(6469),B=r(1503),A=r(6895),L=r(1690),I=r(1151),H=r(535),D=r(4531),N=r(8816),R=r(9227),z={backgroundColor:n.backgroundColorFormatHandler,bold:a.boldFormatHandler,border:i.borderFormatHandler,borderBox:l.borderBoxFormatHandler,boxShadow:s.boxShadowFormatHandler,dataset:d.datasetFormatHandler,direction:c.directionFormatHandler,display:u.displayFormatHandler,fontFamily:f.fontFamilyFormatHandler,fontSize:m.fontSizeFormatHandler,htmlAlign:v.htmlAlignFormatHandler,id:g.idFormatHandler,italic:h.italicFormatHandler,letterSpacing:b.letterSpacingFormatHandler,lineHeight:y.lineHeightFormatHandler,link:_.linkFormatHandler,listItemMetadata:k.listItemMetadataFormatHandler,listItemThread:C.listItemThreadFormatHandler,listLevelMetadata:S.listLevelMetadataFormatHandler,listLevelThread:P.listLevelThreadFormatHandler,listStylePosition:O.listStylePositionFormatHandler,listType:M.listTypeFormatHandler,margin:w.marginFormatHandler,padding:F.paddingFormatHandler,size:T.sizeFormatHandler,strike:x.strikeFormatHandler,superOrSubScript:E.superOrSubScriptFormatHandler,tableLayout:j.tableLayoutFormatHandler,tableSpacing:B.tableSpacingFormatHandler,textAlign:A.textAlignFormatHandler,textColor:L.textColorFormatHandler,textColorOnTableCell:I.textColorOnTableCellFormatHandler,underline:H.underlineFormatHandler,verticalAlign:D.verticalAlignFormatHandler,whiteSpace:N.whiteSpaceFormatHandler,wordBreak:R.wordBreakFormatHandler},W=["letterSpacing","fontFamily","fontSize"],G=["strike","underline","superOrSubScript","italic","bold"],U=["direction","textAlign","lineHeight","whiteSpace"],K=["backgroundColor","margin","padding","border"],V={block:U,listItem:["listItemThread","listItemMetadata"],listItemElement:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(U),!1),["direction","textAlign","lineHeight","margin"],!1),listLevel:["listType","listLevelThread","listLevelMetadata","direction","textAlign","margin","padding","listStylePosition","backgroundColor"],styleBasedSegment:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),["textColor","backgroundColor","lineHeight"],!1),elementBasedSegment:G,segment:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(G),!1),["textColor","backgroundColor","lineHeight"],!1),segmentOnBlock:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(G),!1),["textColor"],!1),segmentOnTableCell:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(W),!1),(0,o.__read)(G),!1),["textColorOnTableCell"],!1),tableCell:["border","backgroundColor","padding","verticalAlign","wordBreak","textColor","htmlAlign"],tableRow:["backgroundColor"],table:["id","border","backgroundColor","display","htmlAlign","margin","size","tableLayout"],tableBorder:["borderBox","tableSpacing"],tableCellBorder:["borderBox"],image:["id","size","margin","padding","borderBox","border","boxShadow","display"],link:["link","textColor","underline","display","margin","padding","backgroundColor","border","size","textAlign"],segmentUnderLink:["textColor"],code:["fontFamily","display"],dataset:["dataset"],divider:(0,o.__spreadArray)((0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(U),!1),(0,o.__read)(K),!1),["display","size","htmlAlign"],!1),container:(0,o.__spreadArray)((0,o.__spreadArray)([],(0,o.__read)(K),!1),["htmlAlign","size","display"],!1)};t.defaultFormatParsers=(0,p.getObjectKeys)(z).reduce((function(e,t){return e[t]=z[t].parse,e}),{}),t.defaultFormatAppliers=(0,p.getObjectKeys)(z).reduce((function(e,t){return e[t]=z[t].apply,e}),{}),t.getFormatParsers=function(e,r){return void 0===e&&(e={}),void 0===r&&(r={}),(0,p.getObjectKeys)(V).reduce((function(o,n){var a=V[n].map((function(r){return void 0===e[r]?t.defaultFormatParsers[r]:e[r]})).concat(r[n]||[]);return o[n]=a,o}),{})},t.getFormatAppliers=function(e,r){return void 0===e&&(e={}),void 0===r&&(r={}),(0,p.getObjectKeys)(V).reduce((function(o,n){var a=V[n].map((function(r){return void 0===e[r]?t.defaultFormatAppliers[r]:e[r]})).concat(r[n]||[]);return o[n]=a,o}),{})}},4746:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getOrderedListStyleValue=t.listItemMetadataFormatHandler=void 0;var o=r(7582),n=r(2594),a=r(455),l=r(6446),i=/\$\{(\w+)\}/,s=["decimal","lower-alpha","lower-roman"],d=["disc","circle","square"],c=65,u={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};function f(e,t){return e?e.replace(i,(function(e,r){switch(r){case"Number":return t+"";case"LowerAlpha":return m(t,!0);case"UpperAlpha":return m(t,!1);case"LowerRoman":return p(t,!0);case"UpperRoman":return p(t,!1)}return""})):void 0}function m(e,t){var r="";for(e--;e>=0;)r=String.fromCharCode(e%26+c)+r,e=Math.floor(e/26)-1;return t?r.toLowerCase():r}function p(e,t){var r,a,l="";try{for(var i=(0,o.__values)((0,n.getObjectKeys)(u)),s=i.next();!s.done;s=i.next()){var d=s.value,c=Math.floor(e/u[d]);e-=c*u[d],l+=d.repeat(c)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}return t?l.toLocaleLowerCase():l}t.listItemMetadataFormatHandler={parse:function(){},apply:function(e,t,r){var o,i,c=t.parentNode,u=r.listFormat.nodeStack.length-2;if(u>=0&&(0,a.isNodeOfType)(c,1)&&!c.style.listStyleType){var m="OL"==(0,n.getTagOfNode)(c)?null!==(o=f(l.OrderedMap[e.orderedStyleType],r.listFormat.threadItemCounts[u]))&&void 0!==o?o:s[u%s.length]:null!==(i=l.UnorderedMap[e.unorderedStyleType])&&void 0!==i?i:d[u%d.length];m&&(u>0||"decimal"!=m&&"disc"!=m)&&(t.style.listStyleType=m)}}},t.getOrderedListStyleValue=f},5238:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listItemThreadFormatHandler=void 0;var o=r(2594);function n(e){return(0,o.safeInstanceOf)(e,"HTMLLIElement")&&(0,o.safeInstanceOf)(e.parentNode,"HTMLOListElement")}t.listItemThreadFormatHandler={parse:function(e,t,r,o){var a=r.listFormat,l=a.levels.length,i=t.style.display||o.display;i&&"list-item"!=i?e.displayForDummyItem=i:n(t)&&l>0&&(a.threadItemCounts[l-1]++,a.threadItemCounts.splice(l),a.levels.forEach((function(e){delete e.startNumberOverride})))},apply:function(e,t,r){var o;if(e.displayForDummyItem)t.style.display=e.displayForDummyItem;else if(n(t)){var a=r.listFormat,l=a.threadItemCounts,i=a.nodeStack.length-2;i>=0&&(l.splice(i+1),l[i]=(null!==(o=l[i])&&void 0!==o?o:0)+1)}}}},6446:(e,t,r)=>{var o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.listLevelMetadataFormatHandler=t.UnorderedMap=t.OrderedMap=void 0;var a=r(2594);t.OrderedMap=((o={})[1]="decimal",o[2]='"${Number}- "',o[3]='"${Number}) "',o[4]='"(${Number}) "',o[5]="lower-alpha",o[8]='"${LowerAlpha}- "',o[6]='"${LowerAlpha}) "',o[7]='"(${LowerAlpha}) "',o[9]="upper-alpha",o[12]='"${UpperAlpha}- "',o[10]='"${UpperAlpha}) "',o[11]='"(${UpperAlpha}) "',o[13]="lower-roman",o[16]='"${LowerRoman}- "',o[14]='"${LowerRoman}) "',o[15]='"(${LowerRoman}) "',o[17]="upper-roman",o[20]='"${UpperRoman}- "',o[18]='"${UpperRoman}) "',o[19]='"(${UpperRoman}) "',o),t.UnorderedMap=((n={})[1]="disc",n[3]='"∎ "',n[9]="circle",n[2]='"- "',n[5]='"➔ "',n[8]='"➔ "',n[4]='"➢ "',n[6]='"➪ "',n[7]='"— "',n);var l={1:"decimal",a:"lower-alpha",A:"upper-alpha",i:"lower-roman",I:"upper-roman"};function i(e,t){return void 0===t?void 0:(0,a.getObjectKeys)(e).filter((function(r){return e[r]==t}))[0]}t.listLevelMetadataFormatHandler={parse:function(e,r){var o=r.style.listStyleType||(0,a.safeInstanceOf)(r,"HTMLOListElement")&&l[r.type],n=(0,a.getTagOfNode)(r);if(o)if("OL"==n&&void 0===e.orderedStyleType){var s=i(t.OrderedMap,o);e.orderedStyleType=void 0===s?void 0:parseInt(s)}else"UL"==n&&void 0===e.unorderedStyleType&&(s=i(t.UnorderedMap,o),e.unorderedStyleType=void 0===s?void 0:parseInt(s))},apply:function(e,r){var o="OL"==(0,a.getTagOfNode)(r)?t.OrderedMap[e.orderedStyleType]:t.UnorderedMap[e.unorderedStyleType];o&&o.indexOf('"')<0&&(r.style.listStyleType=o)}}},9299:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listLevelThreadFormatHandler=void 0;var o=r(2594);t.listLevelThreadFormatHandler={parse:function(e,t,r){if((0,o.safeInstanceOf)(t,"HTMLOListElement")){var n=r.listFormat,a=n.threadItemCounts,l=n.levels.length;"number"==typeof a[l]&&t.start!=a[l]+1&&(e.startNumberOverride=t.start),a[l]=t.start-1}},apply:function(e,t,r){var n=r.listFormat,a=n.threadItemCounts,l=n.nodeStack.length-1;if(l>=0&&(0,o.safeInstanceOf)(t,"HTMLOListElement")){var i=e.startNumberOverride;"number"==typeof i?a[l]=i-1:"number"!=typeof a[l]&&(a[l]=0),a.splice(l+1),t.start=a[l]+1}}}},8966:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listStylePositionFormatHandler=void 0,t.listStylePositionFormatHandler={parse:function(e,t){var r=t.style.listStylePosition;r&&(e.listStylePosition=r)},apply:function(e,t){e.listStylePosition&&(t.style.listStylePosition=e.listStylePosition)}}},9623:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listTypeFormatHandler=void 0;var o=r(2594);t.listTypeFormatHandler={parse:function(e,t){var r=(0,o.getTagOfNode)(t);"OL"!=r&&"UL"!=r||(e.listType=r)},apply:function(){}}},755:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.marginFormatHandler=void 0;var o=r(7733),n=["marginTop","marginRight","marginBottom","marginLeft"];t.marginFormatHandler={parse:function(e,t,r,a){n.forEach((function(r){var n=t.style[r]||a[r];if(n)switch(r){case"marginTop":case"marginBottom":e[r]=n;break;case"marginLeft":case"marginRight":e[r]=e[r]?(0,o.parseValueWithUnit)(e[r]||"",t)+(0,o.parseValueWithUnit)(n,t)+"px":n}}))},apply:function(e,t,r){n.forEach((function(o){var n=e[o];n!=r.implicitFormat[o]&&(t.style[o]=n||"0")}))}}},938:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paddingFormatHandler=void 0;var r=["paddingTop","paddingRight","paddingBottom","paddingLeft"];t.paddingFormatHandler={parse:function(e,t){r.forEach((function(r){var o=t.style[r];o&&(e[r]=o)}))},apply:function(e,t){r.forEach((function(r){var o=e[r];o&&(t.style[r]=o)}))}}},6673:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.rootDirectionFormatHandler=void 0,t.rootDirectionFormatHandler={parse:function(e,t){var r,o=null===(r=t.ownerDocument.defaultView)||void 0===r?void 0:r.getComputedStyle(t);"rtl"==(null==o?void 0:o.direction)&&(e.direction="rtl")},apply:function(){}}},5946:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.zoomScaleFormatHandler=void 0,t.zoomScaleFormatHandler={parse:function(e,t){var r=t.getBoundingClientRect().width,o=t.offsetWidth;e.zoomScale=o>0&&r>0?Math.round(r/o*100)/100:1},apply:function(){}}},9105:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.boldFormatHandler=void 0;var o=r(2594);t.boldFormatHandler={parse:function(e,t,r,o){var n=t.style.fontWeight||o.fontWeight;n&&(e.fontWeight=n)},apply:function(e,t,r){if(void 0!==e.fontWeight){var n=r.implicitFormat.fontWeight;if(n&&n!=e.fontWeight||!n&&e.fontWeight&&"normal"!=e.fontWeight)if("bold"==e.fontWeight){var a=t.ownerDocument.createElement("b");(0,o.moveChildNodes)(a,t),t.appendChild(a)}else t.style.fontWeight=e.fontWeight||"normal"}}}},283:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontFamilyFormatHandler=void 0,t.fontFamilyFormatHandler={parse:function(e,t,r,o){var n=t.style.fontFamily||o.fontFamily;n&&"inherit"!=n&&(e.fontFamily=n)},apply:function(e,t,r){e.fontFamily&&e.fontFamily!=r.implicitFormat.fontFamily&&(t.style.fontFamily=e.fontFamily)}}},5499:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fontSizeFormatHandler=void 0;var o=r(5905);t.fontSizeFormatHandler={parse:function(e,t,r,n){var a=t.style.fontSize||n.fontSize,l=t.style.verticalAlign||n.verticalAlign;a&&!(0,o.isSuperOrSubScript)(a,l)&&"inherit"!=a&&(e.fontSize=a)},apply:function(e,t,r){e.fontSize&&e.fontSize!=r.implicitFormat.fontSize&&(t.style.fontSize=e.fontSize)}}},2552:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.italicFormatHandler=void 0;var o=r(2594);t.italicFormatHandler={parse:function(e,t,r,o){var n=t.style.fontStyle||o.fontStyle;"italic"==n||"oblique"==n?e.italic=!0:"initial"!=n&&"normal"!=n||(e.italic=!1)},apply:function(e,t,r){if(void 0!==e.italic&&!!r.implicitFormat.italic!=!!e.italic)if(e.italic){var n=t.ownerDocument.createElement("i");(0,o.moveChildNodes)(n,t),t.appendChild(n)}else t.style.fontStyle="normal"}}},8157:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.letterSpacingFormatHandler=void 0,t.letterSpacingFormatHandler={parse:function(e,t,r,o){var n=t.style.letterSpacing||o.letterSpacing;n&&(e.letterSpacing=n)},apply:function(e,t,r){e.letterSpacing&&(t.style.letterSpacing=e.letterSpacing)}}},9056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.linkFormatHandler=void 0;var o=r(2594);t.linkFormatHandler={parse:function(e,t){if((0,o.safeInstanceOf)(t,"HTMLAnchorElement")){var r=t.name,n=t.getAttribute("href"),a=t.target,l=t.rel,i=t.id,s=t.className,d=t.title;r&&(e.name=r),n&&(e.href=n),a&&(e.target=a),i&&(e.anchorId=i),l&&(e.relationship=l),d&&(e.anchorTitle=d),s&&(e.anchorClass=s)}},apply:function(e,t){(0,o.safeInstanceOf)(t,"HTMLAnchorElement")&&e.href&&(t.href=e.href,e.name&&(t.name=e.name),e.target&&(t.target=e.target),e.anchorId&&(t.id=e.anchorId),e.anchorClass&&(t.className=e.anchorClass),e.anchorTitle&&(t.title=e.anchorTitle),e.relationship&&(t.rel=e.relationship))}}},7956:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.strikeFormatHandler=void 0;var o=r(2594);t.strikeFormatHandler={parse:function(e,t,r,o){var n=t.style.textDecoration||o.textDecoration;(null==n?void 0:n.indexOf("line-through"))>=0&&(e.strikethrough=!0)},apply:function(e,t){if(e.strikethrough){var r=t.ownerDocument.createElement("s");(0,o.moveChildNodes)(r,t),t.appendChild(r)}}}},5905:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSuperOrSubScript=t.superOrSubScriptFormatHandler=void 0;var o=r(2594);function n(e,t){return"smaller"==e&&("sub"==t||"super"==t)}t.superOrSubScriptFormatHandler={parse:function(e,t,r,o){var a=t.style.verticalAlign||o.verticalAlign;n(t.style.fontSize||o.fontSize,a)&&(e.superOrSubScriptSequence=(e.superOrSubScriptSequence||"").split(" ").concat(a).join(" ").trim())},apply:function(e,t){e.superOrSubScriptSequence&&e.superOrSubScriptSequence.split(" ").reverse().forEach((function(e){var r="super"==e?"sup":"sub"==e?"sub":null;if(r){var n=t.ownerDocument.createElement(r);(0,o.moveChildNodes)(n,t),t.appendChild(n)}}))}},t.isSuperOrSubScript=n},1690:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textColorFormatHandler=void 0;var o=r(6620);t.textColorFormatHandler={parse:function(e,t,r,n){var a=(0,o.getColor)(t,!1,r.darkColorHandler,r.isDarkMode)||n.color;a&&"inherit"!=a&&(e.textColor=a)},apply:function(e,t,r){var n=r.implicitFormat.textColor;e.textColor&&e.textColor!=n&&(0,o.setColor)(t,e.textColor,!1,r.darkColorHandler,r.isDarkMode)}}},535:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.underlineFormatHandler=void 0;var o=r(2594);t.underlineFormatHandler={parse:function(e,t,r,o){var n=t.style.textDecoration||o.textDecoration;(null==n?void 0:n.indexOf("underline"))>=0?e.underline=!0:"A"==t.tagName&&"none"==n&&(e.underline=!1)},apply:function(e,t,r){if(void 0!==e.underline&&!!r.implicitFormat.underline!=!!e.underline)if(e.underline){var n=t.ownerDocument.createElement("u");(0,o.moveChildNodes)(n,t),t.appendChild(n)}else t.style.textDecoration="none"}}},6469:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableLayoutFormatHandler=void 0,t.tableLayoutFormatHandler={parse:function(e,t){var r=t.style.tableLayout;r&&"inherit"!=r&&(e.tableLayout=r)},apply:function(e,t){e.tableLayout&&(t.style.tableLayout=e.tableLayout)}}},1503:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tableSpacingFormatHandler=void 0;var r="collapse";t.tableSpacingFormatHandler={parse:function(e,t){t.style.borderCollapse==r&&(e.borderCollapse=!0)},apply:function(e,t){e.borderCollapse&&(t.style.borderCollapse=r,t.style.borderSpacing="0",t.style.boxSizing="border-box")}}},1151:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.textColorOnTableCellFormatHandler=void 0,t.textColorOnTableCellFormatHandler={parse:function(e,t){t.style.color&&delete e.textColor},apply:function(){}}},6620:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setColor=t.getColor=void 0;var o=r(2594);t.getColor=function(e,t,r,n){var a;return a||(a=r&&function(e,t,r,n){var a;return"FONT"==(0,o.getTagOfNode)(e)&&!e.style.getPropertyValue(n?"background-color":"color")&&t&&(a=e.getAttribute(n?"bgcolor":"color"))?r.findLightColorFromDarkColor(a):null}(e,n,r,t)||(t?e.style.backgroundColor:e.style.color)||e.getAttribute(t?"bgcolor":"color")||void 0),r&&(a=r.parseColorValue(a).lightModeColor),a},t.setColor=function(e,t,r,o,n){var a=(null==o?void 0:o.registerColor(t,n))||"";r?e.style.backgroundColor=a:e.style.color=a}},6681:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultImplicitFormatMap=t.PseudoTagNames=t.defaultStyleMap=void 0;var o={display:"block"};t.defaultStyleMap={address:o,article:o,aside:o,b:{fontWeight:"bold"},blockquote:{display:"block",marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},br:o,center:{display:"block",textAlign:"center"},dd:o,div:o,dl:o,dt:o,em:{fontStyle:"italic"},fieldset:o,figcaption:o,figure:o,footer:o,form:o,h1:{display:"block",fontWeight:"bold",fontSize:"2em"},h2:{display:"block",fontWeight:"bold",fontSize:"1.5em"},h3:{display:"block",fontWeight:"bold",fontSize:"1.17em"},h4:{display:"block",fontWeight:"bold"},h5:{display:"block",fontWeight:"bold",fontSize:"0.83em"},h6:{display:"block",fontWeight:"bold",fontSize:"0.67em"},header:o,hr:o,i:{fontStyle:"italic"},li:{display:"list-item"},main:o,nav:o,ol:o,p:{display:"block",marginTop:"1em",marginBottom:"1em"},pre:{display:"block",fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"},s:{textDecoration:"line-through"},section:o,strike:{textDecoration:"line-through"},strong:{fontWeight:"bold"},sub:{verticalAlign:"sub",fontSize:"smaller"},sup:{verticalAlign:"super",fontSize:"smaller"},table:{display:"table",boxSizing:"border-box"},td:{display:"table-cell"},th:{display:"table-cell"},u:{textDecoration:"underline"},ul:o},(t.PseudoTagNames||(t.PseudoTagNames={})).childOfPre="pre *",t.defaultImplicitFormatMap=((r={a:{underline:!0},blockquote:{marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px"},code:{fontFamily:"monospace"},h1:{fontWeight:"bold",fontSize:"2em"},h2:{fontWeight:"bold",fontSize:"1.5em"},h3:{fontWeight:"bold",fontSize:"1.17em"},h4:{fontWeight:"bold",fontSize:"1em"},h5:{fontWeight:"bold",fontSize:"0.83em"},h6:{fontWeight:"bold",fontSize:"0.67em"},p:{marginTop:"1em",marginBottom:"1em"},pre:{fontFamily:"monospace",whiteSpace:"pre",marginTop:"1em",marginBottom:"1em"}})["pre *"]={fontFamily:"monospace",whiteSpace:"pre"},r)},3101:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.calcAlign=t.ResultMap=void 0,t.ResultMap={start:{ltr:"left",rtl:"right"},center:{ltr:"center",rtl:"center"},end:{ltr:"right",rtl:"left"},initial:{ltr:"initial",rtl:"initial"},justify:{ltr:"justify",rtl:"justify"}},t.calcAlign=function(e,t){switch(e){case"center":return"center";case"left":return"rtl"==t?"end":"start";case"right":return"rtl"==t?"start":"end";case"start":case"end":case"justify":case"initial":return e;default:return}}},7733:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseValueWithUnit=void 0;var o=r(7582),n=r(2594),a=/(-?\d+(\.\d+)?)([a-z]+|%)/;function l(e){var t=(0,n.getComputedStyle)(e,"font-size");return i(parseFloat(t))}function i(e){return Math.round(4e3*e/3)/1e3}t.parseValueWithUnit=function(e,t,r){void 0===e&&(e=""),void 0===r&&(r="px");var n,s=a.exec(e),d=0;if(s){var c=(0,o.__read)(s,4),u=(c[0],c[1]),f=(c[2],c[3]),m=parseFloat(u);switch(f){case"px":d=m;break;case"pt":d=i(m);break;case"em":d=t?l(t)*m:0;break;case"ex":d=t?l(t)*m/2:0;break;case"%":d=t?t.offsetWidth*m/100:0}}return d>0&&"pt"==r&&(n=d,d=Math.round(3e3*n/4)/1e3),d}},5803:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582);(0,o.__exportStar)(r(8658),t),(0,o.__exportStar)(r(517),t),(0,o.__exportStar)(r(4526),t),(0,o.__exportStar)(r(3870),t)},9516:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLeafSiblingBlock=void 0;var o=r(7582),n=r(461);t.getLeafSiblingBlock=function(e,t,r){for(var a,l=(0,o.__spreadArray)([],(0,o.__read)(e),!1),i=function(){var e=l[0],o=e.blocks.indexOf(t);if(o<0)return"break";var i=e.blocks[o+(r?1:-1)];if(i){for(;"BlockGroup"==i.blockType;){var s=i.blocks[r?0:i.blocks.length-1];if(!s)return{value:{block:i,path:l}};if("BlockGroup"!=s.blockType)return l.unshift(i),{value:{block:s,path:l}};l.unshift(i),i=s}return{value:{block:i,path:l}}}if((0,n.isGeneralSegment)(e)){l.shift();var d=-1,c=e,u=null===(a=l[0])||void 0===a?void 0:a.blocks.find((function(e){return"Paragraph"==e.blockType&&(d=e.segments.indexOf(c))>=0}));if(!u)return"break";var f=u.segments[d+(r?1:-1)];if(f)return{value:{block:u,path:l,siblingSegment:f}};t=u}else{if("Document"==e.blockGroupType||"TableCell"==e.blockGroupType)return"break";l.shift(),t=e}};l.length>0;){var s=i();if("object"==typeof s)return s.value;if("break"===s)break}return null}},1096:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelAlignment=void 0;var o=r(3592),n=r(6827),a={left:{ltr:"start",rtl:"end"},center:{ltr:"center",rtl:"center"},right:{ltr:"end",rtl:"start"}},l={left:{ltr:15,rtl:16},center:{ltr:14,rtl:14},right:{ltr:16,rtl:15}};t.setModelAlignment=function(e,t){var r=(0,n.getOperationalBlocks)(e,["ListItem"],["TableCell"]);return r.forEach((function(e){var r=e.block,n=a[t]["rtl"==r.format.direction?"rtl":"ltr"];"Table"===r.blockType?(0,o.alignTable)(r,l[t]["rtl"==r.format.direction?"rtl":"ltr"]):r&&(r.format.textAlign=n)})),r.length>0}},3366:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setModelIndentation=void 0;var o=r(7582),n=r(6827),a=r(9291),l=r(7733);t.setModelIndentation=function(e,t,r){void 0===r&&(r=40);var i=(0,n.getOperationalBlocks)(e,["ListItem"],["TableCell"]),s="indent"==t;return i.forEach((function(e){var t=e.block;if((0,a.isBlockGroupOfType)(t,"ListItem"))if(s){var n=(0,o.__assign)({},t.levels[t.levels.length-1]);delete n.startNumberOverride,delete n.orderedStyleType,delete n.unorderedStyleType,t.levels.push(n)}else t.levels.pop();else if(t){var i=t.format,d=i.marginLeft,c=i.marginRight,u="rtl"==i.direction,f=(0,l.parseValueWithUnit)(u?c:d),m=(s?Math.ceil:Math.floor)(f/r)*r;m==f&&(m=Math.max(m+r*(s?1:-1),0)),u?i.marginRight=m+"px":i.marginLeft=m+"px"}})),i.length>0}},5378:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setParagraphNotImplicit=void 0,t.setParagraphNotImplicit=function(e){"Paragraph"==e.blockType&&e.isImplicit&&(e.isImplicit=!1)}},6621:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toggleModelBlockQuote=void 0;var o=r(7143),n=r(9242),a=r(6827),l=r(9291),i=r(3775),s=r(184);function d(e){return(0,l.isBlockGroupOfType)(e,"FormatContainer")&&"blockquote"==e.tagName}t.toggleModelBlockQuote=function(e,t){var r=(0,a.getOperationalBlocks)(e,["FormatContainer","ListItem"],["TableCell"],!0);if(r.every((function(e){return d(e.block)})))r.forEach((function(e){var t=e.block,r=e.parent;(0,i.unwrapBlock)(r,t)}));else{var l=[],c=function(){return(0,n.createQuote)(t)},u=function(e,r){return function(e,t){return d(e)&&(0,o.areSameFormats)(t,e.format)}(e,(null==r?void 0:r.format)||t)};r.forEach((function(e){var t=e.block,r=e.parent;d(t)||(0,s.wrapBlockStep1)(l,r,t,c,u)})),(0,s.wrapBlockStep2)(l,u)}return r.length>0}},3958:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addBlock=void 0,t.addBlock=function(e,t){e.blocks.push(t)}},7978:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDecorators=t.addCode=t.addLink=void 0;var o=r(7582);function n(e,t){t.format.href&&(e.link={format:(0,o.__assign)({},t.format),dataset:(0,o.__assign)({},t.dataset)})}function a(e,t){t.format.fontFamily&&(e.code={format:(0,o.__assign)({},t.format)})}t.addLink=n,t.addCode=a,t.addDecorators=function(e,t){n(e,t.link),a(e,t.code)}},3394:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSegment=void 0;var o=r(3958),n=r(4186);t.addSegment=function(e,t,r){var a,l=e.blocks[e.blocks.length-1];"Paragraph"==(null==l?void 0:l.blockType)?a=l:(a=(0,n.createParagraph)(!0,r),(0,o.addBlock)(e,a));var i=a.segments[a.segments.length-1];"SelectionMarker"==t.segmentType?i&&i.isSelected||a.segments.push(t):(t.isSelected&&"SelectionMarker"==(null==i?void 0:i.segmentType)&&a.segments.pop(),a.segments.push(t))}},2598:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clearModelFormat=void 0;var o=r(7582),n=r(4059),a=r(6228),l=r(2594),i=r(9664),s=r(7083),d=r(2537),c=r(5311),u=r(6110);function f(e,t){var r=(0,s.getClosestAncestorBlockGroupIndex)(e,["FormatContainer"],["TableCell"]);if(r>=0&&r<e.length-1){var o=e[r],n=e[r+1].blocks.indexOf(o),a=o.blocks.indexOf(t);if(a>=0&&n>=0){var l=(0,i.createFormatContainer)(o.tagName,o.format);o.blocks.splice(a,1),l.blocks=o.blocks.splice(a),e[r+1].blocks.splice(n+1,0,t,l)}}}function m(e){var t=e[(0,s.getClosestAncestorBlockGroupIndex)(e,["ListItem"],["TableCell"])];t&&(t.levels=[])}function p(e,t){if("Divider"==t.blockType){var r=e[0].blocks.indexOf(t);r>=0&&e[0].blocks.splice(r,1)}else"Paragraph"==t.blockType&&(t.format={},delete t.decorator)}t.clearModelFormat=function(e,t,r,i){(0,d.iterateSelections)([e],(function(e,o,n,a){a&&(0,l.arrayPush)(r,a),n?t.push([e,n]):o&&function(e,t){if(e){var r=e.table,o=e.colIndex,n=e.rowIndex,a=e.isWholeTableSelected,l=r.rows[n].cells[o];l.isSelected&&((0,c.updateTableCellMetadata)(l,(function(){return null})),l.isHeader=!1,l.format={useBorderBox:l.format.useBorderBox}),t.find((function(e){return e[0]==r}))||t.push([r,a])}}(o,i)}),{includeListFormatHolder:e.format?"never":"anySegment"});var s=r[0];if(1==t.length&&function(e){var t="Paragraph"==e.blockType?e.segments.filter((function(e){return e.isSelected})):[];return 1==t.length&&"SelectionMarker"==t[0].segmentType}(t[0][1])&&1==t.length)r.splice.apply(r,(0,o.__spreadArray)([0,r.length],(0,o.__read)((0,n.adjustWordSelection)(e,s)),!1)),m(t[0][0]);else if(t.length>1||t.some((function(e){return function(e){return e.isSelected||"Paragraph"==e.blockType&&e.segments.every((function(e){return e.isSelected}))}(e[1])})))for(var v=t.length-1;v>=0;v--){var g=(0,o.__read)(t[v],2),h=g[0],b=g[1];p(h,b),m(h),f(h,b)}!function(e,t){e.forEach((function(e){e.format=(0,o.__assign)({},t||{}),e.link&&delete e.link.format.textColor,delete e.code}))}(r,e.format),function(e){e.forEach((function(e){var t=(0,o.__read)(e,2),r=t[0];t[1]&&(r.format={useBorderBox:r.format.useBorderBox,borderCollapse:r.format.borderCollapse},(0,u.updateTableMetadata)(r,(function(){return null}))),(0,a.applyTableFormat)(r,void 0,!0)}))}(i)}},1392:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.cloneModel=void 0;var o=r(7582);function n(e){switch(e.blockType){case"BlockGroup":switch(e.blockGroupType){case"FormatContainer":return function(e){var t=e.tagName,r=e.cachedElement,o=Object.assign({tagName:t,cachedElement:r},s(e),d(e));return e.zeroFontSize&&(o.zeroFontSize=!0),o}(e);case"General":return p(e);case"ListItem":return g=(m=e).formatHolder,h=m.levels,Object.assign({formatHolder:v(g),levels:h.map((function(e){return Object.assign({},e)}))},s(m),d(m))}break;case"Divider":return r=(t=e).tagName,n=t.isSelected,c=t.cachedElement,Object.assign({isSelected:n,tagName:r,cachedElement:c},s(t));case"Entity":return u(e);case"Paragraph":return function(e){var t=e.cachedElement,r=e.segments,n=e.isImplicit,i=e.decorator,d=e.segmentFormat,c=Object.assign({cachedElement:t,isImplicit:n,segments:r.map(a),segmentFormat:d?(0,o.__assign)({},d):void 0},s(e),l(e));return i&&(c.decorator=Object.assign({tagName:i.tagName},l(i))),c}(e);case"Table":return function(e){var t=e.cachedElement,r=e.widths,o=e.rows;return Object.assign({cachedElement:t,widths:Array.from(r),rows:o.map(f)},s(e),i(e))}(e)}var t,r,n,c,m,g,h}function a(e){switch(e.segmentType){case"Br":return c(e);case"Entity":return u(e);case"General":return d=e,Object.assign(p(d),c(d));case"Image":return n=(o=e).src,a=o.alt,l=o.title,s=o.isSelectedAsImageSelection,Object.assign({src:n,alt:a,title:l,isSelectedAsImageSelection:s},c(o),i(o));case"SelectionMarker":return v(e);case"Text":return r=(t=e).text,Object.assign({text:r},c(t))}var t,r,o,n,a,l,s,d}function l(e){return{format:Object.assign({},e.format)}}function i(e){return{dataset:Object.assign({},e.dataset)}}function s(e){var t=e.blockType;return Object.assign({blockType:t},l(e))}function d(e){return{blockGroupType:e.blockGroupType,blocks:e.blocks.map(n)}}function c(e){var t=e.segmentType,r=e.isSelected,o=e.code,n=e.link,a=Object.assign({segmentType:t,isSelected:r},l(e));return o&&(a.code=l(o)),n&&(a.link=Object.assign(l(n),i(n))),a}function u(e){var t=e.wrapper,r=e.isReadonly,o=e.type,n=e.id;return Object.assign({wrapper:t,isReadonly:r,type:o,id:n},s(e),c(e))}function f(e){var t=e.height,r=e.cells,o=e.cachedElement;return Object.assign({height:t,cachedElement:o,cells:r.map(m)},l(e))}function m(e){var t=e.cachedElement,r=e.isSelected,o=e.spanAbove,n=e.spanLeft,a=e.isHeader;return Object.assign({cachedElement:t,isSelected:r,spanAbove:o,spanLeft:n,isHeader:a},d(e),l(e),i(e))}function p(e){var t=e.element;return Object.assign({element:t},s(e),d(e))}function v(e){return Object.assign({isSelected:e.isSelected},c(e))}t.cloneModel=function(e){var t=d(e);return e.format&&(t.format=Object.assign({},e.format)),t}},7083:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestAncestorBlockGroupIndex=void 0,t.getClosestAncestorBlockGroupIndex=function(e,t,r){void 0===r&&(r=[]);for(var o=0;o<e.length;o++){var n=e[o];if(t.indexOf(n.blockGroupType)>=0)return o;if(r.indexOf(n.blockGroupType)>=0)return-1}return-1}},9291:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBlockGroupOfType=void 0,t.isBlockGroupOfType=function(e,t){return(null==e?void 0:e.blockGroupType)==t}},6233:(e,t)=>{function r(e){switch(e.blockType){case"Paragraph":return 0==e.segments.length;case"Table":return e.rows.every((function(e){return 0==e.cells.length}));case"BlockGroup":return o(e);default:return!1}}function o(e){switch(e.blockGroupType){case"FormatContainer":return"div"!=e.tagName&&e.blocks.every(r);case"ListItem":return e.blocks.every(r);case"Document":case"General":case"TableCell":return!1;default:return!0}}function n(e){switch(e.segmentType){case"Text":return!e.text;case"Image":return!e.src;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.isEmpty=t.isSegmentEmpty=t.isBlockGroupEmpty=t.isBlockEmpty=void 0,t.isBlockEmpty=r,t.isBlockGroupEmpty=o,t.isSegmentEmpty=n,t.isEmpty=function(e){return function(e){return"string"==typeof e.blockGroupType}(e)?o(e):function(e){return"string"==typeof e.blockType}(e)?r(e):!!function(e){return"string"==typeof e.segmentType}(e)&&n(e)}},461:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isGeneralSegment=void 0,t.isGeneralSegment=function(e){return"General"==e.blockGroupType&&"General"==e.segmentType}},230:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isWhiteSpacePreserved=void 0;var r=["pre","pre-wrap","break-spaces"];t.isWhiteSpacePreserved=function(e){return e.format.whiteSpace&&r.indexOf(e.format.whiteSpace)>=0||!1}},9248:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeModel=void 0;var o=r(7582),n=r(3394),a=r(6228),l=r(518),i=r(4186),s=r(8996),d=r(7520),c=r(1242),u=r(7083),f=r(5568),m=r(9325);function p(e,t,r){var n,a=e.paragraph,l=e.marker,i=r?a:h(e,t.format),s=i.segments.indexOf(l);s>=0&&(n=i.segments).splice.apply(n,(0,o.__spreadArray)([s,0],(0,o.__read)(t.segments),!1))}function v(e,t,r){var o,l,i=e.tableContext;if(i&&1==r.blocks.length&&r.blocks[0]==t){for(var c=i.table,u=i.colIndex,f=i.rowIndex,p=0;p<t.rows.length;p++)for(var v=0;v<t.rows[p].cells.length;v++){var g=t.rows[p].cells[v];if(0==p&&u+v>=c.rows[0].cells.length)for(var h=0;h<c.rows.length;h++){var y=null===(o=c.rows[h])||void 0===o?void 0:o.cells[u+v-1];c.rows[h].cells[u+v]=(0,d.createTableCell)(!1,!1,null==y?void 0:y.isHeader,null==y?void 0:y.format)}if(0==v&&f+p>=c.rows.length)for(c.rows[f+p]||(c.rows[f+p]={cells:[],format:{},height:0}),h=0;h<c.rows[f].cells.length;h++){var _=null===(l=c.rows[f+p-1])||void 0===l?void 0:l.cells[h];c.rows[f+p].cells[h]=(0,d.createTableCell)(!1,!1,!1,null==_?void 0:_.format)}c.rows[f+p].cells[u+v]=g,0==p&&0==v&&(0,n.addSegment)(g,(0,s.createSelectionMarker)())}(0,m.normalizeTable)(c,e.marker.format),(0,a.applyTableFormat)(c,void 0,!0)}else b(e,t)}function g(e,t){h(e,t.format);var r=e.path,n=e.paragraph,a=(0,u.getClosestAncestorBlockGroupIndex)(r,["ListItem"]),l=r[a],i=r[a+1],s=i.blocks.indexOf(l||n);s>=0&&i.blocks.splice(s,0,t),l&&(null==l||l.levels.forEach((function(e,r){t.levels[r]=(0,o.__assign)({},e)})))}function h(e,t){var r=e.paragraph,n=e.marker,a=e.path,s=r.segments.indexOf(n),d=a[0].blocks.indexOf(r),c=(0,i.createParagraph)(!1,(0,o.__assign)((0,o.__assign)({},r.format),t),r.segmentFormat);s>=0&&(c.segments=r.segments.splice(s)),d>=0&&a[0].blocks.splice(d+1,0,c);var f=(0,u.getClosestAncestorBlockGroupIndex)(a,["ListItem"],["FormatContainer","TableCell"]),m=a[f];if(m){var p=f>=0?a[f+1]:null,v=p?p.blocks.indexOf(m):-1;if(v>=0&&p){var g=(0,l.createListItem)(m.levels,m.formatHolder.format);d>=0&&(g.blocks=m.blocks.splice(d+1)),v>=0&&p.blocks.splice(v+1,0,g),a[f]=g}}return e.paragraph=c,c}function b(e,t){var r=e.path,o=h(e,t.format),n=r[0].blocks.indexOf(o);n>=0&&r[0].blocks.splice(n,0,t)}function y(e,t,r){e.blocks.forEach((function(e){switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType&&(e.formatHolder.format=_(r,t,e.formatHolder.format)),y(e,t,r);break;case"Table":e.rows.forEach((function(e){return e.cells.forEach((function(e){y(e,t,r)}))}));break;case"Paragraph":e.segments.forEach((function(e){"General"==e.segmentType&&y(e,t,r),e.format=_(r,t,e.format)}))}}))}function _(e,t,r){return"mergeAll"==e?(0,o.__assign)((0,o.__assign)({},t),r):(0,o.__assign)((0,o.__assign)({},t),(a={},l=(n=r).fontWeight,i=n.italic,s=n.underline,l&&"normal"!=l&&(a.fontWeight=l),i&&(a.italic=i),s&&(a.underline=s),a));var n,a,l,i,s}t.mergeModel=function(e,t,r,n){var a,l=null!==(a=null==n?void 0:n.insertPosition)&&void 0!==a?a:(0,c.deleteSelection)(e,r).insertPoint;if(l){(null==n?void 0:n.mergeFormat)&&"none"!=n.mergeFormat&&y(t,(0,o.__assign)((0,o.__assign)({},e.format||{}),l.marker.format),null==n?void 0:n.mergeFormat);for(var i=0;i<t.blocks.length;i++){var s=t.blocks[i];switch(s.blockType){case"Paragraph":p(l,s,0==i);break;case"Divider":case"Entity":b(l,s);break;case"Table":1==t.blocks.length&&(null==n?void 0:n.mergeTable)?v(l,s,t):b(l,s);break;case"BlockGroup":switch(s.blockGroupType){case"General":case"FormatContainer":b(l,s);break;case"ListItem":g(l,s)}}}}(0,f.normalizeContentModel)(e)}},5568:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeContentModel=void 0;var o=r(6233),n=r(1457),a=r(3775);t.normalizeContentModel=function e(t){for(var r=t.blocks.length-1;r>=0;r--){var l=t.blocks[r];switch(l.blockType){case"BlockGroup":"ListItem"==l.blockGroupType&&0==l.levels.length?(r+=l.blocks.length,(0,a.unwrapBlock)(t,l)):e(l);break;case"Paragraph":(0,n.normalizeParagraph)(l);break;case"Table":for(var i=0;i<l.rows.length;i++)for(var s=0;s<l.rows[i].cells.length;s++)l.rows[i].cells[s]&&e(l.rows[i].cells[s])}(0,o.isBlockEmpty)(l)&&t.blocks.splice(r,1)}}},1457:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeParagraph=void 0;var o=r(2914),n=r(6233),a=r(230),l=r(2208);t.normalizeParagraph=function(e){var t=e.segments;if(!e.isImplicit&&t.length>0){var r=t[t.length-1],i=t[t.length-2];if("SelectionMarker"!=r.segmentType||i&&"Br"!=i.segmentType){if(t.length>1&&"Br"==t[t.length-1].segmentType){var s=t.filter((function(e){return"SelectionMarker"!=e.segmentType}));s.length>1&&"Br"!=s[s.length-2].segmentType&&t.pop()}}else t.push((0,o.createBr)(r.format))}if(!(0,a.isWhiteSpacePreserved)(e)){var d=(0,l.createNormalizeSegmentContext)();t.forEach((function(e){(0,l.normalizeSegment)(e,d)})),(0,l.normalizeTextSegments)(d.textSegments,d.lastInlineSegment),(0,l.normalizeLastTextSegment)(d.lastTextSegment,d.lastInlineSegment)}!function(e){for(var t=e.segments.length-1;t>=0;t--)(0,n.isSegmentEmpty)(e.segments[t])&&e.segments.splice(t,1)}(e)}},2208:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeLastTextSegment=t.normalizeTextSegments=t.normalizeSegment=t.createNormalizeSegmentContext=void 0;var o=r(7646),n=" ",a=/^\u0020+/,l=/\u0020+$/;function i(e){return Object.assign(null!=e?e:{},{textSegments:[],ignoreLeadingSpaces:!0,ignoreTrailingSpaces:!0,lastInlineSegment:void 0,lastTextSegment:void 0})}function s(e,t){e.forEach((function(e){if(e!=t){var r=e.text;" "==r.substr(-1)&&r.length>1&&r.substr(-2,1)!=n&&(e.text=r.substring(0,r.length-1)+n)}}))}function d(e,t){e&&e==t&&(null==e?void 0:e.text.substr(-1))==n&&(e.text=e.text.replace(l,""))}t.createNormalizeSegmentContext=function(){return i()},t.normalizeSegment=function(e,t){switch(e.segmentType){case"Br":s(t.textSegments,t.lastInlineSegment),d(t.lastTextSegment,t.lastInlineSegment),i(t);break;case"Entity":case"General":case"Image":t.lastInlineSegment=e,t.ignoreLeadingSpaces=!1;break;case"Text":t.textSegments.push(e),t.lastInlineSegment=e,t.lastTextSegment=e;var r=e.text.substring(0,1),c=e.text.substr(-1);(0,o.hasSpacesOnly)(e.text)||(r==n&&(e.text=e.text.replace(a,t.ignoreLeadingSpaces?"":" ")),c==n&&(e.text=e.text.replace(l,t.ignoreTrailingSpaces?n:" "))),t.ignoreLeadingSpaces=c==n}},t.normalizeTextSegments=s,t.normalizeLastTextSegment=d},3982:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.retrieveModelFormatState=void 0;var o=r(8117),n=r(7083),a=r(6513),l=r(2537),i=r(6110);function s(e,t,r,o){o?void 0!==r&&(e[t]=r):r!==e[t]&&delete e[t]}t.retrieveModelFormatState=function(e,t,r){var d,c,u=!0,f=!0,m=!0;(0,l.iterateSelections)([e],(function(l,p,v,g){if(function(e,t,r){var o,a,l=(0,n.getClosestAncestorBlockGroupIndex)(t,["ListItem"],[]),i=(0,n.getClosestAncestorBlockGroupIndex)(t,["FormatContainer"],[]);if(l>=0){var d=t[l],c=null===(o=null==d?void 0:d.levels[d.levels.length-1])||void 0===o?void 0:o.listType;s(e,"isBullet","UL"==c,r),s(e,"isNumbering","OL"==c,r)}s(e,"isBlockQuote",i>=0&&"blockquote"==(null===(a=t[i])||void 0===a?void 0:a.tagName),r)}(r,l,u),v&&(c?r.isMultilineSelection=!0:c=v),"Paragraph"==(null==v?void 0:v.blockType)&&(function(e,t,r){var o,n=parseInt(((null===(o=t.decorator)||void 0===o?void 0:o.tagName)||"").substring(1)),a=n>=1&&n<=6?n:void 0;s(e,"marginBottom",t.format.marginBottom,r),s(e,"marginTop",t.format.marginTop,r),s(e,"headerLevel",a,r),s(e,"textAlign",t.format.textAlign,r),s(e,"direction",t.format.direction,r)}(r,v,u),null==g||g.forEach((function(n){var l,i,d,c,p,h,b,y,_;(m||"SelectionMarker"!=n.segmentType)&&(function(e,t,r){var o,n,l=null===(n=null===(o=r.superOrSubScriptSequence)||void 0===o?void 0:o.split(" "))||void 0===n?void 0:n.pop();s(e,"isBold",(0,a.isBold)(r.fontWeight),t),s(e,"isItalic",r.italic,t),s(e,"isUnderline",r.underline,t),s(e,"isStrikeThrough",r.strikethrough,t),s(e,"isSuperscript","super"==l,t),s(e,"isSubscript","sub"==l,t),s(e,"fontName",r.fontFamily,t),s(e,"fontSize",r.fontSize,t),s(e,"backgroundColor",r.backgroundColor,t),s(e,"textColor",r.textColor,t),s(e,"lineHeight",r.lineHeight,t)}(r,u,Object.assign({},e.format,v.format,null===(l=v.decorator)||void 0===l?void 0:l.format,n.format,null===(i=n.code)||void 0===i?void 0:i.format,null===(d=n.link)||void 0===d?void 0:d.format,t)),s(r,"isCodeInline",!!(null==n?void 0:n.code),u)),m=!1,r.canUnlink=r.canUnlink||!!n.link,r.canAddImageAltText=r.canAddImageAltText||g.some((function(e){return"Image"==e.segmentType})),u=!1,"Image"===n.segmentType&&(f?(c=r,p=n.format,"borderTop",b=(h=(0,o.extractBorderValues)(p.borderTop)).color,y=h.width,_=h.style,c.imageFormat={borderColor:b,borderWidth:y,borderStyle:_,boxShadow:p.boxShadow,borderRadius:p.borderRadius},f=!1):r.imageFormat=void 0)})),u=!1),p)if(d){var h=d.table,b=d.colIndex,y=d.rowIndex;p.table!=h||p.colIndex==b&&p.rowIndex==y||(r.canMergeTableCell=!0,r.isMultilineSelection=!0)}else!function(e,t){var r=(0,i.updateTableMetadata)(e.table);t.isInTable=!0,t.tableHasHeader=e.table.rows.some((function(e){return e.cells.some((function(e){return e.isHeader}))})),r&&(t.tableFormat=r)}(p,r),d=p}),{includeListFormatHolder:"never"})}},3775:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unwrapBlock=void 0;var o=r(7582),n=r(5378);t.unwrapBlock=function(e,t){var r,a,l=null!==(a=null==e?void 0:e.blocks.indexOf(t))&&void 0!==a?a:-1;l>=0&&(t.blocks.forEach(n.setParagraphNotImplicit),null==e||(r=e.blocks).splice.apply(r,(0,o.__spreadArray)([l,1],(0,o.__read)(t.blocks),!1)))}},184:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapBlockStep2=t.wrapBlockStep1=void 0;var o=r(3958),n=r(2594),a=r(5378);t.wrapBlockStep1=function(e,t,r,n,l){var i,s=null!==(i=null==t?void 0:t.blocks.indexOf(r))&&void 0!==i?i:-1;if(t&&s>=0){t.blocks.splice(s,1);var d=t.blocks[s-1],c=l(d)?d:function(e,t,r){var o=r();return e.blocks.splice(t,0,o),o}(t,s,n);(0,a.setParagraphNotImplicit)(r),(0,o.addBlock)(c,r),e.unshift({parent:t,wrapper:c})}},t.wrapBlockStep2=function(e,t){e.forEach((function(e){var r=e.parent,o=e.wrapper,l=r.blocks.indexOf(o),i=r.blocks[l+1];l>=0&&t(i,o)&&(o.blocks.forEach(a.setParagraphNotImplicit),(0,n.arrayPush)(o.blocks,i.blocks),r.blocks.splice(l+1,1))}))}},2914:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createBr=void 0;var o=r(7582);t.createBr=function(e){return{segmentType:"Br",format:e?(0,o.__assign)({},e):{}}}},3106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createContentModelDocument=void 0,t.createContentModelDocument=function(e){var t={blockGroupType:"Document",blocks:[]};return e&&(t.format=e),t}},9907:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDivider=void 0;var o=r(7582);t.createDivider=function(e,t){return{blockType:"Divider",tagName:e,format:t?(0,o.__assign)({},t):{}}}},6400:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createEntity=void 0;var o=r(7582);t.createEntity=function(e,t,r,n,a){return{segmentType:"Entity",blockType:"Entity",format:(0,o.__assign)({},r||{}),id:n,type:a,isReadonly:t,wrapper:e}}},9664:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFormatContainer=void 0;var o=r(7582);t.createFormatContainer=function(e,t){return{blockType:"BlockGroup",blockGroupType:"FormatContainer",tagName:e,blocks:[],format:(0,o.__assign)({},t||{})}}},1965:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralBlock=void 0,t.createGeneralBlock=function(e){return{blockType:"BlockGroup",blockGroupType:"General",element:e,blocks:[],format:{}}}},7522:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createGeneralSegment=void 0;var o=r(7582);t.createGeneralSegment=function(e,t){return{blockType:"BlockGroup",blockGroupType:"General",segmentType:"General",format:t?(0,o.__assign)({},t):{},blocks:[],element:e}}},4109:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createImage=void 0;var o=r(7582);t.createImage=function(e,t){return{segmentType:"Image",src:e,format:t?(0,o.__assign)({},t):{},dataset:{}}}},518:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createListItem=void 0;var o=r(7582),n=r(8996);t.createListItem=function(e,t){return{blockType:"BlockGroup",blockGroupType:"ListItem",blocks:[],levels:e?e.map((function(e){return(0,o.__assign)({},e)})):[],formatHolder:(0,n.createSelectionMarker)(t),format:{}}}},4186:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraph=void 0;var o=r(7582);t.createParagraph=function(e,t,r,n){var a={blockType:"Paragraph",segments:[],format:t?(0,o.__assign)({},t):{}};return r&&Object.keys(r).length>0&&(a.segmentFormat=(0,o.__assign)({},r)),e&&(a.isImplicit=!0),n&&(a.decorator={tagName:n.tagName,format:(0,o.__assign)({},n.format)}),a}},1309:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createParagraphDecorator=void 0;var o=r(7582);t.createParagraphDecorator=function(e,t){return{tagName:e.toLocaleLowerCase(),format:(0,o.__assign)({},t||{})}}},9242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createQuote=void 0;var o=r(9664);t.createQuote=function(e){return(0,o.createFormatContainer)("blockquote",e)}},8996:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionMarker=void 0;var o=r(7582);t.createSelectionMarker=function(e){return{segmentType:"SelectionMarker",isSelected:!0,format:e?(0,o.__assign)({},e):{}}}},189:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTable=void 0;var o=r(7582);t.createTable=function(e,t){for(var r=[],n=0;n<e;n++)r.push({height:0,format:{},cells:[]});return{blockType:"Table",rows:r,format:(0,o.__assign)({},t||{}),widths:[],dataset:{}}}},7520:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableCell=void 0;var o=r(7582);t.createTableCell=function(e,t,r,n){var a="number"==typeof e?e>1:!!e,l="number"==typeof t?t>1:!!t;return{blockGroupType:"TableCell",blocks:[],format:n?(0,o.__assign)({},n):{},spanLeft:a,spanAbove:l,isHeader:!!r,dataset:{}}}},7014:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createText=void 0;var o=r(7582);t.createText=function(e,t){return{segmentType:"Text",text:e,format:t?(0,o.__assign)({},t):{}}}},1242:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSelection=void 0;var o=r(7582),n=r(5612);t.deleteSelection=function(e,t,r){void 0===r&&(r=[]);var a=(0,n.deleteExpandedSelection)(e,t);return r.forEach((function(e){e&&function(e){return!!e.insertPoint}(a)&&0==a.deleteResult&&e(a,t)})),function(e){var t,r=e.insertPoint,n=e.deleteResult,a=e.lastParagraph,l=e.lastTableContext;r&&0!=n&&3!=n&&a&&a!=r.paragraph&&l==r.tableContext&&((t=r.paragraph.segments).push.apply(t,(0,o.__spreadArray)([],(0,o.__read)(a.segments),!1)),a.segments=[])}(a),a}},7010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteAllSegmentBefore=void 0;var o=r(9087);t.deleteAllSegmentBefore=function(e,t){for(var r=e.insertPoint,n=r.paragraph,a=r.marker,l=n.segments.indexOf(a)-1;l>=0;l--){var i=n.segments[l];i.isSelected=!0,(0,o.deleteSegment)(n,i,t)&&(e.deleteResult=2)}}},7322:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteCollapsedSelection=t.forwardDeleteCollapsedSelection=void 0;var o=r(9516),n=r(7892),a=r(7285),l=r(9087);function i(e){return function(t,r){var i,s="forward"==e,d=t.insertPoint,c=d.paragraph,u=d.marker,f=d.path,m=d.tableContext,p=c.segments;!function(e){var t,r;if("Br"==(null===(t=e[e.length-1])||void 0===t?void 0:t.segmentType)){var o=e.filter((function(e){return"SelectionMarker"!=e.segmentType}));"Br"!=(null===(r=o[o.length-2])||void 0===r?void 0:r.segmentType)&&e.pop()}}(p);var v,g=p.indexOf(u)+(s?1:-1),h=p[g];if(h)(0,l.deleteSegment)(c,h,r,e)&&(t.deleteResult=1);else if(v=(0,o.getLeafSiblingBlock)(f,c,s)){var b=v.block,y=v.path,_=v.siblingSegment;"Paragraph"==b.blockType?(_?(0,l.deleteSegment)(b,_,r,e)&&(t.deleteResult=2):(s?t.lastParagraph=b:("Br"==(null===(i=b.segments[b.segments.length-1])||void 0===i?void 0:i.segmentType)&&b.segments.pop(),t.insertPoint=(0,n.createInsertPoint)(u,b,y,m),t.lastParagraph=c,delete b.cachedElement),t.deleteResult=2),t.lastTableContext=m):(0,a.deleteBlock)(y[0].blocks,b,r,void 0,e)&&(t.deleteResult=2)}else t.deleteResult=3}}t.forwardDeleteCollapsedSelection=i("forward"),t.backwardDeleteCollapsedSelection=i("backward")},5530:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.backwardDeleteWordSelection=t.forwardDeleteWordSelection=void 0;var o,n=r(7582),a=r(7646),l=r(230);function i(e){return function(t){for(var r=t.insertPoint,o=r.marker,i=r.paragraph,s=i.segments.indexOf(o),d="forward"==e,c=function(e,t,r,o){var i,s,d,c,u,f,m,p,v,g;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:i=r?1:-1,s=e.segments,d=(0,l.isWhiteSpacePreserved)(e),c=t+i,n.label=1;case 1:if(!(c>=0&&c<s.length))return[3,12];switch((u=s[c]).segmentType){case"Text":return[3,2];case"Image":return[3,7];case"SelectionMarker":return[3,9]}return[3,10];case 2:f=r?0:u.text.length-1,n.label=3;case 3:return f>=0&&f<u.text.length?(m=u.text[f],p=(0,a.isPunctuation)(m),v=(0,a.isSpace)(m),[4,{punctuation:p,space:v,text:!p&&!v}]):[3,6];case 4:if(n.sent()){if(g=(g=u.text).substring(0,f)+g.substring(f+1),d||(g=(0,a.normalizeText)(g,r)),o.deleteResult=2,!g)return s.splice(c,1),i>0&&(c-=i),[3,6];u.text=g,i>0&&(f-=i)}n.label=5;case 5:return f+=i,[3,3];case 6:return[3,11];case 7:return[4,{punctuation:!0,space:!1,text:!1}];case 8:return n.sent()&&(s.splice(c,1),i>0&&(c-=i),o.deleteResult=2),[3,11];case 9:return[3,11];case 10:return[2,null];case 11:return c+=i,[3,1];case 12:return[2,null]}}))}(i,s,d,t),u=c.next(),f=0;5!=f&&!u.done;){var m=u.value,p=m.punctuation,v=m.space,g=m.text;switch(f){case 0:f=v?4:p?1:2,u=c.next(!0);break;case 1:d&&v?(f=3,u=c.next(!0)):p?u=c.next(!0):f=5;break;case 2:d&&v?(f=3,u=c.next(!0)):g?u=c.next(!0):f=5;break;case 3:p||!v?f=5:u=c.next(!0);break;case 4:v?u=c.next(!0):p?(f=d?3:1,u=c.next(!0)):f=d?5:2}}}}!function(e){e[e.Start=0]="Start",e[e.Punctuation=1]="Punctuation",e[e.Text=2]="Text",e[e.NonText=3]="NonText",e[e.Space=4]="Space",e[e.End=5]="End"}(o||(o={})),t.forwardDeleteWordSelection=i("forward"),t.backwardDeleteWordSelection=i("backward")},7892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createInsertPoint=void 0,t.createInsertPoint=function(e,t,r,o){return{marker:e,paragraph:t,path:r,tableContext:o}}},7285:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBlock=void 0,t.deleteBlock=function(e,t,r,o,n){var a=e.indexOf(t);switch(t.blockType){case"Table":case"Divider":return o?e.splice(a,1,o):e.splice(a,1),!0;case"Entity":var l=t.isSelected?6:"forward"==n?4:"backward"==n?5:void 0;return void 0===l||r(t,l)||(o?e.splice(a,1,o):e.splice(a,1)),!0;case"BlockGroup":switch(t.blockGroupType){case"General":return!!o&&(e.splice(a,1,o),!0);case"ListItem":case"FormatContainer":return e.splice(a,1),!0}}return!1}},5612:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteExpandedSelection=void 0;var o=r(7582),n=r(2914),a=r(7892),l=r(4186),i=r(8996),s=r(7285),d=r(9087),c=r(2537),u=r(5378),f={contentUnderSelectedTableCell:"ignoreForTableOrCell",contentUnderSelectedGeneralElement:"generalElementOnly",includeListFormatHolder:"never"};t.deleteExpandedSelection=function(e,t){var r={deleteResult:0,insertPoint:null};return(0,c.iterateSelections)([e],(function(c,f,m,p){var v=(0,l.createParagraph)(!0,void 0,e.format),g=e.format,h=0;if(p)p[0]&&"Paragraph"==(null==m?void 0:m.blockType)&&(h=(v=m).segments.indexOf(p[0]),g=p[0].format,r.lastParagraph=v,r.lastTableContext=f,p.forEach((function(e,o){0!=o||r.insertPoint||"SelectionMarker"!=e.segmentType?(0,d.deleteSegment)(m,e,t)&&(r.deleteResult=2):r.insertPoint=(0,a.createInsertPoint)(e,m,c,f)})),2==r.deleteResult&&(0,u.setParagraphNotImplicit)(m));else if(m){var b=c[0].blocks;(0,s.deleteBlock)(b,m,t,v)&&(r.deleteResult=2)}else if(f){var y=f.table,_=f.colIndex,k=f.rowIndex,C=y.rows[k],S=C.cells[_];c=(0,o.__spreadArray)([S],(0,o.__read)(c),!1),v.segments.push((0,n.createBr)(e.format)),S.blocks=[v],delete S.cachedElement,delete C.cachedElement,r.deleteResult=2}if(!r.insertPoint){var P=(0,i.createSelectionMarker)(g);(0,u.setParagraphNotImplicit)(v),v.segments.splice(h,0,P),r.insertPoint=(0,a.createInsertPoint)(P,v,c,f)}}),f),r}},9087:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSegment=void 0;var o=r(2208),n=r(6074),a=r(230),l=r(7646);t.deleteSegment=function(e,t,r,i){var s=e.segments,d=s.indexOf(t),c=(0,a.isWhiteSpacePreserved)(e),u="forward"==i,f="backward"==i;switch(c||function(e,t){for(var r,n=t-1;"SelectionMarker"==(null===(r=e[n])||void 0===r?void 0:r.segmentType);)n--;var a=e[n];if(a){var l=(0,o.createNormalizeSegmentContext)();l.ignoreTrailingSpaces=!1,(0,o.normalizeSegment)(a,l)}}(s,d),t.segmentType){case"Br":case"Image":case"SelectionMarker":return s.splice(d,1),!0;case"Entity":var m=t.isSelected?6:u?4:f?5:void 0;return void 0===m||r(t,m)||s.splice(d,1),!0;case"Text":var p=t.text;return 0==p.length||t.isSelected?s.splice(d,1):i&&(p=(0,n.deleteSingleChar)(p,u),c||(p=(0,l.normalizeText)(p,u)),""==p?s.splice(d,1):t.text=p),!0;case"General":return!!t.isSelected&&(s.splice(d,1),!0)}}},6074:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteSingleChar=void 0;var o=r(7582);t.deleteSingleChar=function(e,t){for(var r=(0,o.__spreadArray)([],(0,o.__read)(e),!1),n=0,a=t?0:r.length-1,l="notDeleted";a>=0&&a<r.length&&"done"!=l;a+=t?1:-1)switch(r[a]){case"‍":case"⃣":case"︎":case"️":l="notDeleted",n++;break;default:"notDeleted"==l?(l="waiting",n++):"waiting"==l&&(l="done")}return r.splice(t?0:r.length-n,n),r.join("")}},13:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canApplyPendingFormat=t.clearPendingFormat=t.setPendingFormat=t.getPendingFormat=void 0,t.getPendingFormat=function(e){return o(e).format},t.setPendingFormat=function(e,t,r){var n=o(e);n.format=t,n.position=r},t.clearPendingFormat=function(e){var t=o(e);t.format=null,t.position=null},t.canApplyPendingFormat=function(e){var t=o(e),r=!1;if(t.format&&t.position){var n=e.getFocusedPosition();(null==n?void 0:n.equalTo(t.position))&&(r=!0)}return r};var r="__ContentModelPendingFormat";function o(e){return e.getCustomData(r,(function(){return{format:null,position:null}}))}},3631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(8117),n=r(7733);t.default=function(e,t,r){if(t){var a=e.format,l=t.width,i=t.style,s=t.color,d=(0,o.extractBorderValues)(a.borderTop),c=d.color,u=d.width,f=d.style,m="";m=l?(0,n.parseValueWithUnit)(l)+"px":u||"1px",i?m=m+" "+i:f?m=m+" "+f:m+=" solid",s?m=m+" "+s:c&&(m=m+" "+c),e.format.borderLeft=m,e.format.borderTop=m,e.format.borderBottom=m,e.format.borderRight=m}else delete e.format.borderLeft,delete e.format.borderTop,delete e.format.borderBottom,delete e.format.borderRight;r&&(e.format.borderRadius=r)}},4372:(e,t)=>{function r(e,t){e.blocks.forEach((function(e){switch(e.blockType){case"BlockGroup":"ListItem"==e.blockGroupType?t.push(e):(o(t),r(e,t),o(t));break;case"Paragraph":o(t),e.segments.forEach((function(e){"General"==e.segmentType&&r(e,t)})),o(t);break;case"Table":o(t),e.rows.forEach((function(e){return e.cells.forEach((function(e){r(e,t)}))})),o(t)}}))}function o(e){var t=e[e.length-1];t&&null===t||e.push(null)}function n(e,t,r){var o=e[t].levels,n=e[r].levels;return o.length<=n.length&&o.every((function(e,t){return e.listType==n[t].listType}))}function a(e,t){return e.levels.slice(0,t).some((function(e){return void 0!==e.startNumberOverride}))}Object.defineProperty(t,"__esModule",{value:!0}),t.findListItemsInSameThread=void 0,t.findListItemsInSameThread=function(e,t){var o=[];return r(e,o),function(e,t){var r,o=[],l=e.indexOf(t),i=t.levels.length,s="OL"==(null===(r=t.levels[i-1])||void 0===r?void 0:r.listType);if(l>=0){for(var d=l;d>=0;d--){if(!(u=e[d])){if(s)continue;break}var c=a(u,i);if(n(e,l,d)){if(o.unshift(u),s&&c)break}else if(!s||c)break}for(d=l+1;d<e.length;d++){var u;if(!(u=e[d])){if(s)continue;break}if(c=a(u,i),n(e,l,d)&&!c)o.push(u);else if(!s||c)break}}return o}(o,t)}},5670:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setListType=void 0;var o=r(518),n=r(6827),a=r(9291),l=r(5568),i=r(5378);function s(e,t){return 1==e.length||"Paragraph"==t.blockType&&t.segments.length>0&&t.segments.some((function(e){return"Br"!=e.segmentType&&"SelectionMarker"!=e.segmentType}))}t.setListType=function(e,t){var r=(0,n.getOperationalBlocks)(e,["ListItem"],[]),d=r.every((function(e){var o,n=e.block;return(0,a.isBlockGroupOfType)(n,"ListItem")&&(null===(o=n.levels[n.levels.length-1])||void 0===o?void 0:o.listType)==t||!s(r,n)})),c=[],u=!1;return r.forEach((function(e,n){var l,f,m=e.block,p=e.parent;if((0,a.isBlockGroupOfType)(m,"ListItem")){var v=m.levels.pop();!d&&v?(v.listType=t,m.levels.push(v)):1==m.blocks.length&&(0,i.setParagraphNotImplicit)(m.blocks[0])}else{var g=p.blocks.indexOf(m);if(g>=0)if(s(r,m)){var h=p.blocks[g-1],b="Paragraph"==m.blockType&&(null===(l=m.segments[0])||void 0===l?void 0:l.format)||{},y=(0,o.createListItem)([{listType:t,startNumberOverride:n>0||"BlockGroup"==(null==h?void 0:h.blockType)&&"ListItem"==h.blockGroupType&&"OL"==(null===(f=h.levels[0])||void 0===f?void 0:f.listType)?void 0:1,direction:m.format.direction,textAlign:m.format.textAlign,marginTop:u?"0":void 0}],{fontFamily:b.fontFamily,fontSize:b.fontSize,textColor:b.textColor});"Paragraph"==m.blockType&&(m.isImplicit=!0),y.blocks.push(m),p.blocks.splice(g,1,y),c.push(y)}else u=!0,c.forEach((function(e){return e.levels[0].marginBottom="0"})),c=[]}})),(0,l.normalizeContentModel)(e),r.length>0}},9380:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustSegmentSelection=void 0;var o=r(6827),n=r(4783);t.adjustSegmentSelection=function(e,t,r){var a,l,i=(0,o.getSelectedParagraphs)(e),s=!1;return i.forEach((function(e){var o=a?0:e.segments.findIndex((function(e){return t(e)})),n=e.segments;if(!a){a=n[o];for(var i=o;i>0;i--){if(!r(n[i-1],a)){s=s||!!n[i-1].isSelected;break}a=n[i-1],s=s||!n[i-1].isSelected}}if(a)for(i=o;i<e.segments.length;i++){if(i!=o&&!r(n[i],l||n[o])){s=s||!!n[i].isSelected;break}l=n[i],s=s||!n[i].isSelected}})),a&&l&&(0,n.setSelection)(e,a,l),s}},4059:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.adjustWordSelection=void 0;var o=r(7582),n=r(7014),a=r(7646),l=r(2537);function i(e,t){var r=e.text,o=-1;if(t)for(var n=0;n<r.length;n++){var l=r[n];if((0,a.isPunctuation)(l)||(0,a.isSpace)(l)){o=n;break}}else for(n=r.length-1;n>=0;n--)if(l=r[n],(0,a.isPunctuation)(l)||(0,a.isSpace)(l)){o=n+1;break}return o}function s(e,t,r,a){var l=t.text,i=(0,n.createText)(l.substring(0,a),e[r].format);t.code&&(i.code={format:(0,o.__assign)({},t.code.format)}),t.link&&(i.link={format:(0,o.__assign)({},t.link.format),dataset:(0,o.__assign)({},t.link.dataset)}),t.text=l.substring(a,l.length),e.splice(r,0,i)}t.adjustWordSelection=function(e,t){var r;if((0,l.iterateSelections)([e],(function(e,o,n,a){return"Paragraph"==(null==n?void 0:n.blockType)&&1==(null==a?void 0:a.length)&&a[0]==t&&(r=n),!0})),r){for(var o=[],n=r.segments.indexOf(t),a=n-1;a>=0&&"Text"==(d=r.segments[a]).segmentType;a--){if((c=i(d,!1))>-1){if(c==d.text.length)break;s(r.segments,d,a,c),o.push(r.segments[a+1]);break}o.push(r.segments[a])}if(n=r.segments.indexOf(t),o.push(t),o.length<=1)return o;for(a=n+1;a<r.segments.length;a++){var d,c;if("Text"!=(d=r.segments[a]).segmentType)break;if((c=i(d,!0))>-1){if(0==c)break;s(r.segments,d,a,c),o.push(r.segments[a]);break}o.push(r.segments[a])}return o[o.length-1]==t?[t]:o}return[t]}},4152:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.collapseTableSelection=void 0;var o=r(3394),n=r(8996);t.collapseTableSelection=function(e,t){var r,a=t.firstCol,l=null===(r=e[t.firstRow])||void 0===r?void 0:r.cells[a];l&&(0,o.addSegment)(l,(0,n.createSelectionMarker)())}},6827:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFirstSelectedListItem=t.getFirstSelectedTable=t.getOperationalBlocks=t.getSelectedParagraphs=t.getSelectedSegments=t.getSelectedSegmentsAndParagraphs=void 0;var o=r(9291),n=r(2537),a=r(7083);function l(e,t){var r=s(e,{includeListFormatHolder:t?"allSegments":"never"}),o=[];return r.forEach((function(e){var r=e.segments,n=e.block;r&&(t&&!n||"Paragraph"==(null==n?void 0:n.blockType))&&r.forEach((function(e){"Entity"==e.segmentType&&e.isReadonly||o.push([e,"Paragraph"==(null==n?void 0:n.blockType)?n:null])}))})),o}function i(e,t,r,o){var n=[],l=o?t.map((function(e){return[e]})):[t],i=s(e,{includeListFormatHolder:"never",contentUnderSelectedTableCell:"ignoreForTable"});return d(i),i.forEach((function(e){for(var t=e.path,o=e.block,i=function(e){var i=(0,a.getClosestAncestorBlockGroupIndex)(t,l[e],r);return i>=0?(n.filter((function(e){return e.block==t[i]})).length<=0&&n.push({parent:t[i+1],block:t[i]}),"break"):e==l.length-1&&o?(n.push({parent:t[0],block:o}),"break"):void 0},s=0;s<l.length&&"break"!==i(s);s++);})),n}function s(e,t){var r=[];return(0,n.iterateSelections)([e],(function(e,t,o,n){r.push({path:e,tableContext:t,block:o,segments:n})}),t),r}function d(e){e.length>1&&c(e,!1)&&e.pop(),e.length>1&&c(e,!0)&&e.shift()}function c(e,t){var r,o=e[t?0:e.length-1];if("Paragraph"==(null===(r=o.block)||void 0===r?void 0:r.blockType)&&o.segments&&o.segments.length>0){var n=o.block.segments,a=o.segments[0];return 1==o.segments.length&&"SelectionMarker"==a.segmentType&&a==n[t?n.length-1:0]}return!1}t.getSelectedSegmentsAndParagraphs=l,t.getSelectedSegments=function(e,t){return l(e,t).map((function(e){return e[0]}))},t.getSelectedParagraphs=function(e){var t=s(e,{includeListFormatHolder:"never"}),r=[];return d(t),t.forEach((function(e){var t=e.block;"Paragraph"==(null==t?void 0:t.blockType)&&r.push(t)})),r},t.getOperationalBlocks=i,t.getFirstSelectedTable=function(e){var t,r=s(e,{includeListFormatHolder:"never"});return d(r),r.forEach((function(e){var r=e.block,o=e.tableContext;t||(t="Table"==(null==r?void 0:r.blockType)?r:null==o?void 0:o.table)})),t},t.getFirstSelectedListItem=function(e){var t;return i(e,["ListItem"],["TableCell"]).forEach((function(e){!t&&(0,o.isBlockGroupOfType)(e.block,"ListItem")&&(t=e.block)})),t}},2537:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.iterateSelections=void 0;var o=r(7582);function n(e,t,r,a,l){for(var i=e[0],s=(null==r?void 0:r.includeListFormatHolder)||"allSegments",d=(null==r?void 0:r.contentUnderSelectedTableCell)||"include",c=(null==r?void 0:r.contentUnderSelectedGeneralElement)||"contentOnly",u=!1,f=!1,m=0;m<i.blocks.length;m++){var p=i.blocks[m];switch(p.blockType){case"BlockGroup":var v=(0,o.__spreadArray)([p],(0,o.__read)(e),!1);if("General"==p.blockGroupType){var g=!(F=l||p.isSelected)||"both"==c||"contentOnly"==c,h=F&&("both"==c||"generalElementOnly"==c||0==p.blocks.length);if(g&&n(v,t,r,a,F)||h&&t(e,a,p))return!0}else if(n(v,t,r,a,l))return!0;break;case"Table":var b=p.rows,y=b.every((function(e){return e.cells.every((function(e){return e.isSelected}))}));if("include"!=d&&y){if(t(e,a,p))return!0}else for(var _=0;_<b.length;_++)for(var k=b[_],C=0;C<k.cells.length;C++){var S=k.cells[C];if(S){var P={table:p,rowIndex:_,colIndex:C,isWholeTableSelected:y};if(S.isSelected&&t(e,P))return!0;if((!S.isSelected||"ignoreForTableOrCell"!=d)&&n((0,o.__spreadArray)([S],(0,o.__read)(e),!1),t,r,P,F=l||S.isSelected))return!0}}break;case"Paragraph":for(var O=[],M=0;M<p.segments.length;M++){var w=p.segments[M],F=l||w.isSelected;if("General"==w.segmentType){if(g=!F||"both"==c||"contentOnly"==c,h=F&&("both"==c||"generalElementOnly"==c||0==w.blocks.length),g&&n((0,o.__spreadArray)([w],(0,o.__read)(e),!1),t,r,a,F))return!0;h&&O.push(w)}else F&&O.push(w);F?u=!0:f=!0}if(O.length>0&&t(e,a,p,O))return!0;break;case"Divider":case"Entity":if((l||p.isSelected)&&t(e,a,p))return!0}}return!("never"==s||"ListItem"!=i.blockGroupType||!u||f&&"anySegment"!=s||!t(e,a,void 0,[i.formatHolder]))}t.iterateSelections=function(e,t,r,o,a){n(e,(function(e,r,o,n){var a;return(null===(a=o)||void 0===a?void 0:a.cachedElement)&&delete o.cachedElement,t(e,r,o,n)}),r,o,a)}},4783:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSelection=void 0;var o=r(461);function n(e,t,r,s){return i(t,e,r,s,(function(t){return(0,o.isGeneralSegment)(e)&&l(e,t),e.blocks.forEach((function(e){t=function(e,t,r,o){switch(e.blockType){case"BlockGroup":return n(e,t,r,o);case"Table":return function(e,t,r,o){var i=a(e,r),s=o?a(e,o):i;if(!t&&i&&s)for(var d=0;d<e.rows.length;d++)for(var c=0;c<e.rows[d].cells.length;c++){var u=d>=i.y&&d<=s.y&&c>=i.x&&c<=s.x;l(e.rows[d].cells[c],u)}else e.rows.forEach((function(e){return e.cells.forEach((function(e){t=n(e,t,r,o)}))}));return t}(e,t,r,o);case"Divider":case"Entity":return i(t,e,r,o,(function(t){return t?e.isSelected=!0:delete e.isSelected,t}));case"Paragraph":var s=[];for(e.segments.forEach((function(e,a){t=i(t,e,r,o,(function(t){return function(e,t,r,o,a,i){switch(e.segmentType){case"SelectionMarker":return(!t||e!=o&&e!=a)&&r.push(i),t;case"General":return l(e,t),e!=o&&e!=a?n(e,t,o,a):t;case"Image":return l(e,t),e.isSelectedAsImageSelection=o==e&&(!a||a==e),t;default:return l(e,t),t}}(e,t,s,r,o,a)}))}));s.length>0;){var d=s.pop();d>=0&&e.segments.splice(d,1)}return t;default:return t}}(e,t,r,s)})),t}))}function a(e,t){var r=-1,o=-1;if(t)for(var n=0;o<0&&n<e.rows.length;n++)for(var a=0;r<0&&a<e.rows[n].cells.length;a++)e.rows[n].cells[a]==t&&(r=a,o=n);return r>=0&&o>=0?{x:r,y:o}:void 0}function l(e,t){return t?e.isSelected=!0:delete e.isSelected,t}function i(e,t,r,o,n){return(e=n(e=e||t==r))&&!!o&&t!=o}t.setSelection=function(e,t,r){n(e,!1,t||null,r||null)}},3592:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.alignTable=void 0,t.alignTable=function(e,t){e.format.marginLeft=15==t?"":"auto",e.format.marginRight=16==t?"":"auto",delete e.cachedElement}},793:(e,t,r)=>{var o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.alignTableCell=void 0;var a=r(4964),l=((o={})[17]="start",o[18]="center",o[19]="end",o),i=((n={})[20]="top",n[21]="middle",n[22]="bottom",n);t.alignTableCell=function(e,t){var r,o=(0,a.getSelectedCells)(e);if(o)for(var n=l[t],s=i[t],d=o.firstRow;d<=o.lastRow;d++)for(var c=o.firstCol;c<=o.lastCol;c++){var u=null===(r=e.rows[d])||void 0===r?void 0:r.cells[c],f=null==u?void 0:u.format;f&&(delete u.cachedElement,f.textAlign=n||f.textAlign,f.verticalAlign=s||f.verticalAlign)}}},6228:(e,t,r)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.applyTableFormat=void 0;var n=r(7582),a=r(4192),l=r(8117),i=r(9454),s=r(5311),d=r(6110),c={topBorderColor:"#ABABAB",bottomBorderColor:"#ABABAB",verticalBorderColor:"#ABABAB",hasHeaderRow:!1,hasFirstColumn:!1,hasBandedRows:!1,hasBandedColumns:!1,bgColorEven:null,bgColorOdd:"#ABABAB20",headerRowColor:"#ABABAB",tableBorderFormat:0};t.applyTableFormat=function(e,t,r){var o=e.rows;(0,d.updateTableMetadata)(e,(function(d){var p=(0,n.__assign)((0,n.__assign)((0,n.__assign)({},c),d),t||{}),v=function(e,t){var r=[];return e.forEach((function(e){var o=[];r.push(o),e.cells.forEach((function(e){(0,s.updateTableCellMetadata)(e,(function(e){return e&&t?(o.push(!1),delete e.bgColorOverride):o.push(!!(null==e?void 0:e.bgColorOverride)),e}))}))})),r}(o,!r);return delete e.cachedElement,function(e){e.forEach((function(e){e.cells.forEach((function(e){delete e.cachedElement})),delete e.cachedElement}))}(o),function(e,t){e.forEach((function(r,o){r.cells.forEach((function(n,i){var s=u[t.tableBorderFormat]({firstRow:0===o,lastRow:o===e.length-1,firstColumn:0===i,lastColumn:i===r.cells.length-1}),d=[t.topBorderColor,t.verticalBorderColor,t.bottomBorderColor,t.verticalBorderColor];s.forEach((function(e,t){var r=!e&&d[t]||"";n.format[a.BorderKeys[t]]=(0,l.combineBorderValue)({style:m(r),width:"1px",color:r})}))}))}))}(o,p),function(e,t,r){var o=t.hasBandedRows,n=t.hasBandedColumns,a=t.bgColorOdd,l=t.bgColorEven;e.forEach((function(e,t){e.cells.forEach((function(e,s){if(!r[t][s]){var d=(o||n)&&(n&&s%2!=0||o&&t%2!=0)?a:l;(0,i.setTableCellBackgroundColor)(e,d)}}))}))}(o,p,v),function(e,t,r){e.forEach((function(o,n){o.cells.forEach((function(o,a){t.hasFirstColumn&&0===a?(o.isHeader=!0,0===n||r[n][a]||(f(o.format,"borderTop"),(0,i.setTableCellBackgroundColor)(o,null)),n!==e.length-1&&0!==n&&f(o.format,"borderBottom")):o.isHeader=!1}))}))}(o,p,v),function(e,t,r){var o;null===(o=e[0])||void 0===o||o.cells.forEach((function(e,o){e.isHeader=t.hasHeaderRow,t.hasHeaderRow&&t.headerRowColor&&(r[0][o]||(0,i.setTableCellBackgroundColor)(e,t.headerRowColor),f(e.format,"borderTop",t.headerRowColor),f(e.format,"borderRight",t.headerRowColor),f(e.format,"borderLeft",t.headerRowColor))}))}(o,p,v),p}))};var u=((o={})[0]=function(e){return[!1,!1,!1,!1]},o[1]=function(e){return[!1,!e.lastColumn,!1,!e.firstColumn]},o[4]=function(e){var t=e.firstColumn,r=e.firstRow;return[!r,!e.lastColumn&&!t||t&&r,!e.lastRow&&!r,!t]},o[2]=function(e){var t=e.firstRow,r=e.firstColumn,o=e.lastColumn;return[t,t||o,!1,t||r]},o[3]=function(e){var t=e.firstColumn;return[!1,e.lastColumn,!1,t]},o[5]=function(e){var t=e.firstRow,r=e.firstColumn;return[r&&!t,t,r&&!t,t&&!r]},o[6]=function(e){var t=e.firstRow,r=e.firstColumn;return[!t,t||!r,!t,!r]},o[7]=function(e){var t=e.firstColumn,r=e.firstRow;return[!0,r||!t,!r,!0]},o[8]=function(){return[!0,!0,!0,!0]},o);function f(e,t,r){var o=(0,l.extractBorderValues)(e[t]);o.color=r||"",o.style=m(o.color),e[t]=(0,l.combineBorderValue)(o)}function m(e){return e&&"transparent"!=e?"solid":"none"}},266:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.canMergeCells=void 0,t.canMergeCells=function(e,t,r,o,n){var a=r==n||e[t].cells.every((function(e,t){return t<r||t>n||!e.spanAbove})),l=t==o||e.every((function(e,n){return n<t||n>o||!e.cells[r].spanLeft})),i=e[o].cells.map((function(t,a){return a>=r&&a<=n?function(e,t,r){for(var o,n,a=0,l=t+1;l<e.length&&(null===(n=null===(o=e[l])||void 0===o?void 0:o.cells[r])||void 0===n?void 0:n.spanAbove);l++)a++;return a}(e,o,a):-1})).every((function(e,t,o){return e<0||e==o[r]})),s=e.map((function(r,a){return a>=t&&a<=o?function(e,t,r){for(var o,n,a,l=0,i=r+1;i<(null===(o=e[t])||void 0===o?void 0:o.cells.length)&&(null===(a=null===(n=e[t])||void 0===n?void 0:n.cells[i])||void 0===a?void 0:a.spanLeft);i++)l++;return l}(e,a,n):-1})).every((function(e,r,o){return e<0||e==o[t]}));return a&&l&&i&&s}},8097:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTableStructure=void 0;var o=r(3958),n=r(189),a=r(7520);t.createTableStructure=function(e,t,r){var l=(0,n.createTable)(r);return(0,o.addBlock)(e,l),l.rows.forEach((function(e){for(var r=0;r<t;r++){var o=(0,a.createTableCell)();e.cells.push(o)}})),l}},3765:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTable=void 0,t.deleteTable=function(e){e.rows=[],delete e.cachedElement}},533:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableColumn=void 0;var o=r(4152),n=r(4964);t.deleteTableColumn=function(e){var t=(0,n.getSelectedCells)(e);if(t){for(var r=0;r<e.rows.length;r++){var a=e.rows[r].cells[t.lastCol+1];a&&(a.spanLeft=a.spanLeft&&e.rows[r].cells[t.firstCol].spanLeft),e.rows[r].cells.splice(t.firstCol,t.lastCol-t.firstCol+1)}e.widths.splice(t.firstCol,t.lastCol-t.firstCol+1),(0,o.collapseTableSelection)(e.rows,t)}}},3364:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteTableRow=void 0;var o=r(4152),n=r(4964);t.deleteTableRow=function(e){var t=(0,n.getSelectedCells)(e);t&&(e.rows[t.firstRow].cells.forEach((function(r,o){var n,a=null===(n=e.rows[t.lastRow+1])||void 0===n?void 0:n.cells[o];a&&(a.spanAbove=a.spanAbove&&r.spanAbove)})),e.rows.splice(t.firstRow,t.lastRow-t.firstRow+1),(0,o.collapseTableSelection)(e.rows,t))}},4964:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectedCells=void 0;var o=r(8780);t.getSelectedCells=function(e){var t=-1,r=-1,n=-1,a=-1,l=!1;return e.rows.forEach((function(e,i){return e.cells.forEach((function(e,s){(0,o.default)(e)&&(l=!0,t<0&&(t=i),r<0&&(r=s),n=Math.max(n,i),a=Math.max(a,s))}))})),l?{firstRow:t,firstCol:r,lastRow:n,lastCol:a}:null}},7899:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableColumn=void 0;var o=r(7520),n=r(4964);t.insertTableColumn=function(e,t){var r=(0,n.getSelectedCells)(e),a=2==t;if(r)for(var l=null==r?void 0:r.firstCol;l<=r.lastCol;l++)e.rows.forEach((function(e){var t=e.cells[a?r.firstCol:r.lastCol];e.cells.splice(a?r.firstCol:r.lastCol+1,0,(0,o.createTableCell)(t.spanLeft,t.spanAbove,t.isHeader,t.format))})),e.widths.splice(a?r.firstCol:r.lastCol+1,0,e.widths[a?r.firstCol:r.lastCol])}},662:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.insertTableRow=void 0;var o=r(7582),n=r(7520),a=r(4964);t.insertTableRow=function(e,t){var r=(0,a.getSelectedCells)(e),l=0==t;if(r)for(var i=r.firstRow;i<=r.lastRow;i++){var s=e.rows[l?r.firstRow:r.lastRow];e.rows.splice(l?r.firstRow:r.lastRow+1,0,{format:(0,o.__assign)({},s.format),cells:s.cells.map((function(e){return(0,n.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format)})),height:s.height})}}},5409:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableCells=void 0;var o=r(266),n=r(4964);t.mergeTableCells=function(e){var t=(0,n.getSelectedCells)(e);if(t&&(0,o.canMergeCells)(e.rows,t.firstRow,t.firstCol,t.lastRow,t.lastCol))for(var r=t.firstRow;r<=t.lastRow;r++){for(var a=t.firstCol;a<=t.lastCol;a++){var l=e.rows[r].cells[a];l&&(l.spanLeft=a>t.firstCol,l.spanAbove=r>t.firstRow,delete l.cachedElement)}delete e.rows[r].cachedElement}}},4642:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableColumn=void 0;var o=r(266),n=r(4964);t.mergeTableColumn=function(e,t){var r,a,l,i,s=(0,n.getSelectedCells)(e);if(s){var d=9==t?s.firstCol:s.lastCol+1;if(d>0&&d<e.rows[0].cells.length)for(var c=s.firstRow;c<=s.lastRow;c++){var u=null===(r=e.rows[c])||void 0===r?void 0:r.cells[d];if(u&&(0,o.canMergeCells)(e.rows,c,d-1,c,d)){u.spanLeft=!0;for(var f=d;null===(l=null===(a=e.rows[c])||void 0===a?void 0:a.cells[f])||void 0===l?void 0:l.spanLeft;)delete e.rows[c].cells[f].cachedElement,f--;(null===(i=e.rows[c])||void 0===i?void 0:i.cells[f])&&(e.rows[c].cells[f].isSelected=!0,delete e.rows[c].cells[f].cachedElement),delete u.cachedElement}delete e.rows[c].cachedElement}}}},994:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeTableRow=void 0;var o=r(266),n=r(4964);t.mergeTableRow=function(e,t){var r,a,l,i=(0,n.getSelectedCells)(e);if(i){var s=7==t?i.firstRow:i.lastRow+1;if(s>0&&s<e.rows.length)for(var d=i.firstCol;d<=i.lastCol;d++){var c=e.rows[s].cells[d];if(c&&(0,o.canMergeCells)(e.rows,s-1,d,s,d)){c.spanAbove=!0;for(var u=s;null===(a=null===(r=e.rows[u])||void 0===r?void 0:r.cells[d])||void 0===a?void 0:a.spanAbove;)delete e.rows[u].cells[d].cachedElement,delete e.rows[u].cachedElement,u--;(null===(l=e.rows[u])||void 0===l?void 0:l.cells[d])&&(e.rows[u].cells[d].isSelected=!0,delete e.rows[u].cells[d].cachedElement,delete e.rows[u].cachedElement),delete c.cachedElement}}}}},9325:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeTable=void 0;var o=r(7582),n=r(3394),a=r(2594),l=r(2914);function i(e){return e<=4?120:e<=6?100:70}function s(e,t){t.blocks.every((function(e){return"Paragraph"==e.blockType&&(0==(t=(t=e.segments).filter((function(e){return"SelectionMarker"!=e.segmentType}))).length||1==t.length&&"Br"==t[0].segmentType);var t}))||((0,a.arrayPush)(e.blocks,t.blocks),t.blocks=[])}t.normalizeTable=function(e,t){var r,a=e.format;a.borderCollapse&&a.useBorderBox||(a.borderCollapse=!0,a.useBorderBox=!0),e.rows.forEach((function(e,r){e.cells.forEach((function(e,o){0==e.blocks.length&&(0,n.addSegment)(e,(0,l.createBr)(t)),0==r?e.spanAbove=!1:r>0&&e.isHeader&&(e.isHeader=!1,delete e.cachedElement),0==o&&(e.spanLeft=!1),e.format.useBorderBox=!0})),e.height<22&&(e.height=22)}));for(var d=Math.max.apply(Math,(0,o.__spreadArray)([],(0,o.__read)(e.rows.map((function(e){return e.cells.length}))),!1)),c=0;c<d;c++)void 0===e.widths[c]&&(e.widths[c]=i(d));for(var u=function(t){e.rows.forEach((function(e){var r=e.cells[t],o=e.cells[t-1];r&&o&&r.spanLeft&&s(o,r)})),e.rows.every((function(e){var r;return null===(r=e.cells[t])||void 0===r?void 0:r.spanLeft}))&&(e.rows.forEach((function(e){return e.cells.splice(t,1)})),e.widths.splice(t-1,2,e.widths[t-1]+e.widths[t]))},f=((null===(r=e.rows[0])||void 0===r?void 0:r.cells.length)||0)-1;f>0;f--)u(f);for(var m=function(t){var r=e.rows[t];r.cells.forEach((function(r,o){var n,a=null===(n=e.rows[t-1])||void 0===n?void 0:n.cells[o];a&&r.spanAbove&&s(a,r)})),r.cells.every((function(e){return e.spanAbove}))&&(e.rows[t-1].height+=r.height,e.rows.splice(t,1))},p=e.rows.length-1;p>0;p--)m(p)}},9454:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTableCellBackgroundColor=void 0;var o=r(2594),n=r(5311);t.setTableCellBackgroundColor=function(e,t,r){if(t){e.format.backgroundColor=t,r&&(0,n.updateTableCellMetadata)(e,(function(e){return(e=e||{}).bgColorOverride=!0,e}));var a=function(e){var t=(0,o.parseColor)(e);if(t){var r=t[0]/255,n=t[1]/255,a=t[2]/255;return 50*(Math.max(r,n,a)+Math.min(r,n,a))}return 255}(t);a<20?e.format.textColor="#ffffff":a>80?e.format.textColor="#000000":delete e.format.textColor}else delete e.format.backgroundColor,delete e.format.textColor;delete e.cachedElement}},8811:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellHorizontally=void 0;var o=r(7582),n=r(7520),a=r(4964);t.splitTableCellHorizontally=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=function(r){if(e.rows.every((function(e,o){var n;return o<t.firstRow||o>t.lastRow||(null===(n=e.cells[r+1])||void 0===n?void 0:n.spanLeft)})))e.rows.forEach((function(e,o){delete e.cells[r].cachedElement,o>=t.firstRow&&o<=t.lastRow&&(e.cells[r+1].spanLeft=!1,delete e.cells[r+1].cachedElement)}));else{e.rows.forEach((function(e,a){var l=e.cells[r];if(l){var i=(0,n.createTableCell)(l.spanLeft,l.spanAbove,l.isHeader,l.format);i.dataset=(0,o.__assign)({},l.dataset),a<t.firstRow||a>t.lastRow?i.spanLeft=!0:i.isSelected=l.isSelected,e.cells.splice(r+1,0,i),delete e.cells[r].cachedElement}}));var a=Math.max(e.widths[r]/2,30);e.widths.splice(r,1,a,a)}},l=t.lastCol;l>=t.firstCol;l--)r(l)}},4053:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.splitTableCellVertically=void 0;var o=r(7582),n=r(7520),a=r(4964);t.splitTableCellVertically=function(e){var t=(0,a.getSelectedCells)(e);if(t)for(var r=t.lastRow;r>=t.firstRow;r--){var l=e.rows[r],i=e.rows[r+1];if(l.cells.forEach((function(e){delete e.cachedElement})),delete l.cachedElement,null==i?void 0:i.cells.every((function(e,r){return r<t.firstCol||r>t.lastCol||e.spanAbove})))i.cells.forEach((function(e,r){r>=t.firstCol&&r<=t.lastCol&&(e.spanAbove=!1,delete e.cachedElement)})),delete i.cachedElement;else{var s=Math.max(l.height/=2,22),d={format:(0,o.__assign)({},l.format),height:s,cells:l.cells.map((function(e,r){var a=(0,n.createTableCell)(e.spanLeft,e.spanAbove,e.isHeader,e.format);return a.dataset=(0,o.__assign)({},e.dataset),r<t.firstCol||r>t.lastCol?a.spanAbove=!0:a.isSelected=e.isSelected,a}))};l.height=s,e.rows.splice(r+1,0,d)}}}},3556:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(8728),n=r(2594),a=r(455);function l(e){var t,r;return e.block&&(r=e.segment?(0,a.isNodeOfType)(e.segment,3)?new n.Position(e.segment,(null===(t=e.segment.nodeValue)||void 0===t?void 0:t.length)||0):new n.Position(e.segment.parentNode,(0,n.toArray)(e.segment.parentNode.childNodes).indexOf(e.segment)+1):new n.Position(e.block,0)),(0,a.isNodeOfType)(null==r?void 0:r.node,11)&&(r=null==r?void 0:r.normalize()),r}t.default=function(e,t,r,a,i){var s=(0,o.createModelToDomContext)(a,i);s.modelHandlers.blockGroupChildren(e,t,r,s);var d=function(e){var t,r,o=e.regularSelection,a=o.start,i=o.end,s=e.tableSelection,d=e.imageSelection;if(null==d?void 0:d.image)return{type:2,ranges:[(0,n.createRange)(d.image)],areAllCollapsed:!1,image:d.image};if((t=a&&l(a))&&(r=i&&l(i))){var c=(0,n.createRange)(t,r);return{type:0,ranges:[(0,n.createRange)(t,r)],areAllCollapsed:c.collapsed}}return(null==s?void 0:s.table)?{type:1,ranges:[],areAllCollapsed:!1,table:s.table,coordinates:{firstCell:s.firstCell,lastCell:s.lastCell}}:null}(s);return t.normalize(),d}},8728:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createModelToDomContext=void 0;var o=r(7582),n=r(628),a=r(6681),l=r(8596);t.createModelToDomContext=function(e,t){return t=t||{},(0,o.__assign)((0,o.__assign)({},e||{isDarkMode:!1}),{regularSelection:{current:{block:null,segment:null}},listFormat:{threadItemCounts:[],nodeStack:[]},implicitFormat:{},formatAppliers:(0,l.getFormatAppliers)(t.formatApplierOverride,t.additionalFormatAppliers),modelHandlers:(0,o.__assign)((0,o.__assign)({},n.defaultContentModelHandlers),t.modelHandlerOverride||{}),defaultImplicitFormatMap:(0,o.__assign)((0,o.__assign)({},a.defaultImplicitFormatMap),t.defaultImplicitFormatOverride||{}),defaultModelHandlers:n.defaultContentModelHandlers,defaultFormatAppliers:l.defaultFormatAppliers,onNodeCreated:t.onNodeCreated})}},628:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultContentModelHandlers=void 0;var o=r(2358),n=r(1811),a=r(7537),l=r(3733),i=r(7123),s=r(8532),d=r(3685),c=r(7568),u=r(643),f=r(9726),m=r(3451),p=r(7552),v=r(6297),g=r(188),h=r(3531);t.defaultContentModelHandlers={block:o.handleBlock,blockGroupChildren:n.handleBlockGroupChildren,br:a.handleBr,entity:i.handleEntity,general:d.handleGeneralModel,divider:l.handleDivider,image:c.handleImage,list:u.handleList,listItem:f.handleListItem,paragraph:m.handleParagraph,formatContainer:s.handleFormatContainer,segment:p.handleSegment,segmentDecorator:v.handleSegmentDecorator,table:g.handleTable,text:h.handleText}},2358:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlock=void 0,t.handleBlock=function(e,t,r,o,n){var a=o.modelHandlers;switch(r.blockType){case"Table":n=a.table(e,t,r,o,n);break;case"Paragraph":n=a.paragraph(e,t,r,o,n);break;case"Entity":n=a.entity(e,t,r,o,n);break;case"Divider":n=a.divider(e,t,r,o,n);break;case"BlockGroup":switch(r.blockGroupType){case"General":n=a.general(e,t,r,o,n);break;case"FormatContainer":n=a.formatContainer(e,t,r,o,n);break;case"ListItem":n=a.listItem(e,t,r,o,n)}}return n}},1811:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlockGroupChildren=void 0,t.handleBlockGroupChildren=function(e,t,r,o){var n,a=o.listFormat,l=a.nodeStack,i=t.firstChild;try{for(r.blocks.forEach((function(r,n){0!=n&&"BlockGroup"==r.blockType&&"ListItem"==r.blockGroupType||(a.nodeStack=[]),i=o.modelHandlers.block(e,t,r,o,i)}));i;){var s=i.nextSibling;null===(n=i.parentNode)||void 0===n||n.removeChild(i),i=s}}finally{a.nodeStack=l}}},7537:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleBr=void 0;var o=r(5571);t.handleBr=function(e,t,r,n){var a=e.createElement("br"),l=e.createElement("span");l.appendChild(a),t.appendChild(l),(0,o.handleSegmentCommon)(e,a,l,r,n)}},3733:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleDivider=void 0;var o=r(5087),n=r(7153);t.handleDivider=function(e,t,r,a,l){var i,s=r.cachedElement;return s?l=(0,n.reuseCachedElement)(t,s,l):(s=e.createElement(r.tagName),r.cachedElement=s,t.insertBefore(s,l),(0,o.applyFormat)(s,a.formatAppliers.divider,r.format,a),r.size&&s.setAttribute("size",r.size)),null===(i=a.onNodeCreated)||void 0===i||i.call(a,r,s),l}},7123:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleEntity=void 0;var o=r(7582),n=r(5087),a=r(7153),l=r(2594);t.handleEntity=function(e,t,r,i,s){var d,c=r.wrapper,u=r.id,f=r.type,m=r.isReadonly,p=r.format,v=u&&f?{wrapper:c,id:u,type:f,isReadonly:!!m}:null,g=!(0,l.isBlockElement)(c);if(v&&(0,l.commitEntity)(c,v.type,v.isReadonly,v.id),s=(0,a.reuseCachedElement)(t,c,s),g&&(0,l.getObjectKeys)(p).length>0){var h=(0,l.wrap)(c,"span");(0,n.applyFormat)(h,i.formatAppliers.segment,p,i)}if(i.addDelimiterForEntity&&g&&m){var b=(0,o.__read)((0,l.addDelimiters)(c),1)[0];i.regularSelection.current.segment=b}return null===(d=i.onNodeCreated)||void 0===d||d.call(i,r,c),s}},8532:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleFormatContainer=void 0;var o=r(5087),n=r(6233),a=r(7153),l=r(7586);t.handleFormatContainer=function(e,t,r,i,s){var d,c=r.cachedElement;if(c)s=(0,a.reuseCachedElement)(t,c,s),i.modelHandlers.blockGroupChildren(e,c,r,i);else if(!(0,n.isBlockGroupEmpty)(r)){var u=e.createElement(r.tagName);r.cachedElement=u,t.insertBefore(u,s),(0,l.stackFormat)(i,r.tagName,(function(){(0,o.applyFormat)(u,i.formatAppliers.container,r.format,i),(0,o.applyFormat)(u,i.formatAppliers.segmentOnBlock,r.format,i),(0,o.applyFormat)(u,i.formatAppliers.container,r.format,i)})),"pre"==r.tagName?(0,l.stackFormat)(i,"pre *",(function(){i.modelHandlers.blockGroupChildren(e,u,r,i)})):i.modelHandlers.blockGroupChildren(e,u,r,i),c=u}return c&&(null===(d=i.onNodeCreated)||void 0===d||d.call(i,r,c)),s}},3685:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleGeneralModel=void 0;var o=r(5571),n=r(461),a=r(455),l=r(7153),i=r(2594);t.handleGeneralModel=function(e,t,r,s,d){var c,u=r.element;if(d&&u.parentNode==t?d=(0,l.reuseCachedElement)(t,u,d):(u=u.cloneNode(),r.element=u,t.insertBefore(u,d)),(0,n.isGeneralSegment)(r)&&(0,a.isNodeOfType)(u,1)){var f=(0,i.wrap)(u,"span");(0,o.handleSegmentCommon)(e,u,f,r,s)}else null===(c=s.onNodeCreated)||void 0===c||c.call(s,r,u);return s.modelHandlers.blockGroupChildren(e,u,r,s),d}},7568:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleImage=void 0;var o=r(5087),n=r(5571),a=r(7733);t.handleImage=function(e,t,r,l){var i=e.createElement("img"),s=document.createElement("span");t.appendChild(s),s.appendChild(i),i.src=r.src,r.alt&&(i.alt=r.alt),r.title&&(i.title=r.title),(0,o.applyFormat)(i,l.formatAppliers.image,r.format,l),(0,o.applyFormat)(i,l.formatAppliers.dataset,r.dataset,l);var d=r.format,c=d.width,u=d.height,f=c?(0,a.parseValueWithUnit)(c):0,m=u?(0,a.parseValueWithUnit)(u):0;f>0&&(i.width=f),m>0&&(i.height=m),r.isSelectedAsImageSelection&&(l.imageSelection={image:i}),(0,n.handleSegmentCommon)(e,i,s,r,l)}},643:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleList=void 0;var o=r(7582),n=r(5087),a=r(7274);function l(e,t,r){var o={};(0,a.updateListMetadata)({dataset:o},(function(){return"number"==typeof e.orderedStyleType||"number"==typeof e.unorderedStyleType?{orderedStyleType:e.orderedStyleType,unorderedStyleType:e.unorderedStyleType}:null})),(0,n.applyFormat)(t,r.formatAppliers.dataset,o,r)}t.handleList=function(e,t,r,a,i){var s,d=0,c=a.listFormat.nodeStack;for(0==c.length&&c.push({node:t});d<r.levels.length&&d+1<c.length;d++){var u=c[d+1],f=r.levels[d];if(u.listType!=f.listType||u.orderedStyleType!=f.orderedStyleType||u.unorderedStyleType!=f.unorderedStyleType||"OL"==f.listType&&"number"==typeof f.startNumberOverride)break}for(c.splice(d+1);d<r.levels.length;d++){var m=r.levels[d],p=e.createElement(m.listType||"UL");c[c.length-1].node.insertBefore(p,0==d?i:null),(0,n.applyFormat)(p,a.formatAppliers.listLevel,m,a),l(m,p,a),c.push((0,o.__assign)({node:p},m)),null===(s=a.onNodeCreated)||void 0===s||s.call(a,m,p)}return i}},9726:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleListItem=void 0;var o=r(5087),n=r(5378),a=r(2594);t.handleListItem=function(e,t,r,l,i){var s,d;i=l.modelHandlers.list(e,t,r,l,i);var c=l.listFormat.nodeStack,u=(null===(s=null==c?void 0:c[(null==c?void 0:c.length)-1])||void 0===s?void 0:s.node)||t,f=e.createElement("li"),m=r.levels[r.levels.length-1];return u.insertBefore(f,(null==i?void 0:i.parentNode)==u?i:null),m?((0,o.applyFormat)(f,l.formatAppliers.listItemElement,r.format,l),(0,o.applyFormat)(f,l.formatAppliers.segment,r.formatHolder.format,l),(0,o.applyFormat)(f,l.formatAppliers.listItem,m,l),l.modelHandlers.blockGroupChildren(e,f,r,l)):(r.blocks.forEach(n.setParagraphNotImplicit),l.modelHandlers.blockGroupChildren(e,f,r,l),(0,a.unwrap)(f)),null===(d=l.onNodeCreated)||void 0===d||d.call(l,r,f),i}},3451:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleParagraph=void 0;var o=r(7582),n=r(5087),a=r(2594),l=r(6630),i=r(7153),s=r(7586);t.handleParagraph=function(e,t,r,d,c){var u,f,m=r.cachedElement;return m?c=(0,i.reuseCachedElement)(t,m,c):(0,s.stackFormat)(d,(null===(u=r.decorator)||void 0===u?void 0:u.tagName)||null,(function(){var i,u,f=!r.isImplicit||!!r.decorator||(0,a.getObjectKeys)(r.format).length>0&&r.segments.some((function(e){return"SelectionMarker"!=e.segmentType})),p=f?(0,o.__assign)((0,o.__assign)({},(null===(i=r.decorator)||void 0===i?void 0:i.format)||{}),r.segmentFormat):{};m=e.createElement((null===(u=r.decorator)||void 0===u?void 0:u.tagName)||"div"),t.insertBefore(m,c),d.regularSelection.current={block:f?m:m.parentNode,segment:null};var v=function(){var t=m;if(t){var n=r.segments[0];"SelectionMarker"==(null==n?void 0:n.segmentType)&&d.modelHandlers.text(e,t,(0,o.__assign)((0,o.__assign)({},n),{segmentType:"Text",text:""}),d),r.segments.forEach((function(r){d.modelHandlers.segment(e,t,r,d)}))}};f?((0,s.stackFormat)(d,p,v),(0,n.applyFormat)(m,d.formatAppliers.block,r.format,d),(0,n.applyFormat)(m,d.formatAppliers.container,r.format,d),(0,n.applyFormat)(m,d.formatAppliers.segmentOnBlock,p,d)):v(),(0,l.optimize)(m),c=m.nextSibling,f?r.cachedElement=m:(0,a.unwrap)(m)})),m&&(null===(f=d.onNodeCreated)||void 0===f||f.call(d,r,m)),c}},7552:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegment=void 0;var o=r(7582);t.handleSegment=function(e,t,r,n){var a=n.regularSelection;switch(r.isSelected&&!a.start&&(a.start=(0,o.__assign)({},a.current)),r.segmentType){case"Text":n.modelHandlers.text(e,t,r,n);break;case"Br":n.modelHandlers.br(e,t,r,n);break;case"Image":n.modelHandlers.image(e,t,r,n);break;case"General":n.modelHandlers.general(e,t,r,n,null);break;case"Entity":n.modelHandlers.entity(e,t,r,n,null)}r.isSelected&&a.start&&(a.end=(0,o.__assign)({},a.current))}},6297:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentDecorator=void 0;var o=r(5087),n=r(2594),a=r(7586);t.handleSegmentDecorator=function(e,t,r,l){var i=r.code,s=r.link;s&&(0,a.stackFormat)(l,"a",(function(){var e,r=document.createElement("a");(0,n.moveChildNodes)(r,t),t.appendChild(r),(0,o.applyFormat)(r,l.formatAppliers.link,s.format,l),(0,o.applyFormat)(r,l.formatAppliers.dataset,s.dataset,l),null===(e=l.onNodeCreated)||void 0===e||e.call(l,s,r)})),i&&(0,a.stackFormat)(l,"code",(function(){var e,r=document.createElement("code");(0,n.moveChildNodes)(r,t),t.appendChild(r),(0,o.applyFormat)(r,l.formatAppliers.code,i.format,l),null===(e=l.onNodeCreated)||void 0===e||e.call(l,i,r)}))}},188:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleTable=void 0;var o=r(5087),n=r(1774),a=r(6233),l=r(2594),i=r(7153);t.handleTable=function(e,t,r,s,d){var c,u,f,m,p,v;if((0,a.isBlockEmpty)(r))return d;var g=r.cachedElement;g?(d=(0,i.reuseCachedElement)(t,g,d),(0,l.moveChildNodes)(g)):(g=e.createElement("table"),r.cachedElement=g,t.insertBefore(g,d),(0,o.applyFormat)(g,s.formatAppliers.block,r.format,s),(0,o.applyFormat)(g,s.formatAppliers.table,r.format,s),(0,o.applyFormat)(g,s.formatAppliers.tableBorder,r.format,s),(0,o.applyFormat)(g,s.formatAppliers.dataset,r.dataset,s)),null===(c=s.onNodeCreated)||void 0===c||c.call(s,r,g);var h=e.createElement("tbody");g.appendChild(h);for(var b=0;b<r.rows.length;b++){var y=r.rows[b];if(0!=y.cells.length){var _=y.cachedElement||e.createElement("tr");h.appendChild(_),(0,l.moveChildNodes)(_),y.cachedElement||(y.cachedElement=_,(0,o.applyFormat)(_,s.formatAppliers.tableRow,y.format,s)),null===(u=s.onNodeCreated)||void 0===u||u.call(s,y,_);for(var k=0;k<y.cells.length;k++){var C=y.cells[k];if(C.isSelected&&(s.tableSelection=s.tableSelection||{table:g,firstCell:{x:k,y:b},lastCell:{x:k,y:b}},s.tableSelection.table==g)){var S=s.tableSelection.lastCell;S.x=Math.max(S.x,k),S.y=Math.max(S.y,b)}if(!C.spanAbove&&!C.spanLeft){var P=C.cachedElement||e.createElement(C.isHeader?"th":"td");_.appendChild(P);for(var O=1,M=1,w=r.widths[k],F=y.height;null===(m=null===(f=r.rows[b+O])||void 0===f?void 0:f.cells[k])||void 0===m?void 0:m.spanAbove;O++)F+=r.rows[b+O].height;for(;null===(p=y.cells[k+M])||void 0===p?void 0:p.spanLeft;M++)w+=r.widths[k+M];O>1&&(P.rowSpan=O),M>1&&(P.colSpan=M),(!C.cachedElement||C.format.useBorderBox&&(0,n.hasMetadata)(r))&&(w>0&&(P.style.width=w+"px"),F>0&&(P.style.height=F+"px")),C.cachedElement||(C.cachedElement=P,(0,o.applyFormat)(P,s.formatAppliers.block,C.format,s),(0,o.applyFormat)(P,s.formatAppliers.tableCell,C.format,s),(0,o.applyFormat)(P,s.formatAppliers.tableCellBorder,C.format,s),(0,o.applyFormat)(P,s.formatAppliers.dataset,C.dataset,s)),s.modelHandlers.blockGroupChildren(e,P,C,s),null===(v=s.onNodeCreated)||void 0===v||v.call(s,C,P)}}}}return d}},3531:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleText=void 0;var o=r(5571);t.handleText=function(e,t,r,n){var a=e.createTextNode(r.text),l=e.createElement("span");t.appendChild(l),l.appendChild(a),(0,o.handleSegmentCommon)(e,a,l,r,n)}},262:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeNode=void 0;var o=r(455),n=["SPAN","B","EM","I","U","SUB","SUP","STRIKE","S","A","CODE"];function a(e,t){var r=e.attributes,o=t.attributes;if(r.length!=o.length)return!1;for(var n=0;n<r.length;n++)if(r[n].name!=o[n].name||r[n].value!=o[n].value)return!1;return!0}t.mergeNode=function(e){for(var t=e.firstChild;t;){var r=t.nextSibling;if(r&&(0,o.isNodeOfType)(t,1)&&(0,o.isNodeOfType)(r,1)&&t.tagName==r.tagName&&n.indexOf(t.tagName)>=0&&a(t,r)){for(;r.firstChild;)t.appendChild(r.firstChild);r.parentNode.removeChild(r)}else t=r}}},6630:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.optimize=void 0;var o=r(455),n=r(262),a=r(5669);t.optimize=function e(t){if(!(0,o.isNodeOfType)(t,1)||!t.classList.contains("_Entity")){(0,a.removeUnnecessarySpan)(t),(0,n.mergeNode)(t);for(var r=t.firstChild;r;r=r.nextSibling)e(r)}}},5669:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeUnnecessarySpan=void 0;var o=r(455);t.removeUnnecessarySpan=function(e){for(var t=e.firstChild;t;)if((0,o.isNodeOfType)(t,1)&&"SPAN"==t.tagName&&0==t.attributes.length){var r=t,n=t.nextSibling;for(t=t.nextSibling;r.lastChild;){var a=r.lastChild;e.insertBefore(a,n),n=a}e.removeChild(r)}else t=t.nextSibling}},5087:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyFormat=void 0,t.applyFormat=function(e,t,r,o){t.forEach((function(t){null==t||t(r,e,o)}))}},5571:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleSegmentCommon=void 0;var o=r(5087);t.handleSegmentCommon=function(e,t,r,n,a){var l;t.firstChild||(a.regularSelection.current.segment=t),(0,o.applyFormat)(r,a.formatAppliers.styleBasedSegment,n.format,a),a.modelHandlers.segmentDecorator(e,r,n,a),(0,o.applyFormat)(r,a.formatAppliers.elementBasedSegment,n.format,a),null===(l=a.onNodeCreated)||void 0===l||l.call(a,n,t)}},7153:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeNode=t.reuseCachedElement=void 0;var o=r(2594),n=r(455);t.reuseCachedElement=function(e,t,r){var a,l;if(t.parentNode==e){for(;r&&r!=t&&(l=r,!(0,n.isNodeOfType)(l,1)||!(0,o.getEntityFromElement)(l));){var i=r.nextSibling;null===(a=r.parentNode)||void 0===a||a.removeChild(r),r=i}r&&r==t?r=r.nextSibling:e.insertBefore(t,r)}else e.insertBefore(t,r);return r},t.removeNode=function(e){var t,r=e.nextSibling;return null===(t=e.parentNode)||void 0===t||t.removeChild(e),r}},7586:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stackFormat=void 0;var o=r(7582);t.stackFormat=function(e,t,r){var n="string"==typeof t?e.defaultImplicitFormatMap[t]:t;if(n){var a=e.implicitFormat;try{e.implicitFormat=(0,o.__assign)((0,o.__assign)({},a),n),r()}finally{e.implicitFormat=a}}else r()}},2435:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7342),n=r(1096);t.default=function(e,t){(0,o.formatWithContentModel)(e,"setAlignment",(function(e){return(0,n.setModelAlignment)(e,t)}))}},9341:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9909);t.default=function(e,t){(0,o.formatParagraphWithContentModel)(e,"setDirection",(function(e){if("rtl"==e.format.direction!=("rtl"==t)){e.format.direction=t;var r=e.format.marginLeft,o=e.format.paddingLeft;e.format.marginLeft=e.format.marginRight,e.format.marginRight=r,e.format.paddingLeft=e.format.paddingRight,e.format.paddingRight=o}}))}},7716:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(6681),a=r(9909);t.default=function(e,t){(0,a.formatParagraphWithContentModel)(e,"setHeaderLevel",(function(e){var r,a,l,i=t>0?"h"+t:(a=(null==(r=e.decorator)?void 0:r.tagName)||"",(l=parseInt(a.substring(1)))>=1&&l<=6?a:null),s=i&&n.defaultImplicitFormatMap[i]||{};t>0?(e.decorator={tagName:i,format:(0,o.__assign)({},s)},e.segments.forEach((function(e){delete e.format.fontSize,delete e.format.fontWeight}))):i&&delete e.decorator}))}},1110:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7342),n=r(3366);t.default=function(e,t,r){(0,o.formatWithContentModel)(e,"setIndentation",(function(e){return(0,n.setModelIndentation)(e,t,r)}),{preservePendingFormat:!0})}},971:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(1309),n=r(9909);t.default=function(e,t,r){(0,n.formatParagraphWithContentModel)(e,"setParagraphMargin",(function(e){e.decorator||(e.decorator=(0,o.createParagraphDecorator)("p")),t?e.format.marginTop=t:null===t&&delete e.format.marginTop,r?e.format.marginBottom=r:null===r&&delete e.format.marginBottom}))}},861:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9909);t.default=function(e,t){(0,o.formatParagraphWithContentModel)(e,"setSpacing",(function(e){e.format.lineHeight=t.toString(),e.segments.forEach((function(e){e.format.lineHeight&&delete e.format.lineHeight}))}))}},7149:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(7342),a=r(6621),l={borderLeft:"3px solid rgb(200, 200, 200)",textColor:"rgb(102, 102, 102)"},i={marginTop:"1em",marginBottom:"1em",marginLeft:"40px",marginRight:"40px",paddingLeft:"10px"};t.default=function(e,t){void 0===t&&(t=l);var r=(0,o.__assign)((0,o.__assign)({},i),t);(0,n.formatWithContentModel)(e,"toggleBlockQuote",(function(e){return(0,a.toggleModelBlockQuote)(e,r)}),{preservePendingFormat:!0})}},6334:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2594),n=r(7010),a=r(1242),l=r(7342),i=r(8252),s=r(5530),d=r(7322);t.default=function(e,t,r){var c=t.which;(0,l.formatWithContentModel)(e,46==c?"handleDeleteKey":"handleBackspaceKey",(function(l){var c=(0,a.deleteSelection)(l,(0,i.getOnDeleteEntityCallback)(e,t,r),function(e){var t=46==e.which;return[(0,i.shouldDeleteAllSegmentsBefore)(e)&&!t?n.deleteAllSegmentBefore:null,(0,i.shouldDeleteWord)(e,!!o.Browser.isMac)?t?s.forwardDeleteWordSelection:s.backwardDeleteWordSelection:null,t?d.forwardDeleteCollapsedSelection:d.backwardDeleteCollapsedSelection]}(t)).deleteResult;return(0,i.handleKeyboardEventResult)(e,l,t,c)}),{skipUndoSnapshot:!0,changeSource:"Keyboard",getChangeData:function(){return c}})}},3744:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(7014),a=r(7342),l=r(13),i=r(2537),s=r(5568),d=r(5378);t.default=function(e,t){var r=(0,l.getPendingFormat)(e);if(r){var c=!1;(0,a.formatWithContentModel)(e,"applyPendingFormat",(function(e){return(0,i.iterateSelections)([e],(function(e,a,l,i){if("Paragraph"==(null==l?void 0:l.blockType)&&1==(null==i?void 0:i.length)&&"SelectionMarker"==i[0].segmentType){var s=i[0],u=l.segments.indexOf(s),f=l.segments[u-1];if("Text"==(null==f?void 0:f.segmentType)){var m=f.text,p=m.substr(-t.length,t.length);if(p==t||" "==t&&" "==p){s.format=(0,o.__assign)({},r),f.text=m.substring(0,m.length-t.length);var v=(0,n.createText)(" "==t?" ":t,(0,o.__assign)((0,o.__assign)({},f.format),r));l.segments.splice(u,0,v),(0,d.setParagraphNotImplicit)(l),c=!0}}}return!0})),c&&(0,s.normalizeContentModel)(e),c}),{skipUndoSnapshot:!0})}}},4202:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(2598),n=r(7342),a=r(5568);t.default=function(e){(0,n.formatWithContentModel)(e,"clearFormat",(function(e){var t=[],r=[],n=[];return(0,o.clearModelFormat)(e,t,r,n),(0,a.normalizeContentModel)(e),t.length>0||r.length>0||n.length>0}))}},4975:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(7342),a=r(13),l=r(3982);t.default=function(e){var t=(0,o.__assign)((0,o.__assign)({},e.getUndoState()),{isDarkMode:e.isDarkMode(),zoomScale:e.getZoomScale()});return(0,n.formatWithContentModel)(e,"getFormatState",(function(r){var o=(0,a.getPendingFormat)(e);return(0,l.retrieveModelFormatState)(r,o,t),!1}),{useReducedModel:!0}),t}},4340:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7342),n=r(13),a=r(2537);t.default=function(e){var t=(0,n.getPendingFormat)(e);return t||(0,o.formatWithContentModel)(e,"getSegmentFormat",(function(e){return(0,a.iterateSelections)([e],(function(e,r,o,n){var a;return t=(null===(a=null==n?void 0:n[0])||void 0===a?void 0:a.format)||null,!0}),{includeListFormatHolder:"never"}),!1}),{useReducedModel:!0}),t}},6986:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9380),n=r(7342);t.default=function(e){var t=null;return(0,n.formatWithContentModel)(e,"adjustImageSelection",(function(e){return(0,o.adjustSegmentSelection)(e,(function(e){return!(!e.isSelected||"Image"!=e.segmentType||(t=e,0))}),(function(e,t){return e==t}))})),t}},4976:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6919),n=r(2594);t.default=function(e,t){var r=e.getSelectionRangeEx();(0,n.readFile)(t,(function(t){t&&!e.isDisposed()&&2===r.type&&(0,o.default)(e,"changeImage",(function(e){e.src=t,e.dataset={},e.format.width="",e.format.height=""}),{image:r.image,previousSrc:r.image.src,newSrc:t,originalSrc:a(r.image)})}))};var a=function(e){var t=(0,n.getMetadata)(e);return t&&t.src||""}},8817:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(3394),n=r(3106),a=r(4109),l=r(7342),i=r(8252),s=r(9248),d=r(2594);function c(e,t){(0,l.formatWithContentModel)(e,"insertImage",(function(r){var l=(0,a.createImage)(t),d=(0,n.createContentModelDocument)();return(0,o.addSegment)(d,l),(0,s.mergeModel)(r,d,(0,i.getOnDeleteEntityCallback)(e),{mergeFormat:"mergeAll"}),!0}))}t.default=function(e,t){"string"==typeof t?c(e,t):(0,d.readFile)(t,(function(t){t&&!e.isDisposed()&&c(e,t)}))}},8092:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6919);t.default=function(e,t){(0,o.default)(e,"setImageAltText",(function(e){e.alt=t}))}},1236:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(3631),n=r(6919);t.default=function(e,t,r){(0,n.default)(e,"setImageBorder",(function(e){(0,o.default)(e,t,r)}))}},2631:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6919);t.default=function(e,t,r){(0,o.default)(e,"setImageBoxShadow",(function(e){e.format.boxShadow=t,r?(e.format.marginBottom=r,e.format.marginLeft=r,e.format.marginRight=r,e.format.marginTop=r):null===r&&(delete e.format.marginBottom,delete e.format.marginLeft,delete e.format.marginRight,delete e.format.marginTop)}))}},4526:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paste=t.toggleCode=t.setParagraphMargin=t.adjustImageSelection=t.setImageAltText=t.adjustLinkSelection=t.removeLink=t.insertLink=t.clearFormat=t.applyPendingFormat=t.getSegmentFormat=t.getFormatState=t.changeImage=t.setImageBoxShadow=t.setImageBorder=t.setSpacing=t.toggleBlockQuote=t.setHeaderLevel=t.setDirection=t.setAlignment=t.setIndentation=t.hasSelectionInBlockGroup=t.hasSelectionInSegment=t.hasSelectionInBlock=t.setListStartNumber=t.setListStyle=t.insertImage=t.changeCapitalization=t.applySegmentFormat=t.changeFontSize=t.setTextColor=t.setFontSize=t.setFontName=t.setBackgroundColor=t.toggleSuperscript=t.toggleSubscript=t.toggleStrikethrough=t.toggleUnderline=t.toggleItalic=t.toggleBold=t.toggleNumbering=t.toggleBullet=t.editTable=t.setTableCellShade=t.formatTable=t.insertTable=void 0;var o=r(2193);Object.defineProperty(t,"insertTable",{enumerable:!0,get:function(){return o.default}});var n=r(7669);Object.defineProperty(t,"formatTable",{enumerable:!0,get:function(){return n.default}});var a=r(610);Object.defineProperty(t,"setTableCellShade",{enumerable:!0,get:function(){return a.default}});var l=r(5614);Object.defineProperty(t,"editTable",{enumerable:!0,get:function(){return l.default}});var i=r(1911);Object.defineProperty(t,"toggleBullet",{enumerable:!0,get:function(){return i.default}});var s=r(9504);Object.defineProperty(t,"toggleNumbering",{enumerable:!0,get:function(){return s.default}});var d=r(6513);Object.defineProperty(t,"toggleBold",{enumerable:!0,get:function(){return d.default}});var c=r(2747);Object.defineProperty(t,"toggleItalic",{enumerable:!0,get:function(){return c.default}});var u=r(5318);Object.defineProperty(t,"toggleUnderline",{enumerable:!0,get:function(){return u.default}});var f=r(8467);Object.defineProperty(t,"toggleStrikethrough",{enumerable:!0,get:function(){return f.default}});var m=r(3760);Object.defineProperty(t,"toggleSubscript",{enumerable:!0,get:function(){return m.default}});var p=r(9206);Object.defineProperty(t,"toggleSuperscript",{enumerable:!0,get:function(){return p.default}});var v=r(7760);Object.defineProperty(t,"setBackgroundColor",{enumerable:!0,get:function(){return v.default}});var g=r(5766);Object.defineProperty(t,"setFontName",{enumerable:!0,get:function(){return g.default}});var h=r(401);Object.defineProperty(t,"setFontSize",{enumerable:!0,get:function(){return h.default}});var b=r(3015);Object.defineProperty(t,"setTextColor",{enumerable:!0,get:function(){return b.default}});var y=r(1066);Object.defineProperty(t,"changeFontSize",{enumerable:!0,get:function(){return y.default}});var _=r(433);Object.defineProperty(t,"applySegmentFormat",{enumerable:!0,get:function(){return _.default}});var k=r(4223);Object.defineProperty(t,"changeCapitalization",{enumerable:!0,get:function(){return k.default}});var C=r(8817);Object.defineProperty(t,"insertImage",{enumerable:!0,get:function(){return C.default}});var S=r(9603);Object.defineProperty(t,"setListStyle",{enumerable:!0,get:function(){return S.default}});var P=r(9888);Object.defineProperty(t,"setListStartNumber",{enumerable:!0,get:function(){return P.default}});var O=r(8984);Object.defineProperty(t,"hasSelectionInBlock",{enumerable:!0,get:function(){return O.default}});var M=r(3073);Object.defineProperty(t,"hasSelectionInSegment",{enumerable:!0,get:function(){return M.default}});var w=r(8780);Object.defineProperty(t,"hasSelectionInBlockGroup",{enumerable:!0,get:function(){return w.default}});var F=r(1110);Object.defineProperty(t,"setIndentation",{enumerable:!0,get:function(){return F.default}});var T=r(2435);Object.defineProperty(t,"setAlignment",{enumerable:!0,get:function(){return T.default}});var x=r(9341);Object.defineProperty(t,"setDirection",{enumerable:!0,get:function(){return x.default}});var E=r(7716);Object.defineProperty(t,"setHeaderLevel",{enumerable:!0,get:function(){return E.default}});var j=r(7149);Object.defineProperty(t,"toggleBlockQuote",{enumerable:!0,get:function(){return j.default}});var B=r(861);Object.defineProperty(t,"setSpacing",{enumerable:!0,get:function(){return B.default}});var A=r(1236);Object.defineProperty(t,"setImageBorder",{enumerable:!0,get:function(){return A.default}});var L=r(2631);Object.defineProperty(t,"setImageBoxShadow",{enumerable:!0,get:function(){return L.default}});var I=r(4976);Object.defineProperty(t,"changeImage",{enumerable:!0,get:function(){return I.default}});var H=r(4975);Object.defineProperty(t,"getFormatState",{enumerable:!0,get:function(){return H.default}});var D=r(4340);Object.defineProperty(t,"getSegmentFormat",{enumerable:!0,get:function(){return D.default}});var N=r(3744);Object.defineProperty(t,"applyPendingFormat",{enumerable:!0,get:function(){return N.default}});var R=r(4202);Object.defineProperty(t,"clearFormat",{enumerable:!0,get:function(){return R.default}});var z=r(1569);Object.defineProperty(t,"insertLink",{enumerable:!0,get:function(){return z.default}});var W=r(7937);Object.defineProperty(t,"removeLink",{enumerable:!0,get:function(){return W.default}});var G=r(336);Object.defineProperty(t,"adjustLinkSelection",{enumerable:!0,get:function(){return G.default}});var U=r(8092);Object.defineProperty(t,"setImageAltText",{enumerable:!0,get:function(){return U.default}});var K=r(6986);Object.defineProperty(t,"adjustImageSelection",{enumerable:!0,get:function(){return K.default}});var V=r(971);Object.defineProperty(t,"setParagraphMargin",{enumerable:!0,get:function(){return V.default}});var q=r(4153);Object.defineProperty(t,"toggleCode",{enumerable:!0,get:function(){return q.default}});var $=r(5985);Object.defineProperty(t,"paste",{enumerable:!0,get:function(){return $.default}})},336:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9380),n=r(4059),a=r(7342),l=r(6827),i=r(4783);t.default=function(e){var t="",r=null;return(0,a.formatWithContentModel)(e,"adjustLinkSelection",(function(e){var a,s,d=(0,o.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return!!e.link&&e.link.format.href==t.link.format.href})),c=(0,l.getSelectedSegments)(e,!1),u=c[0];return 1==c.length&&"SelectionMarker"==u.segmentType&&(c=(0,n.adjustWordSelection)(e,u)).length>1&&(d=!0,(0,i.setSelection)(e,c[0],c[c.length-1])),t=c.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),r=(null===(s=null===(a=c[0])||void 0===a?void 0:a.link)||void 0===s?void 0:s.format.href)||null,d})),[t,r]}},1569:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(7978),a=r(3394),l=r(3106),i=r(7014),s=r(7342),d=r(8252),c=r(13),u=r(6827),f=r(2594),m=r(9248),p=/^[a-zA-Z]+:/i,v=/^[\w.%+-]+@/i,g=/^ftp\./i;function h(e){if(!e)return e;var t="";return e.search(p)<0&&(t=0==e.search(v)?"mailto:":0==e.search(g)?"ftp://":"http://"),t+e}t.default=function(e,t,r,p,v){var g=(function(e){var t=new f.HtmlSanitizer,r=document.createElement("a");return r.href=e||"",t.sanitize(r),r.getAttribute("href")||""}(t)||"").trim();if(g){var b,y=(0,f.matchLink)(g),_={dataset:{},format:{href:y?y.normalizedUrl:h(g),anchorTitle:r,target:v,underline:!0}},k=[];(0,s.formatWithContentModel)(e,"insertLink",(function(t){var r,s=(0,u.getSelectedSegments)(t,!1),f=s.map((function(e){return"Text"==e.segmentType?e.text:""})).join(""),v=p||f||"";if(s.some((function(e){return"SelectionMarker"!=e.segmentType}))&&f==v)s.forEach((function(e){(0,n.addLink)(e,_),e.link&&k.push(e.link)}));else if(s.every((function(e){return"SelectionMarker"==e.segmentType}))||v&&v!=f){var h=(0,i.createText)(v||(y?y.originalUrl:g),(0,o.__assign)((0,o.__assign)({},(null===(r=s[0])||void 0===r?void 0:r.format)||{}),(0,c.getPendingFormat)(e)||{})),b=(0,l.createContentModelDocument)();(0,n.addLink)(h,_),(0,a.addSegment)(b,h),h.link&&k.push(h.link),(0,m.mergeModel)(t,b,(0,d.getOnDeleteEntityCallback)(e),{mergeFormat:"mergeAll"})}return s.length>0}),{changeSource:"CreateLink",onNodeCreated:function(e,t){!b&&k.indexOf(e)>=0&&(b=t)},getChangeData:function(){return b}})}}},7937:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9380),n=r(7342),a=r(6827);t.default=function(e){(0,n.formatWithContentModel)(e,"removeLink",(function(e){(0,o.adjustSegmentSelection)(e,(function(e){return!!e.isSelected&&!!e.link}),(function(e,t){return e.isSelected||!!e.link&&e.link.format.href==t.link.format.href}));var t=(0,a.getSelectedSegments)(e,!1),r=!1;return t.forEach((function(e){e.link&&(r=!0,delete e.link)})),r}))}},9888:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7342),n=r(6827);t.default=function(e,t){(0,o.formatWithContentModel)(e,"setListStartNumber",(function(e){var r=(0,n.getFirstSelectedListItem)(e),o=null==r?void 0:r.levels[(null==r?void 0:r.levels.length)-1];return!!o&&(o.startNumberOverride=t,!0)}))}},9603:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4372),n=r(7342),a=r(6827);t.default=function(e,t){(0,n.formatWithContentModel)(e,"setListStyle",(function(e){var r=(0,a.getFirstSelectedListItem)(e);if(r){var n=(0,o.findListItemsInSameThread)(e,r),l=r.levels.length-1;return n.forEach((function(e){void 0!==t.orderedStyleType&&(e.levels[l].orderedStyleType=t.orderedStyleType),void 0!==t.unorderedStyleType&&(e.levels[l].unorderedStyleType=t.unorderedStyleType)})),!0}return!1}))}},1911:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7342),n=r(5670);t.default=function(e){(0,o.formatWithContentModel)(e,"toggleBullet",(function(e){return(0,n.setListType)(e,"UL")}),{preservePendingFormat:!0})}},9504:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7342),n=r(5670);t.default=function(e){(0,o.formatWithContentModel)(e,"toggleNumbering",(function(e){return(0,n.setListType)(e,"OL")}),{preservePendingFormat:!0})}},433:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e,t){(0,o.formatSegmentWithContentModel)(e,"applySegmentFormat",(function(e){e.backgroundColor=t.backgroundColor,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontWeight=t.fontWeight,e.italic=t.italic,e.strikethrough=t.strikethrough,e.superOrSubScriptSequence=t.superOrSubScriptSequence,e.textColor=t.textColor,e.underline=t.underline}),void 0,!0)}},4223:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e,t,r){(0,o.formatSegmentWithContentModel)(e,"changeCapitalization",(function(e,o,n){if("Text"==(null==n?void 0:n.segmentType))switch(t){case"lowerCase":n.text=n.text.toLocaleLowerCase(r);break;case"upperCase":n.text=n.text.toLocaleUpperCase(r);break;case"capitalize":for(var a=n.text.toLocaleLowerCase(r).split(" "),l=0;l<a.length;l++)a[l]=a[l].charAt(0).toLocaleUpperCase(r)+a[l].slice(1);n.text=a.join(" ");break;case"sentence":var i=new RegExp("^\\s*\\w|[\\.\\!\\?]\\s+\\w","g");n.text=n.text.toLocaleLowerCase(r).replace(i,(function(e){return e.toLocaleUpperCase(r)}))}}))}},1066:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365),n=r(7733),a=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];t.default=function(e,t){(0,o.formatSegmentWithContentModel)(e,"changeFontSize",(function(e){return function(e,t){if(e.fontSize){var r=(0,n.parseValueWithUnit)(e.fontSize,void 0,"pt");if(r>0){var o=function(e,t,r){e=1==t?Math.floor(e):Math.ceil(e);var o=r[r.length-1];if(e<=r[0])e=Math.max(e+t,1);else if(e>o||e==o&&1==t)e/=10,e=1==t?Math.floor(e):Math.ceil(e),e=Math.min(Math.max(10*(e+t),o),1e3);else if(1==t){for(var n=0;n<r.length;n++)if(e<r[n]){e=r[n];break}}else for(n=r.length-1;n>=0;n--)if(e>r[n]){e=r[n];break}return e}(r,"increase"==t?1:-1,a);e.fontSize=o+"pt"}}}(e,t)}),void 0,!0)}},7760:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e,t){(0,o.formatSegmentWithContentModel)(e,"setBackgroundColor",null===t?function(e){delete e.backgroundColor}:function(e){e.backgroundColor=t})}},5766:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e,t){(0,o.formatSegmentWithContentModel)(e,"setFontName",(function(e,r,o){e.fontFamily=t,(null==o?void 0:o.code)&&(o.code.format.fontFamily=t)}),void 0,!0)}},401:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e,t){(0,o.formatSegmentWithContentModel)(e,"setFontSize",(function(e){e.fontSize=t}),void 0,!0)}},3015:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e,t){(0,o.formatSegmentWithContentModel)(e,"setTextColor",null===t?function(e,t,r){delete e.textColor,(null==r?void 0:r.link)&&delete r.link.format.textColor}:function(e,r,o){e.textColor=t,(null==o?void 0:o.link)&&(o.link.format.textColor=t)},void 0,!0)}},6513:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isBold=void 0;var o=r(4365);function n(e){return!!e&&("bold"==e||"bolder"==e||parseInt(e)>=600)}t.default=function(e){(0,o.formatSegmentWithContentModel)(e,"toggleBold",(function(e,t){e.fontWeight=t?"bold":"normal"}),(function(e,t,r){var o;return n(void 0===e.fontWeight?null===(o=null==r?void 0:r.decorator)||void 0===o?void 0:o.format.fontWeight:e.fontWeight)}))},t.isBold=n},4153:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7978),n=r(4365),a={format:{fontFamily:"monospace"}};t.default=function(e){(0,n.formatSegmentWithContentModel)(e,"toggleCode",(function(e,t,r){r&&(t?(0,o.addCode)(r,a):delete r.code)}),(function(e,t){return!!(null==t?void 0:t.code)}))}},2747:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e){(0,o.formatSegmentWithContentModel)(e,"toggleItalic",(function(e,t){e.italic=!!t}),(function(e){return!!e.italic}))}},8467:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e){(0,o.formatSegmentWithContentModel)(e,"toggleStrikethrough",(function(e,t){e.strikethrough=!!t}),(function(e){return!!e.strikethrough}))}},3760:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e){(0,o.formatSegmentWithContentModel)(e,"toggleSubscript",(function(e,t){e.superOrSubScriptSequence=t?"sub":""}),(function(e){var t;return"sub"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},9206:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e){(0,o.formatSegmentWithContentModel)(e,"toggleSuperscript",(function(e,t){e.superOrSubScriptSequence=t?"super":""}),(function(e){var t;return"super"==(null===(t=e.superOrSubScriptSequence)||void 0===t?void 0:t.split(" ").pop())}))}},5318:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e){(0,o.formatSegmentWithContentModel)(e,"toggleUnderline",(function(e,t,r){e.underline=!!t,(null==r?void 0:r.link)&&(r.link.format.underline=!!t)}),(function(e){return!!e.underline}))}},8984:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(8780),n=r(3073);t.default=function(e){switch(e.blockType){case"Paragraph":return e.segments.some(n.default);case"Table":return e.rows.some((function(e){return e.cells.some(o.default)}));case"BlockGroup":return(0,o.default)(e);case"Divider":case"Entity":return!!e.isSelected;default:return!1}}},8780:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(8984);t.default=function(e){return!("TableCell"!=e.blockGroupType||!e.isSelected)||!!e.blocks.some(o.default)}},3073:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(8984);t.default=function(e){return e.isSelected||"General"==e.segmentType&&e.blocks.some(o.default)}},5614:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(3592),n=r(793),a=r(6228),l=r(3765),i=r(533),s=r(3364),d=r(7342),c=r(6827),u=r(1774),f=r(7899),m=r(662),p=r(5409),v=r(4642),g=r(994),h=r(9325),b=r(8811),y=r(4053);t.default=function(e,t){(0,d.formatWithContentModel)(e,"editTable",(function(e){var r=(0,c.getFirstSelectedTable)(e);if(r){switch(t){case 22:case 18:case 17:case 21:case 19:case 20:(0,n.alignTableCell)(r,t);break;case 14:case 15:case 16:(0,o.alignTable)(r,t);break;case 5:(0,i.deleteTableColumn)(r);break;case 6:(0,s.deleteTableRow)(r);break;case 4:(0,l.deleteTable)(r);break;case 0:case 1:(0,m.insertTableRow)(r,t);break;case 2:case 3:(0,f.insertTableColumn)(r,t);break;case 7:case 8:(0,g.mergeTableRow)(r,t);break;case 11:(0,p.mergeTableCells)(r);break;case 9:case 10:(0,v.mergeTableColumn)(r,t);break;case 12:(0,b.splitTableCellHorizontally)(r);break;case 13:(0,y.splitTableCellVertically)(r)}return(0,h.normalizeTable)(r),(0,u.hasMetadata)(r)&&(0,a.applyTableFormat)(r,void 0,!0),!0}return!1}))}},7669:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6228),n=r(7342),a=r(6827);t.default=function(e,t,r){(0,n.formatWithContentModel)(e,"formatTable",(function(e){var n=(0,a.getFirstSelectedTable)(e);return!!n&&((0,o.applyTableFormat)(n,t,r),!0)}))}},2193:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(6228),n=r(3106),a=r(8996),l=r(8097),i=r(1242),s=r(7342),d=r(8252),c=r(13),u=r(9248),f=r(9325),m=r(4783);t.default=function(e,t,r,p){(0,s.formatWithContentModel)(e,"insertTable",(function(s){var v,g,h,b=(0,d.getOnDeleteEntityCallback)(e),y=(0,i.deleteSelection)(s,b).insertPoint;if(y){var _=(0,n.createContentModelDocument)(),k=(0,l.createTableStructure)(_,t,r);(0,f.normalizeTable)(k,(0,c.getPendingFormat)(e)||y.marker.format),(0,o.applyTableFormat)(k,p),(0,u.mergeModel)(s,_,b,{insertPosition:y,mergeFormat:"mergeAll"});var C=null===(g=null===(v=k.rows[0])||void 0===v?void 0:v.cells[0])||void 0===g?void 0:g.blocks[0];if("Paragraph"==(null==C?void 0:C.blockType)){var S=(0,a.createSelectionMarker)(null===(h=C.segments[0])||void 0===h?void 0:h.format);C.segments.unshift(S),(0,m.setSelection)(s,S)}return!0}return!1}))}},610:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(8780),n=r(7342),a=r(6827),l=r(9325),i=r(9454);t.default=function(e,t){(0,n.formatWithContentModel)(e,"setTableCellShade",(function(e){var r=(0,a.getFirstSelectedTable)(e);return!!r&&((0,l.normalizeTable)(r),r.rows.forEach((function(e){return e.cells.forEach((function(e){(0,o.default)(e)&&(0,i.setTableCellBackgroundColor)(e,t,!0)}))})),!0)}))}},6919:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(4365);t.default=function(e,t,r,n){(0,o.formatSegmentWithContentModel)(e,t,(function(t,o,a){"Image"==(null==a?void 0:a.segmentType)&&(r(a),n&&e.triggerPluginEvent(19,n))}),void 0,void 0)}},9909:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatParagraphWithContentModel=void 0;var o=r(7342),n=r(6827);t.formatParagraphWithContentModel=function(e,t,r){(0,o.formatWithContentModel)(e,t,(function(e){var t=(0,n.getSelectedParagraphs)(e);return t.forEach(r),t.length>0}),{preservePendingFormat:!0})}},4365:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatSegmentWithContentModel=void 0;var o=r(7582),n=r(4059),a=r(7342),l=r(13),i=r(6827);t.formatSegmentWithContentModel=function(e,t,r,s,d){(0,a.formatWithContentModel)(e,t,(function(t){var a=(0,i.getSelectedSegmentsAndParagraphs)(t,!!d),c=(0,l.getPendingFormat)(e),u=1==a.length&&"SelectionMarker"==a[0][0].segmentType;if(u){var f=a[0][1];(a=(0,n.adjustWordSelection)(t,a[0][0]).map((function(e){return[e,f]}))).length>1&&(u=!1)}var m=c?[[c,null,null]]:a.map((function(e){return[e[0].format,e[0],e[1]]})),p=!!s&&m.every((function(e){var t=(0,o.__read)(e,3),r=t[0],n=t[1],a=t[2];return s(r,n,a)}));if(m.forEach((function(e){var t=(0,o.__read)(e,2),n=t[0],a=t[1];return r(n,!p,a)})),!c&&u){var v=e.getFocusedPosition();v&&(0,l.setPendingFormat)(e,a[0][0].format,v)}return u?(e.focus(),!1):m.length>0}))}},7342:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatWithContentModel=void 0;var o=r(13),n=r(5441);t.formatWithContentModel=function(e,t,r,a){var l,i=a||{},s=i.useReducedModel,d=i.onNodeCreated,c=i.preservePendingFormat,u=i.getChangeData,f=i.skipUndoSnapshot,m=i.changeSource,p=s?{processorOverride:{child:n.reducedModelChildProcessor}}:void 0,v=e.createContentModel(p);if(r(v)){var g=function(){if(e.focus(),v&&e.setContentModel(v,{onNodeCreated:d}),c){var t=(0,o.getPendingFormat)(e),r=e.getFocusedPosition();t&&r&&(0,o.setPendingFormat)(e,t,r)}return null==u?void 0:u()};f?(g(),m&&e.triggerContentChangedEvent(m,null==u?void 0:u())):e.addUndoSnapshot(g,m||"Format",!1,{formatApiName:t}),null===(l=e.cacheContentModel)||void 0===l||l.call(e,v)}}},5985:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(7582),n=r(1940),a=r(7342),l=r(8252),i=r(9248),s=r(2594);t.default=function(e,t,r,c,u){void 0===r&&(r=!1),void 0===c&&(c=!1),void 0===u&&(u=!1),t.snapshotBeforePaste?e.setContent(t.snapshotBeforePaste):t.snapshotBeforePaste=e.getContent(2);var f=e.getSelectionRange(),m=f&&s.Position.getStart(f),p=function(e,t,r){var o=(0,s.createDefaultHtmlSanitizerOptions)();return o.cssStyleCallbacks["caret-color"]=function(){return!1},{eventType:10,clipboardData:t,fragment:e.getDocument().createDocumentFragment(),sanitizingOption:o,htmlBefore:"",htmlAfter:"",htmlAttributes:{},domToModelOption:{},pasteType:r}}(e,t,(0,s.getPasteType)(r,c,u)),v=function(e,t,r,o,n,a){var l=a.fragment,i=t.rawHtml,d=t.text,c=t.imageDataUri,u=e.getTrustedHTMLHandler(),f=i?(new DOMParser).parseFromString(u(i),"text/html"):void 0;return(0,s.retrieveMetadataFromClipboard)(f,a,e.getTrustedHTMLHandler()),n&&c||!o&&!d&&c?(0,s.handleImagePaste)(c,l):!o&&i&&f&&f.body?(0,s.moveChildNodes)(l,null==f?void 0:f.body):d&&(0,s.handleTextPaste)(d,r,l),e.triggerPluginEvent(10,a,!0),(0,s.sanitizePasteContent)(a,r),l}(e,t,m,r,u,p),g=(0,n.default)(v,{isDarkMode:e.isDarkMode(),darkColorHandler:e.getDarkColorHandler(),defaultFormat:e.getDefaultFormat()},(0,o.__assign)((0,o.__assign)({},p.domToModelOption),{disableCacheElement:!0,additionalFormatParsers:(0,o.__assign)((0,o.__assign)({},p.domToModelOption),{block:(0,o.__spreadArray)([],(0,o.__read)(c?[d]:[]),!1),listLevel:(0,o.__spreadArray)([],(0,o.__read)(c?[d]:[]),!1)})}));g&&(0,a.formatWithContentModel)(e,"Paste",(function(t){return(0,i.mergeModel)(t,g,(0,l.getOnDeleteEntityCallback)(e),{mergeFormat:c?"keepSourceEmphasisFormat":"none"}),!0}),{changeSource:"Paste",getChangeData:function(){return t}})};var d=function(e,t){t.style.backgroundColor&&(t.style.backgroundColor="",delete e.backgroundColor)}},8658:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2594:e=>{e.exports=roosterjs},7582:(e,t,r)=>{r.r(t),r.d(t,{__assign:()=>a,__asyncDelegator:()=>O,__asyncGenerator:()=>P,__asyncValues:()=>M,__await:()=>S,__awaiter:()=>p,__classPrivateFieldGet:()=>E,__classPrivateFieldIn:()=>B,__classPrivateFieldSet:()=>j,__createBinding:()=>g,__decorate:()=>i,__esDecorate:()=>d,__exportStar:()=>h,__extends:()=>n,__generator:()=>v,__importDefault:()=>x,__importStar:()=>T,__makeTemplateObject:()=>w,__metadata:()=>m,__param:()=>s,__propKey:()=>u,__read:()=>y,__rest:()=>l,__runInitializers:()=>c,__setFunctionName:()=>f,__spread:()=>_,__spreadArray:()=>C,__spreadArrays:()=>k,__values:()=>b,default:()=>A});var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)};function l(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}function i(e,t,r,o){var n,a=arguments.length,l=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,r,o);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(a<3?n(l):a>3?n(t,r,l):n(t,r))||l);return a>3&&l&&Object.defineProperty(t,r,l),l}function s(e,t){return function(r,o){t(r,o,e)}}function d(e,t,r,o,n,a){function l(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var i,s=o.kind,d="getter"===s?"get":"setter"===s?"set":"value",c=!t&&e?o.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,o.name):{}),f=!1,m=r.length-1;m>=0;m--){var p={};for(var v in o)p[v]="access"===v?{}:o[v];for(var v in o.access)p.access[v]=o.access[v];p.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(l(e||null))};var g=(0,r[m])("accessor"===s?{get:u.get,set:u.set}:u[d],p);if("accessor"===s){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(i=l(g.get))&&(u.get=i),(i=l(g.set))&&(u.set=i),(i=l(g.init))&&n.unshift(i)}else(i=l(g))&&("field"===s?n.unshift(i):u[d]=i)}c&&Object.defineProperty(c,o.name,u),f=!0}function c(e,t,r){for(var o=arguments.length>2,n=0;n<t.length;n++)r=o?t[n].call(e,r):t[n].call(e);return o?r:void 0}function u(e){return"symbol"==typeof e?e:"".concat(e)}function f(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function m(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,o){return new(r||(r=Promise))((function(n,a){function l(e){try{s(o.next(e))}catch(e){a(e)}}function i(e){try{s(o.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(l,i)}s((o=o.apply(e,t||[])).next())}))}function v(e,t){var r,o,n,a,l={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,i[0]&&(l=0)),l;)try{if(r=1,o&&(n=2&i[0]?o.return:i[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,i[1])).done)return n;switch(o=0,n&&(i=[2&i[0],n.value]),i[0]){case 0:case 1:n=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,o=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!((n=(n=l.trys).length>0&&n[n.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){l.label=i[1];break}if(6===i[0]&&l.label<n[1]){l.label=n[1],n=i;break}if(n&&l.label<n[2]){l.label=n[2],l.ops.push(i);break}n[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],o=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var g=Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]};function h(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||g(t,e,r)}function b(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,a=r.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(o=a.next()).done;)l.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return l}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function k(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var o=Array(e),n=0;for(t=0;t<r;t++)for(var a=arguments[t],l=0,i=a.length;l<i;l++,n++)o[n]=a[l];return o}function C(e,t,r){if(r||2===arguments.length)for(var o,n=0,a=t.length;n<a;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function P(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,n=r.apply(e,t||[]),a=[];return o={},l("next"),l("throw"),l("return"),o[Symbol.asyncIterator]=function(){return this},o;function l(e){n[e]&&(o[e]=function(t){return new Promise((function(r,o){a.push([e,t,r,o])>1||i(e,t)}))})}function i(e,t){try{(r=n[e](t)).value instanceof S?Promise.resolve(r.value.v).then(s,d):c(a[0][2],r)}catch(e){c(a[0][3],e)}var r}function s(e){i("next",e)}function d(e){i("throw",e)}function c(e,t){e(t),a.shift(),a.length&&i(a[0][0],a[0][1])}}function O(e){var t,r;return t={},o("next"),o("throw",(function(e){throw e})),o("return"),t[Symbol.iterator]=function(){return this},t;function o(o,n){t[o]=e[o]?function(t){return(r=!r)?{value:S(e[o](t)),done:!1}:n?n(t):t}:n}}function M(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=b(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(r){t[r]=e[r]&&function(t){return new Promise((function(o,n){!function(e,t,r,o){Promise.resolve(o).then((function(t){e({value:t,done:r})}),t)}(o,n,(t=e[r](t)).done,t.value)}))}}}function w(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var F=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&g(t,e,r);return F(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function E(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)}function j(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r}function B(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}const A={__extends:n,__assign:a,__rest:l,__decorate:i,__param:s,__metadata:m,__awaiter:p,__generator:v,__createBinding:g,__exportStar:h,__values:b,__read:y,__spread:_,__spreadArrays:k,__spreadArray:C,__await:S,__asyncGenerator:P,__asyncDelegator:O,__asyncValues:M,__makeTemplateObject:w,__importStar:T,__importDefault:x,__classPrivateFieldGet:E,__classPrivateFieldSet:j,__classPrivateFieldIn:B}}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o=r(5803);roosterjsContentModel=o})();
//# sourceMappingURL=rooster-content-model-min.js.map